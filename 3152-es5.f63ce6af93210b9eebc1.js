!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[3152],{66341:function(t,i,r){r.d(i,{n:function(){return l}});var s,a=r(88002),o=r(15189),c=r(37716),l=((s=function(){function t(n){e(this,t),this.reqAPIService=n,this.urlApi="/manager/farm-api"}return n(t,[{key:"searchMember",value:function(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-user&key="+e).pipe((0,a.U)(function(e){return e.data}))}},{key:"searchExpert",value:function(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-expert&key="+e).pipe((0,a.U)(function(e){return e.data}))}},{key:"getSitePath",value:function(){return this.reqAPIService.FILE_PATH}}]),t}()).\u0275fac=function(e){return new(e||s)(c.LFG(o.$))},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac}),s)},54101:function(t,i,r){r.d(i,{C:function(){return v}});var s=r(90665),a=r(28049),o=r(27887),c=r(22923),l=r(37716),u=r(47063),g=r(81780),d=r(84465),m=r(71239),p=r(38583);function Z(e,t){if(1&e&&(l.TgZ(0,"div",13),l.TgZ(1,"ion-text",14),l.TgZ(2,"i"),l._uU(3),l.qZA(),l.qZA(),l.qZA()),2&e){var n=l.oxw();l.xp6(3),l.Oqu(n.message)}}function f(e,t){1&e&&(l.TgZ(0,"div"),l._UZ(1,"ion-spinner",15),l.qZA())}var h,v=((h=function(){function t(n,i,r,a,c){e(this,t),this.modalController=n,this.translate=i,this.storeService=r,this.toastService=a,this.dbLocalService=c,this.form=new s.cw({name:new s.NI("",s.kI.required),area:new s.NI("",s.kI.required),description:new s.NI("")}),this.savingFlag=new o.E,this.manager=[]}return n(t,[{key:"ngOnInit",value:function(){this.form.setValue({name:this.data.name,area:this.data.area,description:this.data.description})}},{key:"onSubmit",value:function(){var e=this;this.savingFlag.setPending(!0),this.storeService.sendPost("edit",this.form.value).pipe((0,a.P)()).subscribe(function(t){if(1===t.status){e.modalController.dismiss(e.form.value);var n=e.dbLocalService.stores.findIndex(function(t){return t.infor.code===e.storeService.getStoreCode()});n>=0&&(e.dbLocalService.stores[n].infor.name=e.form.value.name,e.dbLocalService.stores[n].infor.area=e.form.value.area,e.dbLocalService.stores[n].infor.description=e.form.value.description,e.dbLocalService.setLocalData("stores",e.dbLocalService.stores))}else e.message=t.error;e.savingFlag.setResult(!0)},function(t){e.savingFlag.setResult(!1),e.message=e.translate.instant("ERROR_CONNECT")})}}]),t}()).\u0275fac=function(e){return new(e||h)(l.Y36(u.IN),l.Y36(g.sK),l.Y36(c.d),l.Y36(d.k),l.Y36(m.T))},h.\u0275cmp=l.Xpm({type:h,selectors:[["app-store-edit"]],inputs:{data:"data"},decls:32,vars:19,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["class","ion-padding ion-text-center",4,"ngIf"],[3,"formGroup","ngSubmit"],["lines","inset"],["position","floating"],["type","text","formControlName","name","inputmode","text"],["type","number","formControlName","area","inputmode","text"],["type","text","formControlName","description","inputmode","text"],[1,"ion-text-center","ion-padding"],[4,"ngIf"],["type","submit","color","primary","shape","round",3,"disabled"],[1,"ion-padding","ion-text-center"],["color","danger"],["name","dots"]],template:function(e,t){1&e&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l.TgZ(3,"ion-button",1),l.NdJ("click",function(){return t.modalController.dismiss()}),l._UZ(4,"ion-icon",2),l.qZA(),l.qZA(),l.TgZ(5,"ion-title"),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"ion-content"),l.YNc(9,Z,4,1,"div",3),l.TgZ(10,"form",4),l.NdJ("ngSubmit",function(){return t.onSubmit()}),l.TgZ(11,"ion-list"),l.TgZ(12,"ion-item",5),l.TgZ(13,"ion-label",6),l._uU(14),l.ALo(15,"translate"),l.qZA(),l._UZ(16,"ion-input",7),l.qZA(),l.TgZ(17,"ion-item",5),l.TgZ(18,"ion-label",6),l._uU(19),l.ALo(20,"translate"),l.qZA(),l._UZ(21,"ion-input",8),l.qZA(),l.TgZ(22,"ion-item",5),l.TgZ(23,"ion-label",6),l._uU(24),l.ALo(25,"translate"),l.qZA(),l._UZ(26,"ion-textarea",9),l.qZA(),l.qZA(),l.TgZ(27,"div",10),l.YNc(28,f,2,0,"div",11),l.TgZ(29,"ion-button",12),l._uU(30),l.ALo(31,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(6),l.Oqu(l.lcZ(7,9,"WAREHOUSE_MOD.UPDATE_INFOR")),l.xp6(3),l.Q6J("ngIf",t.message),l.xp6(1),l.Q6J("formGroup",t.form),l.xp6(4),l.Oqu(l.lcZ(15,11,"WAREHOUSE_MOD.NAME")),l.xp6(5),l.Oqu(l.lcZ(20,13,"AREA")),l.xp6(5),l.Oqu(l.lcZ(25,15,"PHOTO_MOD.DESCRIPTION")),l.xp6(4),l.Q6J("ngIf",t.savingFlag.pending),l.xp6(1),l.Q6J("disabled",t.form.invalid||t.savingFlag.pending),l.xp6(1),l.hij("",l.lcZ(31,17,"WAREHOUSE_MOD.SAVE")," "))},directives:[u.Gu,u.sr,u.Sm,u.YG,u.gu,u.wd,u.W2,p.O5,s._Y,s.JL,s.sg,u.q_,u.Ie,u.Q$,u.pK,u.j9,s.JJ,s.u,u.as,u.g2,u.yW,u.PQ],pipes:[g.X$],styles:[""]}),h)},12039:function(t,i,r){r.d(i,{N:function(){return b}});var s=r(64762),a=r(79765),o=r(25917),c=r(54395),l=r(87519),u=r(43190),g=r(27887),d=r(66341),m=r(22923),p=r(37716),Z=r(47063),f=r(84465),h=r(81780),v=r(38583);function A(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"ion-item"),p.TgZ(1,"ion-avatar",0),p._UZ(2,"img",8),p.qZA(),p.TgZ(3,"ion-label"),p.TgZ(4,"h3"),p._uU(5),p.qZA(),p.qZA(),p.TgZ(6,"ion-button",9),p.NdJ("click",function(){var e=p.CHM(n).index;return p.oxw().presentRemoveUser(e)}),p._uU(7),p.ALo(8,"translate"),p.qZA(),p.qZA()}if(2&e){var i=t.$implicit;p.xp6(5),p.Oqu(i.user_name),p.xp6(2),p.hij(" ",p.lcZ(8,2,"POND_MOD.DELETE")," ")}}function T(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"ion-item"),p.TgZ(1,"ion-avatar",0),p._UZ(2,"img",10),p.qZA(),p.TgZ(3,"ion-label"),p.TgZ(4,"h3"),p._uU(5),p.qZA(),p.TgZ(6,"p"),p._uU(7),p.qZA(),p.qZA(),p.TgZ(8,"ion-button",11),p.NdJ("click",function(){var e=p.CHM(n).$implicit;return p.oxw().addPermission(e)}),p._uU(9),p.ALo(10,"translate"),p.qZA(),p.qZA()}if(2&e){var i=t.$implicit,r=p.oxw();p.xp6(2),p.Q6J("src",r.memberService.getSitePath()+"/upload/users/avatars/medium/"+i.photo,p.LSH),p.xp6(3),p.Oqu(i.username),p.xp6(2),p.Oqu(i.email),p.xp6(1),p.Q6J("disabled",r.checkExistUser(i)),p.xp6(1),p.hij(" ",p.lcZ(10,5,"POND_MOD.SELECT")," ")}}function q(e,t){if(1&e&&(p.TgZ(0,"ion-item",12),p.TgZ(1,"ion-label"),p.TgZ(2,"p"),p._uU(3),p.qZA(),p.qZA(),p.qZA()),2&e){var n=p.oxw();p.xp6(3),p.Oqu(n.message)}}function O(e,t){1&e&&(p.TgZ(0,"div"),p._UZ(1,"ion-spinner",13),p.qZA())}var _,b=((_=function(){function t(n,i,r,s,o,c){e(this,t),this.modalController=n,this.storeService=i,this.memberService=r,this.toastService=s,this.translate=o,this.alertController=c,this.savingFlag=new g.E,this.loadingFlag=new g.E,this.searchTerms=new a.xQ}return n(t,[{key:"ngOnInit",value:function(){var e=this,t=this.searchTerms.pipe((0,c.b)(300),(0,l.x)(),(0,u.w)(function(t){return e.getListMember(t)}));this.members$=t,this.members$.subscribe(function(t){t?(e.loadingFlag.setResult(!0),e.message=""):(e.loadingFlag.setResult(!1),e.message=e.translate.instant("POND_MOD.NOT_FOUND"))})}},{key:"search",value:function(e){this.searchTerms.next(e.detail.value)}},{key:"getListMember",value:function(e){return this.loadingFlag.setPending(!0),e.trim()?this.memberService.searchMember(e).pipe():(this.loadingFlag.setResult(!0),(0,o.of)([]))}},{key:"onSelect",value:function(e){this.memberSelected=e}},{key:"addPermission",value:function(e){var t=this;this.storeService.sendPost("addMember",{user_manager:e.user_id}).pipe().subscribe(function(n){0==n.status?t.toastService.warning(n.error):(t.manager.push({user_name:e.username,user_id:e.user_id}),t.toastService.success(t.translate.instant("FARM_MOD.ADDED_STAFF"))),t.savingFlag.setResult(!0)},function(e){t.savingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"removePermission",value:function(e){var t=this;this.storeService.getApiStore("removeMember","&user_id="+this.manager[e].user_id).pipe().subscribe(function(n){0==n.status?t.toastService.warning(n.error):(t.manager.splice(e,1),t.toastService.success(t.translate.instant("FARM_MOD.REMOVED_STAFF"))),t.savingFlag.setResult(!0)},function(e){t.savingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"presentRemoveUser",value:function(e){return(0,s.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_REMOVE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){n.removePermission(e)}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"close",value:function(){this.modalController.dismiss(this.manager)}},{key:"checkExistUser",value:function(e){for(var t=0;t<this.manager.length;t++)if(this.manager[t].user_name==e.username)return!0;return!1}}]),t}()).\u0275fac=function(e){return new(e||_)(p.Y36(Z.IN),p.Y36(m.d),p.Y36(d.n),p.Y36(f.k),p.Y36(h.sK),p.Y36(Z.Br))},_.\u0275cmp=p.Xpm({type:_,selectors:[["app-store-manager"]],inputs:{manager:"manager"},decls:23,vars:15,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"placeholder","ionChange"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],[4,"ngIf"],["src","assets/img/default-profile.jpg"],["slot","end","color","danger",3,"click"],["onError","this.src='assets/img/default-profile.jpg'",3,"src"],["slot","end",3,"disabled","click"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(p.TgZ(0,"ion-header"),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-buttons",0),p.TgZ(3,"ion-button",1),p.NdJ("click",function(){return t.close()}),p._UZ(4,"ion-icon",2),p.qZA(),p.qZA(),p.TgZ(5,"ion-title"),p._uU(6),p.ALo(7,"translate"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"ion-content"),p.TgZ(9,"ion-searchbar",3),p.NdJ("ionChange",function(e){return t.search(e)}),p.ALo(10,"translate"),p.qZA(),p.TgZ(11,"ion-list"),p.YNc(12,A,9,4,"ion-item",4),p.qZA(),p.TgZ(13,"ion-list"),p.TgZ(14,"ion-list-header"),p.TgZ(15,"ion-label"),p._uU(16),p.ALo(17,"translate"),p.qZA(),p.qZA(),p.YNc(18,T,11,7,"ion-item",4),p.ALo(19,"async"),p.YNc(20,q,4,1,"ion-item",5),p.qZA(),p.TgZ(21,"div",6),p.YNc(22,O,2,0,"div",7),p.qZA(),p.qZA()),2&e&&(p.xp6(6),p.Oqu(p.lcZ(7,7,"FARM_MOD.MEMBER")),p.xp6(3),p.Q6J("placeholder",p.lcZ(10,9,"FARM_MOD.MANAGER_EMAIL")),p.xp6(3),p.Q6J("ngForOf",t.manager),p.xp6(4),p.Oqu(p.lcZ(17,11,"POND_MOD.RESULT")),p.xp6(2),p.Q6J("ngForOf",p.lcZ(19,13,t.members$)),p.xp6(2),p.Q6J("ngIf",t.message),p.xp6(2),p.Q6J("ngIf",t.loadingFlag.pending))},directives:[Z.Gu,Z.sr,Z.Sm,Z.YG,Z.gu,Z.wd,Z.W2,Z.VI,Z.j9,Z.q_,v.sg,Z.yh,Z.Q$,v.O5,Z.Ie,Z.BJ,Z.PQ],pipes:[h.X$,v.Ov],styles:[""]}),_)},93152:function(t,i,r){r.d(i,{T:function(){return h}});var s,a=r(64762),o=r(27887),c=r(54101),l=r(12039),u=r(22923),g=r(37716),d=r(47063),m=r(81780),p=r(84465),Z=r(71239),f=r(13619),h=((s=function(){function t(n,i,r,s,a,c,l){e(this,t),this.modalController=n,this.storeService=i,this.translate=r,this.toastService=s,this.alertController=a,this.dbLocalService=c,this.router=l,this.loading=new o.E,this.manager=[]}return n(t,[{key:"ngOnInit",value:function(){this.getSetting()}},{key:"getSetting",value:function(){var e=this;this.loading.setPending(!0),this.storeService.getApiStore("getSetting").subscribe(function(t){1===t.status?(e.store=t.data.infor,e.manager=t.data.managers):e.toastService.warning(t.error)},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"presentManager",value:function(){return(0,a.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:l.N,componentProps:{manager:this.manager}});case 2:return(t=e.sent).onDidDismiss().then(function(e){e.data&&(n.manager=e.data)}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentEdit",value:function(){return(0,a.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:c.C,componentProps:{data:this.store}});case 2:return(t=e.sent).onDidDismiss().then(function(e){e.data&&(n.store.name=e.data.name,n.store.area=e.data.area,n.store.description=e.data.description)}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentDelete",value:function(){return(0,a.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.CAREFUL"),message:this.translate.instant("POND_MOD.CONFIRM_DELETE")+" <strong>"+this.store.name+"</strong>?",inputs:[{name:"confirmInput",type:"text",placeholder:this.translate.instant("POND_MOD.ENTER")+' "OK"'}],buttons:[{text:this.translate.instant("NO"),role:"cancel",cssClass:"secondary"},{text:this.translate.instant("POND_MOD.DELETE"),cssClass:"secondary",handler:function(e){"OK"===e.confirmInput&&t.delete()}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"delete",value:function(){var e=this;this.storeService.getApiStore("remove","&wcode="+this.store.code+"&fcode="+this.storeService.getFarmCode(),"manager/store-api-mobie").pipe().subscribe(function(t){if(1==t.status){var n=e.dbLocalService.stores.findIndex(function(t){return t.infor.code===e.store.code});e.dbLocalService.stores.splice(n,1),e.dbLocalService.setLocalData("stores",e.dbLocalService.stores),e.toastService.success(e.translate.instant("WAREHOUSE_MOD.DELETED")),e.modalController.dismiss(),e.router.navigateByUrl("store/"+e.storeService.getFarmCode()+"/list")}else e.toastService.warning(t.error)})}}]),t}()).\u0275fac=function(e){return new(e||s)(g.Y36(d.IN),g.Y36(u.d),g.Y36(m.sK),g.Y36(p.k),g.Y36(d.Br),g.Y36(Z.T),g.Y36(f.F0))},s.\u0275cmp=g.Xpm({type:s,selectors:[["app-store-setting"]],decls:56,vars:29,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding","ion-text-center"],[1,""],["name","cube-outline","slot","start"],["name","book-outline","slot","start"],["detail","",3,"click"],["src","assets/icon/supervised_user_circle-24px.svg","slot","start"],["mode","ios"],["name","options"],["size","large","expand","block","shape","round","fill","outline",3,"click"],["name","create-outline","slot","start"],["size","small","color","medium","expand","block","fill","clear",3,"click"],["name","remove-circle-outline","slot","start"]],template:function(e,t){1&e&&(g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar"),g.TgZ(2,"ion-buttons",0),g.TgZ(3,"ion-button",1),g.NdJ("click",function(){return t.modalController.dismiss()}),g._UZ(4,"ion-icon",2),g.qZA(),g.qZA(),g.TgZ(5,"ion-title"),g._uU(6),g.ALo(7,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(8,"ion-content"),g.TgZ(9,"div",3),g.TgZ(10,"h1",4),g._uU(11),g.qZA(),g.TgZ(12,"span"),g._uU(13),g.qZA(),g.qZA(),g.TgZ(14,"ion-list"),g.TgZ(15,"ion-item"),g._UZ(16,"ion-icon",5),g.TgZ(17,"ion-label"),g.TgZ(18,"h3"),g._uU(19),g.ALo(20,"translate"),g.qZA(),g.TgZ(21,"p"),g._uU(22),g.qZA(),g.qZA(),g.qZA(),g.TgZ(23,"ion-item"),g._UZ(24,"ion-icon",6),g.TgZ(25,"ion-label"),g.TgZ(26,"h3"),g._uU(27),g.ALo(28,"translate"),g.qZA(),g.TgZ(29,"p"),g._uU(30),g.qZA(),g.qZA(),g.qZA(),g.TgZ(31,"ion-item",7),g.NdJ("click",function(){return t.presentManager()}),g._UZ(32,"ion-icon",8),g.TgZ(33,"ion-label"),g.TgZ(34,"h3"),g._uU(35),g.ALo(36,"translate"),g.qZA(),g.TgZ(37,"p"),g._uU(38),g.ALo(39,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(40,"div"),g.TgZ(41,"ion-card",9),g.TgZ(42,"ion-card-header"),g.TgZ(43,"ion-card-subtitle"),g._UZ(44,"ion-icon",10),g._uU(45),g.ALo(46,"translate"),g.qZA(),g.qZA(),g.TgZ(47,"ion-card-content"),g.TgZ(48,"ion-button",11),g.NdJ("click",function(){return t.presentEdit()}),g._UZ(49,"ion-icon",12),g._uU(50),g.ALo(51,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(52,"ion-button",13),g.NdJ("click",function(){return t.presentDelete()}),g._UZ(53,"ion-icon",14),g._uU(54),g.ALo(55,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.xp6(6),g.Oqu(g.lcZ(7,13,"WAREHOUSE_MOD.SETTING")),g.xp6(5),g.Oqu(null==t.store?null:t.store.name),g.xp6(2),g.hij("#",null==t.store?null:t.store.code,""),g.xp6(6),g.Oqu(g.lcZ(20,15,"AREA")),g.xp6(3),g.hij("",null==t.store?null:t.store.area," m2"),g.xp6(5),g.Oqu(g.lcZ(28,17,"PHOTO_MOD.DESCRIPTION")),g.xp6(3),g.Oqu(null==t.store?null:t.store.description),g.xp6(5),g.Oqu(g.lcZ(36,19,"FARM_MOD.MANAGER")),g.xp6(3),g.AsE("",null==t.manager?null:t.manager.length," ",g.lcZ(39,21,"FARM_MOD.MEMBER"),""),g.xp6(7),g.hij(" ",g.lcZ(46,23,"WAREHOUSE_MOD.SETTING")," "),g.xp6(5),g.hij(" ",g.lcZ(51,25,"FARM_MOD.EDIT")," "),g.xp6(4),g.hij(" ",g.lcZ(55,27,"DEVICE_MOD.REMOVE")," "))},directives:[d.Gu,d.sr,d.Sm,d.YG,d.gu,d.wd,d.W2,d.q_,d.Ie,d.Q$,d.PM,d.Zi,d.tO,d.FN],pipes:[m.X$],styles:[""]}),s)}}])}();