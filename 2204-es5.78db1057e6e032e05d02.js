!function(){"use strict";function e(e,n){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){c=!0,r=e},f:function(){try{s||null==i.return||i.return()}finally{if(c)throw r}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return o(this,n)}}function o(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[2204],{54395:function(e,t,o){o.d(t,{b:function(){return l}});var a=o(77393),s=o(33637);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.P;return function(n){return n.lift(new u(e,t))}}var u=function(){function e(t,n){r(this,e),this.dueTime=t,this.scheduler=n}return c(e,[{key:"call",value:function(e,t){return t.subscribe(new d(e,this.dueTime,this.scheduler))}}]),e}(),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(o,e);var t=i(o);function o(e,n,i){var a;return r(this,o),(a=t.call(this,e)).dueTime=n,a.scheduler=i,a.debouncedSubscription=null,a.lastValue=null,a.hasValue=!1,a}return c(o,[{key:"_next",value:function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(g,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}},{key:"clearDebounce",value:function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}]),o}(a.L);function g(e){e.debouncedNext()}},62014:function(e,t,n){n.d(t,{y:function(){return i}});var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currency";r(this,e),this.setType(n),this.setInput(t),this.processConvert()}return c(e,[{key:"setInput",value:function(e){"string"!=typeof e&&(e=String(e)),this.input=e}},{key:"setValue",value:function(e){"string"!=typeof e&&(e=String(e)),this.input=e,this.processConvert()}},{key:"setType",value:function(e){this.type=e}},{key:"processConvert",value:function(){var e,t,n=this.input.split(",").join("");if(n.indexOf(".")!=n.lastIndexOf(".")&&(n=n.slice(0,n.lastIndexOf("."))),-1!=n.indexOf(".")){t=n.indexOf(".");var i=n.split(".");n=i[0],"float"===this.type&&(e=i[1].substring(0,2))}else t=n.length;for(var o=new Array,a=1,r=-3;Math.abs(r)<t;r-=3)o.push(n.slice(r,t+r+3)),a++;var s=n.slice(0,t-3*(a-1));s.length>0&&o.push(s),o.reverse();var c=n.replace(/,/gi,""),l="";this.fakeView=o.join(),"float"===this.type&&null!=e&&(this.fakeView=this.fakeView+"."+e,l=e),this.realValue=parseFloat(c+"."+l)}}]),e}()},19228:function(e,t,n){n.d(t,{r:function(){return l}});var i,o=n(15189),a=n(88002),s=n(37716),l=((i=function(){function e(t){r(this,e),this.reqAPIService=t,this.urlApi="/manager/money-api-mobie",this.urlApiNew="/manager/finance-api"}return c(e,[{key:"setCode",value:function(e){this.fcode=e,console.log(this.fcode)}},{key:"loadMoney",value:function(e){return this.reqAPIService.get(this.urlApiNew+"?fcode="+this.fcode+"&action=list&page="+e).pipe((0,a.U)(function(e){return e}))}},{key:"search",value:function(e){return this.reqAPIService.get(this.urlApiNew+"?fcode="+this.fcode+"&action=search&keyword="+e.keyword+"&type="+e.type+"&timeFrom="+e.timeFrom+"&timeTo="+e.timeTo+"&page=0&numRow=20").pipe((0,a.U)(function(e){return e}))}},{key:"quickSearch",value:function(e){return this.reqAPIService.get(this.urlApiNew+"?fcode="+this.fcode+"&action=quick-search&type="+e.type+"&keyword="+e.keyword).pipe((0,a.U)(function(e){return e}))}},{key:"add",value:function(e){return this.reqAPIService.postApiWithFile("add",e,"&fcode="+this.fcode,this.urlApiNew)}},{key:"edit",value:function(e){return this.reqAPIService.postApiWithFile("edit",e,"&fcode="+this.fcode+"&item="+e.get("id")+"&cr="+e.get("type"),this.urlApiNew)}},{key:"editGroup",value:function(e){return this.reqAPIService.postApiWithFile("editTypeAll",e,"&fcode="+this.fcode+"&item="+e.get("id")+"&cr="+e.get("type"),this.urlApiNew)}},{key:"delete",value:function(e){return this.reqAPIService.get(this.urlApiNew+"?fcode="+this.fcode+"&action=detele&item="+e.item+"&cr="+e.cr)}},{key:"getAnalyst",value:function(e){return this.reqAPIService.post(this.urlApiNew+"?fcode="+this.fcode+"&action=analyst",e)}},{key:"getGroup",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?fcode="+this.fcode+"&action=getItemByCode&code="+e+"&cr="+t)}},{key:"getCategories",value:function(){return this.reqAPIService.get(this.urlApiNew+"?fcode="+this.fcode+"&action=listCategory")}},{key:"confirmMoney",value:function(e,t,n,i){return this.reqAPIService.get(this.urlApiNew+"?action=confirm&ccode="+n+"&cr="+t+"&id="+e+"&confirm="+i)}},{key:"updateFund",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?action=updateFund&fcode="+e+"&value="+t)}},{key:"addCategory",value:function(e){return this.reqAPIService.post(this.urlApiNew+"?action=addCategory&fcode="+this.fcode,e)}},{key:"searchCustomer",value:function(e,t){return this.reqAPIService.post(this.urlApiNew+"?action=searchCustomer&fcode="+this.fcode,{name:e,type:t})}},{key:"getBill",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?action=get&fcode="+this.fcode+"&type="+t+"&id="+e)}},{key:"getCustomers",value:function(){return this.reqAPIService.get(this.urlApiNew+"?action=getCustomers&fcode="+this.fcode)}},{key:"getACustomer",value:function(e){return this.reqAPIService.get(this.urlApiNew+"?action=getACustomer&fcode="+this.fcode+"&customer_slug="+e)}},{key:"getDebtCustomer",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?action=getDebtCustomer&type="+t+"&fcode="+this.fcode+"&customer_slug="+e)}},{key:"addMultiDebtRecord",value:function(e){return this.reqAPIService.post(this.urlApiNew+"?action=addMultiDebt&fcode="+this.fcode,e)}},{key:"getBillByAlias",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?action=getByAlias&fcode="+this.fcode+"&alias="+e+"&type="+t)}},{key:"getListMoneyByGroup",value:function(){return this.reqAPIService.get(this.urlApiNew+"?action=getListMoneyByGroup&fcode="+this.fcode)}},{key:"getDetailByGroup",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?action=getDetailByGroup&fcode="+this.fcode+"&group="+e+"&type="+t)}},{key:"getDebtByGroup",value:function(e,t){return this.reqAPIService.get(this.urlApiNew+"?action=getDebtByGroup&type="+t+"&fcode="+this.fcode+"&group="+e)}}]),e}()).\u0275fac=function(e){return new(e||i)(s.LFG(o.$))},i.\u0275prov=s.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},92204:function(t,n,i){i.r(n),i.d(n,{PondPageModule:function(){return Ts}});var o=i(38583),a=i(90665),s=i(13619),l=i(47063),u=i(56209),d=i(64762),g=i(80272),p=i(27887),m=i(16738),h=i(37716),f=i(81780);function Z(e,t){1&e&&(h.TgZ(0,"div",8),h._UZ(1,"ion-spinner",9),h.qZA())}function v(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",10),h.TgZ(2,"p"),h.TgZ(3,"ion-text",11),h._uU(4),h.qZA(),h._uU(5),h.qZA(),h.TgZ(6,"h3"),h._uU(7),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(4),h.Oqu(n.vendor_name),h.xp6(1),h.hij(" ",n.time," "),h.xp6(2),h.Oqu(n.message)}}function A(e,t){if(1&e&&(h.TgZ(0,"div",12),h.TgZ(1,"p"),h._uU(2),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(n.message)}}var _,T=((_=function(){function e(t,n,i){r(this,e),this.modalCtrl=t,this.pondService=n,this.translate=i,this.loadingFlag=new p.E,this.alertItems=[],this.message="",this.pageIndex=0}return c(e,[{key:"ngOnInit",value:function(){this.loadAlerList()}},{key:"loadAlerList",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.getAlertList(this.pageIndex).pipe().subscribe(function(t){t.data&&t.data.length>0&&t.data.map(function(t){t.time=m(1e3*t.add_time).fromNow(),e.alertItems.push(t)}),e.alertItems.length<10&&(e.infiniteScroll.disabled=!e.infiniteScroll.disabled),e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.message=e.translate.instant("ERROR_CONNECT")})}},{key:"loadData",value:function(e){var t=this;this.pageIndex++,this.pondService.getAlertList(this.pageIndex).pipe().subscribe(function(n){n.data&&n.data.length>0?n.data.map(function(e){e.time=m(1e3*e.add_time).fromNow(),t.alertItems.push(e)}):e.target.disabled=!0,e.target.complete()},function(n){e.target.complete(),t.message=t.translate.instant("ERROR_CONNECT")}),this.pageIndex>20&&(e.target.disabled=!0)}}]),e}()).\u0275fac=function(e){return new(e||_)(h.Y36(l.IN),h.Y36(g.p),h.Y36(f.sK))},_.\u0275cmp=h.Xpm({type:_,selectors:[["app-pond-alert"]],viewQuery:function(e,t){var n;1&e&&h.Gf(l.ju,5),2&e&&h.iGM(n=h.CRH())&&(t.infiniteScroll=n.first)},decls:15,vars:6,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["class","spiner-loading",4,"ngIf"],[4,"ngFor","ngForOf"],["class","ion-padding",4,"ngIf"],[3,"ionInfinite"],["loadingSpinner","dots"],[1,"spiner-loading"],["name","dots"],[1,"ion-text-wrap"],["color","primary"],[1,"ion-padding"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.YNc(9,Z,2,0,"div",3),h.TgZ(10,"ion-list"),h.YNc(11,v,8,3,"ion-item",4),h.qZA(),h.YNc(12,A,3,1,"div",5),h.TgZ(13,"ion-infinite-scroll",6),h.NdJ("ionInfinite",function(e){return t.loadData(e)}),h._UZ(14,"ion-infinite-scroll-content",7),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"POND_MOD.WARNING")),h.xp6(3),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(2),h.Q6J("ngForOf",t.alertItems),h.xp6(1),h.Q6J("ngIf",t.message))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o.O5,l.q_,o.sg,l.ju,l.MB,l.PQ,l.Ie,l.Q$,l.yW],pipes:[f.X$],styles:[""]}),_),x=i(84465);function q(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-chip",18),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).choiceSuggest(e)}),h.TgZ(1,"ion-label"),h._uU(2),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.Oqu(i)}}function O(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"p"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.YNc(4,q,3,1,"ion-chip",17),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"POND_MOD.SUGGEST")),h.xp6(2),h.Q6J("ngForOf",n.valueSuggest)}}var b=function(){var e=function(){function e(t,n,i,o){r(this,e),this.toastService=t,this.modalCtrl=n,this.pondService=i,this.translate=o,this.saveLoadingFlag=new p.E,this.form=new a.cw({date:new a.NI(m().format("YYYY-MM-DD")),value:new a.NI("",[a.kI.required,a.kI.min(0)])}),this.seedsSuggest=[.9,.95,1,1.05,1.1],this.valueSuggest=[],this.maxDate=m(),this.minDate=m().subtract(180,"days")}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.form.patchValue({value:this.factor.values[0]}),this.form.controls.value.setValidators([a.kI.min(this.factor.min),a.kI.max(this.factor.max)]),this.factor.values[0]>0&&this.seedsSuggest.forEach(function(t){var n=+(t*e.factor.values[0]).toFixed(1);-1==e.valueSuggest.indexOf(+n)&&e.valueSuggest.push(n)}),this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.form.controls.date.valueChanges.subscribe(function(t){var n=m(t).format("YYYY-MM-DD");e.pondService.loadDay(n).subscribe(function(t){t.data?e.form.patchValue({value:t.data[e.factor.key]}):e.form.controls.value.reset()}),console.log(e.form.value)})}},{key:"dismiss",value:function(){this.modalCtrl.dismiss()}},{key:"onSave",value:function(){var e=this;this.saveLoadingFlag.setPending(!0);var t={};t[this.factor.key]=this.form.value.value;var n=m(this.form.value.date).format("YYYY-MM-DD");this.pondService.quickUpdateParam(t,n).pipe().subscribe(function(t){"success"!=t.status?e.toastService.warning(t.message):e.toastService.success(t.message),e.saveLoadingFlag.setResult(!0),e.form.value.date==e.maxDate.format("YYYY-MM-DD")?e.modalCtrl.dismiss({value:e.form.value.value}):e.dismiss()},function(){e.saveLoadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"choiceSuggest",value:function(e){this.form.patchValue({value:e})}},{key:"changeDate",value:function(e){var t=m(this.form.value.date).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.form.patchValue({date:t.format("YYYY-MM-DD")}),console.log(this.form.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(x.k),h.Y36(l.IN),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-parameter-update"]],inputs:{factor:"factor"},decls:36,vars:25,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[3,"formGroup"],[1,"ion-text-center"],[1,"title","ion-padding"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],["formControlName","date",1,"ion-text-center","w-100",3,"displayFormat","min","max"],["slot","icon-only","name","arrow-forward"],["lines","none",1,"ion-text-center"],["type","tel","inputmode","decimal","required","","autofocus","","formControlName","value",1,"l-r",3,"placeholder"],["class","ion-text-center",4,"ngIf"],["color","secondary","outline","true",3,"click",4,"ngFor","ngForOf"],["color","secondary","outline","true",3,"click"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.onSave()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content",5),h.TgZ(13,"div",6),h.TgZ(14,"h1",7),h._uU(15),h.ALo(16,"translate"),h.ALo(17,"uppercase"),h.TgZ(18,"small"),h._uU(19),h.qZA(),h.qZA(),h.TgZ(20,"ion-grid"),h.TgZ(21,"ion-row"),h.TgZ(22,"ion-col",8),h.TgZ(23,"ion-button",9),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(24,"ion-icon",10),h.qZA(),h.qZA(),h.TgZ(25,"ion-col",11),h.TgZ(26,"ion-item",6),h._UZ(27,"ion-datetime",12),h.ALo(28,"translate"),h.qZA(),h.qZA(),h.TgZ(29,"ion-col",8),h.TgZ(30,"ion-button",9),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(31,"ion-icon",13),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(32,"ion-item",14),h._UZ(33,"ion-input",15),h.ALo(34,"translate"),h.qZA(),h.YNc(35,O,5,4,"div",16),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,13,"POND_MOD.ADD_EN_INDEX")),h.xp6(6),h.Q6J("disabled",t.form.invalid),h.xp6(1),h.hij(" ",h.lcZ(11,15,"POND_MOD.SAVE")," "),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(3),h.hij("",h.lcZ(16,17,h.lcZ(17,19,"POND_MOD.PARAM."+t.factor.name))," "),h.xp6(4),h.Oqu(t.factor.unit),h.xp6(4),h.Q6J("disabled",t.form.value.date<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(28,21,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("disabled",t.form.value.date>=t.maxDate.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("placeholder",h.lcZ(34,23,"POND_MOD.ENTER_INDEX")),h.xp6(2),h.Q6J("ngIf",t.valueSuggest.length>0))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,a.JL,a.sg,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,a.JJ,a.u,l.pK,l.j9,a.Q7,o.O5,o.sg,l.hM,l.Q$],pipes:[f.X$,o.gd],styles:[""]}),e}(),D=function(e){return{color:e}};function y(e,t){if(1&e&&(h.TgZ(0,"ion-col",13),h.TgZ(1,"div",14),h._uU(2),h.qZA(),h.TgZ(3,"div",15),h._uU(4),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.Q6J("ngStyle",h.VKq(3,D,n.style)),h.xp6(2),h.hij(" ",n.label," "),h.xp6(2),h.hij(" ",n.data," ")}}function S(e,t){if(1&e&&(h.TgZ(0,"div",10),h.TgZ(1,"ion-grid"),h.TgZ(2,"ion-row"),h.YNc(3,y,5,5,"ion-col",11),h.qZA(),h.qZA(),h._UZ(4,"div",12),h.qZA()),2&e){var n=t.index,i=h.oxw(3);h.xp6(3),h.Q6J("ngForOf",i.groupsChartLabel[n]),h.xp6(1),h.Q6J("options",i.setOption(n))}}function C(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,S,5,2,"div",9),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",n.groupsChartLabel)}}function w(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-content"),h.TgZ(1,"div"),h.TgZ(2,"ion-grid"),h.TgZ(3,"ion-row",4),h.TgZ(4,"ion-col",5),h.TgZ(5,"ion-item",6),h.TgZ(6,"ion-datetime",7),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().onChangeDate(e)}),h.ALo(7,"translate"),h.qZA(),h._UZ(8,"ion-icon",8),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(9,C,2,1,"div",3),h.qZA()}if(2&e){var i=h.oxw();h.xp6(6),h.Q6J("displayFormat",h.lcZ(7,5,"FORMAT_DATE_MOMENT"))("min",i.pondService.seasonStartTime.format("YYYY-MM-DD"))("max",i.dateMax)("value",i.dateRangeSelected),h.xp6(3),h.Q6J("ngIf",i.groupsChartLabel.length>0)}}var k=function(){var e=function(){function e(t,n,i){var o=this;r(this,e),this.modalCtrl=t,this.pondService=n,this.translate=i,this.factor="",this.loadingFlag=new p.E,this.data=[],this.dataRaw=[],this.dateRangeSelected=m().format("YYYY-MM-DD"),this.dateMax=m().format("YYYY-MM-DD"),this.dateMin=m().format("YYYY-MM-DD"),this.show=!1,this.numberGroupChart=0,this.groupsChart=[],this.groupsChartOption=[],this.groupsChartData=[],this.groupsChartLabel=[],this.optionLine={tooltip:{trigger:"axis",formatter:function(e){var t=m(e[0].value[0]).format(o.translate.instant("FORMAT_DATE_MOMENT"))+"<br/>";return e.forEach(function(e){t+=e.marker+e.seriesName+" : "+(new Intl.NumberFormat).format(e.value[1])+"<br>"}),t},axisPointer:{animation:!0}},xAxis:{type:"time",splitLine:{show:!1},axisLabel:{formatter:"{dd}"}},yAxis:[],series:[]}}return c(e,[{key:"ngOnInit",value:function(){this.paramSelected=this.pondService.trackingPamameters[0],this.paramSelectedItem=this.pondService.trackingObjects[0],console.log(this.pondService.trackingPamameters),this.numberGroupChart=Math.ceil(this.pondService.trackingPamameters.length/4),console.log(this.numberGroupChart),this.getData()}},{key:"dismiss",value:function(){this.modalCtrl.dismiss()}},{key:"presentParameterUpdate",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:b,componentProps:{data:this.factor}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"onChangeDate",value:function(e){console.log("vao day"),this.dateRangeSelected=e.detail.value,e.detail.value!=this.dateRangeSelected&&this.getData()}},{key:"onChangeParam",value:function(){var e=this;this.paramSelectedItem=this.pondService.trackingObjects[this.pondService.trackingObjects.findIndex(function(t){return t.key==e.paramSelected})],this.prepareData(this.dataRaw)}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadParamDaily(this.dateRangeSelected,30).subscribe(function(t){t.data?(e.dataRaw=t.data,console.log(e.dataRaw),e.prepareDataNew(e.dataRaw),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"prepareDataNew",value:function(e){var t=this;if(0!=e.length){console.log(this.pondService.trackingObjects);for(var n=this.pondService.trackingObjects.map(function(e){return{show:!1,type:"value",name:t.translate.instant(("POND_MOD.PARAM."+e.name).toUpperCase()),min:e.min,max:e.max}}),i=this.pondService.trackingObjects.map(function(n){return{name:t.translate.instant(("POND_MOD.PARAM."+n.name).toUpperCase()),type:"line",yAxisIndex:0,data:e.map(function(e){return e[n.key]?e[n.key]:""}).reverse()}}),o=e.map(function(e){return m(e.date).format("DD/MM")}).reverse(),a=this.pondService.trackingObjects.map(function(e){return e.colorStr}),r=[],s=[],c=0;c<this.pondService.trackingObjects.length;c++)c%4==0?(r.push({color:[a[c]],tooltip:{trigger:"axis",position:["50%","50%"]},xAxis:[{type:"category",axisTick:{alignWithLabel:!0},data:o}],yAxis:[n[c]],series:[i[c]]}),s.push([{style:this.pondService.trackingObjects[c].colorStr,label:this.translate.instant(("POND_MOD.PARAM."+this.pondService.trackingObjects[c].name).toUpperCase()),data:this.pondService.trackingObjects[c].values.length>0?this.pondService.trackingObjects[c].values[0]:"-"}])):(i[c].yAxisIndex=c%4,r[r.length-1].color.push(a[c]),r[r.length-1].yAxis.push(n[c]),r[r.length-1].series.push(i[c]),s[s.length-1].push({style:this.pondService.trackingObjects[c].colorStr,label:this.translate.instant(("POND_MOD.PARAM."+this.pondService.trackingObjects[c].name).toUpperCase()),data:this.pondService.trackingObjects[c].values.length>0&&this.pondService.trackingObjects[c].values.length>0?this.pondService.trackingObjects[c].values[0]:"-"}));this.groupsChartLabel=s,this.groupsChartOption=r,console.log(this.groupsChartOption[2]),console.log(this.groupsChartOption[3])}}},{key:"setOption",value:function(e){return this.groupsChartOption[e]}},{key:"prepareData",value:function(e){var t=this;console.log("run s"),console.log("run");var n=[];e.forEach(function(e){var i=new Date(e.date),o=0;t.pondService.trackingObjects.forEach(function(n){void 0===t.data[n.key]&&(t.data[n.key]=[]),t.data[n.key].unshift({name:i.toString(),value:[e.date,e[n.key]]}),null===e[n.key]&&(o+=1)}),n.unshift(o)});for(var i=function(e){n[e]==t.pondService.trackingObjects.length&&t.pondService.trackingObjects.forEach(function(n){t.data[n.key].splice(e,1)})},o=0;o<n.length;o++)i(o);for(var a=function(e){t.groupsChart.push(e);var n=t.pondService.trackingObjects.slice(4*e,4*(e+1));t.groupsChartLabel.push(n);var i=[],o=[];n.forEach(function(e,n){var a={show:0==n,type:"value",name:t.translate.instant(("POND_MOD.PARAM."+e.name).toUpperCase()),min:e.min,max:e.max};i.push(a);var r={data:t.data[e.key],type:"line",yAxisIndex:n,itemStyle:{color:e.colorStr},smooth:!0,name:t.translate.instant(("POND_MOD.PARAM."+e.name).toUpperCase()),showSymbol:!0,hoverAnimation:!0};o.push(r)}),t.groupsChartOption.push(t.setChartOption(i)),t.groupsChartData.push({series:o})},r=0;r<this.numberGroupChart;r++)a(r);console.log(this.data)}},{key:"setChartOption",value:function(e){var t=Object.assign({},this.optionLine);return t.yAxis=e,t}},{key:"ionViewDidEnter",value:function(){this.show=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-parameter"]],decls:9,vars:4,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[4,"ngIf"],[1,"ion-align-items-center"],["size","8","push","2",1,"ion-align-self-center"],["lines","inset"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","end","name","calendar-outline"],["class","data-item",4,"ngFor","ngForOf"],[1,"data-item"],["class","ion-text-center",3,"ngStyle",4,"ngFor","ngForOf"],["echarts","",1,"demo-chart",3,"options"],[1,"ion-text-center",3,"ngStyle"],[1,"ion-text-uppercase","title"],[1,"para-value"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.YNc(8,w,10,7,"ion-content",3)),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,2,"POND_MOD.WATER_QUANLITY")),h.xp6(2),h.Q6J("ngIf",t.show))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,o.O5,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,o.sg,u._w,o.PC],pipes:[f.X$],styles:["[_nghost-%COMP%]   .demo-chart[_ngcontent-%COMP%]{height:400px}[_nghost-%COMP%]   ion-select[_ngcontent-%COMP%]{max-width:90%!important}[_nghost-%COMP%]   .para-value[_ngcontent-%COMP%]{font-size:2em;font-family:Atomic}[_nghost-%COMP%]   .data-item[_ngcontent-%COMP%]{margin-top:2em}[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{font-size:.8em}"]}),e}();function N(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",7),h.TgZ(2,"p"),h.TgZ(3,"ion-text",8),h._uU(4),h.qZA(),h._uU(5),h.qZA(),h.TgZ(6,"h3"),h._uU(7),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(4),h.Oqu(n.vendor_name),h.xp6(1),h.hij(" ",n.time," "),h.xp6(2),h.Oqu(n.message)}}function E(e,t){if(1&e&&(h.TgZ(0,"div",9),h.TgZ(1,"p"),h._uU(2),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(n.message)}}var M=function(){var e=function(){function e(t,n,i){r(this,e),this.modalCtrl=t,this.pondService=n,this.translate=i,this.loadingFlag=new p.E,this.suggestItems=[],this.message="",this.pageIndex=0}return c(e,[{key:"ngOnInit",value:function(){this.loadAlerList()}},{key:"loadAlerList",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.getSuggestList(this.pageIndex).pipe().subscribe(function(t){t.data&&t.data.length>0&&t.data.map(function(t){t.time=m(1e3*t.add_time).fromNow(),e.suggestItems.push(t)}),e.suggestItems.length<10&&(e.infiniteScroll.disabled=!e.infiniteScroll.disabled),e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.message=e.translate.instant("ERROR_CONNECT")})}},{key:"loadData",value:function(e){var t=this;this.pageIndex++,this.pondService.getSuggestList(this.pageIndex).pipe().subscribe(function(n){n.data&&n.data.length>0?n.data.map(function(e){e.time=m(1e3*e.add_time).fromNow(),t.suggestItems.push(e)}):e.target.disabled=!0,e.target.complete()},function(n){e.target.complete(),t.message=t.translate.instant("ERROR_CONNECT")}),this.pageIndex>20&&(e.target.disabled=!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-suggest"]],viewQuery:function(e,t){var n;(1&e&&h.Gf(l.ju,5),2&e)&&(h.iGM(n=h.CRH())&&(t.infiniteScroll=n.first))},decls:14,vars:5,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[4,"ngFor","ngForOf"],["class","ion-padding",4,"ngIf"],[3,"ionInfinite"],["loadingSpinner","dots"],[1,"ion-text-wrap"],["color","primary"],[1,"ion-padding"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-list"),h.YNc(10,N,8,3,"ion-item",3),h.qZA(),h.YNc(11,E,3,1,"div",4),h.TgZ(12,"ion-infinite-scroll",5),h.NdJ("ionInfinite",function(e){return t.loadData(e)}),h._UZ(13,"ion-infinite-scroll-content",6),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,3,"POND_MOD.SUGGEST")),h.xp6(4),h.Q6J("ngForOf",t.suggestItems),h.xp6(1),h.Q6J("ngIf",t.message))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.q_,o.sg,o.O5,l.ju,l.MB,l.Ie,l.Q$,l.yW],pipes:[f.X$],styles:[""]}),e}(),I=i(90650),R=i(62374),U=i(82196);function P(e,t){if(1&e&&(h.TgZ(0,"div",12),h.TgZ(1,"small"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"h1"),h._uU(5),h.ALo(6,"number"),h.TgZ(7,"small"),h._uU(8,"kg"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"POND_MOD.FEED_INCREMENTAL")),h.xp6(3),h.hij("",h.xi3(6,4,null==n.itemSelected?null:n.itemSelected.feed_incremental,"1.0-1")," ")}}function Y(e,t){if(1&e&&(h.TgZ(0,"ion-text",18),h._uU(1),h.ALo(2,"translate"),h.ALo(3,"number"),h.TgZ(4,"small"),h._uU(5,"kg"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.AsE("",h.lcZ(2,2,"POND_MOD.EXPECTED")," ",h.xi3(3,4,null==n.inforloadExpectedDaily?null:n.inforloadExpectedDaily.for_calendar.value_check,"1.0-1")," ")}}function L(e,t){if(1&e&&(h.TgZ(0,"ion-text",19),h._uU(1),h.ALo(2,"translate"),h.ALo(3,"number"),h.TgZ(4,"small"),h._uU(5,"kg"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.AsE("",h.lcZ(2,2,"POND_MOD.FOR_PROCEDURE")," ",h.xi3(3,4,null==n.inforloadExpectedDaily?null:n.inforloadExpectedDaily.for_procedure.feed,"1.0-1")," ")}}function F(e,t){if(1&e&&(h.TgZ(0,"ion-col",22),h.TgZ(1,"ion-text",18),h._uU(2),h.ALo(3,"number"),h.qZA(),h.TgZ(4,"small"),h._uU(5),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.xi3(3,2,n.quantity,"1.0-1")," "),h.xp6(3),h.Oqu(n.unit)}}function J(e,t){if(1&e&&(h.TgZ(0,"ion-col",22),h.TgZ(1,"ion-text",23),h._uU(2),h.ALo(3,"number"),h.qZA(),h.TgZ(4,"small"),h._uU(5),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.xi3(3,2,n.quantity,"1.0-1")," "),h.xp6(3),h.Oqu(n.unit)}}function Q(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.TgZ(1,"ion-col"),h._uU(2),h.qZA(),h.YNc(3,F,6,5,"ion-col",21),h.YNc(4,J,6,5,"ion-col",21),h.qZA()),2&e){var n=t.$implicit;h.xp6(2),h.AsE("",n.store_name," | ",n.product_name,""),h.xp6(1),h.Q6J("ngIf",1==n.type),h.xp6(1),h.Q6J("ngIf",2==n.type)}}function V(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"span",0),h._uU(2),h.qZA(),h.TgZ(3,"ion-label",20),h.TgZ(4,"ion-grid"),h.YNc(5,Q,5,4,"ion-row",17),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit,i=t.index,o=h.oxw(2);h.xp6(2),h.Oqu(i+1),h.xp6(3),h.Q6J("ngForOf",o.convertRepass(n))}}function j(e,t){if(1&e&&(h.TgZ(0,"ion-list",14),h.TgZ(1,"div",3),h.TgZ(2,"span"),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"number"),h.TgZ(6,"small"),h._uU(7,"kg"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"div",3),h.YNc(9,Y,6,7,"ion-text",15),h.qZA(),h.TgZ(10,"div",3),h.YNc(11,L,6,7,"ion-text",16),h.qZA(),h.YNc(12,V,6,2,"ion-item",17),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.AsE("",h.lcZ(4,5,"FARM_MOD.TOTAL_FEED")," ",h.xi3(5,7,null==n.itemSelected?null:n.itemSelected.feed_today,"1.0-1")," "),h.xp6(6),h.Q6J("ngIf",n.inforloadExpectedDaily&&n.inforloadExpectedDaily.for_calendar),h.xp6(2),h.Q6J("ngIf",n.inforloadExpectedDaily&&n.inforloadExpectedDaily.for_procedure),h.xp6(1),h.Q6J("ngForOf",n.feed)}}function H(e,t){if(1&e&&h._UZ(0,"div",24),2&e){var n=h.oxw();h.Q6J("options",n.optionLine)("merge",n.dataUpdate)}}var G=function(){var e=function(){function e(t,n,i,o,a,s){var c=this;r(this,e),this.modalCtrl=t,this.pondService=n,this.toastService=i,this.translate=o,this.calendarService=a,this.settingService=s,this.loadingFlag=new p.E,this.data=[],this.dataRaw=[],this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.feed=[],this.show=!1,this.optionLine={tooltip:{trigger:"axis",formatter:function(e){var t=m(e[0].value[0]).format(c.translate.instant("FORMAT_DATE_MOMENT"))+"<br/>";return e.forEach(function(e){var n="number"==typeof e.value[1]?(new Intl.NumberFormat).format(e.value[1]):0;t+=e.marker+e.seriesName+" : "+n+"<br>"}),t},axisPointer:{animation:!0}},xAxis:{type:"time",splitLine:{show:!1},axisLabel:{formatter:"{dd}"}},yAxis:{},series:[{data:this.data,type:"line",smooth:!0,name:this.translate.instant("POND_MOD.FEED"),showSymbol:!0,hoverAnimation:!0,lineStyle:{width:1,color:"rgba(128, 255, 165)"},areaStyle:{color:new I.Q.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(128, 255, 165)"},{offset:1,color:"rgba(1, 191, 236)"}])}}]}}return c(e,[{key:"ngOnInit",value:function(){this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.getData(),this.loadExpectedDaily()}},{key:"loadExpectedDaily",value:function(){var e=this;console.log(m(this.dateRangeSelected).valueOf()/1e3),this.calendarService.getExpectedDaily(this.pondService.pond.current_season,"feed",m(this.dateRangeSelected).valueOf()/1e3).subscribe(function(t){1==t.status?e.inforloadExpectedDaily=t.data:e.toastService.warning(t.error)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"dismiss",value:function(){this.modalCtrl.dismiss()}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},m(this.dateRangeSelected).format("YYYY-MM-DD")).subscribe(function(t){t.data?(e.dataRaw=t.data,console.log(e.dateRangeSelected),e.dataRaw[0].date==m(e.dateRangeSelected).format("YYYY-MM-DD")&&(e.itemSelected=e.dataRaw[0]),!e.itemSelected&&e.dataRaw.length>0&&(e.itemSelected={feed_incremental:e.dataRaw[0].feed_incremental}),console.log(e.itemSelected),e.prepareData(e.dataRaw),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"prepareData",value:function(e){var t=this;this.processFeed(),this.data=[],e.forEach(function(e){var n=new Date(e.date);t.data.push({name:n.toString(),value:[e.date,+e.feed_today]})}),this.data.reverse(),this.dataUpdate={series:[{data:this.data}]},console.log(this.dataUpdate)}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=m(this.dateRangeSelected);this.itemSelected=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})],this.processFeed(),(t<m(this.dataRaw[this.dataRaw.length-1].date)||t>m(this.dataRaw[0].date))&&this.getData(),this.loadExpectedDaily()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"processFeed",value:function(){var e=this;this.feed=[];for(var t=1;t<=this.pondService.numRepast;t++)this.feed.push([]);var n=m(this.dateRangeSelected);if(void 0!==this.itemSelected)this.itemSelected.feed&&this.itemSelected.feed.forEach(function(t){t.type=1,e.feed[t.times-1].push(t)}),this.itemSelected.blend&&this.itemSelected.blend.forEach(function(t){t.type=2,e.feed[t.times-1].push(t)}),console.log(this.feed);else{this.itemSelected={feed_incremental:0,feed_today:0};for(var i=0;i<this.dataRaw.length;i++)if(n>m(this.dataRaw[i].date)){this.itemSelected.feed_incremental=this.dataRaw[i].feed_incremental;break}}}},{key:"ionViewDidEnter",value:function(){this.show=!0}},{key:"convertItem",value:function(e){return 2==+e.group_id&&this.settingService.showGramFeed&&("kg"==e.unit?(e.unit="g",e.quantity=1e3*e.quantity):"lit"==e.unit&&(e.unit="ml",e.quantity=1e3*e.quantity)),e}},{key:"convertRepass",value:function(e){var t=this;return e.map(function(e){return t.convertItem(e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(R.o),h.Y36(U.R))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-feed"]],decls:26,vars:14,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-text-center"],["class","ion-padding",4,"ngIf"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back-outline"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward-outline"],["class","ion-padding","lines","none",4,"ngIf"],[1,"ion-padding"],["echarts","","class","demo-chart",3,"options","merge",4,"ngIf"],["lines","none",1,"ion-padding"],["color","secondary",4,"ngIf"],["color","success",4,"ngIf"],[4,"ngFor","ngForOf"],["color","secondary"],["color","success"],[1,"ion-text-wrap"],["class","ion-text-right",4,"ngIf"],[1,"ion-text-right"],["color","tertiary"],["echarts","",1,"demo-chart",3,"options","merge"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.YNc(10,P,9,7,"div",4),h.TgZ(11,"ion-grid"),h.TgZ(12,"ion-row"),h.TgZ(13,"ion-col",5),h.TgZ(14,"ion-button",6),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(15,"ion-icon",7),h.qZA(),h.qZA(),h.TgZ(16,"ion-col",8),h.TgZ(17,"ion-item"),h.TgZ(18,"ion-datetime",9),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(19,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(20,"ion-col",5),h.TgZ(21,"ion-button",6),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(22,"ion-icon",10),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(23,j,13,10,"ion-list",11),h.TgZ(24,"div",12),h.YNc(25,H,1,2,"div",13),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,10,"POND_MOD.FEED")),h.xp6(4),h.Q6J("ngIf",null!==t.itemSelected),h.xp6(4),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(19,12,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(2),h.Q6J("ngIf",t.itemSelected),h.xp6(2),h.Q6J("ngIf",t.show))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o.O5,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,l.q_,o.sg,l.yW,l.Q$,u._w],pipes:[f.X$,o.JJ],styles:[".title[_ngcontent-%COMP%]{font-size:3em;padding:1em}"]}),e}();function B(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",14),h.TgZ(2,"ion-grid"),h.TgZ(3,"ion-row"),h.TgZ(4,"ion-col"),h._uU(5),h.qZA(),h.TgZ(6,"ion-col",15),h.TgZ(7,"ion-text",16),h._uU(8),h.ALo(9,"number"),h.qZA(),h.TgZ(10,"small"),h._uU(11),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(5),h.AsE("",n.store_name," | ",n.product_name,""),h.xp6(3),h.hij(" ",h.xi3(9,4,n.quantity,"1.0-3")," "),h.xp6(3),h.Oqu(n.unit)}}function z(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",14),h.TgZ(2,"ion-grid"),h.TgZ(3,"ion-row"),h.TgZ(4,"ion-col"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"ion-col",15),h.TgZ(8,"ion-text",17),h._uU(9),h.ALo(10,"number"),h.qZA(),h.TgZ(11,"small"),h._uU(12,"kg"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(5),h.Oqu(h.lcZ(6,2,"POND_MOD.EXPECTED")),h.xp6(4),h.hij(" ",h.xi3(10,4,null==n.inforloadExpectedDaily?null:n.inforloadExpectedDaily.for_calendar.value_check,"1.0-3")," ")}}function $(e,t){if(1&e&&h._UZ(0,"div",18),2&e){var n=h.oxw();h.Q6J("options",n.optionChart)("merge",n.dataUpdate)}}var W=function(){var e=function(){function e(t,n,i,o,a){var s=this;r(this,e),this.modalCtrl=t,this.pondService=n,this.toastService=i,this.translate=o,this.calendarService=a,this.loadingFlag=new p.E,this.data=[],this.dataRaw=[],this.show=!1,this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.itemSelected=[],this.optionChart={legend:{show:!0,bottom:0},grid:{bottom:100},tooltip:{trigger:"axis",formatter:function(e){var t=m(e[0].value[0]).format(s.translate.instant("FORMAT_DATE_MOMENT"))+"<br/>";return e.forEach(function(e){t+=e.marker+e.value[2]+" : "+(new Intl.NumberFormat).format(e.value[1])+"<br>"}),t},axisPointer:{animation:!0}},xAxis:{type:"time",axisLabel:{formatter:"{dd}"}},yAxis:{},series:[]}}return c(e,[{key:"ngOnInit",value:function(){this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.getData(),this.loadExpectedDaily()}},{key:"loadExpectedDaily",value:function(){var e=this;console.log(m(this.dateRangeSelected).valueOf()/1e3),this.calendarService.getExpectedDaily(this.pondService.pond.current_season,"enviro",m(this.dateRangeSelected).valueOf()/1e3).subscribe(function(t){1==t.status?e.inforloadExpectedDaily=t.data:e.toastService.warning(t.error)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadDailyDependency("enviroment",{pageIndex:0,pageSize:7},m(this.dateRangeSelected).format("YYYY-MM-DD")).subscribe(function(t){t.data?(e.dataRaw=t.data,e.itemSelected=e.dataRaw.filter(function(t){return t.date==m(e.dateRangeSelected).format("YYYY-MM-DD")}),e.prepareData(e.dataRaw),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"prepareData",value:function(e){var t=this;this.processData(),this.data=[];var n=[],i=[];e.forEach(function(e){if(n.includes(e.product_id)){var o=n.findIndex(function(t){return t==e.product_id});t.data[o].push([e.date,e.quantity*e.packing,e.store_name+" | "+e.product_name])}else n.push(e.product_id),t.data.push([[e.date,e.quantity*e.packing,e.store_name+" | "+e.product_name]]),i.push(e.product_name)});var o=[];n.forEach(function(e,n){o.push({data:t.data[n],type:"scatter",name:i[n],symbolSize:function(e){var t=2*parseInt(e[1]);return t=(t=t<50?t:50)>5?t:5}})}),this.dataUpdate={series:o},console.log(this.dataUpdate)}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=m(this.dateRangeSelected);this.processData(),this.dataRaw.length>0?(t>m(this.dataRaw[this.dataRaw.length-1].date)||t<m(this.dataRaw[0].date))&&this.getData():this.getData(),this.loadExpectedDaily()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"processData",value:function(){var e=this;this.itemSelected=this.dataRaw.filter(function(t){return t.date==m(e.dateRangeSelected).format("YYYY-MM-DD")})}},{key:"ionViewDidEnter",value:function(){this.show=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(R.o))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-enviroment"]],decls:27,vars:14,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],["lines","none",1,"ion-padding"],[4,"ngFor","ngForOf"],[4,"ngIf"],["echarts","","class","demo-chart",3,"options","merge",4,"ngIf"],[1,"ion-text-wrap"],[1,"ion-text-right"],["color","secondary"],["color","danger"],["echarts","",1,"demo-chart",3,"options","merge"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.TgZ(10,"ion-grid"),h.TgZ(11,"ion-row"),h.TgZ(12,"ion-col",4),h.TgZ(13,"ion-button",5),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(14,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(15,"ion-col",7),h.TgZ(16,"ion-item",3),h.TgZ(17,"ion-datetime",8),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(18,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"ion-col",4),h.TgZ(20,"ion-button",5),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(21,"ion-icon",9),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(22,"ion-list",10),h.YNc(23,B,12,7,"ion-item",11),h.YNc(24,z,13,7,"ion-item",12),h.qZA(),h.TgZ(25,"div"),h.YNc(26,$,1,2,"div",13),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,10,"POND_MOD.CHEMICAL_TREATMENT")),h.xp6(7),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(18,12,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("ngForOf",t.itemSelected),h.xp6(1),h.Q6J("ngIf",t.inforloadExpectedDaily&&t.inforloadExpectedDaily.for_calendar),h.xp6(2),h.Q6J("ngIf",t.show))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,l.q_,o.sg,o.O5,l.Q$,l.yW,u._w],pipes:[f.X$,o.JJ],styles:[""]}),e}();function X(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.TgZ(1,"ion-col"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-col",14),h.TgZ(5,"ion-text",15),h._uU(6),h.qZA(),h.TgZ(7,"small"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,3,"LAB_MOD.VACCINATED")),h.xp6(4),h.hij(" ",null==n.healthLab?null:n.healthLab.vaccinated," "),h.xp6(2),h.Oqu(h.lcZ(9,5,"PCS"))}}function K(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.TgZ(1,"ion-col"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-col",14),h.TgZ(5,"ion-text",15),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"LAB_MOD.ANTIBIOTIC")),h.xp6(4),h.hij(" ",n.joinArray(null==n.dataDisease?null:n.dataDisease.antibiotic)," ")}}function ee(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.TgZ(1,"ion-col"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-col",14),h.TgZ(5,"ion-text",15),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"LAB_MOD.BACTERIA")),h.xp6(4),h.hij(" ",n.joinArray(null==n.dataDisease?null:n.dataDisease.bacteria)," ")}}function te(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.TgZ(1,"ion-col"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-col",14),h.TgZ(5,"ion-text",15),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"LAB_MOD.PARASITES")),h.xp6(4),h.hij(" ",n.joinArray(null==n.dataDisease?null:n.dataDisease.parasites)," ")}}function ne(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.TgZ(1,"ion-col"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-col",14),h.TgZ(5,"ion-text",15),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"LAB_MOD.DISEASE")),h.xp6(4),h.hij(" ",n.joinArray(null==n.dataDisease?null:n.dataDisease.disease)," ")}}function ie(e,t){if(1&e&&h._UZ(0,"div",17),2&e){var n=h.oxw();h.Q6J("options",n.optionChart)("merge",n.dataUpdate)}}var oe=function(){var e=function(){function e(t,n,i,o){var a=this;r(this,e),this.modalCtrl=t,this.pondService=n,this.toastService=i,this.translate=o,this.loadingFlag=new p.E,this.data=[],this.dataRaw=[],this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.show=!1,this.optionChart={tooltip:{trigger:"axis",formatter:function(e){var t=m(e[0].axisValue).format(a.translate.instant("FORMAT_DATE_MOMENT"))+"<br/>";return e.forEach(function(e){t+=2==e.seriesIndex?e.marker+" "+e.seriesName+": "+e.value[2]+"<br>":e.marker+" "+e.seriesName+": "+(new Intl.NumberFormat).format(e.value[1])+" <br>"}),t}},xAxis:{type:"time",splitLine:{show:!1},axisLabel:{formatter:"{dd}"}},yAxis:[{type:"value",splitLine:{show:!1}},{type:"value",position:"right",splitLine:{show:!1}}],series:[{type:"line",smooth:!0,name:this.translate.instant("POND_MOD.WEIGHT"),itemStyle:{color:"#00c853"}},{type:"bar",name:this.translate.instant("POND_MOD.LOSS"),barWidth:"10%",yAxisIndex:1},{symbolSize:20,name:this.translate.instant("POND_MOD.HEALTH"),type:"scatter",yAxisIndex:1,itemStyle:{shadowBlur:10,shadowColor:"rgba(120, 36, 50, 0.5)",shadowOffsetY:5}}]},this.dataDisease={antibiotic:[],bacteria:[],parasites:[],disease:[]},this.healthLab={accinated:0}}return c(e,[{key:"ngOnInit",value:function(){this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.getData()}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},m(this.dateRangeSelected).format("YYYY-MM-DD")).subscribe(function(t){t.data?(e.dataRaw=t.data,e.dataRaw[0].date==m(e.dateRangeSelected).format("YYYY-MM-DD")&&(e.itemSelected=e.dataRaw[0]),e.prepareData(e.dataRaw),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1),e.getDataLab()},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"prepareData",value:function(e){var t=this;this.data=[];var n=[],i=[];e.forEach(function(e){e.weight>0&&t.data.push([e.date,e.weight]),e.loss>0&&n.push([e.date,e.loss]),e.note_health&&i.push([e.date,e.weight,e.note_health])}),this.data.reverse(),this.dataUpdate={series:[{data:this.data},{data:n},{data:i}]},console.log(this.dataUpdate)}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=m(this.dateRangeSelected);this.itemSelected=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})],(t<m(this.dataRaw[this.dataRaw.length-1].date)||t>m(this.dataRaw[0].date))&&this.getData(),this.getDataLab()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"ionViewDidEnter",value:function(){this.show=!0}},{key:"getDataLab",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.loadDailyLab(this.dateRangeSelected).subscribe(function(t){1==+t.status?e.processData(t.data.record):e.toastService.warning(t.warning),e.loadingFlag.setResult(!0)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT")),e.loadingFlag.setResult(!1)})}},{key:"processData",value:function(e){for(var t in e)"health"!=t?this.dataDisease[t]=e[t]:"health"==t&&(this.healthLab={vaccinated:e[t]?this.filterHealth(e[t],"vaccinated"):""});console.log(this.healthLab)}},{key:"filterHealth",value:function(e,t){var n=e.find(function(e){return e.key==t});return n?n.value:""}},{key:"joinArray",value:function(e){return e.map(function(e){return e.name}).join(", ")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-health"]],decls:58,vars:32,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-text-center"],[1,"title","ion-padding"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],["lines","none",1,"ion-padding"],[1,"ion-text-wrap"],[4,"ngIf"],[1,"ion-text-right"],["color","danger"],["echarts","","class","demo-chart",3,"options","merge",4,"ngIf"],["echarts","",1,"demo-chart",3,"options","merge"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.TgZ(10,"h1",4),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.TgZ(13,"ion-grid"),h.TgZ(14,"ion-row"),h.TgZ(15,"ion-col",5),h.TgZ(16,"ion-button",6),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(17,"ion-icon",7),h.qZA(),h.qZA(),h.TgZ(18,"ion-col",8),h.TgZ(19,"ion-item",3),h.TgZ(20,"ion-datetime",9),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(21,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(22,"ion-col",5),h.TgZ(23,"ion-button",6),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(24,"ion-icon",10),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(25,"ion-list",11),h.TgZ(26,"ion-item"),h.TgZ(27,"ion-label",12),h.TgZ(28,"ion-grid"),h.YNc(29,X,10,7,"ion-row",13),h.YNc(30,K,7,4,"ion-row",13),h.YNc(31,ee,7,4,"ion-row",13),h.YNc(32,te,7,4,"ion-row",13),h.YNc(33,ne,7,4,"ion-row",13),h.qZA(),h.qZA(),h.qZA(),h.TgZ(34,"ion-item"),h.TgZ(35,"ion-label",12),h.TgZ(36,"ion-grid"),h.TgZ(37,"ion-row"),h.TgZ(38,"ion-col"),h._uU(39),h.ALo(40,"translate"),h.qZA(),h.TgZ(41,"ion-col",14),h.TgZ(42,"ion-text",15),h._uU(43),h.ALo(44,"number"),h.qZA(),h.TgZ(45,"small"),h._uU(46,"kg"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(47,"ion-item"),h.TgZ(48,"ion-label",12),h.TgZ(49,"ion-grid"),h.TgZ(50,"ion-row"),h.TgZ(51,"ion-col"),h._uU(52),h.ALo(53,"translate"),h.qZA(),h.TgZ(54,"ion-col",14),h.TgZ(55,"ion-text",15),h._uU(56),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(57,ie,1,2,"div",16),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,19,"POND_MOD.HEALTH")),h.xp6(5),h.AsE("",null==t.itemSelected?null:t.itemSelected.weight," g/",h.lcZ(12,21,"PCS"),""),h.xp6(5),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(21,23,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(6),h.Q6J("ngIf",+t.healthLab.vaccinated>0),h.xp6(1),h.Q6J("ngIf",t.dataDisease.antibiotic.length>0),h.xp6(1),h.Q6J("ngIf",t.dataDisease.bacteria.length>0),h.xp6(1),h.Q6J("ngIf",t.dataDisease.parasites.length>0),h.xp6(1),h.Q6J("ngIf",t.dataDisease.disease.length>0),h.xp6(6),h.Oqu(h.lcZ(40,25,"POND_MOD.LOSS")),h.xp6(4),h.hij(" ",h.xi3(44,27,(null==t.itemSelected?null:t.itemSelected.loss)*(null==t.itemSelected?null:t.itemSelected.weight)/1e3,"1.0-1")," "),h.xp6(9),h.Oqu(h.lcZ(53,30,"POND_MOD.SESEASE")),h.xp6(4),h.hij(" ",null==t.itemSelected?null:t.itemSelected.note_health," "),h.xp6(1),h.Q6J("ngIf",t.show))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,l.q_,l.Q$,o.O5,l.yW,u._w],pipes:[f.X$,o.JJ],styles:[""]}),e}(),ae=function(){var e=function(){function e(t){r(this,e),this.modalCtrl=t}return c(e,[{key:"ngOnInit",value:function(){}},{key:"dismiss",value:function(){this.modalCtrl.dismiss({dismissed:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-setting"]],decls:18,vars:9,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary"],["slot","start","name","save"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.qZA(),h._UZ(5,"ion-content"),h.TgZ(6,"ion-footer"),h.TgZ(7,"ion-toolbar"),h.TgZ(8,"ion-buttons",0),h.TgZ(9,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(10,"ion-icon",2),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.qZA(),h.TgZ(13,"ion-buttons",3),h.TgZ(14,"ion-button",4),h._UZ(15,"ion-icon",5),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,3,"POND_MOD.SETTING_AND_CONFIG")),h.xp6(8),h.hij(" ",h.lcZ(12,5,"CLOSE")," "),h.xp6(5),h.hij(" ",h.lcZ(17,7,"SAVE")," "))},directives:[l.Gu,l.sr,l.wd,l.W2,l.fr,l.Sm,l.YG,l.gu],pipes:[f.X$],styles:[""]}),e}(),re=i(62014),se=i(71239);function ce(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",11),h.qZA())}var le=function(){var e=function(){function e(t,n,i,o,a,s){r(this,e),this.modalCtrl=t,this._formBuilder=n,this.pondService=i,this.toastService=o,this.translate=a,this.dbLocalService=s,this.saveLoading=new p.E,this.numberFormatCost=new re.y("")}return c(e,[{key:"ngOnInit",value:function(){this.form=this._formBuilder.group({cost:["",a.kI.required],note:["",a.kI.required]})}},{key:"dismiss",value:function(){this.modalCtrl.dismiss({dismissed:!0})}},{key:"onSubmit",value:function(){var e=this,t={cost:this.numberFormatCost.realValue,note:this.form.value.note};this.saveLoading.setPending(!0),this.pondService.reqSeasonCancel(t).subscribe(function(t){if(1!=t.error){e.toastService.success(t.message);var n=e.dbLocalService.ponds.findIndex(function(t){return t.infor.code===e.pondService.pcode});if(n>=0){var i={infor:e.pondService.pond,devices:[]};i.infor.current_season="",i.infor.species_id=null,i.infor.species=null,i.infor.start_time=null,e.dbLocalService.updateItem("ponds",i,n)}e.pondService.seasonStart=!1,e.pondService.reloadSeason$.next(1),e.saveLoading.setResult(!0),e.modalCtrl.dismiss({saved:!0})}else e.toastService.warning(t.message),e.saveLoading.setResult(!1)},function(){e.saveLoading.setResult(!1),e.translate.get("CONNECT_ERROR").subscribe(function(t){e.toastService.warning(t)})})}},{key:"formatCost",value:function(e){this.numberFormatCost.setValue(e.detail.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(a.qu),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(se.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-cancel"]],inputs:{pondsOb:"pondsOb"},decls:26,vars:19,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"formGroup","ngSubmit"],["lines","inset"],["position","stacked"],["type","tel","formControlName","cost","autofocus","","inputmode","numeric",3,"value","ionChange"],["formControlName","note"],[1,"ion-text-center","ion-padding"],[4,"ngIf"],["type","submit","color","primary","shape","round",3,"disabled"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"form",3),h.NdJ("ngSubmit",function(){return t.onSubmit()}),h.TgZ(10,"ion-item",4),h.TgZ(11,"ion-label",5),h._uU(12),h.ALo(13,"translate"),h.ALo(14,"translate"),h.qZA(),h.TgZ(15,"ion-input",6),h.NdJ("ionChange",function(e){return t.formatCost(e)}),h.qZA(),h.qZA(),h.TgZ(16,"ion-item",4),h.TgZ(17,"ion-label",5),h._uU(18),h.ALo(19,"translate"),h.qZA(),h._UZ(20,"ion-textarea",7),h.qZA(),h.TgZ(21,"div",8),h.YNc(22,ce,2,0,"div",9),h.TgZ(23,"ion-button",10),h._uU(24),h.ALo(25,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,9,"POND_MOD.CANCEL_SEASON")),h.xp6(3),h.Q6J("formGroup",t.form),h.xp6(3),h.AsE("",h.lcZ(13,11,"POND_MOD.COST_CANCEL")," (",h.lcZ(14,13,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",t.numberFormatCost.fakeView),h.xp6(3),h.Oqu(h.lcZ(19,15,"POND_MOD.NOTE")),h.xp6(4),h.Q6J("ngIf",t.saveLoading.pending),h.xp6(1),h.Q6J("disabled",t.form.invalid||t.saveLoading.pending),h.xp6(1),h.hij("",h.lcZ(25,17,"POND_MOD.CONFIRM")," "))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,a._Y,a.JL,a.sg,l.Ie,l.Q$,l.pK,l.j9,a.JJ,a.u,l.g2,o.O5,l.PQ],pipes:[f.X$],styles:[""]}),e}();function ue(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",17),h.qZA())}function de(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-content",6),h.TgZ(1,"div",7),h.TgZ(2,"h1"),h._uU(3),h.qZA(),h.YNc(4,ue,2,0,"div",8),h.qZA(),h.TgZ(5,"ion-item",9),h.TgZ(6,"ion-label",10),h._uU(7),h.ALo(8,"translate"),h.qZA(),h._UZ(9,"ion-input",11),h.qZA(),h.TgZ(10,"ion-item",9),h.TgZ(11,"ion-label",10),h._uU(12),h.ALo(13,"translate"),h.qZA(),h._UZ(14,"ion-input",12),h.qZA(),h.TgZ(15,"ion-item",9),h.TgZ(16,"ion-label",10),h._uU(17),h.ALo(18,"translate"),h.qZA(),h._UZ(19,"ion-input",13),h.qZA(),h.TgZ(20,"ion-item",9),h.TgZ(21,"ion-label",10),h._uU(22),h.ALo(23,"translate"),h.ALo(24,"translate"),h.qZA(),h.TgZ(25,"ion-input",14),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().formatCost(e)}),h.qZA(),h.qZA(),h.TgZ(26,"ion-item",9),h.TgZ(27,"ion-label",10),h._uU(28),h.ALo(29,"translate"),h.qZA(),h._UZ(30,"ion-input",15),h.qZA(),h.TgZ(31,"ion-item",16),h.TgZ(32,"ion-label"),h.TgZ(33,"p"),h._uU(34),h.ALo(35,"translate"),h.ALo(36,"translate"),h.qZA(),h.TgZ(37,"span"),h._uU(38),h.ALo(39,"number"),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("formGroup",i.form),h.xp6(3),h.Oqu(i.data.name),h.xp6(1),h.Q6J("ngIf",i.savingFlag.pending),h.xp6(3),h.Oqu(h.lcZ(8,13,"POND_MOD.NAME_POND")),h.xp6(5),h.Oqu(h.lcZ(13,15,"AREA")),h.xp6(5),h.Oqu(h.lcZ(18,17,"POND_MOD.DEEP")),h.xp6(5),h.AsE("",h.lcZ(23,19,"POND_MOD.COST")," (",h.lcZ(24,21,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",i.numberFormatCost.fakeView),h.xp6(3),h.Oqu(h.lcZ(29,23,"FARM_MOD.NUM_SEASON")),h.xp6(6),h.AsE("",h.lcZ(35,25,"FARM_MOD.NUM_CROP")," (",h.lcZ(36,27,"CURRENCY_S"),")"),h.xp6(4),h.Oqu(h.xi3(39,29,i.numberFormatCost.realValue/i.form.value.expire_date,"1.0-0"))}}var ge=function(){var e=function(){function e(t,n,i,o,a,s){r(this,e),this.modalController=t,this.pondService=n,this._formBuilder=i,this.toastService=o,this.translate=a,this.dblocalSerive=s,this.savingFlag=new p.E,this.numberFormatCost=new re.y("")}return c(e,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.data=this.pondService.pond,this.createForm();case 1:case"end":return e.stop()}},e,this)}))}},{key:"createForm",value:function(){console.log(this.data),console.log(this.dblocalSerive.ponds[this.pondLocalIndex]),this.numberFormatCost.setValue(this.data.create_cost),this.form=this._formBuilder.group({name:[this.data.name,a.kI.required],area:[this.data.area,a.kI.required],deep:[this.data.deep,a.kI.required],create_cost:[this.data.create_cost],expire_date:[this.data.expire_date]})}},{key:"formatCost",value:function(e){this.numberFormatCost.setValue(e.detail.value)}},{key:"save",value:function(){var e=this;if(this.form.invalid||this.savingFlag.pending)return console.log(this.form.value),!1;this.savingFlag.setPending(!0);var t={name:this.form.value.name,area:this.form.value.area,deep:this.form.value.deep,create_cost:this.numberFormatCost.realValue,expire_date:this.form.value.expire_date};this.pondService.updateInfo(this.form.value).subscribe(function(n){n.error||1!=n.status?e.toastService.warning(n.error):(e.toastService.success(n.message),e.pondService.pond.name=t.name,e.pondService.pond.area=t.area,e.pondService.pond.deep=t.deep,e.pondService.pond.create_cost=t.create_cost,e.pondService.pond.expire_date=t.expire_date,e.dblocalSerive.ponds[e.pondLocalIndex].infor=e.pondService.pond,e.dblocalSerive.setLocalData("ponds",e.dblocalSerive.ponds),e.modalController.dismiss()),e.savingFlag.setResult(!0)},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT")),e.savingFlag.setResult(!1)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(a.qu),h.Y36(x.k),h.Y36(f.sK),h.Y36(se.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-edit"]],inputs:{pondLocalIndex:"pondLocalIndex"},decls:13,vars:8,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"ion-padding","ion-text-center"],[4,"ngIf"],["lines","inset"],["position","floating"],["formControlName","name"],["formControlName","area","type","tel","inputmode","decimal"],["formControlName","deep","type","tel","inputmode","decimal"],["formControlName","create_cost","type","tel","inputmode","numeric",3,"value","ionChange"],["type","number","inputmode","numeric","formControlName","expire_date"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(12,de,40,32,"ion-content",5)),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"POND_MOD.EDIT_INFOR")),h.xp6(3),h.Q6J("disabled",t.savingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(11,6,"POND_MOD.SAVE")),h.xp6(2),h.Q6J("ngIf",t.data))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,o.O5,l.W2,a.JL,a.sg,l.Ie,l.Q$,l.pK,l.j9,a.JJ,a.u,l.as,l.PQ],pipes:[f.X$,o.JJ],styles:[""]}),e}();function pe(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",11),h.qZA())}var me=function(){var e=function(){function e(t,n,i,o,a){r(this,e),this.modalController=t,this.pondService=n,this.toastService=i,this.translate=o,this.dblocalSerive=a,this.savingFlag=new p.E,this.viewModeCode=0}return c(e,[{key:"ngOnInit",value:function(){}},{key:"selected",value:function(e){this.viewModeCode=e.detail.value}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0),this.pondService.updatePrivate({public:this.viewModeCode}).pipe().subscribe(function(t){0==t.status?e.toastService.warning(t.error):(e.pondService.pond.public=e.viewModeCode,e.dblocalSerive.ponds[e.pondLocalIndex].infor=e.pondService.pond,e.dblocalSerive.setLocalData("ponds",e.dblocalSerive.ponds),e.modalController.dismiss(),e.toastService.success(t.message)),e.savingFlag.setResult(!0),e.modalController.dismiss()},function(t){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(se.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-view-mode"]],inputs:{pondLocalIndex:"pondLocalIndex"},decls:50,vars:31,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[1,"ion-padding","ion-text-center"],[4,"ngIf"],[3,"value","ionChange"],["slot","start","value","3"],["slot","start","value","2"],["slot","start","value","1"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"div",5),h.TgZ(14,"h1"),h._uU(15),h.qZA(),h.YNc(16,pe,2,0,"div",6),h.qZA(),h.TgZ(17,"ion-list"),h.TgZ(18,"ion-radio-group",7),h.NdJ("ionChange",function(e){return t.selected(e)}),h.TgZ(19,"ion-list-header"),h.TgZ(20,"ion-label"),h._uU(21),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.TgZ(23,"ion-item"),h.TgZ(24,"ion-label"),h.TgZ(25,"h3"),h._uU(26),h.ALo(27,"translate"),h.qZA(),h.TgZ(28,"p"),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.qZA(),h._UZ(31,"ion-radio",8),h.qZA(),h.TgZ(32,"ion-item"),h.TgZ(33,"ion-label"),h.TgZ(34,"h3"),h._uU(35),h.ALo(36,"translate"),h.qZA(),h.TgZ(37,"p"),h._uU(38),h.ALo(39,"translate"),h.qZA(),h.qZA(),h._UZ(40,"ion-radio",9),h.qZA(),h.TgZ(41,"ion-item"),h.TgZ(42,"ion-label"),h.TgZ(43,"h3"),h._uU(44),h.ALo(45,"translate"),h.qZA(),h.TgZ(46,"p"),h._uU(47),h.ALo(48,"translate"),h.qZA(),h.qZA(),h._UZ(49,"ion-radio",10),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,13,"PRIVATE_MODE")),h.xp6(3),h.Q6J("disabled",t.savingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(11,15,"SAVE")),h.xp6(5),h.Oqu(t.pondService.pond.name),h.xp6(1),h.Q6J("ngIf",t.savingFlag.pending),h.xp6(2),h.Q6J("value",t.pondService.pond.public),h.xp6(3),h.Oqu(h.lcZ(22,17,"POND_MOD.WHO_CAN_SEE_THIS_POND")),h.xp6(5),h.Oqu(h.lcZ(27,19,"PUBLIC")),h.xp6(3),h.Oqu(h.lcZ(30,21,"PRIVATE_MODE_PUBLIC_DETAIL")),h.xp6(6),h.Oqu(h.lcZ(36,23,"FOLLOWER")),h.xp6(3),h.Oqu(h.lcZ(39,25,"PRIVATE_MODE_FOLLOWER_DETAIL")),h.xp6(6),h.Oqu(h.lcZ(45,27,"PROTECTED")),h.xp6(3),h.Oqu(h.lcZ(48,29,"PRIVATE_MODE_PROTECTED_DETAIL")))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o.O5,l.q_,l.se,l.QI,l.yh,l.Q$,l.Ie,l.B7,l.U5,l.PQ],pipes:[f.X$],styles:[""]}),e}(),he=i(66341),fe=i(79765),Ze=i(25917),ve=i(54395),Ae=i(87519),_e=i(43190);function Te(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",8),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h3"),h._uU(5),h.TgZ(6,"span",9),h._uU(7),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-button",10),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().presentRemoveUser(e)}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw();h.xp6(5),h.hij("",i.user_name," - "),h.xp6(2),h.Oqu(o.permissions[i.key]),h.xp6(2),h.hij(" ",h.lcZ(10,3,"POND_MOD.DELETE")," ")}}function xe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",11),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h3"),h._uU(5),h.qZA(),h.TgZ(6,"p"),h._uU(7),h.qZA(),h.qZA(),h.TgZ(8,"ion-button",12),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw().presentAddUser(e)}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw();h.xp6(2),h.Q6J("src",o.memberService.getSitePath()+"/upload/users/avatars/medium/"+i.photo,h.LSH),h.xp6(3),h.Oqu(i.username),h.xp6(2),h.Oqu(i.email),h.xp6(1),h.Q6J("disabled",o.checkExistUser(i)),h.xp6(1),h.hij(" ",h.lcZ(10,5,"POND_MOD.SELECT")," ")}}function qe(e,t){if(1&e&&(h.TgZ(0,"ion-item",13),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(n.message)}}function Oe(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",14),h.qZA())}var be=function(){var e=function(){function e(t,n,i,o,a,s){r(this,e),this.modalController=t,this.pondService=n,this.memberService=i,this.toastService=o,this.translate=a,this.alertController=s,this.savingFlag=new p.E,this.loadingFlag=new p.E,this.searchTerms=new fe.xQ}return c(e,[{key:"ngOnInit",value:function(){var e=this,t=this.searchTerms.pipe((0,ve.b)(300),(0,Ae.x)(),(0,_e.w)(function(t){return e.getListMember(t)}));this.permissions={pond_operator:this.translate.instant("POND_MOD.OPERATION"),pond_manager:this.translate.instant("FARM_MOD.MANAGER"),pond_expert:this.translate.instant("EXPERT")},this.members$=t,this.members$.subscribe(function(t){t?(e.loadingFlag.setResult(!0),e.message=""):(e.loadingFlag.setResult(!1),e.message=e.translate.instant("POND_MOD.NOT_FOUND"))})}},{key:"search",value:function(e){this.searchTerms.next(e.detail.value)}},{key:"getListMember",value:function(e){return this.loadingFlag.setPending(!0),e.trim()?this.memberService.searchMember(e).pipe():(this.loadingFlag.setResult(!0),(0,Ze.of)([]))}},{key:"onSelect",value:function(e){this.memberSelected=e}},{key:"addPermission",value:function(e,t){var n=this;this.pondService.updatePrivate({user_manager:e.user_id,position:t}).pipe().subscribe(function(i){0==i.status?n.toastService.warning(i.error):(n.manager.push({user_name:e.username,user_id:e.user_id,key:t}),n.toastService.success(n.translate.instant("FARM_MOD.ADDED_STAFF"))),n.savingFlag.setResult(!0)},function(e){n.savingFlag.setResult(!1),n.toastService.danger(n.translate.instant("ERROR_CONNECT"))})}},{key:"removePermission",value:function(e){var t=this;this.pondService.removePermission(this.manager[e].user_id,this.manager[e].key).pipe().subscribe(function(n){0==n.status?t.toastService.warning(n.error):(t.manager.splice(e,1),t.toastService.success(t.translate.instant("FARM_MOD.REMOVED_STAFF"))),t.savingFlag.setResult(!0)},function(e){t.savingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"getLabelPage",value:function(){}},{key:"presentRemoveUser",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_REMOVE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){n.removePermission(e)}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"presentAddUser",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i in n=[],this.permissions)n.push({name:this.permissions[i],type:"radio",value:i,label:this.permissions[i],checked:!1});return n[0].checked=!0,t.next=5,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_ADD"),inputs:n,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(t){o.addPermission(e,t)}}]});case 5:return t.next=7,t.sent.present();case 7:case"end":return t.stop()}},t,this)}))}},{key:"close",value:function(){this.modalController.dismiss(this.manager)}},{key:"checkExistUser",value:function(e){for(var t=0;t<this.manager.length;t++)if(this.manager[t].user_name==e.username)return!0;return!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(he.n),h.Y36(x.k),h.Y36(f.sK),h.Y36(l.Br))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-manager"]],inputs:{manager:"manager"},decls:23,vars:15,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"placeholder","ionChange"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],[4,"ngIf"],["src","assets/img/default-profile.jpg"],[2,"color","red"],["slot","end","color","danger",3,"click"],["onError","this.src='assets/img/default-profile.jpg'",3,"src"],["slot","end",3,"disabled","click"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-searchbar",3),h.NdJ("ionChange",function(e){return t.search(e)}),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"ion-list"),h.YNc(12,Te,11,5,"ion-item",4),h.qZA(),h.TgZ(13,"ion-list"),h.TgZ(14,"ion-list-header"),h.TgZ(15,"ion-label"),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.qZA(),h.YNc(18,xe,11,7,"ion-item",4),h.ALo(19,"async"),h.YNc(20,qe,4,1,"ion-item",5),h.qZA(),h.TgZ(21,"div",6),h.YNc(22,Oe,2,0,"div",7),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,7,"FARM_MOD.MEMBER")),h.xp6(3),h.Q6J("placeholder",h.lcZ(10,9,"FARM_MOD.MANAGER_EMAIL")),h.xp6(3),h.Q6J("ngForOf",t.manager),h.xp6(4),h.Oqu(h.lcZ(17,11,"POND_MOD.RESULT")),h.xp6(2),h.Q6J("ngForOf",h.lcZ(19,13,t.members$)),h.xp6(2),h.Q6J("ngIf",t.message),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.VI,l.j9,l.q_,o.sg,l.yh,l.Q$,o.O5,l.Ie,l.BJ,l.PQ],pipes:[f.X$,o.Ov],styles:[""]}),e}();function De(e,t){if(1&e&&(h.TgZ(0,"ion-item",8),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"span",9),h.TgZ(5,"ion-text"),h._uU(6),h.ALo(7,"number"),h.qZA(),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(2),h.hij(" ",h.lcZ(3,3,"POND_MOD.HARVESTED")," "),h.xp6(4),h.Oqu(h.xi3(7,5,n.total_harvest,"1.0-0")),h.xp6(2),h.hij(" ",h.lcZ(9,8,"PCS")," ")}}function ye(e,t){if(1&e&&(h.TgZ(0,"ion-item",8),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"span",9),h.TgZ(5,"ion-text"),h._uU(6),h.ALo(7,"number"),h.qZA(),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(2),h.hij(" ",h.lcZ(3,3,"POND_MOD.MOVED")," "),h.xp6(4),h.Oqu(h.xi3(7,5,n.total_move,"1.0-0")),h.xp6(2),h.hij(" ",h.lcZ(9,8,"PCS")," ")}}function Se(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",38),h._uU(1),h.ALo(2,"translate"),h.ALo(3,"translate"),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.id),h.xp6(1),h.HOy("",n.name," (",h.lcZ(2,5,"CROP_MOD.CROP_CREATED")," ",n.moment_day," ",h.lcZ(3,7,"CROP_MOD.DAYS_AGO"),") ")}}function Ce(e,t){if(1&e&&(h.TgZ(0,"ion-text",10),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.hij("",h.xi3(2,1,n.post.total_cost/1e6,"1.0-1")," tri\u1ec7u")}}function we(e,t){if(1&e&&(h.TgZ(0,"ion-text",10),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.Oqu(h.xi3(2,1,n.post.total_cost,"1.0-1"))}}function ke(e,t){if(1&e&&(h.TgZ(0,"p"),h.TgZ(1,"ion-text",10),h.TgZ(2,"strong"),h._uU(3),h.qZA(),h.qZA(),h._uU(4),h.ALo(5,"translate"),h.ALo(6,"translate"),h.qZA()),2&e){var n=h.oxw(2);h.xp6(3),h.Oqu(n.pondSelected.name),h.xp6(1),h.lnq(" ",h.lcZ(5,4,"POND_MOD.STARTED_FROM")," ",n.pondSelected.moment_day," ",h.lcZ(6,6,"DAYS")," ")}}function Ne(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-content",4),h.TgZ(1,"ion-slides",5,6),h.NdJ("ionSlideReachEnd",function(){return h.CHM(n),h.oxw().endView()}),h.TgZ(3,"ion-slide"),h.TgZ(4,"div",7),h.TgZ(5,"h1"),h._uU(6),h.qZA(),h.TgZ(7,"ion-item",8),h.TgZ(8,"ion-label"),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"span",9),h.TgZ(12,"ion-text",10),h._uU(13),h.ALo(14,"number"),h.qZA(),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.qZA(),h.YNc(17,De,10,10,"ion-item",11),h.YNc(18,ye,10,10,"ion-item",11),h.TgZ(19,"p",12),h._uU(20),h.ALo(21,"translate"),h.qZA(),h.TgZ(22,"ion-grid"),h.TgZ(23,"ion-row"),h.TgZ(24,"ion-col",13),h.TgZ(25,"ion-item"),h.TgZ(26,"ion-label",14),h._uU(27),h.ALo(28,"translate"),h.qZA(),h.TgZ(29,"ion-input",15),h.NdJ("ionInput",function(e){return h.CHM(n),h.oxw().changeInput("size",e)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(30,"ion-col",13),h.TgZ(31,"ion-item"),h.TgZ(32,"ion-label",14),h._uU(33),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-select",16),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().changeInput("unit",e)}),h.TgZ(36,"ion-select-option",17),h._uU(37),h.ALo(38,"translate"),h.qZA(),h.TgZ(39,"ion-select-option",18),h._uU(40),h.ALo(41,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(42,"ion-row"),h.TgZ(43,"ion-col",13),h.TgZ(44,"ion-item"),h.TgZ(45,"ion-label",14),h._uU(46),h.ALo(47,"translate"),h.ALo(48,"translate"),h.qZA(),h.TgZ(49,"ion-input",19),h.NdJ("ionInput",function(e){return h.CHM(n),h.oxw().changeInput("quantityLive",e)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(50,"ion-col",13),h.TgZ(51,"ion-item"),h.TgZ(52,"ion-label",14),h._uU(53),h.ALo(54,"translate"),h.qZA(),h.TgZ(55,"ion-input",20),h.NdJ("ionInput",function(e){return h.CHM(n),h.oxw().changeInput("ratio",e)}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(56,"ion-button",21),h.NdJ("click",function(){return h.CHM(n),h.MAs(2).slideNext()}),h._uU(57),h.ALo(58,"translate"),h._UZ(59,"ion-icon",22),h.qZA(),h.qZA(),h.qZA(),h.TgZ(60,"ion-slide"),h.TgZ(61,"div",23),h.TgZ(62,"ion-item"),h.TgZ(63,"ion-label",14),h._uU(64),h.ALo(65,"translate"),h.qZA(),h.TgZ(66,"ion-select",24),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().selectPond(e)}),h.YNc(67,Se,4,9,"ion-select-option",25),h.qZA(),h.qZA(),h.TgZ(68,"ion-item"),h.TgZ(69,"ion-label",14),h._uU(70),h.ALo(71,"translate"),h.ALo(72,"translate"),h.qZA(),h.TgZ(73,"ion-input",26),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().numberFormatQuantity.setValue(e.detail.value)}),h.qZA(),h.qZA(),h.TgZ(74,"ion-item"),h.TgZ(75,"ion-label",14),h._uU(76),h.ALo(77,"translate"),h.ALo(78,"translate"),h.qZA(),h.TgZ(79,"ion-input",27),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().numberFormatCost.setValue(e.detail.value)}),h.qZA(),h.qZA(),h.TgZ(80,"ion-item"),h.TgZ(81,"ion-label",14),h._uU(82),h.ALo(83,"translate"),h.qZA(),h._UZ(84,"ion-input",28),h.qZA(),h.TgZ(85,"p",12),h._uU(86),h.ALo(87,"translate"),h.qZA(),h.TgZ(88,"ion-button",29),h.NdJ("click",function(){return h.CHM(n),h.MAs(2).slidePrev()}),h._UZ(89,"ion-icon",30),h._uU(90),h.ALo(91,"translate"),h.qZA(),h.TgZ(92,"ion-button",21),h.NdJ("click",function(){return h.CHM(n),h.MAs(2).slideNext()}),h._uU(93),h.ALo(94,"translate"),h._UZ(95,"ion-icon",22),h.qZA(),h.qZA(),h.qZA(),h.TgZ(96,"ion-slide"),h.TgZ(97,"div",31),h.TgZ(98,"ion-text",10),h.TgZ(99,"h1"),h._uU(100),h.ALo(101,"translate"),h.qZA(),h.qZA(),h.TgZ(102,"p",12),h._uU(103),h.ALo(104,"translate"),h.qZA(),h.TgZ(105,"ion-item"),h.TgZ(106,"ion-label"),h.TgZ(107,"h3"),h._uU(108),h.ALo(109,"translate"),h.qZA(),h.TgZ(110,"p"),h._uU(111),h.ALo(112,"number"),h.TgZ(113,"span"),h._uU(114),h.ALo(115,"translate"),h.qZA(),h._uU(116," ("),h.TgZ(117,"span"),h._uU(118),h.ALo(119,"number"),h.ALo(120,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(121,"ion-item"),h.TgZ(122,"ion-label"),h.TgZ(123,"h3"),h._uU(124),h.ALo(125,"translate"),h.ALo(126,"translate"),h.qZA(),h.TgZ(127,"ion-badge",32),h._uU(128),h.qZA(),h.TgZ(129,"ion-badge",33),h._uU(130),h.ALo(131,"number"),h.ALo(132,"translate"),h.qZA(),h.TgZ(133,"ion-badge",34),h._uU(134),h.qZA(),h.qZA(),h.qZA(),h.TgZ(135,"ion-item"),h.TgZ(136,"ion-label"),h.TgZ(137,"h3"),h._uU(138),h.ALo(139,"translate"),h.qZA(),h.TgZ(140,"p"),h.YNc(141,Ce,3,4,"ion-text",35),h.YNc(142,we,3,4,"ion-text",35),h._uU(143),h.ALo(144,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(145,"ion-item"),h.TgZ(146,"ion-label"),h.TgZ(147,"h3"),h._uU(148),h.ALo(149,"translate"),h.qZA(),h.TgZ(150,"p"),h.TgZ(151,"span"),h._uU(152),h.qZA(),h._uU(153),h.ALo(154,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(155,"ion-item"),h.TgZ(156,"ion-label"),h.TgZ(157,"h3"),h._uU(158),h.ALo(159,"translate"),h.qZA(),h.TgZ(160,"p"),h._uU(161),h.qZA(),h.qZA(),h.qZA(),h.TgZ(162,"ion-item"),h.TgZ(163,"ion-label"),h.TgZ(164,"h3"),h._uU(165),h.ALo(166,"translate"),h.qZA(),h.YNc(167,ke,7,8,"p",36),h.qZA(),h.qZA(),h.TgZ(168,"div",37),h.TgZ(169,"ion-button",29),h.NdJ("click",function(){return h.CHM(n),h.MAs(2).slidePrev()}),h._UZ(170,"ion-icon",30),h._uU(171),h.ALo(172,"translate"),h.qZA(),h.TgZ(173,"ion-button",21),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentAlert()}),h._uU(174),h.ALo(175,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("formGroup",i.form),h.xp6(6),h.Oqu(i.pondService.pond.name),h.xp6(3),h.hij(" ",h.lcZ(10,58,"POND_MOD.TOTAL_COST")," "),h.xp6(4),h.Oqu(h.xi3(14,60,null==i.seasonInfo?null:i.seasonInfo.total,"1.0-0")),h.xp6(2),h.hij(" ",h.lcZ(16,63,"CURRENCY_S")," "),h.xp6(2),h.Q6J("ngIf",i.total_harvest>0),h.xp6(1),h.Q6J("ngIf",i.total_move>0),h.xp6(2),h.hij(" ",h.lcZ(21,65,"POND_MOD.CURRENT_SEASON")," "),h.xp6(7),h.Oqu(h.lcZ(28,67,"POND_MOD.SIZE")),h.xp6(6),h.Oqu(h.lcZ(34,69,"POND_MOD.UNIT")),h.xp6(4),h.hij("",h.lcZ(38,71,"PCS"),"/kg"),h.xp6(3),h.hij("gr/",h.lcZ(41,73,"PCS"),""),h.xp6(6),h.AsE("",h.lcZ(47,75,"POND_MOD.QUANTITY")," (",h.lcZ(48,77,"PCS"),")"),h.xp6(3),h.Q6J("value",i.numberFormatQuantityLive.fakeView),h.xp6(4),h.hij("",h.lcZ(54,79,"POND_MOD.SURVIVAL_RATE")," (%)"),h.xp6(3),h.Q6J("disabled",i.form.controls.form1.invalid),h.xp6(1),h.hij(" ",h.lcZ(58,81,"NEXT")," "),h.xp6(7),h.Oqu(h.lcZ(65,83,"POND_MOD.CHOOSE_POND_DES")),h.xp6(3),h.Q6J("ngForOf",i.targetPonds),h.xp6(3),h.AsE("",h.lcZ(71,85,"POND_MOD.QUANTITY")," ",h.lcZ(72,87,"POND_MOD.MOVE")," (kg)"),h.xp6(3),h.Q6J("value",i.numberFormatQuantity.fakeView),h.xp6(3),h.AsE("",h.lcZ(77,89,"POND_MOD.TRANS_COST")," (",h.lcZ(78,91,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",i.numberFormatCost.fakeView),h.xp6(3),h.Oqu(h.lcZ(83,93,"POND_MOD.NOTE")),h.xp6(4),h.hij(" ",h.lcZ(87,95,"CROP_MOD.NOTE_MOVE")," "),h.xp6(4),h.hij(" ",h.lcZ(91,97,"BACK")," "),h.xp6(2),h.Q6J("disabled",i.form.controls.form2.invalid),h.xp6(1),h.hij(" ",h.lcZ(94,99,"NEXT")," "),h.xp6(7),h.hij("",h.lcZ(101,101,"POND_MOD.CAREFUL"),"!"),h.xp6(3),h.hij(" ",h.lcZ(104,103,"POND_MOD.NOTE_CAREFUL")," "),h.xp6(5),h.Oqu(h.lcZ(109,105,"POND_MOD.SIZE_FISH")),h.xp6(3),h.hij("",h.xi3(112,107,i.post.weight,"1.0-1")," "),h.xp6(3),h.hij("g/",h.lcZ(115,110,"POND_MOD.ANIMAL"),""),h.xp6(4),h.AsE("",h.xi3(119,112,i.post.size,"1.0-1")," ",h.lcZ(120,115,"POND_MOD.ANIMAL"),"/kg)"),h.xp6(6),h.AsE("",h.lcZ(125,117,"POND_MOD.QUANTITY")," ",h.lcZ(126,119,"POND_MOD.MOVE"),""),h.xp6(4),h.hij("",i.form.value.form2.quantity," kg"),h.xp6(2),h.AsE("",h.xi3(131,121,i.post.quantity_individual,"1.0-0")," ",h.lcZ(132,124,"PCS"),""),h.xp6(4),h.hij("",i.post.ratio_move," % "),h.xp6(4),h.Oqu(h.lcZ(139,126,"CROP_MOD.SETTLEMENT_COST")),h.xp6(3),h.Q6J("ngIf","vi"==i.translate.currentLang),h.xp6(1),h.Q6J("ngIf","vi"!=i.translate.currentLang),h.xp6(1),h.hij(" ",h.lcZ(144,128,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(149,130,"POND_MOD.TRANS_COST")),h.xp6(4),h.Oqu(i.form.value.form2.move_cost),h.xp6(1),h.hij(" ",h.lcZ(154,132,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(159,134,"POND_MOD.NOTE")),h.xp6(3),h.Oqu(i.form.value.form2.note),h.xp6(4),h.Oqu(h.lcZ(166,136,"POND_MOD.MOVE_IN")),h.xp6(2),h.Q6J("ngIf",i.pondSelected),h.xp6(4),h.hij("",h.lcZ(172,138,"BACK")," "),h.xp6(2),h.Q6J("disabled",i.form.invalid||i.savingFlag.pending),h.xp6(1),h.hij(" ",h.lcZ(175,140,"CONFIRM"),"")}}var Ee=function(){var e=function(){function e(t,n,i,o,a,s){r(this,e),this.modalController=t,this._formBuilder=n,this.pondService=i,this.toastService=o,this.translate=a,this.alertController=s,this.seed_quantity=0,this.pondsLoading=new p.E,this.savingFlag=new p.E,this.numberFormatQuantity=new re.y(""),this.numberFormatQuantityLive=new re.y(""),this.numberFormatCost=new re.y(""),this.total_seed=0,this.total_move=0,this.total_harvest=0,this.post={date:Math.ceil((new Date).getTime()/1e3),pond_target:0,from_season_code:"",ratio_move:0,quantity:0,quantity_individual:0,size:0,weight:0,date_old:0,total_cost:0,move_cost:0,note:"",seed_cost:0},this.focusState={quantity:!0,ratio:!1}}return c(e,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTargetPonds();case 2:this.buildForm(),this.getWeight();case 4:case"end":return e.stop()}},e,this)}))}},{key:"buildForm",value:function(){this.form=this._formBuilder.group({form1:this._formBuilder.group({quantityLive:["",[a.kI.required,a.kI.min(0)]],ratio:["",[a.kI.required,a.kI.min(0),a.kI.max(100)]],unit:["",a.kI.required],size:["",[a.kI.required,a.kI.min(0)]]}),form2:this._formBuilder.group({quantity:["",[a.kI.required,a.kI.min(0)]],pond_target:["",a.kI.required],move_cost:[""],note:["Chuy\u1ec3n giai \u0111o\u1ea1n "]})}),this.targetPonds&&1==this.targetPonds.length&&this.form.controls.form2.patchValue({pond_target:this.targetPonds[0].id})}},{key:"getWeight",value:function(){var e=this;this.pondService.getWeight().subscribe(function(t){1==t.status?(e.weight={total_loss:t.data.total_loss?t.data.total_loss:0,weight:t.data.weight?t.data.weight:0},e.seedTimes.forEach(function(t){e.seed_quantity+=+t.seed_quantity}),e.harvestTimes.forEach(function(t){e.seed_quantity-=1e3*t.harvest_quantity/t.harvest_size}),e.moveTimes.forEach(function(t){t.to_season_code==e.pondService.pond.current_season?(e.seed_quantity+=+t.quantity_individual,t.weight>=e.weight.weight&&(e.weight.weight=t.weight)):e.seed_quantity-=t.quantity_individual}),e.seed_quantity-=e.weight.total_loss,e.numberFormatQuantityLive.setValue(e.seed_quantity),e.form.controls.form1.patchValue({size:e.weight.weight,unit:"con",quantityLive:e.seed_quantity,ratio:100}),e.numberFormatQuantity.setValue((e.seed_quantity*e.weight.weight/1e3).toFixed(0)),e.reloadData()):e.toastService.warning(t.message)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"onSave",value:function(){var e=this;if(this.post.ratio_move>100)return this.toastService.warning(this.translate.instant("POND_MOD.ERROR_MOVE")),!1;this.post.pond_target=this.form.value.form2.pond_target,this.post.from_season_code=this.seasonInfo.code,this.post.quantity=this.numberFormatQuantity.realValue,this.post.date_old=this.seasonInfo.old,this.post.move_cost=this.form.value.form2.move_cost,this.post.note=this.form.value.form2.note,console.log(this.post),this.savingFlag.setPending(!0),this.pondService.reqSeasonMove(this.post).subscribe(function(t){1==t.status?(e.toastService.success(t.message),100==e.post.ratio_move&&(e.pondService.seasonStart=!1),e.pondService.reloadSeason$.next(1),e.savingFlag.setResult(!0),e.modalController.dismiss()):(e.toastService.warning(t.message),e.savingFlag.setResult(!1))},function(){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"endView",value:function(){var e=this;"con"==this.form.value.form1.unit?(this.post.weight=this.form.value.form1.size,this.post.size=1e3/this.form.value.form1.size):(this.post.size=this.form.value.form1.size,this.post.weight=1e3/this.form.value.form1.size),this.post.quantity_individual=Math.ceil(1e3*this.numberFormatQuantity.realValue/this.post.weight),this.post.ratio_move=parseFloat((100*this.post.quantity_individual/this.seed_quantity).toFixed(0));var t=0;if(t+=this.seasonInfo.harvest_list.reduce(function(e,t){return e+ +t.cost},0),t+=this.seasonInfo.moved_list.reduce(function(t,n){return n.from_season_code==e.seasonInfo.code?t+parseInt(n.cost):t},0),console.log(t),!(this.post.ratio_move<=100))return this.post.total_cost=this.seasonInfo.total-t,this.toastService.warning(this.translate.instant("POND_MOD.ERROR_MOVE")),!1;this.post.total_cost=(this.seasonInfo.total-t)*this.post.ratio_move/100,this.post.seed_cost=this.post.total_cost/this.post.quantity_individual,console.log(this.post)}},{key:"selectPond",value:function(e){var t=this.targetPonds.findIndex(function(t){return t.id==e.target.value});this.pondSelected=this.targetPonds[t]}},{key:"quantityLiveChange",value:function(){if(0!=this.seed_quantity&&0!=this.focusState.quantity){var e=(100*this.numberFormatQuantityLive.realValue/this.seed_quantity).toFixed(0);this.form.get("form1.ratio").patchValue(e);var t=this.form.controls.form1.value.size;"kg"==this.form.controls.form1.value.unit&&(t=1e3/t),console.log(this.seed_quantity*(+e/100)*t/1e3),this.numberFormatQuantity.setValue(this.seed_quantity*(+e/100)*t/1e3)}}},{key:"ratioChange",value:function(e){var t=Math.round(this.seed_quantity*e.target.value/100);t>0&&1==this.focusState.ratio&&this.numberFormatQuantityLive.setValue(t)}},{key:"getTargetPonds",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pondsLoading.setPending(!0),e.next=3,this.pondService.getTargetPonds().toPromise().catch(function(){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))});case 3:1==(t=e.sent).status?(this.targetPonds=t.data,this.seasonInfo=t.season,this.numberFormatQuantityLive.setValue(t.season.now_individual),this.total_harvest=this.seasonInfo.harvest_list.reduce(function(e,t){return e+1e3*t.harvest_quantity/t.harvest_size},0),this.total_move=this.seasonInfo.moved_list.reduce(function(e,t){return console.log(t.from_season_code+" = "+n.seasonInfo.code),t.from_season_code==n.seasonInfo.code?e+parseInt(t.quantity_individual):e},0),this.pondsLoading.setResult(!0)):(this.toastService.warning(t.error),this.pondsLoading.setResult(!1));case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentAlert",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.CAREFUL"),message:this.translate.instant("POND_MOD.NOTE_CAREFUL"),buttons:[{text:this.translate.instant("CANCEL"),role:"cancel",cssClass:"secondary"},{text:"OK",handler:function(){t.onSave()}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"changeUnit",value:function(){}},{key:"changeInput",value:function(e,t){if(this.form.controls.form1.value.size&&0!=this.seed_quantity){switch(e){case"size":this.form.get("form1.size").patchValue(t.target.value);break;case"unit":this.form.controls.form1.patchValue({size:1e3/this.form.controls.form1.value.size});break;case"quantityLive":this.numberFormatQuantityLive.setValue(t.target.value);var n=(100*this.numberFormatQuantityLive.realValue/this.seed_quantity).toFixed(0);this.form.get("form1.ratio").patchValue(n);break;case"ratio":var i=Math.round(this.seed_quantity*t.target.value/100);this.form.get("form1.ratio").patchValue(t.target.value),this.numberFormatQuantityLive.setValue(i)}this.reloadData()}}},{key:"reloadData",value:function(){var e=+this.form.controls.form1.value.ratio;console.log(e);var t=+this.form.controls.form1.value.size;"kg"==this.form.controls.form1.value.unit&&(t=1e3/t),this.numberFormatQuantity.setValue(this.seed_quantity*(+e/100)*t/1e3)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(a.qu),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(l.Br))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-move"]],inputs:{harvestTimes:"harvestTimes",seedTimes:"seedTimes",moveTimes:"moveTimes"},decls:9,vars:4,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[3,"ionSlideReachEnd"],["slides",""],["formGroupName","form1",1,"w-100","ion-padding"],["lines","none"],["slot","end"],["color","danger"],["lines","none",4,"ngIf"],[1,"tip"],["size","6"],["color","primary","position","floating"],["required","","formControlName","size","type","tel","inputmode","decimal",3,"ionInput"],["formControlName","unit",3,"ionChange"],["value","kg"],["value","con"],["required","","formControlName","quantityLive","type","tel","inputmode","numeric",3,"value","ionInput"],["required","","formControlName","ratio","type","tel","inputmode","decimal",3,"ionInput"],["shape","round",3,"disabled","click"],["slot","end","name","arrow-forward"],["formGroupName","form2",1,"w-100","ion-padding"],["formControlName","pond_target",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["required","","type","tel","inputmode","numeric","formControlName","quantity",3,"value","ionChange"],["required","","type","tel","inputmode","numeric","formControlName","move_cost",3,"value","ionChange"],["required","","type","text","inputmode","text","formControlName","note"],["shape","round","fill","clear",3,"click"],["slot","start","name","arrow-back"],[1,"w-100","ion-padding"],["color","primary",1,"mr-2"],["color","success",1,"mr-2"],["color","tertiary",1,"mr-2"],["color","danger",4,"ngIf"],[4,"ngIf"],[1,"ion-padding"],[3,"value"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.YNc(8,Ne,176,142,"ion-content",3)),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,2,"POND_MOD.MOVE_POND")),h.xp6(2),h.Q6J("ngIf",t.seasonInfo))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,o.O5,l.W2,a.JL,a.sg,l.Hr,l.A$,a.x0,l.Ie,l.Q$,l.yW,l.jY,l.Nd,l.wI,l.pK,l.j9,a.Q7,a.JJ,a.u,l.t9,l.QI,l.n0,o.sg,l.yp],pipes:[f.X$,o.JJ],styles:["[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .w-100[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:.6em;font-style:italic;padding:10px}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .p-info[_ngcontent-%COMP%]{padding:5px 0}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .mr-2[_ngcontent-%COMP%]{margin-right:5px}"]}),e}(),Me=i(82629);function Ie(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"PRIVATE_MODE_PUBLIC")))}function Re(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"PRIVATE_MODE_FOLLOWER")))}function Ue(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"PRIVATE_MODE_PROTECTED")))}function Pe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text",0),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",21),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).moveDevice(e.value,"pub",e.key)}),h._uU(4,"Chuy\u1ec3n"),h.qZA(),h.TgZ(5,"ion-button",22),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).removeDevice("pub",e.key,e.value.id)}),h._uU(6,"X\xf3a"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.Oqu(i.value.name)}}function Ye(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text",0),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",21),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).moveDevice(e.value,"sub",e.key)}),h._uU(4,"Chuy\u1ec3n"),h.qZA(),h.TgZ(5,"ion-button",22),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).removeDevice("sub",e.key,e.value.id)}),h._uU(6,"X\xf3a"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.Oqu(i.value.name)}}function Le(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text",0),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",21),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).moveDevice(e.value,"feed",e.key)}),h._uU(4,"Chuy\u1ec3n"),h.qZA(),h.TgZ(5,"ion-button",22),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).removeDevice("feed",e.key,e.value.id)}),h._uU(6,"X\xf3a"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.Oqu(i.value.name)}}function Fe(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card",11),h.TgZ(2,"ion-card-header"),h.TgZ(3,"ion-card-subtitle"),h._UZ(4,"ion-icon",19),h._uU(5," Qu\u1ea3n l\xfd thi\u1ebft b\u1ecb "),h.qZA(),h.qZA(),h.TgZ(6,"ion-card-content"),h.TgZ(7,"ion-list",5),h.YNc(8,Pe,7,1,"ion-item",20),h.ALo(9,"keyvalue"),h.YNc(10,Ye,7,1,"ion-item",20),h.ALo(11,"keyvalue"),h.YNc(12,Le,7,1,"ion-item",20),h.ALo(13,"keyvalue"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(8),h.Q6J("ngForOf",h.lcZ(9,3,n.pubs)),h.xp6(2),h.Q6J("ngForOf",h.lcZ(11,5,n.subs)),h.xp6(2),h.Q6J("ngForOf",h.lcZ(13,7,n.feedings))}}function Je(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",23),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentMove()}),h._UZ(1,"ion-icon",24),h._uU(2),h.ALo(3,"translate"),h.qZA()}2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"CROP_MOD.MOVE_AWAY")," "))}function Qe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",25),h.NdJ("click",function(){return h.CHM(n),h.oxw().openSeasonCancel()}),h._UZ(1,"ion-icon",26),h._uU(2),h.ALo(3,"translate"),h.qZA()}2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"CROP_MOD.CANCEL_CROP")," "))}var Ve=function(){var e=function(){function e(t,n,i,o,a,s,c,l,u){r(this,e),this.modalCtrl=t,this.pondService=n,this.router=i,this.alertController=o,this.loadingController=a,this.toastService=s,this.translate=c,this.iotService=l,this.dblocalService=u,this.manager=[]}return c(e,[{key:"ngOnInit",value:function(){this.loadSetting(),this.dblocalService.getLocalData(),this.ponds=this.dblocalService.ponds}},{key:"dismiss",value:function(){this.modalCtrl.dismiss({dismissed:!0})}},{key:"presentViewMode",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:me,componentProps:{pondLocalIndex:this.pondLocalIndex}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentManager",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:be,componentProps:{manager:this.manager}});case 2:return(t=e.sent).onDidDismiss().then(function(e){e.data&&(n.manager=e.data)}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentEdit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:ge,componentProps:{pondLocalIndex:this.pondLocalIndex}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentSetting",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:ae});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"openSeasonCancel",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:le,componentProps:{pondLocalIndex:this.pondLocalIndex}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentMove",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:Ee});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"gotoHistory",value:function(){this.modalCtrl.dismiss(),this.router.navigateByUrl("pond/"+this.pondService.pcode+"/history")}},{key:"loadSetting",value:function(){var e=this;this.pondService.getSeting().pipe().subscribe(function(t){1==t.status&&("pond_operator"in t.data.manager&&t.data.manager.pond_operator.forEach(function(t){t.key="pond_operator",e.manager.push(t)}),"pond_manager"in t.data.manager&&t.data.manager.pond_manager.forEach(function(t){t.key="pond_manager",e.manager.push(t)}),"pond_expert"in t.data.manager&&t.data.manager.pond_expert.forEach(function(t){t.key="pond_expert",e.manager.push(t)}),console.log(e.manager))})}},{key:"presentDeletePond",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.CAREFUL"),message:this.translate.instant("POND_MOD.CONFIRM_DELETE")+" <strong>"+this.pondService.pond.name+"</strong>?",inputs:[{name:"confirmInput",type:"text",placeholder:this.translate.instant("POND_MOD.ENTER")+' "OK"'}],buttons:[{text:this.translate.instant("NO"),role:"cancel",cssClass:"secondary"},{text:this.translate.instant("POND_MOD.DELETE"),cssClass:"secondary",handler:function(e){"OK"===e.confirmInput&&(t.loadingController.create({message:t.translate.instant("POND_MOD.DELETING")}).then(function(e){e.present()}),t.deletePond())}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"deletePond",value:function(){var e=this;this.pondService.deletePond({confirm:"XOA"}).pipe().subscribe(function(t){1==t.status?(e.toastService.success(t.message),e.dblocalService.ponds.splice(e.pondLocalIndex,1),e.modalCtrl.dismiss(),e.router.navigateByUrl("tabs/management")):e.toastService.warning(t.error),e.loadingController.dismiss()})}},{key:"moveDevice",value:function(e,t,n){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,a=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=[],this.ponds.forEach(function(e){o.push({name:e.infor.name,type:"radio",label:e.infor.name,value:e.infor.code,checked:!1})}),o[0].checked=!0,i.next=5,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("DEVICE_MOD.MOVE_TEXT"),message:this.translate.instant("DEVICE_MOD.CHOOSE_POND"),inputs:o,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(i){a.handleMove(e,i,t,n)}}]});case 5:return i.next=7,i.sent.present();case 7:case"end":return i.stop()}},i,this)}))}},{key:"handleMove",value:function(e,t,n,i){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function o(){var a,r,s,c=this;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.iotService.move(e.name,t,e.id).catch(function(){c.toastService.danger(c.translate.instant("ERROR_CONNECT"))});case 2:(a=o.sent)&&1==a.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.MOVE_SUCCESS")),"sub"==n?delete this.subs[i]:"pubs"==n?delete this.pubs[i]:"feed"==n&&delete this.feedings[i],r=this.findIndexDevice(i),-1!=(s=this.findIndexPond(t))&&-1!=r&&(this.dblocalService.ponds[s].devices.push(this.dblocalService.ponds[this.pondLocalIndex].devices[r]),this.dblocalService.ponds[this.pondLocalIndex].devices.splice(r,1),this.dblocalService.setLocalData("ponds",this.dblocalService.ponds))):a&&0==a.status&&this.toastService.warning(a.error);case 4:case"end":return o.stop()}},o,this)}))}},{key:"findIndexDevice",value:function(e){return this.dblocalService.ponds[this.pondLocalIndex].devices.findIndex(function(t){return t.device_id_fb===e})}},{key:"findIndexPond",value:function(e){return this.dblocalService.ponds.findIndex(function(t){return t.infor.code===e})}},{key:"handleRemove",value:function(e,t,n){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,a,r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.iotService.remove(n).catch(function(){r.toastService.danger(r.translate.instant("ERROR_CONNECT"))});case 2:(o=i.sent)&&1==o.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.REMOVE_SUCCESS")),-1!=(a=this.findIndexDevice(t))&&(this.dblocalService.ponds[this.pondLocalIndex].devices.splice(a,1),this.dblocalService.setLocalData("ponds",this.dblocalService.ponds)),"sub"==e?delete this.subs[t]:"pub"==e?delete this.pubs[t]:"feed"==e&&delete this.feedings[t]):o&&0==o.status&&this.toastService.warning(o.error);case 4:case"end":return i.stop()}},i,this)}))}},{key:"removeDevice",value:function(e,t,n){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("DEVICE_MOD.NOTI_REMOVE"),message:this.translate.instant("DEVICE_MOD.CONFIRM_REMOVE_DEVICE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){o.handleRemove(e,t,n)}}]});case 2:return i.next=4,i.sent.present();case 4:case"end":return i.stop()}},i,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(s.F0),h.Y36(l.Br),h.Y36(l.HT),h.Y36(x.k),h.Y36(f.sK),h.Y36(Me.d),h.Y36(se.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-info"]],inputs:{subs:"subs",pubs:"pubs",feedings:"feedings",showDevice:"showDevice",pondLocalIndex:"pondLocalIndex"},decls:64,vars:42,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding","ion-text-center"],[3,"src"],["lines","none"],["detail","",3,"click"],["name","information-circle-outline","slot","start"],["name","eye-outline","slot","start"],[4,"ngIf"],["src","assets/icon/supervised_user_circle-24px.svg","slot","start"],["mode","ios"],["name","options"],["size","large","expand","block","shape","round","fill","outline",3,"click",4,"ngIf"],["size","large","color","danger","expand","block","shape","round","fill","outline",3,"click",4,"ngIf"],["size","large","color","medium","expand","block","shape","round","fill","outline",3,"click"],["name","timer-outline","slot","start"],["size","small","color","medium","expand","block","fill","clear",3,"click"],["name","remove-circle-outline","slot","start"],["name","hardware-chip-outline"],[4,"ngFor","ngForOf"],["expand","block","shape","round","fill","outline","slot","end","size","small",3,"click"],["expand","block","shape","round","fill","outline","slot","end","size","small","color","danger",3,"click"],["size","large","expand","block","shape","round","fill","outline",3,"click"],["src","assets/icon/priority.svg","slot","start"],["size","large","color","danger","expand","block","shape","round","fill","outline",3,"click"],["name","trash-outline","slot","start"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h._UZ(10,"img",4),h.TgZ(11,"h1"),h._uU(12),h.qZA(),h.TgZ(13,"span"),h._uU(14),h.qZA(),h.qZA(),h.TgZ(15,"ion-list",5),h.TgZ(16,"ion-item",6),h.NdJ("click",function(){return t.presentEdit()}),h._UZ(17,"ion-icon",7),h.TgZ(18,"ion-label"),h.TgZ(19,"h3"),h._uU(20),h.ALo(21,"translate"),h.qZA(),h.TgZ(22,"p"),h._uU(23),h.ALo(24,"translate"),h.ALo(25,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(26,"ion-item",6),h.NdJ("click",function(){return t.presentViewMode()}),h._UZ(27,"ion-icon",8),h.TgZ(28,"ion-label"),h.TgZ(29,"h3"),h._uU(30),h.ALo(31,"translate"),h.qZA(),h.TgZ(32,"p"),h.YNc(33,Ie,3,3,"span",9),h.YNc(34,Re,3,3,"span",9),h.YNc(35,Ue,3,3,"span",9),h.qZA(),h.qZA(),h.qZA(),h.TgZ(36,"ion-item",6),h.NdJ("click",function(){return t.presentManager()}),h._UZ(37,"ion-icon",10),h.TgZ(38,"ion-label"),h.TgZ(39,"h3"),h._uU(40),h.ALo(41,"translate"),h.qZA(),h.TgZ(42,"p"),h._uU(43),h.ALo(44,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(45,Fe,14,9,"div",9),h.TgZ(46,"div"),h.TgZ(47,"ion-card",11),h.TgZ(48,"ion-card-header"),h.TgZ(49,"ion-card-subtitle"),h._UZ(50,"ion-icon",12),h._uU(51),h.ALo(52,"translate"),h.qZA(),h.qZA(),h.TgZ(53,"ion-card-content"),h.YNc(54,Je,4,3,"ion-button",13),h.YNc(55,Qe,4,3,"ion-button",14),h.TgZ(56,"ion-button",15),h.NdJ("click",function(){return t.gotoHistory()}),h._UZ(57,"ion-icon",16),h._uU(58),h.ALo(59,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(60,"ion-button",17),h.NdJ("click",function(){return t.presentDeletePond()}),h._UZ(61,"ion-icon",18),h._uU(62),h.ALo(63,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,22,"POND_MOD.POND_INFORMATION")),h.xp6(4),h.Q6J("src","https://chart.googleapis.com/chart?chs=120x120&cht=qr&chl=pond:"+t.pondService.pond.code+"&choe=UTF-8",h.LSH),h.xp6(2),h.Oqu(t.pondService.pond.name),h.xp6(2),h.hij("#",t.pondService.pond.code,""),h.xp6(6),h.Oqu(h.lcZ(21,24,"POND_MOD.POND_SPECIFICATIONS")),h.xp6(3),h.HOy("",h.lcZ(24,26,"AREA"),": ",t.pondService.pond.area," m2, ",h.lcZ(25,28,"DEEP"),": ",t.pondService.pond.deep," m"),h.xp6(7),h.Oqu(h.lcZ(31,30,"PRIVATE_MODE")),h.xp6(3),h.Q6J("ngIf",3==t.pondService.pond.public),h.xp6(1),h.Q6J("ngIf",2==t.pondService.pond.public),h.xp6(1),h.Q6J("ngIf",1==t.pondService.pond.public),h.xp6(5),h.Oqu(h.lcZ(41,32,"MANAGER")),h.xp6(3),h.AsE("",null==t.manager?null:t.manager.length," ",h.lcZ(44,34,"FARM_MOD.MEMBER"),""),h.xp6(2),h.Q6J("ngIf",t.showDevice),h.xp6(6),h.hij(" ",h.lcZ(52,36,"CROP_MOD.CROP_MANAGEMENT")," "),h.xp6(3),h.Q6J("ngIf",t.pondService.seasonStart),h.xp6(1),h.Q6J("ngIf",t.pondService.seasonStart),h.xp6(3),h.hij(" ",h.lcZ(59,38,"POND_MOD.POND_HISTORY")," "),h.xp6(4),h.hij(" ",h.lcZ(63,40,"POND_MOD.REMOVE_POND")," "))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.q_,l.Ie,l.Q$,o.O5,l.PM,l.Zi,l.tO,l.FN,o.sg,l.yW],pipes:[f.X$,o.Nd],styles:[""]}),e}(),je=i(17238),He=i(22923),Ge=i(1965);function Be(e,t){if(1&e&&(h.TgZ(0,"ion-segment-button",21),h.TgZ(1,"h2"),h._uU(2),h.qZA(),h.qZA()),2&e){var n=t.index;h.Q6J("value",n),h.xp6(2),h.Oqu(n+1)}}function ze(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",18),h.TgZ(1,"p",5),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-segment",19),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().changeRepast(e)}),h.YNc(5,Be,3,2,"ion-segment-button",20),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,3,"POND_MOD.REPAST")),h.xp6(2),h.Q6J("value",i.repastSelected),h.xp6(1),h.Q6J("ngForOf",i.repasts)}}function $e(e,t){if(1&e&&(h.TgZ(0,"ion-chip",22),h._UZ(1,"ion-icon",23),h.TgZ(2,"ion-label",24),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.AsE("",h.lcZ(4,2,"POND_MOD.EXPECTED")," ",null==n.inforloadExpectedDaily?null:n.inforloadExpectedDaily.for_calendar.value_check,"kg")}}function We(e,t){if(1&e&&(h.TgZ(0,"ion-chip",25),h._UZ(1,"ion-icon",26),h.TgZ(2,"ion-label",27),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.AsE("",h.lcZ(4,2,"POND_MOD.FOR_PROCEDURE")," ",null==n.inforloadExpectedDaily?null:n.inforloadExpectedDaily.for_procedure.feed,"kg")}}function Xe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-row",32),h.TgZ(1,"ion-col",7),h.TgZ(2,"ion-button",33),h.NdJ("click",function(){var e=h.CHM(n).index,t=h.oxw().index;return h.oxw().removeRowFeed(t,e)}),h._UZ(3,"ion-icon",34),h.qZA(),h.qZA(),h.TgZ(4,"ion-col",35),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label",36),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"ion-input",37),h.NdJ("click",function(){var e=h.CHM(n),t=e.index,i=e.$implicit,o=h.oxw().index;return h.oxw().openPicker(1,"feed",o,t,i)})("ngModelChange",function(e){return t.$implicit.product_name=e}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-col",38),h.TgZ(11,"ion-item"),h.TgZ(12,"ion-label",36),h._uU(13),h.qZA(),h.TgZ(14,"ion-input",39),h.NdJ("ngModelChange",function(e){return t.$implicit.quantity=e})("ionBlur",function(){var e=h.CHM(n).$implicit;return h.oxw(2).checkInvetory(e,"repast")}),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=t.index,a=h.oxw(2);h.xp6(2),h.Q6J("disabled",0==o),h.xp6(5),h.AsE("",i.store_name," | ",h.lcZ(8,8,"POND_MOD.FEED"),""),h.xp6(2),h.Q6J("disabled",a.disableForm.feed)("ngModel",i.product_name)("value",i.product_name),h.xp6(4),h.Oqu(i.unit),h.xp6(1),h.Q6J("ngModel",i.quantity)}}function Ke(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-row",32),h.TgZ(1,"ion-col",7),h.TgZ(2,"ion-button",33),h.NdJ("click",function(){var e=h.CHM(n).index,t=h.oxw().index;return h.oxw().removeRowBlend(t,e)}),h._UZ(3,"ion-icon",34),h.qZA(),h.qZA(),h.TgZ(4,"ion-col",35),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label",36),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"ion-input",37),h.NdJ("click",function(){var e=h.CHM(n),t=e.index,i=e.$implicit,o=h.oxw().index;return h.oxw().openPicker(2,"blend",o,t,i)})("ngModelChange",function(e){return t.$implicit.product_name=e}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-col",38),h.TgZ(11,"ion-item"),h.TgZ(12,"ion-label",36),h._uU(13),h.qZA(),h.TgZ(14,"ion-input",39),h.NdJ("ngModelChange",function(e){return t.$implicit.quantity=e})("ionBlur",function(){var e=h.CHM(n).$implicit;return h.oxw(2).checkInvetory(e,"blend")}),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=t.index,a=h.oxw(2);h.xp6(2),h.Q6J("disabled",0==o),h.xp6(5),h.AsE("",i.store_name," | ",h.lcZ(8,8,"POND_MOD.FEED_SUPPLEMENT"),""),h.xp6(2),h.Q6J("disabled",a.disableForm.blend)("ngModel",i.product_name)("value",i.product_name),h.xp6(4),h.Oqu(i.unit),h.xp6(1),h.Q6J("ngModel",i.quantity)}}function et(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",28),h.TgZ(1,"ion-grid"),h.YNc(2,Xe,15,10,"ion-row",29),h.YNc(3,Ke,15,10,"ion-row",29),h.TgZ(4,"ion-row"),h.TgZ(5,"ion-col",5),h.TgZ(6,"ion-button",30),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().presentOptionProduct(1,e)}),h._UZ(7,"ion-icon",31),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.TgZ(10,"ion-button",30),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().presentOptionProduct(2,e)}),h._UZ(11,"ion-icon",31),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.index,o=h.oxw();h.Q6J("hidden",i!=o.repastSelected)("@showRepast",i==o.repastSelected),h.xp6(2),h.Q6J("ngForOf",o.feed[i]),h.xp6(1),h.Q6J("ngForOf",o.blend[i]),h.xp6(3),h.Q6J("disabled",o.feed[i].length>=6),h.xp6(2),h.hij(" ",h.lcZ(9,8,"POND_MOD.FEED")," "),h.xp6(2),h.Q6J("disabled",o.blend[i].length>=10),h.xp6(2),h.hij(" ",h.lcZ(13,10,"POND_MOD.BLEND")," ")}}function tt(e,t){1&e&&(h.TgZ(0,"div",5),h._UZ(1,"ion-spinner",40),h.qZA())}function nt(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",41),h.TgZ(1,"ion-chip",1),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentRemind()}),h._UZ(2,"ion-icon",42),h.TgZ(3,"ion-label"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(4),h.AsE("",h.lcZ(5,2,"POND_MOD.REMIND_MIXED")," ",i.itemRemind,"")}}var it=function(){var e=function(){function e(t,n,i,o,a,s,c,l,u,d,g){r(this,e),this.modalCtrl=t,this.pondService=n,this.pickerCtrl=i,this.toastService=o,this.calendarService=a,this.alertController=s,this.translate=c,this.settingService=l,this.storeService=u,this.modalController=d,this.dbLocalService=g,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.dataRaw=[],this.repastSelected=0,this.repasts=[],this.feed=[],this.blend=[],this.itemRemind="",this.disableForm={feed:!1,blend:!1}}return c(e,[{key:"ngOnInit",value:function(){this.settingService.getSetting("showGramFeed"),this.repastSelected=this.repast?this.repast:0,this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.item.date==this.dateRangeSelected&&(this.itemSelected=this.item);for(var e=1;e<=this.pondService.numRepast;e++)this.repasts.push([]);this.processGroupRepast(),this.loadExpectedDaily()}},{key:"loadStore",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.dbLocalService.stores.length){e.next=5;break}return e.next=3,this.storeService.getApiStore("get-list-avaiable","&pcode="+this.pondService.pcode,"manager/pond-store-mobie").toPromise().catch(function(){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 3:1==(t=e.sent).status?(this.dbLocalService.stores=t.data.map(function(e){return{infor:e,store:[]}}),this.dbLocalService.setLocalData("stores",this.dbLocalService.stores)):this.toastService.warning(t.error);case 5:if(0!=this.dbLocalService.stores[0].store.length){e.next=10;break}return e.next=8,this.storeService.getApiStore("get-list-product","&pcode="+this.pondService.pcode+"&wcode="+this.dbLocalService.stores[0].infor.code,"manager/pond-store-mobie").toPromise().catch(function(){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 8:1==(n=e.sent).status?(this.dbLocalService.stores[0].store=n.data,this.dbLocalService.setLocalData("stores",this.dbLocalService.stores)):this.toastService.warning(n.error);case 10:case"end":return e.stop()}},e,this)}))}},{key:"loadExpectedDaily",value:function(){var e=this;console.log(m(this.dateRangeSelected).valueOf()/1e3),this.calendarService.getExpectedDaily(this.pondService.pond.current_season,"feed",m(this.dateRangeSelected).valueOf()/1e3).subscribe(function(t){1==t.status?e.inforloadExpectedDaily=t.data:e.toastService.warning(t.error)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"dismiss",value:function(){this.modalCtrl.dismiss()}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0);var t=[];this.repasts.forEach(function(n,i){console.log(n),t[i]={feeds:e.feed[i].map(function(e){if(e.product_id)return{kind:e.product_id,quantity:e.quantity.toString().replace(",","."),wcode:e.wcode,packing:e.packing}}),blends:e.blend[i].map(function(t){if(t.product_id)return{kind:t.product_id,quantity:parseFloat((t.quantity.toString().replace(",",".")*e.getFactor(t,"blend")).toFixed(5)),wcode:t.wcode,packing:t.packing}})}});var n=m(this.dateRangeSelected).format("YYYY-MM-DD"),i={date:n,repast:t};console.log(i),this.pondService.fullUpdate(i).subscribe(function(t){"success"==t.status?(e.toastService.success(e.translate.instant("POND_MOD.NOTI_UPDATE")),e.savingFlag.setResult(!0),n==e.maxDate.format("YYYY-MM-DD")?e.modalCtrl.dismiss(i):e.dismiss()):(e.toastService.warning(t.message),e.savingFlag.setResult(!1))},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=m(this.dateRangeSelected);this.dataRaw.length>0?(this.itemSelected=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})],this.processGroupRepast(),(t<m(this.dataRaw[this.dataRaw.length-1].date)||t>m(this.dataRaw[0].date))&&this.getData()):this.getData(),this.loadExpectedDaily()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"changeRepast",value:function(e){this.repastSelected=e.detail.value}},{key:"removeRowFeed",value:function(e,t){if(0==t)return this.feed[e][0].quantity=0,!1;this.feed[e].splice(t,1)}},{key:"removeRowBlend",value:function(e,t){if(0==t)return this.blend[e][0].quantity=0,!1;this.blend[e].splice(t,1)}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0);var t=m(this.dateRangeSelected).format("YYYY-MM-DD");this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},t).subscribe(function(n){n.data?(e.dataRaw=n.data,e.itemSelected=e.dataRaw[e.dataRaw.findIndex(function(e){return e.date==t})],e.processGroupRepast(),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(t)})}},{key:"processGroupRepast",value:function(){var e=this;this.blend=[],this.feed=[];for(var t=1;t<=this.pondService.numRepast;t++)this.feed.push([]),this.blend.push([]);void 0!==this.itemSelected?(this.itemSelected.feed&&this.itemSelected.feed.forEach(function(t){t.type=1,e.feed[t.times-1].push(t)}),this.itemSelected.blend&&this.itemSelected.blend.forEach(function(t){e.checkUnitBlend(t);var n={pond_daily_id:t.pond_daily_id,product_id:t.product_id,product_name:t.product_name,quantity:parseFloat((t.quantity/e.getFactor(t,"blend")).toFixed(5).toString()),type:2,store_name:t.store_name,wcode:t.wcode,unit:t.unit};console.log(n),e.blend[t.times-1].push(n)})):console.log("item undefined")}},{key:"openPicker",value:function(e,t,n,i,o){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r,s=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.modalController.create({component:Ge.z,componentProps:{groupId:e,item:o}});case 2:return(r=a.sent).onDidDismiss().then(function(e){if(e.data){var o={product_name:e.data.product_name,product_id:e.data.product_id,unit:e.data.unit,quantity_current:e.data.quantity_current,wcode:e.data.wcode,store_name:e.data.store_name,quantity:e.data.quantity};console.log(o),s[t][n][i]=o,s.itemRemind=o.product_name}}),a.next=6,r.present();case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},a,this)}))}},{key:"presentRemind",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.REMIND"),message:this.translate.instant("POND_MOD.DAY_MIXED")+" <strong>"+this.itemRemind+"</strong> "+this.translate.instant("POND_MOD.REPEAT")+"?",inputs:[{name:"date",type:"number",min:1,max:60,placeholder:this.translate.instant("POND_MOD.DAY_COME")}],buttons:[{text:this.translate.instant("OPTION.CANCEL"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(e){t.saveRemind(e.date)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"saveRemind",value:function(e){var t=this,n=m().add(e,"days"),i={content:this.translate.instant("POND_MOD.DAY_MIXED")+" "+this.itemRemind+" "+this.translate.instant("POND_MOD.REPEAT"),date:n.format("YYYY-MM-DD"),time:n.format("HH:mm"),pond_id:this.pondService.pcode,done:!1};this.calendarService.insertCalendar(i).subscribe(function(e){e.error||1!=e.status?t.toastService.warning(e.error):(t.toastService.success(t.translate.instant("POND_MOD.NOTI_ADD_REMIND")),t.itemRemind=null)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"checkInvetory",value:function(e,t){!this.settingService.alertInventory||!e.quantity_current||(console.log(e.quantity_current),console.log(this.getFactor(e,t)),console.log(e.quantity),+e.quantity_current<+this.getFactor(e,t)*e.quantity&&this.presentAlertInvetory(e))}},{key:"getFactor",value:function(e,t){return console.log(e),"g"==e.unit||"ml"==e.unit?.001:1}},{key:"presentAlertInvetory",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.ALERT"),message:this.translate.instant("POND_MOD.PRODUCT")+" <strong>"+e.product_name+"</strong> "+this.translate.instant("POND_MOD.NOT_ENOUGH")+"!",inputs:[{name:"data",type:"checkbox",value:!0,label:this.translate.instant("POND_MOD.DONT_SHOW_NEXT_TIME"),placeholder:this.translate.instant("POND_MOD.DAY_COME")}],buttons:[{text:this.translate.instant("OPTION.CANCEL"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(e){console.log(e),e[0]&&n.settingService.alertInventoryChange(!1)}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"presentOptionProduct",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:Ge.z,componentProps:{groupId:e}});case 2:return(i=n.sent).onDidDismiss().then(function(n){if(n.data){var i={product_name:n.data.product_name,product_id:n.data.product_id,unit:n.data.unit,quantity_current:n.data.quantity_current,wcode:n.data.wcode,store_name:n.data.store_name,packing:n.data.packing,quantity:""};console.log(o.settingService.showGramFeed),1===e?o.feed[t].push(i):(o.checkUnitBlend(i),o.blend[t].push(i)),o.itemRemind=i.product_name}}),n.next=6,i.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"checkValid",value:function(){var e=this,t=!0;return this.repasts.forEach(function(n,i){e.feed[i].forEach(function(e){(!e.product_id||e.quantity<0)&&(t=!1)}),e.blend[i].forEach(function(e){(!e.product_id||e.quantity<0)&&(t=!1)})}),t}},{key:"checkInvalid",value:function(){return this.repasts[this.repastSelected].find(function(e){return!parseFloat(e.quantity)||parseFloat(e.quantity)<0})}},{key:"checkUnitBlend",value:function(e){this.settingService.showGramFeed&&("kg"==e.unit?e.unit="g":"lit"==e.unit&&(e.unit="ml"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(l.up),h.Y36(x.k),h.Y36(R.o),h.Y36(l.Br),h.Y36(f.sK),h.Y36(U.R),h.Y36(He.d),h.Y36(l.IN),h.Y36(se.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-feed-update"]],inputs:{repast:"repast",item:"item"},decls:34,vars:21,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[1,"ion-text-center"],["class","title ion-padding",4,"ngIf"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],["mode","ios","outline","","color","primary",4,"ngIf"],["mode","ios","outline","","color","success",4,"ngIf"],[3,"hidden",4,"ngFor","ngForOf"],["class","ion-text-center",4,"ngIf"],["class","ion-text-center ion-padding",4,"ngIf"],[1,"title","ion-padding"],["scrollable","","layout","icon-bottom",3,"value","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mode","ios","outline","","color","primary"],["name","happy"],["color","primary"],["mode","ios","outline","","color","success"],["name","bulb"],["color","success"],[3,"hidden"],["class","align-items-center",4,"ngFor","ngForOf"],["shape","round","fill","outline","size","small","color","primary",3,"disabled","click"],["name","add","slot","start"],[1,"align-items-center"],["fill","clear","color","medium",3,"disabled","click"],["name","remove-circle-outline","slot","icon-only"],["size","6"],["position","floating"],[3,"disabled","ngModel","value","click","ngModelChange"],["size","4"],["type","tel","inputmode","decimal",3,"ngModel","ngModelChange","ionBlur"],["name","dots"],[1,"ion-text-center","ion-padding"],["name","stopwatch-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"div",5),h.YNc(14,ze,6,5,"div",6),h.TgZ(15,"div",5),h.TgZ(16,"ion-grid"),h.TgZ(17,"ion-row"),h.TgZ(18,"ion-col",7),h.TgZ(19,"ion-button",8),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(20,"ion-icon",9),h.qZA(),h.qZA(),h.TgZ(21,"ion-col",10),h.TgZ(22,"ion-item",5),h.TgZ(23,"ion-datetime",11),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(25,"ion-col",7),h.TgZ(26,"ion-button",8),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(27,"ion-icon",12),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(28,"div",5),h.YNc(29,$e,5,4,"ion-chip",13),h.YNc(30,We,5,4,"ion-chip",14),h.qZA(),h.YNc(31,et,14,12,"div",15),h.YNc(32,tt,2,0,"div",16),h.YNc(33,nt,6,4,"div",17),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,15,"POND_MOD.ADD_FEED")),h.xp6(6),h.Q6J("disabled",t.savingFlag.pending||!t.checkValid()),h.xp6(1),h.hij(" ",h.lcZ(11,17,"POND_MOD.SAVE")," "),h.xp6(4),h.Q6J("ngIf",t.repasts.length>1),h.xp6(5),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(24,19,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("ngIf",t.inforloadExpectedDaily&&t.inforloadExpectedDaily.for_calendar),h.xp6(1),h.Q6J("ngIf",t.inforloadExpectedDaily&&t.inforloadExpectedDaily.for_procedure),h.xp6(1),h.Q6J("ngForOf",t.repasts),h.xp6(1),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(1),h.Q6J("ngIf",t.itemRemind))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,o.O5,l.jY,l.Nd,l.wI,l.Ie,l.QI,l.x4,o.sg,l.cJ,l.GO,l.hM,l.Q$,l.pK,l.j9,a.JJ,a.On,l.PQ],pipes:[f.X$],styles:[""],data:{animation:[(0,je.X$)("showRepast",[(0,je.SB)("true",(0,je.oB)({opacity:1})),(0,je.SB)("false",(0,je.oB)({opacity:1})),(0,je.eR)("false <=> true",(0,je.jt)(500))])]}}),e}();function ot(e,t){1&e&&(h.TgZ(0,"div",5),h._UZ(1,"ion-spinner",18),h.qZA())}function at(e,t){if(1&e&&(h.TgZ(0,"ion-chip",19),h._UZ(1,"ion-icon",20),h.TgZ(2,"ion-label",21),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.AsE("",h.lcZ(4,2,"POND_MOD.EXPECTED")," ",null==n.inforloadExpectedDaily?null:n.inforloadExpectedDaily.for_calendar.value_check,"kg")}}function rt(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-row",22),h.TgZ(1,"ion-col",6),h.TgZ(2,"ion-button",23),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().removeRow(e)}),h._UZ(3,"ion-icon",24),h.qZA(),h.qZA(),h.TgZ(4,"ion-col",25),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label",26),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"ion-input",27),h.NdJ("click",function(){var e=h.CHM(n),t=e.$implicit,i=e.index;return h.oxw().openPicker(t,i)})("ngModelChange",function(e){return t.$implicit.product_name=e}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-col",28),h.TgZ(11,"ion-item"),h.TgZ(12,"ion-label",26),h._uU(13),h.qZA(),h.TgZ(14,"ion-input",29),h.NdJ("ngModelChange",function(e){return t.$implicit.quantity=e})("ionBlur",function(){var e=h.CHM(n).$implicit;return h.oxw().checkInvetory(e)}),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw();h.xp6(7),h.AsE("",i.store_name," | ",h.lcZ(8,7,"POND_MOD.PRODUCT"),""),h.xp6(2),h.Q6J("disabled",o.disabledForm)("ngModel",i.product_name)("value",i.product_name),h.xp6(4),h.Oqu(i.unit),h.xp6(1),h.Q6J("ngModel",i.quantity)}}function st(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",30),h.TgZ(1,"ion-chip",1),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentRemind()}),h._UZ(2,"ion-icon",31),h.TgZ(3,"ion-label"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(4),h.AsE("",h.lcZ(5,2,"POND_MOD.REMIND_USE")," ",i.itemRemind,"")}}var ct=function(){var e=function(){function e(t,n,i,o,a,s,c,l,u){r(this,e),this.modalCtrl=t,this.pondService=n,this.pickerCtrl=i,this.toastService=o,this.alertController=a,this.calendarService=s,this.translate=c,this.settingService=l,this.modalController=u,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.enviro=[],this.dataRaw=[],this.itemRemind="",this.disabledForm=!1}return c(e,[{key:"ngOnInit",value:function(){console.log(this.item),this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.item.date==this.dateRangeSelected&&(this.itemSelected=this.item),this.processData(),this.loadExpectedDaily()}},{key:"loadExpectedDaily",value:function(){var e=this;console.log(m(this.dateRangeSelected).valueOf()/1e3),this.calendarService.getExpectedDaily(this.pondService.pond.current_season,"enviro",m(this.dateRangeSelected).valueOf()/1e3).subscribe(function(t){1==t.status?e.inforloadExpectedDaily=t.data:e.toastService.warning(t.error)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"dismiss",value:function(){this.modalCtrl.dismiss()}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value,console.log(e.detail);var t=m(this.dateRangeSelected);console.log(this.dataRaw.length),this.dataRaw.length>0?(this.itemSelected=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})],console.log(this.itemSelected),this.processData(),(t<m(this.dataRaw[this.dataRaw.length-1].date)||t>m(this.dataRaw[0].date))&&this.getData()):this.getData(),this.loadExpectedDaily()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"checkInvetory",value:function(e){!this.settingService.alertInventory||!e.quantity_current||(console.log(e),+e.quantity_current<+e.quantity&&this.presentAlertInvetory(e))}},{key:"presentAlertInvetory",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.ALERT"),message:this.translate.instant("POND_MOD.PRODUCT")+" <strong>"+e.product_name+"</strong> "+this.translate.instant("POND_MOD.NOT_ENOUGH")+"!",inputs:[{name:"data",type:"checkbox",value:!0,label:this.translate.instant("POND_MOD.DONT_SHOW_NEXT_TIME"),placeholder:this.translate.instant("POND_MOD.DAY_COME")}],buttons:[{text:this.translate.instant("OPTION.CANCEL"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(e){console.log(e),e[0]&&n.settingService.alertInventoryChange(!1)}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"removeRow",value:function(e){if(0==e)return this.enviro[0].quantity=0,!1;this.enviro.splice(e,1)}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0);var t=m(this.dateRangeSelected).format("YYYY-MM-DD");this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},t).subscribe(function(n){n.data?(e.dataRaw=n.data,e.itemSelected=e.dataRaw[e.dataRaw.findIndex(function(e){return e.date==t})],e.processData(),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),e.toastService.warning(t)})}},{key:"processData",value:function(){var e=this;this.enviro=[],this.itemSelected&&this.itemSelected.enviroment&&this.itemSelected.enviroment.forEach(function(t){e.enviro.push(t)})}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0);var t=[];console.log(this.enviro);for(var n=0;n<this.enviro.length;n++)this.enviro[n].quantity=this.enviro[n].quantity.replace(",","."),this.enviro[n].quantity>=0&&t.push({kind:this.enviro[n].product_id,quantity:this.enviro[n].quantity,wcode:this.enviro[n].wcode});var i={date:m(this.dateRangeSelected).format("YYYY-MM-DD"),enviro:t};this.pondService.fullUpdate(i).subscribe(function(t){"success"==t.status?(e.toastService.success(e.translate.instant("POND_MOD.NOTI_UPDATE")),e.savingFlag.setResult(!0),e.dateRangeSelected==e.maxDate.format("YYYY-MM-DD")?e.modalCtrl.dismiss(e.enviro):e.modalCtrl.dismiss()):(e.toastService.warning(t.message),e.savingFlag.setResult(!1))},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"openPicker",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:Ge.z,componentProps:{groupId:3,item:e}});case 2:return(i=n.sent).onDidDismiss().then(function(e){if(e.data){var n={product_name:e.data.product_name,product_id:e.data.product_id,unit:e.data.unit,quantity_current:e.data.quantity_current,wcode:e.data.wcode,store_name:e.data.store_name,quantity:e.data.quantity};console.log(n),o.enviro[t]=n,o.itemRemind=n.product_name}}),n.next=6,i.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"presentRemind",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("POND_MOD.REMIND"),message:this.translate.instant("POND_MOD.DAY_PROCESS")+" <strong>"+this.itemRemind+"</strong> "+this.translate.instant("POND_MOD.REPEAT")+"?",inputs:[{name:"date",type:"number",min:1,max:60,placeholder:this.translate.instant("POND_MOD.DAY_COME")}],buttons:[{text:this.translate.instant("OPTION.CANCEL"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(e){t.saveRemind(e.date)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"saveRemind",value:function(e){var t=this,n=m().add(e,"days"),i={content:this.translate.instant("POND_MOD.PROCESS")+" "+this.itemRemind+" "+this.translate.instant("POND_MOD.REPEAT"),date:n.format("YYYY-MM-DD"),time:n.format("HH:mm"),pond_id:this.pondService.pcode,done:!1};this.calendarService.insertCalendar(i).subscribe(function(e){e.error||1!=e.status?t.toastService.warning(e.error):(t.toastService.success(t.translate.instant("POND_MOD.NOTI_ADD_REMIND")),t.itemRemind=null)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"presentOptionProduct",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ge.z,componentProps:{groupId:3}});case 2:return(t=e.sent).onDidDismiss().then(function(e){if(e.data){var t={product_name:e.data.product_name,product_id:e.data.product_id,unit:e.data.unit,quantity_current:e.data.quantity_current,wcode:e.data.wcode,store_name:e.data.store_name,quantity:""};n.enviro.push(t),n.itemRemind=t.product_name}}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"checkInvalid",value:function(){return this.enviro.find(function(e){return""===e.quantity||parseFloat(e.quantity)<0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(l.up),h.Y36(x.k),h.Y36(l.Br),h.Y36(R.o),h.Y36(f.sK),h.Y36(U.R),h.Y36(l.IN))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-enviroment-update"]],inputs:{item:"item"},decls:38,vars:23,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],["class","ion-text-center",4,"ngIf"],["mode","ios","outline","","color","primary",4,"ngIf"],["class","align-items-center",4,"ngFor","ngForOf"],["shape","round","fill","outline","size","small","color","primary",3,"disabled","click"],["name","add","slot","start"],["class","ion-text-center ion-padding",4,"ngIf"],["name","dots"],["mode","ios","outline","","color","primary"],["name","happy"],["color","primary"],[1,"align-items-center"],["fill","clear","color","medium",3,"click"],["name","remove-circle-outline","slot","icon-only"],["size","6"],["position","floating"],[3,"disabled","ngModel","value","click","ngModelChange"],["size","4"],["type","tel","inputmode","decimal",3,"ngModel","ngModelChange","ionBlur"],[1,"ion-text-center","ion-padding"],["name","stopwatch-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"div",5),h.TgZ(14,"ion-grid"),h.TgZ(15,"ion-row"),h.TgZ(16,"ion-col",6),h.TgZ(17,"ion-button",7),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(18,"ion-icon",8),h.qZA(),h.qZA(),h.TgZ(19,"ion-col",9),h.TgZ(20,"ion-item",5),h.TgZ(21,"ion-datetime",10),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(23,"ion-col",6),h.TgZ(24,"ion-button",7),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(25,"ion-icon",11),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(26,ot,2,0,"div",12),h.TgZ(27,"div",5),h.YNc(28,at,5,4,"ion-chip",13),h.qZA(),h.TgZ(29,"ion-grid"),h.YNc(30,rt,15,9,"ion-row",14),h.TgZ(31,"ion-row"),h.TgZ(32,"ion-col",5),h.TgZ(33,"ion-button",15),h.NdJ("click",function(){return t.presentOptionProduct()}),h._UZ(34,"ion-icon",16),h._uU(35),h.ALo(36,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(37,st,6,4,"div",17),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,15,"POND_MOD.CHEMICAL_TREATMENT")),h.xp6(6),h.Q6J("disabled",t.savingFlag.pending||t.checkInvalid()),h.xp6(1),h.hij(" ",h.lcZ(11,17,"POND_MOD.SAVE")," "),h.xp6(7),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(22,19,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(2),h.Q6J("ngIf",t.inforloadExpectedDaily&&t.inforloadExpectedDaily.for_calendar),h.xp6(2),h.Q6J("ngForOf",t.enviro),h.xp6(3),h.Q6J("disabled",t.enviro.length>=7),h.xp6(2),h.hij(" ",h.lcZ(36,21,"ADD")," "),h.xp6(2),h.Q6J("ngIf",t.itemRemind))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,o.O5,o.sg,l.PQ,l.hM,l.Q$,l.pK,l.j9,a.JJ,a.On],pipes:[f.X$],styles:[""]}),e}();i(35386);var lt=i(82482),ut=["inputDisease"];function dt(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",27),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw(2).removeDisease(e)}),h._uU(1),h._UZ(2,"ion-icon",28),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(1),h.hij(" ",i.name," ")}}function gt(e,t){if(1&e&&(h.TgZ(0,"ion-col",13),h.TgZ(1,"ion-item"),h.YNc(2,dt,3,1,"ion-button",26),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Q6J("ngForOf",n.diseaseSelected)}}var pt=function(){var e=function(){function e(t,n,i,o,s,c,l,u){r(this,e),this.toastService=t,this.modalCtrl=n,this.pondService=i,this._fb=o,this.translate=s,this.cd=c,this.alertController=l,this.el=u,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.dataRaw=[],this.invalid=!0,this.form=this._fb.group({weight:new a.NI("",[a.kI.required,a.kI.min(0)]),loss:new a.NI("",[a.kI.min(0)]),lossKg:new a.NI("",[a.kI.min(0)]),note:new a.NI(""),unit:new a.NI("kg"),textSearch:new a.NI("")}),this.configMention={dropUp:!0,labelKey:"name"},this.listDisease=[],this.diseaseSelected=[]}return c(e,[{key:"ngOnInit",value:function(){this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.item.date==this.dateRangeSelected&&(this.itemSelected=this.item,this.itemSelected.disease=this.disease),this.processData(),this.getListDisease()}},{key:"getListDisease",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.getListDisease().subscribe(function(t){1==+t.status?e.listDisease=t.data:e.toastService.warning(t.error)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"chooseDisease",value:function(e){console.log(e),this.diseaseSelected.find(function(t){return t.id===e.id})||this.diseaseSelected.push(e)}},{key:"checkRemoveDisease",value:function(e){var t=this;if(8===e.keyCode){var n=this.form.value.note,i=-1!==n.lastIndexOf("@")?n.substring(n.lastIndexOf("@"),n.length):"";console.log(i),this.diseaseSelected.forEach(function(e,o){i==="@"+e.name&&""!==i&&(n=(n=n.replace(new RegExp("@"+e.name,"g"),"")).replace(new RegExp("@"+e.name.slice(0,-1),"g"),""),t.diseaseSelected.splice(o,1))}),this.form.patchValue({note:n})}}},{key:"removeDisease",value:function(e){var t=this.form.value.note;t=t.replace(new RegExp("@"+this.diseaseSelected[e].name,"g"),this.diseaseSelected[e].name),this.form.patchValue({note:t}),this.diseaseSelected.splice(e,1)}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=m(this.dateRangeSelected);if(this.dataRaw.length>0){var n=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})];void 0!==n&&(this.itemSelected=n,this.processData()),(t<m(this.dataRaw[this.dataRaw.length-1].date)||t>m(this.dataRaw[0].date))&&this.getData()}else this.getData()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0);var t=m(this.dateRangeSelected).format("YYYY-MM-DD");this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},t).subscribe(function(n){if(n.data){e.dataRaw=n.data;var i=e.dataRaw[e.dataRaw.findIndex(function(e){return e.date==t})];void 0!==i&&(e.itemSelected=i,e.processData()),e.loadingFlag.setResult(!0)}else e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(t)})}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0);var t=m(this.dateRangeSelected).format("YYYY-MM-DD"),n=this.form.value;this.pondService.updateHealth({date:t,health:n,disease:this.diseaseSelected}).subscribe(function(t){"success"==t.status?(e.toastService.success(e.translate.instant("POND_MOD.NOTI_UPDATE")),e.savingFlag.setResult(!0),n.date=m(e.dateRangeSelected).format("YYYY-MM-DD"),n.disease=e.diseaseSelected,e.modalCtrl.dismiss(n)):(e.toastService.warning(t.message),e.savingFlag.setResult(!1))},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"processData",value:function(){if(void 0!==this.itemSelected&&this.itemSelected){var e=this.itemSelected.weight>0?this.itemSelected.weight:"",t=e*this.itemSelected.loss/1e3;this.diseaseSelected=this.itemSelected.disease?this.itemSelected.disease:[],console.log(this.diseaseSelected),this.form.patchValue({weight:e,loss:this.itemSelected.loss,lossKg:t,note:this.itemSelected.note_health})}}},{key:"convertLoss",value:function(){if(this.form.value.weight>0){if("kg"==this.form.value.unit){var e=Math.ceil(this.form.value.lossKg/(this.form.value.weight/1e3));this.form.patchValue({loss:e})}else{var t=Math.ceil(this.form.value.loss*this.form.value.weight/1e3);this.form.patchValue({lossKg:t})}this.form.get("weight").clearValidators()}else 0!=this.form.value.loss||0!=this.form.value.lossKg?(this.form.get("weight").setValidators([a.kI.required,a.kI.min(.01)]),this.form.get("weight").updateValueAndValidity()):this.form.get("weight").clearValidators();this.invalid=this.form.invalid}},{key:"presentAlertRemoveDisease",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Option",inputs:[{name:"radio1",type:"radio",label:this.translate.instant("DISEASE.DELETE_ALL"),value:"all",checked:!0},{name:"radio2",type:"radio",label:this.translate.instant("DISEASE.DELETE_LAST"),value:"one"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(t){n.pondService.saveProcessDisease({type_action:0,action_del:t,disease_id:e.id}).subscribe(function(e){1==e.status?n.toastService.success(n.translate.instant("DISEASE.REMOVE_SUCCESS")):n.toastService.warning(e.error)})}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"checkFocus",value:function(){var e=this.el.nativeElement.querySelector("textarea");if(e){if(e.setSelectionRange)return e.setSelectionRange(e.value.length,e.value.length);e.select()}}},{key:"closeModal",value:function(){this.modalCtrl.dismiss()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(x.k),h.Y36(l.IN),h.Y36(g.p),h.Y36(a.qu),h.Y36(f.sK),h.Y36(h.sBO),h.Y36(l.Br),h.Y36(h.SBq))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-health-update"]],viewQuery:function(e,t){var n;(1&e&&h.Gf(ut,5),2&e)&&(h.iGM(n=h.CRH())&&(t.inputElement=n.first))},hostBindings:function(e,t){1&e&&h.NdJ("click",function(){return t.checkFocus()})},inputs:{item:"item",disease:"disease"},decls:63,vars:39,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],[3,"formGroup"],["size","12"],["position","floating"],["autofocus","","formControlName","weight","type","tel","inputmode","decimal",3,"ionChange"],["size","6"],[3,"hidden"],["formControlName","loss","type","tel","inputmode","decimal",3,"ionChange"],["formControlName","lossKg","type","tel","inputmode","decimal",3,"ionChange"],["formControlName","unit"],["value","con"],["value","kg"],["size","12",4,"ngIf"],[1,"healstatusBox"],["move-end","","formControlName","note","type","text",1,"tagsInput",3,"mentionConfig","mention","itemSelected","keydown.ArrowLeft","keydown.ArrowRight","keydown.ArrowUp","keydown.ArrowDown","keydown"],["color","danger","size","small",3,"click",4,"ngFor","ngForOf"],["color","danger","size","small",3,"click"],["name","remove-circle-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.closeModal()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"div",5),h.TgZ(14,"ion-grid"),h.TgZ(15,"ion-row"),h.TgZ(16,"ion-col",6),h.TgZ(17,"ion-button",7),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(18,"ion-icon",8),h.qZA(),h.qZA(),h.TgZ(19,"ion-col",9),h.TgZ(20,"ion-item",5),h.TgZ(21,"ion-datetime",10),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(23,"ion-col",6),h.TgZ(24,"ion-button",7),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(25,"ion-icon",11),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(26,"div"),h.TgZ(27,"ion-grid",12),h.TgZ(28,"ion-row"),h.TgZ(29,"ion-col",13),h.TgZ(30,"ion-item"),h.TgZ(31,"ion-label",14),h._uU(32),h.ALo(33,"translate"),h.qZA(),h.TgZ(34,"ion-input",15),h.NdJ("ionChange",function(){return t.convertLoss()}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(35,"ion-col",16),h.TgZ(36,"ion-item",17),h.TgZ(37,"ion-label",14),h._uU(38),h.ALo(39,"translate"),h.qZA(),h.TgZ(40,"ion-input",18),h.NdJ("ionChange",function(){return t.convertLoss()}),h.qZA(),h.qZA(),h.TgZ(41,"ion-item",17),h.TgZ(42,"ion-label",14),h._uU(43),h.ALo(44,"translate"),h.qZA(),h.TgZ(45,"ion-input",19),h.NdJ("ionChange",function(){return t.convertLoss()}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(46,"ion-col",16),h.TgZ(47,"ion-item"),h.TgZ(48,"ion-label",14),h._uU(49),h.ALo(50,"translate"),h.qZA(),h.TgZ(51,"ion-select",20),h.TgZ(52,"ion-select-option",21),h._uU(53),h.ALo(54,"translate"),h.qZA(),h.TgZ(55,"ion-select-option",22),h._uU(56,"Kg"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(57,gt,3,1,"ion-col",23),h.qZA(),h.TgZ(58,"div",24),h.TgZ(59,"ion-label"),h._uU(60),h.ALo(61,"translate"),h.qZA(),h.TgZ(62,"textarea",25),h.NdJ("itemSelected",function(e){return t.chooseDisease(e)})("keydown.ArrowLeft",function(e){return e.preventDefault()})("keydown.ArrowRight",function(e){return e.preventDefault()})("keydown.ArrowUp",function(e){return e.preventDefault()})("keydown.ArrowDown",function(e){return e.preventDefault()})("keydown",function(e){return t.checkRemoveDisease(e)}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.hij(" ",h.lcZ(7,21,"POND_MOD.HEALTH"),""),h.xp6(3),h.Q6J("disabled",t.form.invalid),h.xp6(1),h.hij(" ",h.lcZ(11,23,"SAVE")," "),h.xp6(7),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(22,25,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("formGroup",t.form),h.xp6(5),h.hij(" ",h.lcZ(33,27,"WEIGHT")," (g)"),h.xp6(4),h.Q6J("hidden","kg"==t.form.value.unit),h.xp6(2),h.Oqu(h.lcZ(39,29,"POND_MOD.LOSS")),h.xp6(3),h.Q6J("hidden","con"==t.form.value.unit),h.xp6(2),h.Oqu(h.lcZ(44,31,"POND_MOD.LOSS")),h.xp6(6),h.Oqu(h.lcZ(50,33,"POND_MOD.UNIT")),h.xp6(4),h.Oqu(h.lcZ(54,35,"POND_MOD.ANIMAL")),h.xp6(4),h.Q6J("ngIf",t.diseaseSelected.length>0),h.xp6(3),h.Oqu(h.lcZ(61,37,"POND_MOD.HEALTH_STATUS")),h.xp6(2),h.Q6J("mentionConfig",t.configMention)("mention",t.listDisease))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,a.JL,a.sg,l.Q$,l.pK,l.j9,a.JJ,a.u,l.t9,l.n0,o.O5,a.Fj,lt.Db,o.sg],pipes:[f.X$],styles:[".input_opacy{background:transparent;color:#000;-webkit-text-fill-color:transparent;z-index:100}.text{position:absolute;top:0;left:0;width:100%;height:100%;padding-top:10px;padding-bottom:10px}.red{color:red}.suggest-box{position:absolute;bottom:0;width:100%}.suggest-box .disease-suggest{z-index:100;background-color:#fff;padding:15px 10px 10px;border-top-left-radius:10px;border-top-right-radius:10px;box-shadow:#c7c6c6 0 1px 10px}.suggest-box .disease-suggest .disease-suggest-item{text-align:center;padding:10px;margin:3px auto;border-radius:20px;border:1px solid silver}.healstatusBox{padding:26px;border-bottom-style:solid;border-bottom-color:#f5f5f5}.healstatusBox:focus{border-bottom-style:solid;border-bottom-color:#2dd36f}.tagsInput{border:none;background-color:transparent;resize:none;outline:none;width:100%}mentions-list{top:0px}.scrollable-menu{max-height:100px}\n"],encapsulation:2}),e}(),mt=function(){var e=function(){function e(t,n,i,o){r(this,e),this.toastService=t,this.modalCtrl=n,this.pondService=i,this.translate=o,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.dateRangeSelected=m().format("YYYY-MM-DD"),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.dataRaw=[],this.form=new a.cw({cost:new a.NI("",[a.kI.min(0)]),income:new a.NI("",[a.kI.min(0)]),note:new a.NI("")})}return c(e,[{key:"ngOnInit",value:function(){this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.item.date==this.dateRangeSelected&&(this.itemSelected=this.item),this.processData()}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=m(this.dateRangeSelected);this.dataRaw.length>0?(this.itemSelected=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})],this.processData(),(t<m(this.dataRaw[this.dataRaw.length-1].date)||t>m(this.dataRaw[0].date))&&this.getData()):this.getData()}},{key:"changeDate",value:function(e){var t=m(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0);var t=m(this.dateRangeSelected).format("YYYY-MM-DD");this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},t).subscribe(function(n){n.data?(e.dataRaw=n.data,e.itemSelected=e.dataRaw[e.dataRaw.findIndex(function(e){return e.date==t})],e.processData(),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),e.toastService.warning(t)})}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0);var t=m(this.dateRangeSelected).format("YYYY-MM-DD");this.pondService.fullUpdate({date:t,cost_other:this.form.value.cost,income:this.form.value.income,note_general:this.form.value.note}).subscribe(function(n){"success"==n.status?(e.toastService.success(e.translate.instant("POND_MOD.NOTI_UPDATE")),e.savingFlag.setResult(!0),t==e.maxDate.format("YYYY-MM-DD")?e.modalCtrl.dismiss(e.form.value):e.modalCtrl.dismiss()):(e.toastService.warning(n.message),e.savingFlag.setResult(!1))},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"processData",value:function(){void 0!==this.itemSelected&&this.itemSelected&&(console.log(this.itemSelected),this.form.setValue({cost:this.itemSelected.cost_other,income:this.itemSelected.income,note:this.itemSelected.note_general}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(x.k),h.Y36(l.IN),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-note-update"]],inputs:{item:"item"},decls:44,vars:31,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],[3,"formGroup"],["lines","inset"],["position","floating"],["autofocus","","formControlName","cost","type","tel","inputmode","decimal"],["formControlName","income","type","tel","inputmode","decimal"],["type","type","formControlName","note"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"div",5),h.TgZ(14,"ion-grid"),h.TgZ(15,"ion-row"),h.TgZ(16,"ion-col",6),h.TgZ(17,"ion-button",7),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(18,"ion-icon",8),h.qZA(),h.qZA(),h.TgZ(19,"ion-col",9),h.TgZ(20,"ion-item",5),h.TgZ(21,"ion-datetime",10),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(23,"ion-col",6),h.TgZ(24,"ion-button",7),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(25,"ion-icon",11),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(26,"div",12),h.TgZ(27,"ion-item",13),h.TgZ(28,"ion-label",14),h._uU(29),h.ALo(30,"translate"),h.ALo(31,"translate"),h.qZA(),h._UZ(32,"ion-input",15),h.qZA(),h.TgZ(33,"ion-item",13),h.TgZ(34,"ion-label",14),h._uU(35),h.ALo(36,"translate"),h.ALo(37,"translate"),h.qZA(),h._UZ(38,"ion-input",16),h.qZA(),h.TgZ(39,"ion-item",13),h.TgZ(40,"ion-label",14),h._uU(41),h.ALo(42,"translate"),h.qZA(),h._UZ(43,"ion-input",17),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,15,"POND_MOD.NOTE")),h.xp6(3),h.Q6J("disabled",t.savingFlag.pending),h.xp6(1),h.hij(" ",h.lcZ(11,17,"SAVE")," "),h.xp6(7),h.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(22,19,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(3),h.AsE("",h.lcZ(30,21,"POND_MOD.EXPENSE_OTHER")," (",h.lcZ(31,23,"CURRENCY_S"),")"),h.xp6(6),h.AsE("",h.lcZ(36,25,"POND_MOD.INCOME_OTHER")," (",h.lcZ(37,27,"CURRENCY_S"),")"),h.xp6(6),h.Oqu(h.lcZ(42,29,"POND_MOD.NOTE")))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,a.JL,a.sg,l.Q$,l.pK,l.j9,a.JJ,a.u],pipes:[f.X$],styles:[""]}),e}(),ht=i(26262);function ft(e,t){1&e&&(h.TgZ(0,"div",9),h._UZ(1,"ion-spinner",10),h.qZA())}var Zt=function(){var e=function(){function e(t,n,i,o){r(this,e),this.modalController=t,this.toastService=n,this.expertService=i,this.pondService=o,this.saveLoadingFlag=new p.E,this.content=new a.NI("",a.kI.required)}return c(e,[{key:"ngOnInit",value:function(){}},{key:"send",value:function(){var e=this;this.saveLoadingFlag.setPending(!0),this.expertService.addSuggest({content:this.content.value,pond:this.pondService.pond.code}).pipe().subscribe(function(t){1==t.status?(e.toastService.success(t.message),e.saveLoadingFlag.setResult(!0),e.modalController.dismiss()):(e.toastService.warning(t.error),e.saveLoadingFlag.setResult(!1))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(x.k),h.Y36(ht.$),h.Y36(g.p))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-suggest-add"]],decls:21,vars:13,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding","ion-text-center"],[1,"ion-padding"],["line","inset"],[3,"formControl","placeholder"],["class","spiner-loading",4,"ngIf"],["shape","round",3,"disabled","click"],[1,"spiner-loading"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.TgZ(10,"h1"),h._uU(11),h.qZA(),h.qZA(),h.TgZ(12,"ion-list",4),h.TgZ(13,"ion-item",5),h._UZ(14,"ion-textarea",6),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.YNc(16,ft,2,0,"div",7),h.TgZ(17,"div",3),h.TgZ(18,"ion-button",8),h.NdJ("click",function(){return t.send()}),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,7,"FARM_MOD.ADVISORY")),h.xp6(5),h.Oqu(t.pondService.pond.name),h.xp6(3),h.Q6J("formControl",t.content)("placeholder",h.lcZ(15,9,"POND_MOD.CONTENT")),h.xp6(2),h.Q6J("ngIf",t.saveLoadingFlag.pending),h.xp6(2),h.Q6J("disabled",t.content.invalid||t.saveLoadingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(20,11,"POND_MOD.SEND")))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.q_,l.Ie,l.g2,l.j9,a.JJ,a.oH,o.O5,l.PQ],pipes:[f.X$],styles:[""]}),e}();function vt(e,t){1&e&&(h.TgZ(0,"div",8),h._UZ(1,"ion-spinner",9),h.qZA())}function At(e,t){if(1&e&&(h.TgZ(0,"ion-text",13),h.TgZ(1,"p"),h._uU(2),h.ALo(3,"translate"),h.ALo(4,"number"),h.ALo(5,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(2),h.lnq("",h.lcZ(3,3,"POND_MOD.INCOME_OTHER"),": ",h.lcZ(4,5,n.income)," ",h.lcZ(5,7,"CURRENCY_S"),"")}}function _t(e,t){if(1&e&&(h.TgZ(0,"ion-text",13),h.TgZ(1,"p"),h._uU(2),h.ALo(3,"translate"),h.ALo(4,"number"),h.ALo(5,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(2),h.lnq("",h.lcZ(3,3,"POND_MOD.EXPENSE_OTHER"),": ",h.lcZ(4,5,n.cost_other)," ",h.lcZ(5,7,"CURRENCY_S"),"")}}function Tt(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",10),h.TgZ(2,"p"),h._uU(3),h.ALo(4,"date"),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"ion-text",11),h.TgZ(7,"h3"),h._uU(8),h.qZA(),h.qZA(),h.YNc(9,At,6,9,"ion-text",12),h.YNc(10,_t,6,9,"ion-text",12),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(3),h.Oqu(h.xi3(4,4,n.date,h.lcZ(5,7,"FORMAT_DATE"))),h.xp6(5),h.hij(" ",n.note_general,""),h.xp6(1),h.Q6J("ngIf",n.income>0),h.xp6(1),h.Q6J("ngIf",n.cost_other>0)}}function xt(e,t){1&e&&(h.TgZ(0,"ion-card"),h.TgZ(1,"ion-card-content"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.qZA()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"POND_MOD.NO_NOTES")," "))}var qt=function(){var e=function(){function e(t,n,i){r(this,e),this.toastController=t,this.modalCtrl=n,this.pondService=i,this.items=[],this.loadingFlag=new p.E,this.pageLoaded=0}return c(e,[{key:"ngOnInit",value:function(){this.getData(0)}},{key:"getData",value:function(e){var t=this;console.log("h"),this.loadingFlag.setStart(!0),this.pondService.loadDailyPaging({pageIndex:e,pageSize:20},m().format("YYYY-MM-DD")).subscribe(function(e){e.data?(t.items=t.items.concat(t.filter(e.data)),t.loadingFlag.setResult(!0),t.pageLoaded++):t.loadingFlag.setResult(!1),t.infiniteScroll.complete(),(t.pageLoaded>=10||e.data.length<3)&&(t.infiniteScroll.disabled=!0),console.log(t.infiniteScroll)},function(e){t.loadingFlag.setResult(!1),console.log(e)})}},{key:"filter",value:function(e){return e.filter(function(e){return e.cost_other>0||e.income>0||""!=e.note_general})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.yF),h.Y36(l.IN),h.Y36(g.p))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-note"]],viewQuery:function(e,t){var n;(1&e&&h.Gf(l.ju,5),2&e)&&(h.iGM(n=h.CRH())&&(t.infiniteScroll=n.first))},decls:15,vars:6,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["class","spiner-loading",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","dots"],[1,"spiner-loading"],["name","dots"],[1,"ion-text-wrap"],["color","primary"],["color","secondary",4,"ngIf"],["color","secondary"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.YNc(9,vt,2,0,"div",3),h.TgZ(10,"ion-list"),h.YNc(11,Tt,11,9,"ion-item",4),h.qZA(),h.YNc(12,xt,4,3,"ion-card",5),h.TgZ(13,"ion-infinite-scroll",6),h.NdJ("ionInfinite",function(){return t.getData(t.pageLoaded)}),h._UZ(14,"ion-infinite-scroll-content",7),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"POND_MOD.NOTE")),h.xp6(3),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(2),h.Q6J("ngForOf",t.items),h.xp6(1),h.Q6J("ngIf",0==t.items.length&&t.loadingFlag.result))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o.O5,l.q_,o.sg,l.ju,l.MB,l.PQ,l.Ie,l.Q$,l.yW,l.PM,l.FN],pipes:[f.X$,o.uU,o.JJ],styles:[""]}),e}(),Ot=i(73473);function bt(e,t){if(1&e&&(h.TgZ(0,"small"),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.hij("\xb1",h.xi3(2,1,(null==n.todayData?null:n.todayData.quantityPCSDelta)/1e3,"1.0-1"),"")}}function Dt(e,t){if(1&e&&(h.TgZ(0,"small"),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.hij("\xb1",h.xi3(2,1,(null==n.todayData?null:n.todayData.quantityDelta)/1e3,"1.0-1"),"")}}function yt(e,t){if(1&e&&(h.TgZ(0,"small"),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.hij("\xb1",h.xi3(2,1,(null==n.todayData?null:n.todayData.quantityDelta)/1e3,"1.0-1"),"")}}var St=function(){return["company_manager"]},Ct=function(){var e=function(){function e(t,n,i){r(this,e),this.modalCtrl=t,this.toastService=n,this.pondService=i,this.costLoadingFlag=new p.E,this.priceLoadingFlag=new p.E,this.showDelta=!1,this.todayData={},this.next7Data={},this.priceList=[],this.price=0,this.price7day=0,this.day=7}return c(e,[{key:"ngOnInit",value:function(){this.procesEstimate(),"company_manager"==this.pondService.permission&&this.loadCost()}},{key:"procesEstimate",value:function(){this.procedure&&this.procedure.culture_day>0&&this.procedure.FCR>0&&this.procedure.survival_ratio>0?(this.todayData.quantityPCSTheory=this.data.old<this.procedure.culture_day?this.data.old*this.pondService.seasonInfo.seedQuantity*this.procedure.survival_ratio/this.procedure.culture_day:this.pondService.seasonInfo.seedQuantity*this.procedure.survival_ratio,this.todayData.quantityPCSDelta=Math.abs(this.todayData.quantityPCSTheory-this.data.quantity_pcs)/2,this.todayData.quantityFCR=this.data.feed/parseFloat(this.procedure.FCR),this.next7Data.quantityPCSTheory=(this.data.old+this.day)*this.pondService.seasonInfo.seedQuantity*this.procedure.survival_ratio/this.procedure.culture_day,this.next7Data.quantityPCSDelta=Math.abs(this.next7Data.quantityPCSTheory-this.data.quantity_pcs)/2):(this.todayData.quantityPCSDelta=0,this.todayData.quantityPCSTheory=this.data.quantity_pcs,this.todayData.quantityFCR=this.data.quantity_pcs*this.data.weight/1e3,this.next7Data.quantityPCSDelta=0,this.next7Data.quantityPCSTheory=this.data.quantity_pcs),this.todayData.quantity=Math.min(this.todayData.quantityPCSTheory*this.data.weight/1e3,this.data.quantity,this.todayData.quantityFCR),this.todayData.quantityDelta=Math.abs(this.todayData.quantity-Math.max(this.todayData.quantityPCSTheory*this.data.weight/1e3,this.data.quantity,this.todayData.quantityFCR))/2,this.todayData.quantityPCS=1e3*this.todayData.quantity/this.data.weight,this.next7Data.weight=this.data.grow_speed*this.day+this.data.weight,this.next7Data.quantity=this.todayData.quantityPCS*this.next7Data.weight/1e3,this.getCurrentPrice()}},{key:"loadCost",value:function(){var e=this;this.costLoadingFlag.setStart(!0),this.pondService.getTotalCost().subscribe(function(t){if(1==t.status){e.todayData.cost=t.data.cost.feed+t.data.cost.blend+t.data.cost.enviroment+t.data.cost.seed+t.data.cost.other+parseInt(t.data.cost.record.amounts);var n=e.data.FCR*e.next7Data.quantity*(t.data.cost.feed/e.data.feed)-t.data.cost.feed;n<0&&(n=t.data.cost.feed/e.data.old*e.day),e.next7Data.deltaCost=n+t.data.cost.enviroment/e.data.old*e.day,e.next7Data.cost=t.data.cost.feed+e.next7Data.deltaCost}else e.toastService.warning(t.error);e.costLoadingFlag.setResult(!0)},function(){e.costLoadingFlag.setResult(!1)})}},{key:"getCurrentPrice",value:function(){var e=this;this.priceLoadingFlag.setStart(!0),this.pondService.getCurrentPrice(this.season.species_id,0).subscribe(function(t){"success"==t.status?(1==t.data.length?(e.price=t.data[0].price,e.price7day=t.data[0].price):(e.priceList=t.data,e.priceList.push({price:0,time:0,diff:"",size:parseFloat(e.data.weight)}),e.price=e.matchPrice(e.priceList,e.data.weight),e.priceList.push({price:0,time:0,diff:"",size:parseFloat(e.next7Data.weight)}),e.price7day=e.matchPrice(e.priceList,e.next7Data.weight)),console.log(e.price)):e.toastService.warning(t.error.message),e.priceLoadingFlag.setResult(!0)},function(){e.priceLoadingFlag.setResult(!1)})}},{key:"matchPrice",value:function(e,t){var n=0;e.map(function(e){return parseFloat(e.size),e}),console.log("runing"),e.sort(function(e,t){return e.size>t.size?1:e.size<t.size?-1:0}),console.log(t);var i=e.findIndex(function(e){return e.size==t&&0==e.time});return console.log(i),console.log(e),0==i?(n=e.length>1?e[1].price*t/e[1].size:0,console.log(n)):i+1==e.length?(n=e[i-1].price,console.log(i)):n=(e[i+1].price-e[i-1].price)/(e[i+1].size-e[i-1].size)*(t-e[i-1].size)+parseInt(e[i-1].price),e.splice(i,1),n>1e4&&(n=100*Math.round(n/100)),n}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(x.k),h.Y36(g.p))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-estimate"]],inputs:{data:"data",procedure:"procedure",season:"season"},decls:185,vars:164,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["mode","ios","color","medium"],["name","medical-outline"],["lines","full"],["slot","end",1,"ion-margin"],[4,"ngIf"],["lines","none",3,"appPermission","currentPermission"],["mode","ios","color","tertiary"],[3,"appPermission","currentPermission"],[3,"ngModel","ngModelChange"],["lines","inset"],["position","fixed"],[1,"ion-padding"],[1,"sm-text","ion-text-center"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-card",3),h.TgZ(10,"ion-card-header"),h.TgZ(11,"ion-card-subtitle"),h._UZ(12,"ion-icon",4),h._uU(13),h.ALo(14,"translate"),h.qZA(),h.qZA(),h.TgZ(15,"ion-list",5),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.TgZ(21,"small"),h._uU(22),h.ALo(23,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(24,"span",6),h._uU(25),h.ALo(26,"number"),h.qZA(),h.qZA(),h.TgZ(27,"ion-item"),h.TgZ(28,"ion-label"),h.TgZ(29,"h3"),h._uU(30),h.ALo(31,"translate"),h.TgZ(32,"small"),h._uU(33),h.ALo(34,"number"),h.ALo(35,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(36,"span",6),h._uU(37),h.ALo(38,"number"),h.TgZ(39,"small"),h._uU(40,"g"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(41,"ion-item"),h.TgZ(42,"ion-label"),h.TgZ(43,"h3"),h._uU(44),h.ALo(45,"translate"),h.TgZ(46,"small"),h._uU(47),h.ALo(48,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(49,"span",6),h._uU(50),h.ALo(51,"number"),h.YNc(52,bt,3,4,"small",7),h.qZA(),h.qZA(),h.TgZ(53,"ion-item"),h.TgZ(54,"ion-label"),h.TgZ(55,"h3"),h._uU(56),h.ALo(57,"translate"),h.TgZ(58,"small"),h._uU(59),h.ALo(60,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(61,"span",6),h._uU(62),h.ALo(63,"number"),h.YNc(64,Dt,3,4,"small",7),h.qZA(),h.qZA(),h.TgZ(65,"ion-item"),h.TgZ(66,"ion-label"),h.TgZ(67,"h3"),h._uU(68),h.ALo(69,"translate"),h.TgZ(70,"small"),h._uU(71),h.ALo(72,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(73,"span",6),h._uU(74),h.ALo(75,"number"),h.qZA(),h.qZA(),h.TgZ(76,"ion-item",8),h.TgZ(77,"ion-label"),h.TgZ(78,"h3"),h._uU(79),h.ALo(80,"translate"),h.TgZ(81,"small"),h._uU(82),h.ALo(83,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(84,"span",6),h.TgZ(85,"b"),h._uU(86),h.ALo(87,"number"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(88,"ion-card",9),h.TgZ(89,"ion-card-header"),h.TgZ(90,"ion-card-subtitle"),h._UZ(91,"ion-icon",4),h._uU(92),h.ALo(93,"translate"),h.qZA(),h.qZA(),h.TgZ(94,"ion-list",5),h.TgZ(95,"ion-item"),h.TgZ(96,"ion-label"),h.TgZ(97,"h3"),h._uU(98),h.ALo(99,"translate"),h.TgZ(100,"small"),h._uU(101),h.ALo(102,"number"),h.ALo(103,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(104,"span",6),h._uU(105),h.ALo(106,"number"),h.TgZ(107,"small"),h._uU(108,"g"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(109,"ion-item"),h.TgZ(110,"ion-label"),h.TgZ(111,"h3"),h._uU(112),h.ALo(113,"translate"),h.TgZ(114,"small"),h._uU(115),h.ALo(116,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(117,"span",6),h._uU(118),h.ALo(119,"number"),h.YNc(120,yt,3,4,"small",7),h.qZA(),h.qZA(),h.TgZ(121,"ion-item"),h.TgZ(122,"ion-label"),h.TgZ(123,"h3"),h._uU(124),h.ALo(125,"translate"),h.TgZ(126,"small"),h._uU(127),h.ALo(128,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(129,"span",6),h._uU(130),h.ALo(131,"number"),h.qZA(),h.qZA(),h.TgZ(132,"ion-item",10),h.TgZ(133,"ion-label"),h.TgZ(134,"h3"),h._uU(135),h.ALo(136,"translate"),h.TgZ(137,"small"),h._uU(138),h.ALo(139,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(140,"span",6),h._uU(141),h.ALo(142,"number"),h.qZA(),h.qZA(),h.TgZ(143,"ion-item"),h.TgZ(144,"ion-label"),h.TgZ(145,"h3"),h._uU(146),h.ALo(147,"translate"),h.TgZ(148,"small"),h._uU(149),h.ALo(150,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(151,"span",6),h._uU(152),h.ALo(153,"number"),h.qZA(),h.qZA(),h.TgZ(154,"ion-item",8),h.TgZ(155,"ion-label"),h.TgZ(156,"h3"),h._uU(157),h.ALo(158,"translate"),h.TgZ(159,"small"),h._uU(160),h.ALo(161,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(162,"span",6),h.TgZ(163,"b"),h._uU(164),h.ALo(165,"number"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(166,"ion-list"),h.TgZ(167,"ion-item"),h.TgZ(168,"ion-label"),h._uU(169),h.ALo(170,"translate"),h.qZA(),h.TgZ(171,"ion-toggle",11),h.NdJ("ngModelChange",function(e){return t.showDelta=e}),h.qZA(),h.qZA(),h.TgZ(172,"ion-item",12),h.TgZ(173,"ion-label",13),h._uU(174),h.ALo(175,"translate"),h.qZA(),h.TgZ(176,"ion-input",11),h.NdJ("ngModelChange",function(e){return t.price=e}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(177,"div",14),h.TgZ(178,"p",15),h._uU(179),h.ALo(180,"translate"),h._UZ(181,"br"),h.TgZ(182,"span"),h._uU(183),h.ALo(184,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,57,"POND_MOD.ESTIMATE")),h.xp6(10),h.hij(" ",h.lcZ(14,59,"POND_MOD.TODAY")," "),h.xp6(6),h.hij("",h.lcZ(20,61,"POND_MOD.GROW_SPEED")," "),h.xp6(3),h.hij("g/",h.lcZ(23,63,"DAY"),""),h.xp6(3),h.Oqu(h.xi3(26,65,t.data.grow_speed,"0.0-1")),h.xp6(5),h.hij("",h.lcZ(31,68,"POND_MOD.SIZE")," "),h.xp6(3),h.AsE("(",h.xi3(34,70,1e3/t.data.weight,"1.0-1")," ",h.lcZ(35,73,"PCS"),"/kg)"),h.xp6(4),h.hij("",h.xi3(38,75,t.data.weight,"1.0-1")," "),h.xp6(7),h.hij("",h.lcZ(45,78,"POND_MOD.NUMBER_OF_ANIMALS")," "),h.xp6(3),h.hij("(",h.lcZ(48,80,"POND_MOD.THOUSAND"),")"),h.xp6(3),h.hij("",h.xi3(51,82,(null==t.todayData?null:t.todayData.quantityPCS)/1e3,"1.0-1")," "),h.xp6(2),h.Q6J("ngIf",t.showDelta),h.xp6(4),h.hij("",h.lcZ(57,85,"POND_MOD.QUANTITY")," "),h.xp6(3),h.Oqu(h.lcZ(60,87,"POND_MOD.TON")),h.xp6(3),h.hij("",h.xi3(63,89,t.todayData.quantity/1e3,"1.0-2")," "),h.xp6(2),h.Q6J("ngIf",t.showDelta),h.xp6(4),h.hij("",h.lcZ(69,92,"POND_MOD.REVENUE")," "),h.xp6(3),h.Oqu(h.lcZ(72,94,"CURRENCY_S")),h.xp6(3),h.Oqu(h.xi3(75,96,t.todayData.quantity*t.price,"1.0-0")),h.xp6(2),h.Q6J("appPermission",h.DdM(161,St))("currentPermission",t.pondService.permission),h.xp6(3),h.hij("",h.lcZ(80,99,"POND_MOD.PROFIT")," "),h.xp6(3),h.Oqu(h.lcZ(83,101,"CURRENCY_S")),h.xp6(4),h.Oqu(h.xi3(87,103,t.todayData.quantity*t.price-t.todayData.cost,"1.0-0")),h.xp6(6),h.AsE(" ",t.day," ",h.lcZ(93,106,"POND_MOD.NEXT_DAYS")," "),h.xp6(6),h.hij("",h.lcZ(99,108,"POND_MOD.SIZE")," "),h.xp6(3),h.AsE("(",h.xi3(102,110,1e3/t.next7Data.weight,"1.0-1")," ",h.lcZ(103,113,"PCS"),"/kg)"),h.xp6(4),h.hij("",h.xi3(106,115,t.next7Data.weight,"1.0-1")," "),h.xp6(7),h.hij("",h.lcZ(113,118,"POND_MOD.QUANTITY")," "),h.xp6(3),h.Oqu(h.lcZ(116,120,"POND_MOD.TON")),h.xp6(3),h.hij("",h.xi3(119,122,t.next7Data.quantity/1e3,"1.0-1")," "),h.xp6(2),h.Q6J("ngIf",t.showDelta),h.xp6(4),h.hij("",h.lcZ(125,125,"POND_MOD.ESITMATE_PRICE")," "),h.xp6(3),h.Oqu(h.lcZ(128,127,"CURRENCY_S")),h.xp6(3),h.Oqu(h.xi3(131,129,t.price7day,"1.0-1")),h.xp6(2),h.Q6J("appPermission",h.DdM(162,St))("currentPermission",t.pondService.permission),h.xp6(3),h.hij("",h.lcZ(136,132,"POND_MOD.INVEST_MORE")," "),h.xp6(3),h.Oqu(h.lcZ(139,134,"CURRENCY_S")),h.xp6(3),h.Oqu(h.xi3(142,136,t.next7Data.deltaCost,"1.0-0")),h.xp6(5),h.hij("",h.lcZ(147,139,"POND_MOD.REVENUE")," "),h.xp6(3),h.Oqu(h.lcZ(150,141,"CURRENCY_S")),h.xp6(3),h.Oqu(h.xi3(153,143,t.next7Data.quantity*t.price7day,"1.0-0")),h.xp6(2),h.Q6J("appPermission",h.DdM(163,St))("currentPermission",t.pondService.permission),h.xp6(3),h.hij("",h.lcZ(158,146,"POND_MOD.PROFIT")," "),h.xp6(3),h.Oqu(h.lcZ(161,148,"CURRENCY_S")),h.xp6(4),h.Oqu(h.xi3(165,150,t.next7Data.quantity*t.price7day-t.next7Data.cost,"1.0-0")),h.xp6(5),h.Oqu(h.lcZ(170,153,"POND_MOD.SHOW_ERROR")),h.xp6(2),h.Q6J("ngModel",t.showDelta),h.xp6(3),h.Oqu(h.lcZ(175,155,"POND_MOD.ENTER_PRICE")),h.xp6(2),h.Q6J("ngModel",t.price),h.xp6(3),h.Oqu(h.lcZ(180,157,"POND_MOD.ESITMATE_WARNING")),h.xp6(4),h.hij("",h.lcZ(184,159,"POND_MOD.PRICE_FROM")," tepbac.com"))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,l.PM,l.Zi,l.tO,l.q_,l.Ie,l.Q$,o.O5,Ot.l,l.ho,l.w,a.JJ,a.On,l.pK,l.j9],pipes:[f.X$,o.JJ],styles:[""]}),e}(),wt=function(){var e=function(){function e(t,n,i,o){r(this,e),this.toastService=t,this.modalCtrl=n,this.translate=i,this.pondService=o,this.form=new a.cw({type_action:new a.NI("1",a.kI.required),description:new a.NI(""),time_stamp:new a.NI("")})}return c(e,[{key:"ngOnInit",value:function(){this.form.patchValue({time_stamp:(new Date).getTime()})}},{key:"save",value:function(){var e=this,t=this.form.value;t.disease_id=this.item.disease_id,this.pondService.saveProcessDisease(t).subscribe(function(n){1==n.status?(e.toastService.success(e.translate.instant("DISEASE.HANDING_SUCCESS")),e.modalCtrl.dismiss(1==t.type_action)):e.toastService.warning(n.error)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(x.k),h.Y36(l.IN),h.Y36(f.sK),h.Y36(g.p))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-process-disease"]],inputs:{item:"item"},decls:19,vars:10,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding"],[3,"formGroup"],["position","floating"],["formControlName","description"],[2,"text-align","center"],["shape","round",3,"click"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content",3),h.TgZ(9,"ion-list",4),h.TgZ(10,"ion-item"),h.TgZ(11,"ion-label",5),h._uU(12),h.ALo(13,"translate"),h.qZA(),h._UZ(14,"ion-textarea",6),h.qZA(),h.qZA(),h.TgZ(15,"div",7),h.TgZ(16,"ion-button",8),h.NdJ("click",function(){return t.save()}),h._uU(17),h.ALo(18,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"DISEASE.HANDING")),h.xp6(3),h.Q6J("formGroup",t.form),h.xp6(3),h.hij(" ",h.lcZ(13,6,"DISEASE.DESCRIPTION")," "),h.xp6(5),h.Oqu(h.lcZ(18,8,"SAVE")))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.q_,a.JL,a.sg,l.Ie,l.Q$,l.g2,l.j9,a.JJ,a.u],pipes:[f.X$],styles:[""]}),e}(),kt=i(26215),Nt=i(92340),Et=i(69814),Mt=i(1533),It=i(55396),Rt=i(66542),Ut=i(87152),Pt=i(98626),Yt=i(23211),Lt=i(88459),Ft=i(59419),Jt=i(90593),Qt=i(10086);function Vt(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(3),h.hij(" ",n.todo," ")}}function jt(e,t){if(1&e&&(h.TgZ(0,"ion-list"),h.TgZ(1,"ion-list-header"),h.TgZ(2,"ion-label"),h._uU(3,"Quan tr\u1ecdng"),h.qZA(),h.qZA(),h.YNc(4,Vt,4,1,"ion-item",9),h.qZA()),2&e){var n=h.oxw(2);h.xp6(4),h.Q6J("ngForOf",n.data.procedure_problem)}}function Ht(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(3),h.hij(" ",n.todo," ")}}function Gt(e,t){1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.hij(" ",h.lcZ(4,1,"POND_MOD.NO_ITEM")," "))}function Bt(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"div",6),h.TgZ(2,"ion-text"),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.qZA(),h.qZA(),h.TgZ(5,"ion-item",7),h.TgZ(6,"ion-label"),h.TgZ(7,"h3"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.TgZ(10,"p"),h.TgZ(11,"ion-text",8),h._uU(12),h.qZA(),h._uU(13,"\xa0"),h.TgZ(14,"span"),h._uU(15),h.ALo(16,"translate"),h.TgZ(17,"sup"),h._uU(18,"2"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"div"),h.TgZ(20,"p"),h._uU(21),h.qZA(),h.qZA(),h.YNc(22,jt,5,1,"ion-list",3),h.TgZ(23,"ion-list"),h.TgZ(24,"ion-list-header"),h.TgZ(25,"ion-label"),h._uU(26),h.ALo(27,"translate"),h.qZA(),h.qZA(),h.YNc(28,Ht,4,1,"ion-item",9),h.YNc(29,Gt,5,3,"ion-item",3),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(4),h.Oqu(n.data.procedure_info.name),h.xp6(4),h.Oqu(h.lcZ(9,9,"POND_MOD.DENSITY")),h.xp6(4),h.Oqu(n.data.procedure_info.density),h.xp6(3),h.hij("",h.lcZ(16,11,"PCS"),"/m"),h.xp6(6),h.Oqu(n.data.procedure_info.description),h.xp6(1),h.Q6J("ngIf",n.data.procedure_problem.length>0),h.xp6(4),h.Oqu(h.lcZ(27,13,"POND_MOD.TODO")),h.xp6(2),h.Q6J("ngForOf",n.data.procedure_todo),h.xp6(1),h.Q6J("ngIf",0==n.data.procedure_todo.length)}}function zt(e,t){1&e&&(h.TgZ(0,"div",10),h._UZ(1,"ion-spinner",11),h.qZA())}function $t(e,t){if(1&e&&h._UZ(0,"div",12),2&e){var n=h.oxw();h.Q6J("options",n.optionChart)("merge",n.dataUpdate)}}var Wt=function(){var e=function(){function e(t,n,i,o,a){var s=this;r(this,e),this.pondService=t,this.toastController=n,this.modalCtrl=i,this.procedureService=o,this.translate=a,this.loadingFlag=new p.E,this.dataRaw=[],this.dataChart=[],this.feedData=[],this.weightData=[],this.show=!1,this.optionChart={tooltip:{trigger:"axis",formatter:function(e){console.log(e);var t=s.translate.instant("DATE")+": "+e[0].axisValue+"<br/>";return e.forEach(function(e){t+=e.marker+e.seriesName+" : "+(new Intl.NumberFormat).format(e.value[1])+"<br>"}),t},axisPointer:{animation:!0}},xAxis:{type:"value",splitLine:{show:!1}},yAxis:[{type:"value",show:!1,splitLine:{show:!1}},{type:"value",show:!1,position:"right",splitLine:{show:!1}}],series:[{type:"bar",smooth:!0,name:this.translate.instant("POND_MOD.HEIGHT"),itemStyle:{color:"#FBC02D"}},{type:"line",name:this.translate.instant("POND_MOD.FEED"),barWidth:"10%",yAxisIndex:1},{type:"bar",smooth:!0,name:this.translate.instant("POND_MOD.CURRENT_WEIGHT"),itemStyle:{color:"#F57F17"}},{type:"line",name:this.translate.instant("POND_MOD.CURRENT_FEED"),barWidth:"10%",yAxisIndex:1}]}}return c(e,[{key:"ngOnInit",value:function(){this.getDetail(),this.getDaily()}},{key:"getDetail",value:function(){var e=this;this.loadingFlag.setStart(!0),this.procedureService.getProcedureRawDetail(this.data.procedure_info.id).subscribe(function(t){t.data?(e.dataRaw=t.data.curves,e.prepareData(e.dataRaw),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"prepareData",value:function(e){var t=this;this.dataChart=[],e.forEach(function(e){e.weight>0&&t.weightData.push([e.day,e.weight]),e.feed>0&&t.feedData.push([e.day,e.feed])}),this.dataUpdate={series:[{data:this.weightData},{data:this.feedData}]}}},{key:"prepareDailyData",value:function(e){var t=this,n=[],i=[];e.forEach(function(e,o){var a=Math.abs(m().diff(m(e.date),"days")-t.dateOld);i.push([a,e.weight]),n.push([a,e.feed_today])}),this.dataUpdate={series:[{data:this.weightData},{data:this.feedData},{data:i},{data:n}]}}},{key:"getDaily",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},m().format("YYYY-MM-DD")).subscribe(function(t){t.data?(e.prepareDailyData(t.data),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"ionViewDidEnter",value:function(){this.show=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(g.p),h.Y36(l.yF),h.Y36(l.IN),h.Y36(Qt.d),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-procedure-view"]],inputs:{data:"data",dateOld:"dateOld"},decls:12,vars:6,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[4,"ngIf"],["class","spiner-loading",4,"ngIf"],["echarts","","class","demo-chart",3,"options","merge",4,"ngIf"],[1,"ion-padding"],["lines","none"],["color","primary"],[4,"ngFor","ngForOf"],[1,"spiner-loading"],["name","dots"],["echarts","",1,"demo-chart",3,"options","merge"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.YNc(9,Bt,30,15,"div",3),h.YNc(10,zt,2,0,"div",4),h.YNc(11,$t,1,2,"div",5),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"PROCEDURE")),h.xp6(3),h.Q6J("ngIf",t.data),h.xp6(1),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(1),h.Q6J("ngIf",t.show))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o.O5,l.yW,l.Ie,l.Q$,l.q_,l.yh,o.sg,l.PQ,u._w],pipes:[f.X$],styles:[""]}),e}();function Xt(e,t){1&e&&h._UZ(0,"ion-icon",9)}function Kt(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",10),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).removeBlock()}),h.TgZ(1,"ion-button",11),h._UZ(2,"ion-icon",12),h.qZA(),h.qZA()}}function en(e,t){if(1&e&&(h.TgZ(0,"div",13),h.TgZ(1,"p"),h._uU(2),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(2),h.Oqu(n.dailyProcedure.procedure_info.name)}}function tn(e,t){1&e&&(h.TgZ(0,"p",17),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"POND_MOD.NO_INFOR")))}function nn(e,t){if(1&e&&(h.TgZ(0,"ion-card-content"),h.TgZ(1,"ion-list",14),h.TgZ(2,"ion-item"),h.TgZ(3,"ion-label"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"span",15),h._uU(7),h.TgZ(8,"small"),h._uU(9,"g"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-item"),h.TgZ(11,"ion-label"),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.TgZ(14,"span",15),h._uU(15),h.TgZ(16,"small"),h._uU(17,"kg"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(18,tn,3,3,"p",16),h.qZA()),2&e){var n=h.oxw(2);h.xp6(4),h.hij(" ",h.lcZ(5,5,"POND_MOD.HEIGHT")," "),h.xp6(3),h.hij("",null==n.dailyProcedure?null:n.dailyProcedure.procedure_curve.weight," "),h.xp6(5),h.hij(" ",h.lcZ(13,7,"POND_MOD.FEED")," "),h.xp6(3),h.hij("",null==n.dailyProcedure?null:n.dailyProcedure.procedure_curve.feed," "),h.xp6(3),h.Q6J("ngIf",n.loadingFlag.result&&!(null!=n.dailyProcedure&&n.dailyProcedure.procedure_info))}}function on(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",18),h.TgZ(1,"ion-button",19),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).upBlockProperty()}),h._UZ(2,"ion-icon",20),h.qZA(),h.TgZ(3,"ion-button",19),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).downBlockProperty()}),h._UZ(4,"ion-icon",21),h.qZA(),h.qZA()}}function an(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",1),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw();return t.enableSort?e.stopPropagation():t.openProcedure()}),h.TgZ(1,"ion-card-header",2),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",3),h._uU(4),h.ALo(5,"translate"),h.YNc(6,Xt,1,0,"ion-icon",4),h.qZA(),h.YNc(7,Kt,3,0,"ion-buttons",5),h.qZA(),h.YNc(8,en,3,1,"div",6),h.YNc(9,nn,19,9,"ion-card-content",7),h.TgZ(10,"div"),h.YNc(11,on,5,0,"ion-buttons",8),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,7,"PROCEDURE")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",(null==i.dailyProcedure?null:i.dailyProcedure.procedure_curve)&&!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}var rn=function(){var e=function(){function e(t,n,i,o){r(this,e),this.pondService=t,this.toastService=n,this.modalCtrl=i,this.translate=o,this.loadingFlag=new p.E,this.dateOld=0,this.eventUp=new h.vpe,this.eventDown=new h.vpe,this.eventRemove=new h.vpe,console.log("onload procerdure")}return c(e,[{key:"ngOnInit",value:function(){this.loadProcedure()}},{key:"openProcedure",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:Wt,componentProps:{data:this.dailyProcedure,dateOld:this.dateOld}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"loadProcedure",value:function(){var e=this;console.log("load procedure"),this.loadingFlag.setPending(!0),this.pondService.getProcedure().pipe().subscribe(function(t){console.log(t),t.error||1!=t.status?e.toastService.warning(t.error):(e.dailyProcedure=t.data,e.dateOld=t.old),e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"upBlockProperty",value:function(){this.eventUp.emit(this.index)}},{key:"downBlockProperty",value:function(){this.eventDown.emit(this.index)}},{key:"removeBlock",value:function(){this.eventRemove.emit(this.index)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(g.p),h.Y36(x.k),h.Y36(l.IN),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-procedure"]],inputs:{enableSort:"enableSort",index:"index"},outputs:{eventUp:"eventUp",eventDown:"eventDown",eventRemove:"eventRemove"},decls:1,vars:1,consts:[["mode","ios",3,"ngClass","click",4,"ngIf"],["mode","ios",3,"ngClass","click"],[1,"procedure"],["src","assets/icon/procedure.svg",1,"icon-f"],["class","icon-detail","name","chevron-forward-outline",4,"ngIf"],["class","btnRemoveBlock",3,"click",4,"ngIf"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],["class","ion-float-end",4,"ngIf"],["name","chevron-forward-outline",1,"icon-detail"],[1,"btnRemoveBlock",3,"click"],["size","small","color","light"],["name","close"],[1,"ion-padding"],["lines","none","mode","ios"],["slot","end",1,"ion-margin"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"],[1,"ion-float-end"],["size","small","color","tertiary",3,"click"],["name","chevron-up-circle-outline"],["name","chevron-down-circle-outline"]],template:function(e,t){1&e&&h.YNc(0,an,12,9,"ion-card",0),2&e&&h.Q6J("ngIf",t.dailyProcedure)},directives:[o.O5,l.PM,o.mk,l.Zi,l.tO,l.gu,l.Sm,l.YG,l.FN,l.q_,l.Ie,l.Q$],pipes:[f.X$],styles:["[_nghost-%COMP%]   .procedure[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#68768A,#3dc2ff)}[_nghost-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff!important;padding-left:3em}[_nghost-%COMP%]   ion-icon.icon-f[_ngcontent-%COMP%]{font-size:2em;position:absolute;left:0;top:-.2em}[_nghost-%COMP%]   .jiggleBlock[_ngcontent-%COMP%]{animation:jiggle .4s infinite;-webkit-animation:jiggle .4s infinite;-moz-animation-duration:.4s;-moz-animation-name:jiggle;-moz-animation-iteration-count:infinite;-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg)}@keyframes jiggle{0%{transform:rotate(-1deg)}50%{transform:rotate(1deg)}}@-webkit-keyframes jiggle{0%{-webkit-transform:rotate(-1deg)}50%{-webkit-transform:rotate(1deg)}}[_nghost-%COMP%]   .btnRemoveBlock[_ngcontent-%COMP%]{position:absolute;top:0;right:0}[_nghost-%COMP%]   .disableEvent[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e}();function sn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-checkbox",14),h.NdJ("ngModelChange",function(e){return t.$implicit.checked=e})("click",function(){var e=h.CHM(n),t=e.$implicit,i=e.index;return h.oxw().setDone(t,i)}),h.qZA(),h.TgZ(2,"ion-label"),h._uU(3),h.TgZ(4,"p"),h._uU(5),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(1),h.Q6J("ngModel",i.checked),h.xp6(2),h.hij(" ",i.content," "),h.xp6(2),h.Oqu(i.time.format("HH:mm A"))}}function cn(e,t){1&e&&(h.TgZ(0,"ion-item",15),h.TgZ(1,"ion-label",3),h.TgZ(2,"p"),h.TgZ(3,"i"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(4),h.Oqu(h.lcZ(5,1,"POND_MOD.NO_TODO")))}function ln(e,t){1&e&&(h.TgZ(0,"div",3),h._UZ(1,"ion-spinner",16),h.qZA())}var un=function(){var e=function(){function e(t,n,i,o,a){r(this,e),this.modalCtrl=t,this.toastService=n,this.calendarService=i,this.pondService=o,this.translate=a,this.loadingFlag=new p.E,this.data=[],this.dataRaw=[],this.dateRangeSelectedOld=m(),this.dateRangeSelected=m(),this.maxDate=m().add(180,"days"),this.minDate=m().subtract(180,"days"),this.minDateTamp=m(),this.maxDateTamp=m()}return c(e,[{key:"ngOnInit",value:function(){console.log(this.item),this.item.length>0&&void 0!==this.item&&0==this.dateRangeSelected.diff(this.item[0].time,"day")?this.itemSelected=this.item:this.getData("up"),this.minDate=m(1e3*this.pondService.pond.add_time),this.maxDate=m().add(7,"days")}},{key:"getData",value:function(e){var t=this;this.loadingFlag.setPending(!0);var n;n="up"==e?this.dateRangeSelected.valueOf()/1e3:this.dateRangeSelected.endOf("day").valueOf()/1e3,this.calendarService.getListByPond(this.pondService.pcode,n,e).pipe().subscribe(function(e){if(e.error)t.itemSelected=[];else{t.dataRaw=e.data.map(function(e){return e.time=m(1e3*e.time),e});for(var n=0;n<t.dataRaw.length;n++)t.dataRaw[n].checked=0!=t.dataRaw[n].done;t.procesData()}t.loadingFlag.setResult(!0)},function(e){t.loadingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"onChangeDate",value:function(e){var t="up";if(e.detail.value<this.dateRangeSelectedOld.format("YYYY-MM-DD")&&(t="down"),this.dateRangeSelected=m(e.detail.value),this.dateRangeSelectedOld=this.dateRangeSelected,this.dataRaw.length>0){var n="down"===t?this.dataRaw[this.dataRaw.length-1].time.diff(this.dateRangeSelected,"days"):this.dataRaw[0].time.diff(this.dateRangeSelected,"days");n<=-1&&"down"==t||n>=1&&"up"==t?this.procesData():this.getData(t)}else this.getData(t)}},{key:"procesData",value:function(){var e=this;this.itemSelected=this.dataRaw.filter(function(t){var n=t.time.diff(e.dateRangeSelected.startOf("day"),"days",!0);return n<1&&n>=0})}},{key:"changeDate",value:function(e){this.dateRangeSelected=m(this.dateRangeSelected).add(e,"days")}},{key:"setDone",value:function(e,t){var n=this;this.pondService.doneTodo(e.id).subscribe(function(e){1==e.status?n.itemSelected[t].checked?(n.itemSelected[t].done=1,n.toastService.success(n.translate.instant("POND_MOD.DONE_TODO"))):(n.item[t].done=0,n.toastService.warning(n.translate.instant("POND_MOD.UNDONE_TODO"))):1==n.itemSelected[t].checked?(n.itemSelected[t].done=0,n.itemSelected[t].checked=!1):(n.itemSelected[t].done=1,n.itemSelected[t].checked=!0,n.toastService.warning(e.error))},function(){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(x.k),h.Y36(R.o),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-todo"]],inputs:{item:"item"},decls:26,vars:14,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back-outline"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward-outline"],["lines","none",1,"ion-padding"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["slot","start",3,"ngModel","ngModelChange","click"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.TgZ(10,"ion-grid"),h.TgZ(11,"ion-row"),h.TgZ(12,"ion-col",4),h.TgZ(13,"ion-button",5),h.NdJ("click",function(){return t.changeDate(-1)}),h._UZ(14,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(15,"ion-col",7),h.TgZ(16,"ion-item",3),h.TgZ(17,"ion-datetime",8),h.NdJ("ionChange",function(e){return t.onChangeDate(e)}),h.ALo(18,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"ion-col",4),h.TgZ(20,"ion-button",5),h.NdJ("click",function(){return t.changeDate(1)}),h._UZ(21,"ion-icon",9),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(22,"ion-list",10),h.YNc(23,sn,6,3,"ion-item",11),h.YNc(24,cn,6,3,"ion-item",12),h.qZA(),h.YNc(25,ln,2,0,"div",13),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,10,"POND_MOD.TODO")),h.xp6(7),h.Q6J("disabled",t.dateRangeSelected.format("YYYY-MM-DD")<=t.minDate.format("YYYY-MM-DD")),h.xp6(4),h.Q6J("displayFormat",h.lcZ(18,12,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("disabled",t.dateRangeSelected.format("YYYY-MM-DD")>=t.maxDate.format("YYYY-MM-DD")),h.xp6(3),h.Q6J("ngForOf",t.itemSelected),h.xp6(1),h.Q6J("ngIf",0==(null==t.itemSelected?null:t.itemSelected.length)),h.xp6(1),h.Q6J("ngIf",t.loadingFlag.pending))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.jY,l.Nd,l.wI,l.Ie,l.x4,l.QI,l.q_,o.sg,o.O5,l.nz,l.w,a.JJ,a.On,l.Q$,l.PQ],pipes:[f.X$],styles:[""]}),e}(),dn=function(){var e=function(){function e(t,n,i,o,s){r(this,e),this.modalCtrl=t,this.toastService=n,this.pondService=i,this.calendarService=o,this.translate=s,this.savingFlag=new p.E,this.minDate=m(),this.maxDate=m().add(30,"days"),this.form=new a.cw({date:new a.NI(m().format("YYYY-MM-DD"),a.kI.required),time:new a.NI(m().toISOString(),[a.kI.required]),content:new a.NI("",[a.kI.required])})}return c(e,[{key:"ngOnInit",value:function(){}},{key:"save",value:function(){var e=this,t=m(this.form.value.time),n=m(this.form.value.date);if(n.set({hour:t.get("hour"),minute:t.get("minute")}),this.form.value.date<this.minDate.format("YYYY-MM-DD"))return this.toastService.success(this.translate.instant("POND_MOD.TIME_PASSED")),!1;var i={content:this.form.value.content,date:n.format("YYYY-MM-DD"),time:n.format("HH:mm"),pond_id:this.pondService.pcode,done:!1};this.savingFlag.setPending(!0),this.calendarService.insertCalendar(i).subscribe(function(t){t.error||1!=t.status?e.toastService.warning(t.error):(e.toastService.success(e.translate.instant("POND_MOD.NOTI_ADD_TODO")),e.form.value.date==e.minDate.format("YYYY-MM-DD")?e.modalCtrl.dismiss(i):e.modalCtrl.dismiss()),e.savingFlag.setResult(!0)},function(t){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(x.k),h.Y36(g.p),h.Y36(R.o),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-todo-add"]],decls:31,vars:22,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"formGroup"],[1,"ion-text-center"],[1,"title","ion-padding"],["lines","inset"],["displayFormat","HH:mm","minuteValues","0,15,30,45","formControlName","time"],["formControlName","date",3,"displayFormat","min","max"],["position","floating"],["rows","2","formControlName","content"],["shape","round","color","primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalCtrl.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(5,"ion-content",3),h.TgZ(6,"div",4),h.TgZ(7,"h1",5),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.TgZ(10,"ion-list"),h.TgZ(11,"ion-item",6),h.TgZ(12,"ion-label"),h._uU(13),h.ALo(14,"translate"),h.qZA(),h._UZ(15,"ion-datetime",7),h.qZA(),h.TgZ(16,"ion-item",6),h.TgZ(17,"ion-label"),h._uU(18),h.ALo(19,"translate"),h.qZA(),h._UZ(20,"ion-datetime",8),h.ALo(21,"translate"),h.qZA(),h.TgZ(22,"ion-item",6),h.TgZ(23,"ion-label",9),h._uU(24),h.ALo(25,"translate"),h.qZA(),h._UZ(26,"ion-textarea",10),h.qZA(),h.qZA(),h.TgZ(27,"div",4),h.TgZ(28,"ion-button",11),h.NdJ("click",function(){return t.save()}),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(5),h.Q6J("formGroup",t.form),h.xp6(3),h.Oqu(h.lcZ(9,10,"POND_MOD.ADD_TODO")),h.xp6(5),h.Oqu(h.lcZ(14,12,"POND_MOD.HOUR")),h.xp6(5),h.Oqu(h.lcZ(19,14,"POND_MOD.DATE")),h.xp6(2),h.Q6J("displayFormat",h.lcZ(21,16,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD")),h.xp6(4),h.Oqu(h.lcZ(25,18,"POND_MOD.CONTENT")),h.xp6(4),h.Q6J("disabled",t.form.invalid||t.savingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(30,20,"SAVE")))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.W2,a.JL,a.sg,l.q_,l.Ie,l.Q$,l.x4,l.QI,a.JJ,a.u,l.g2,l.j9],pipes:[f.X$],styles:[""]}),e}();function gn(e,t){1&e&&h._UZ(0,"ion-icon",7)}function pn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",8),h.NdJ("click",function(){return h.CHM(n),h.oxw().removeBlock()}),h.TgZ(1,"ion-button",9),h._UZ(2,"ion-icon",10),h.qZA(),h.qZA()}}var mn=function(){return["company_manager","farm_manager","farm_operation","pond_operator","pond_manager"]};function hn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",17),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentAdd(e)}),h._UZ(1,"ion-icon",18),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("appPermission",h.DdM(2,mn))("currentPermission",i.pondService.permission)}}function fn(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",14),h.TgZ(2,"ion-label",15),h.TgZ(3,"b"),h._uU(4),h.qZA(),h._uU(5),h.qZA(),h.YNc(6,hn,2,3,"ion-button",16),h.qZA()),2&e){var n=t.$implicit,i=t.index,o=h.oxw(2);h.xp6(1),h.Q6J("color",1==n.done?"success":"")("name",0!=n.done&&n.done?"checkmark-outline":"pricetag-outline"),h.xp6(1),h.Q6J("color",1==n.done?"success":""),h.xp6(2),h.Oqu(n.time.format("HH:mm A")),h.xp6(1),h.hij(" | ",n.content," "),h.xp6(1),h.Q6J("ngIf",i==o.items.length-1)}}function Zn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.TgZ(5,"ion-button",17),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(2);return t.enableSort?e.stopPropagation():t.presentAdd(e)}),h._UZ(6,"ion-icon",18),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(3),h.Oqu(h.lcZ(4,3,"POND_MOD.NOTHING_TODO_TODAY")),h.xp6(2),h.Q6J("appPermission",h.DdM(5,mn))("currentPermission",i.pondService.permission)}}function vn(e,t){if(1&e&&(h.TgZ(0,"ion-list",11),h.YNc(1,fn,7,6,"ion-item",12),h.YNc(2,Zn,7,6,"ion-item",13),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngForOf",n.items),h.xp6(1),h.Q6J("ngIf",0==(null==n.items?null:n.items.length))}}function An(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",19),h.TgZ(1,"ion-button",20),h.NdJ("click",function(){return h.CHM(n),h.oxw().upBlockProperty()}),h._UZ(2,"ion-icon",21),h.qZA(),h.TgZ(3,"ion-button",20),h.NdJ("click",function(){return h.CHM(n),h.oxw().downBlockProperty()}),h._UZ(4,"ion-icon",22),h.qZA(),h.qZA()}}var _n=function(){var e=function(){function e(t,n,i,o){r(this,e),this.modalController=t,this.pondService=n,this.toastService=i,this.translate=o,this.loadingFlag=new p.E,this.items=[],this.eventUp=new h.vpe,this.eventDown=new h.vpe,this.eventRemove=new h.vpe}return c(e,[{key:"ngOnInit",value:function(){this.loadList()}},{key:"presentTodo",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=0;t<this.items.length;t++)this.items[t].checked=0!=this.items[t].done;return e.next=3,this.modalController.create({component:un,componentProps:{item:this.items}});case 3:return e.next=5,e.sent.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"presentAdd",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.target&&e.stopPropagation(),t.next=3,this.modalController.create({component:dn});case 3:return(n=t.sent).onDidDismiss().then(function(e){e.data&&i.items.push(e.data)}),t.next=7,n.present();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}))}},{key:"loadList",value:function(){var e=this,t=m().startOf("day").valueOf()/1e3;this.loadingFlag.setPending(!0),this.pondService.getCalendarList(t).pipe().subscribe(function(t){console.log(t),!t.error&&t.data.length>0?(e.items=t.data.map(function(e){return e.time=m(1e3*e.time),e}),e.items=e.items.slice(0,5)):e.items=[],e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"upBlockProperty",value:function(){this.eventUp.emit(this.index)}},{key:"downBlockProperty",value:function(){this.eventDown.emit(this.index)}},{key:"removeBlock",value:function(){this.eventRemove.emit(this.index)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-todo-info"]],inputs:{enableSort:"enableSort",index:"index"},outputs:{eventUp:"eventUp",eventDown:"eventDown",eventRemove:"eventRemove"},decls:12,vars:8,consts:[["mode","ios",3,"ngClass","click"],[1,"todo"],["name","list",1,"icon-f"],["class","icon-detail","name","chevron-forward-outline",4,"ngIf"],["class","btnRemoveBlock",3,"click",4,"ngIf"],["lines","none","mode","ios",4,"ngIf"],["class","ion-float-end",4,"ngIf"],["name","chevron-forward-outline",1,"icon-detail"],[1,"btnRemoveBlock",3,"click"],["size","small","color","light"],["name","close"],["lines","none","mode","ios"],[4,"ngFor","ngForOf"],[4,"ngIf"],["slot","start",3,"color","name"],[3,"color"],["slot","end","shape","round","fill","clear","size","default",3,"appPermission","currentPermission","click",4,"ngIf"],["slot","end","shape","round","fill","clear","size","default",3,"appPermission","currentPermission","click"],["name","add-circle-outline","slot","icon-only"],[1,"ion-float-end"],["size","small","color","tertiary",3,"click"],["name","chevron-up-circle-outline"],["name","chevron-down-circle-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card",0),h.NdJ("click",function(e){return t.enableSort?e.stopPropagation():t.presentTodo()}),h.TgZ(2,"ion-card-header",1),h.TgZ(3,"ion-card-subtitle"),h._UZ(4,"ion-icon",2),h._uU(5),h.ALo(6,"translate"),h.YNc(7,gn,1,0,"ion-icon",3),h.qZA(),h.YNc(8,pn,3,0,"ion-buttons",4),h.qZA(),h.YNc(9,vn,3,2,"ion-list",5),h.TgZ(10,"div"),h.YNc(11,An,5,0,"ion-buttons",6),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(1),h.Q6J("ngClass",t.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(6,6,"POND_MOD.TODO")," "),h.xp6(2),h.Q6J("ngIf",!t.enableSort),h.xp6(1),h.Q6J("ngIf",t.enableSort),h.xp6(1),h.Q6J("ngIf",!t.enableSort),h.xp6(2),h.Q6J("ngIf",t.enableSort))},directives:[l.PM,o.mk,l.Zi,l.tO,l.gu,o.O5,l.Sm,l.YG,l.q_,o.sg,l.Ie,l.Q$,Ot.l],pipes:[f.X$],styles:["[_nghost-%COMP%]   .todo[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#567C73,#3dc2ff)}[_nghost-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff!important;padding-left:3em}[_nghost-%COMP%]   ion-icon.icon-f[_ngcontent-%COMP%]{font-size:2em;position:absolute;left:0;top:-.2em}[_nghost-%COMP%]   .jiggleBlock[_ngcontent-%COMP%]{animation:jiggle .4s infinite;-webkit-animation:jiggle .4s infinite;-moz-animation-duration:.4s;-moz-animation-name:jiggle;-moz-animation-iteration-count:infinite;-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg)}@keyframes jiggle{0%{transform:rotate(-1deg)}50%{transform:rotate(1deg)}}@-webkit-keyframes jiggle{0%{-webkit-transform:rotate(-1deg)}50%{-webkit-transform:rotate(1deg)}}[_nghost-%COMP%]   .btnRemoveBlock[_ngcontent-%COMP%]{position:absolute;top:0;right:0}[_nghost-%COMP%]   .disableEvent[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e}(),Tn=i(88002),xn=i(19228),qn=i(25375);function On(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",30),h.qZA())}function bn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",31),h.TgZ(1,"ion-label",22),h._uU(2),h.ALo(3,"translate"),h.TgZ(4,"ion-text",32),h._uU(5),h.ALo(6,"translate"),h.ALo(7,"number"),h.ALo(8,"translate"),h.qZA(),h.qZA(),h.TgZ(9,"ion-input",33),h.NdJ("ionFocus",function(){return h.CHM(n),h.oxw().setAmountPayed()})("ionChange",function(e){return h.CHM(n),h.oxw().numberFormatPayed.setValue(e.detail.value)}),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,5,"MONEY_MOD.PAYED")),h.xp6(3),h.lnq("(",h.lcZ(6,7,"SHOP.CART.TOTAL")," ",h.lcZ(7,9,i.totalCost),"",h.lcZ(8,11,"CURRENCY_S"),")"),h.xp6(4),h.Q6J("value",i.numberFormatPayed.fakeView)}}function Dn(e,t){1&e&&(h.TgZ(0,"ion-item",31),h.TgZ(1,"ion-text",34),h._uU(2," Chi ph\xed \u0111\xe3 tr\u1ea3 lu\xf4n nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng chi ph\xed "),h.qZA(),h.qZA())}function yn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label",36),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",37),h.NdJ("click",function(){return h.CHM(n),h.oxw().removeSelected()}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(4),h.Oqu(i.manufacturerSelected.name),h.xp6(2),h.Oqu(i.manufacturerSelected.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"DELETE")," ")}}function Sn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label"),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",38),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw().onSelect(e)}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(4),h.Oqu(i.name),h.xp6(2),h.Oqu(i.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"SELECT")," ")}}function Cn(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(n.message)}}function wn(e,t){1&e&&(h.TgZ(0,"ion-item",31),h.TgZ(1,"ion-label",22),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"ion-input",39),h.qZA()),2&e&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"MONEY_MOD.CUSTOMER")))}function kn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text"),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",38),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).setCustomerName(e.customer_name)}),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.hij(" ",i.customer_name," "),h.xp6(2),h.hij(" ",h.lcZ(5,2,"SELECT")," ")}}function Nn(e,t){if(1&e&&(h.TgZ(0,"ion-list",27),h.YNc(1,kn,6,4,"ion-item",28),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngForOf",n.listCustomer)}}function En(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",30),h.qZA())}var Mn=function(){var e=function(){function e(t,n,i,o,s,c,l,u){r(this,e),this.modalController=t,this._formBuilder=n,this.toastService=i,this.pondService=o,this.translate=s,this.moneyService=c,this.dbLocalService=l,this.settingService=u,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.numberFormatPrice=new re.y(""),this.numberFormatQuantity=new re.y(""),this.numberFormatPayed=new re.y(""),this.minDate=m().subtract(180,"days"),this.maxDate=m(),this.searchTerms=new fe.xQ,this.message="",this.form=this._formBuilder.group({seed_quantity:["",a.kI.required],seed_quantity_individuals:[""],seed_supplier:[""],seed_supplier_id:[""],seed_old:[""],seed_cost:[""],seed_cost_individuals:[""],seed_cost_kg:[""],seed_weight:[""],note:[""],seed_date:m().format("YYYY-MM-DD"),unit:["con"],customer:[""],amounts_payed:[""]}),this.totalCost=0,this.dataUpload={path:"",name:"",base:"",file:null},this.listCustomer=[]}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.form.get("customer").valueChanges.pipe((0,ve.b)(300),(0,Ae.x)()).subscribe(function(t){e.getListCustomer()});var t=this.searchTerms.pipe((0,ve.b)(300),(0,Ae.x)(),(0,_e.w)(function(t){return e.getListManufacturer(t)}));this.manufacturer$=t,this.manufacturer$.subscribe(function(t){e.message=t.length>0||e.manufacturerSelected?"":e.translate.instant("POND_MOD.NO_INFOR"),e.loadingFlag.setResult(!0)});var n=this.dbLocalService.farms.findIndex(function(t){return t.infor.id==e.pondService.pond.farm_id});n>=0&&this.moneyService.setCode(this.dbLocalService.farms[n].infor.code)}},{key:"search",value:function(e){this.searchTerms.next(e)}},{key:"getListCustomer",value:function(){var e=this;this.listCustomer=[],this.moneyService.searchCustomer(this.form.value.customer,"").subscribe(function(t){1==t.status&&(e.listCustomer=t.data.filter(function(t){return t.customer_name!=e.form.value.customer}),console.log(e.listCustomer))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"setCustomerName",value:function(e){this.form.patchValue({customer:e})}},{key:"setAmountPayed",value:function(){"kg"==this.form.controls.unit.value?(console.log(this.form.controls.seed_weight.value),this.numberFormatPayed.setValue(this.form.value.seed_cost_kg*this.numberFormatQuantity.realValue)):this.numberFormatPayed.setValue(this.numberFormatQuantity.realValue*this.form.value.seed_cost_individuals),this.totalCost=this.numberFormatPayed.realValue}},{key:"getListManufacturer",value:function(e){var t=this;return this.loadingFlag.setPending(!0),e.trim()?this.pondService.searchManufacturer(e).pipe((0,Tn.U)(function(e){return e.data.filter(function(e){return!t.manufacturerSelected||e.id!=t.manufacturerSelected.id})})):(this.loadingFlag.setResult(!0),this.message="",(0,Ze.of)([]))}},{key:"onSave",value:function(){var e=this,t=!1,n={seed_quantity:this.numberFormatQuantity.realValue,seed_quantity_individuals:0,seed_supplier:this.form.value.seed_supplier,seed_supplier_id:this.form.value.seed_supplier_id,seed_old:this.form.value.seed_old,seed_cost:this.form.value.seed_cost.toString().replace(",","."),seed_cost_individuals:this.form.value.seed_cost_individuals.toString().replace(",","."),seed_cost_kg:this.form.value.seed_cost_kg.toString().replace(",","."),seed_weight:this.form.value.seed_weight,note:this.form.value.note,seed_date:m(this.form.value.seed_date).valueOf()/1e3,unit:this.form.value.unit,amounts_payed:this.numberFormatPayed.realValue,customer:this.form.value.customer,is_debt:this.settingService.showDebt?1:0};this.manufacturerSelected?(n.seed_supplier=this.manufacturerSelected.fullname,n.seed_supplier_id=this.manufacturerSelected.id):n.seed_supplier=this.form.value.seed_supplier,"kg"==this.form.controls.unit.value?(console.log(this.form.controls.seed_weight.value),""!=this.form.controls.seed_weight.value?(n.seed_quantity_individuals=1e3*n.seed_quantity/n.seed_weight,n.seed_cost=n.seed_cost_kg*n.seed_weight/1e3):(this.form.controls.seed_weight.setValidators(a.kI.required),this.toastService.warning(this.translate.instant("POND_MOD.ERROR_SIZE")),t=!0),this.form.controls.seed_cost_kg.setValidators(a.kI.required)):(this.form.controls.seed_cost_individuals.setValidators(a.kI.required),n.seed_quantity_individuals=this.numberFormatQuantity.realValue,n.seed_cost=this.form.value.seed_cost_individuals);var i=new FormData;for(var o in n)i.append(o,n[o]);this.dataUpload.file&&i.append("image",this.dataUpload.file),0==t&&(this.savingFlag.setPending(!0),this.pondService.reqSeasonSeed(i).subscribe(function(t){1==+t.status?(e.toastService.success(t.message),e.savingFlag.setResult(!0),e.modalController.dismiss(n)):(e.toastService.warning(t.message),e.savingFlag.setResult(!1))},function(){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))}))}},{key:"onSelect",value:function(e){this.manufacturerSelected=e,this.form.controls.seed_supplier.setValue(e.fullname),this.form.controls.seed_supplier_id.setValue(e.id)}},{key:"removeSelected",value:function(){this.manufacturerSelected=null,this.form.controls.seed_supplier.setValue(""),this.form.controls.seed_supplier_id.setValue("")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(a.qu),h.Y36(x.k),h.Y36(g.p),h.Y36(f.sK),h.Y36(xn.r),h.Y36(se.T),h.Y36(U.R))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-seed"]],decls:86,vars:70,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[3,"formGroup"],[1,"ion-text-center"],[4,"ngIf"],[3,"data","toUpload"],["color","primary"],["formControlName","seed_date",3,"displayFormat","min","max"],["size","8"],["color","primary","position","floating"],["required","","formControlName","seed_quantity","type","tel","inputmode","numeric",3,"value","ionChange"],["size","4"],["formControlName","unit",3,"ionChange"],["value","con"],["value","kg"],[3,"hidden"],["formControlName","seed_cost_individuals","type","tel","inputmode","decimal",3,"ionChange"],["formControlName","seed_cost_kg","type","tel","inputmode","decimal",3,"ionChange"],["lines","inset",4,"ngIf"],["position","floating"],["formControlName","seed_weight","type","tel","inputmode","decimal"],["formControlName","seed_old","type","tel","inputmode","decimal"],["rows","2","formControlName","note"],["formControlName","seed_supplier",3,"ionChange"],["lines","none"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],["name","dots"],["lines","inset"],["color","success"],["formControlName","amounts_payed","type","tel","inputmode","numeric",3,"value","ionFocus","ionChange"],["color","danger"],["name","business","slot","start"],[1,"ion-text-wrap"],["color","danger","slot","end",3,"click"],["slot","end",3,"click"],["formControlName","customer"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.onSave()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content",5),h.TgZ(13,"div",6),h.YNc(14,On,2,0,"div",7),h.qZA(),h.TgZ(15,"app-image-picker",8),h.NdJ("toUpload",function(e){return t.dataUpload=e}),h.qZA(),h.TgZ(16,"ion-grid"),h.TgZ(17,"ion-item"),h.TgZ(18,"ion-label",9),h._uU(19),h.ALo(20,"translate"),h.qZA(),h._UZ(21,"ion-datetime",10),h.ALo(22,"translate"),h.qZA(),h.TgZ(23,"ion-row"),h.TgZ(24,"ion-col",11),h.TgZ(25,"ion-item"),h.TgZ(26,"ion-label",12),h._uU(27),h.ALo(28,"translate"),h.qZA(),h.TgZ(29,"ion-input",13),h.NdJ("ionChange",function(e){return t.numberFormatQuantity.setValue(e.detail.value),t.setAmountPayed()}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(30,"ion-col",14),h.TgZ(31,"ion-item"),h.TgZ(32,"ion-label",12),h._uU(33),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-select",15),h.NdJ("ionChange",function(){return t.setAmountPayed()}),h.TgZ(36,"ion-select-option",16),h._uU(37),h.ALo(38,"translate"),h.qZA(),h.TgZ(39,"ion-select-option",17),h._uU(40,"kg"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(41,"ion-item",18),h.TgZ(42,"ion-label",12),h._uU(43),h.ALo(44,"translate"),h.ALo(45,"translate"),h.ALo(46,"translate"),h.qZA(),h.TgZ(47,"ion-input",19),h.NdJ("ionChange",function(){return t.setAmountPayed()}),h.qZA(),h.qZA(),h.TgZ(48,"ion-item",18),h.TgZ(49,"ion-label",12),h._uU(50),h.ALo(51,"translate"),h.ALo(52,"translate"),h.qZA(),h.TgZ(53,"ion-input",20),h.NdJ("ionChange",function(){return t.setAmountPayed()}),h.qZA(),h.qZA(),h.YNc(54,bn,10,13,"ion-item",21),h.YNc(55,Dn,3,0,"ion-item",21),h.TgZ(56,"ion-item"),h.TgZ(57,"ion-label",22),h._uU(58),h.ALo(59,"translate"),h.ALo(60,"translate"),h.qZA(),h._UZ(61,"ion-input",23),h.qZA(),h.TgZ(62,"ion-item"),h.TgZ(63,"ion-label",22),h._uU(64),h.ALo(65,"translate"),h.qZA(),h._UZ(66,"ion-input",24),h.qZA(),h.TgZ(67,"ion-item"),h.TgZ(68,"ion-label",22),h._uU(69),h.ALo(70,"translate"),h.qZA(),h._UZ(71,"ion-textarea",25),h.qZA(),h.TgZ(72,"ion-item"),h.TgZ(73,"ion-label",22),h._uU(74),h.ALo(75,"translate"),h.qZA(),h.TgZ(76,"ion-input",26),h.NdJ("ionChange",function(){return t.search(t.form.controls.seed_supplier.value)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(77,"ion-list",27),h.YNc(78,yn,10,5,"ion-item",7),h.YNc(79,Sn,10,5,"ion-item",28),h.ALo(80,"async"),h.YNc(81,Cn,4,1,"ion-item",7),h.YNc(82,wn,5,3,"ion-item",21),h.qZA(),h.YNc(83,Nn,2,1,"ion-list",29),h.TgZ(84,"div",6),h.YNc(85,En,2,0,"div",7),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,34,"CROP_MOD.CROP_STOCKING")),h.xp6(3),h.Q6J("disabled",t.form.invalid||t.totalCost<t.numberFormatPayed.realValue),h.xp6(1),h.hij(" ",h.lcZ(11,36,"SAVE")," "),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(2),h.Q6J("ngIf",t.savingFlag.pending),h.xp6(1),h.Q6J("data",t.dataUpload),h.xp6(4),h.Oqu(h.lcZ(20,38,"DATE")),h.xp6(2),h.Q6J("displayFormat",h.lcZ(22,40,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD")),h.xp6(6),h.Oqu(h.lcZ(28,42,"QUANTITY")),h.xp6(2),h.Q6J("value",t.numberFormatQuantity.fakeView),h.xp6(4),h.Oqu(h.lcZ(34,44,"UNIT")),h.xp6(4),h.Oqu(h.lcZ(38,46,"PCS")),h.xp6(4),h.Q6J("hidden","con"!=t.form.controls.unit.value),h.xp6(2),h.lnq("",h.lcZ(44,48,"PRICE")," (",h.lcZ(45,50,"CURRENCY_S"),"/",h.lcZ(46,52,"PCS"),")"),h.xp6(5),h.Q6J("hidden","kg"!=t.form.controls.unit.value),h.xp6(2),h.AsE("",h.lcZ(51,54,"PRICE")," (",h.lcZ(52,56,"CURRENCY_S"),"/kg)"),h.xp6(4),h.Q6J("ngIf",(t.form.value.seed_cost_kg>0||t.form.value.seed_cost_individuals>0)&&t.numberFormatQuantity.realValue>0&&t.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",t.totalCost<t.numberFormatPayed.realValue&&t.settingService.showDebt),h.xp6(3),h.AsE("",h.lcZ(59,58,"WEIGHT")," (g/",h.lcZ(60,60,"PCS"),")"),h.xp6(6),h.Oqu(h.lcZ(65,62,"CROP_MOD.DATE_OLD")),h.xp6(5),h.Oqu(h.lcZ(70,64,"NOTE")),h.xp6(5),h.Oqu(h.lcZ(75,66,"SUPPLIER")),h.xp6(4),h.Q6J("ngIf",t.manufacturerSelected),h.xp6(1),h.Q6J("ngForOf",h.lcZ(80,68,t.manufacturer$)),h.xp6(2),h.Q6J("ngIf",t.message),h.xp6(1),h.Q6J("ngIf",t.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",t.settingService.showDebt),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,a.JL,a.sg,o.O5,qn.k,l.jY,l.Ie,l.Q$,l.x4,l.QI,a.JJ,a.u,l.Nd,l.wI,l.pK,l.j9,a.Q7,l.t9,l.n0,l.g2,l.q_,o.sg,l.PQ,l.yW],pipes:[f.X$,o.Ov,o.JJ],styles:[""]}),e}();function In(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",31),h.qZA())}function Rn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",32),h.TgZ(1,"ion-label",23),h._uU(2),h.ALo(3,"translate"),h.TgZ(4,"ion-text",33),h._uU(5),h.ALo(6,"translate"),h.ALo(7,"number"),h.ALo(8,"translate"),h.qZA(),h.qZA(),h.TgZ(9,"ion-input",34),h.NdJ("ionFocus",function(){return h.CHM(n),h.oxw(2).setAmountPayed()})("ionChange",function(e){return h.CHM(n),h.oxw(2).numberFormatPayed.setValue(e.detail.value)}),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(2),h.Oqu(h.lcZ(3,5,"MONEY_MOD.PAYED")),h.xp6(3),h.lnq("(",h.lcZ(6,7,"SHOP.CART.TOTAL")," ",h.lcZ(7,9,i.totalCost),"",h.lcZ(8,11,"CURRENCY_S"),")"),h.xp6(4),h.Q6J("value",i.numberFormatPayed.fakeView)}}function Un(e,t){1&e&&(h.TgZ(0,"ion-item",32),h.TgZ(1,"ion-text",35),h._uU(2," Chi ph\xed \u0111\xe3 tr\u1ea3 lu\xf4n nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng chi ph\xed "),h.qZA(),h.qZA())}function Pn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",36),h.TgZ(2,"ion-label",37),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",38),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).removeSelected()}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(4),h.Oqu(i.manufacturerSelected.name),h.xp6(2),h.Oqu(i.manufacturerSelected.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"DELETE")," ")}}function Yn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",36),h.TgZ(2,"ion-label"),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",39),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).onSelect(e)}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(4),h.Oqu(i.name),h.xp6(2),h.Oqu(i.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"SELECT")," ")}}function Ln(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(3),h.Oqu(n.message)}}function Fn(e,t){1&e&&(h.TgZ(0,"ion-item",32),h.TgZ(1,"ion-label",23),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"ion-input",40),h.qZA()),2&e&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"MONEY_MOD.CUSTOMER")))}function Jn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text"),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",39),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(3).setCustomerName(e.customer_name)}),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.hij(" ",i.customer_name," "),h.xp6(2),h.hij(" ",h.lcZ(5,2,"SELECT")," ")}}function Qn(e,t){if(1&e&&(h.TgZ(0,"ion-list",28),h.YNc(1,Jn,6,4,"ion-item",29),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",n.listCustomer)}}function Vn(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",31),h.qZA())}function jn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-content",6),h.TgZ(1,"div",7),h.YNc(2,In,2,0,"div",8),h.qZA(),h.TgZ(3,"app-image-picker",9),h.NdJ("toUpload",function(e){return h.CHM(n),h.oxw().dataUpload=e}),h.qZA(),h.TgZ(4,"ion-grid"),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label",10),h._uU(7),h.ALo(8,"translate"),h.qZA(),h._UZ(9,"ion-datetime",11),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"ion-row"),h.TgZ(12,"ion-col",12),h.TgZ(13,"ion-item"),h.TgZ(14,"ion-label",13),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.TgZ(17,"ion-input",14),h.NdJ("ionChange",function(e){h.CHM(n);var t=h.oxw();return t.numberFormatQuantity.setValue(e.detail.value),t.setAmountPayed()}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(18,"ion-col",15),h.TgZ(19,"ion-item"),h.TgZ(20,"ion-label",13),h._uU(21),h.ALo(22,"translate"),h.qZA(),h.TgZ(23,"ion-select",16),h.NdJ("ionChange",function(){return h.CHM(n),h.oxw().setAmountPayed()}),h.TgZ(24,"ion-select-option",17),h._uU(25),h.ALo(26,"translate"),h.qZA(),h.TgZ(27,"ion-select-option",18),h._uU(28,"kg"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(29,"ion-item",19),h.TgZ(30,"ion-label",13),h._uU(31),h.ALo(32,"translate"),h.ALo(33,"translate"),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-input",20),h.NdJ("ionChange",function(){return h.CHM(n),h.oxw().setAmountPayed()}),h.qZA(),h.qZA(),h.TgZ(36,"ion-item",19),h.TgZ(37,"ion-label",13),h._uU(38),h.ALo(39,"translate"),h.ALo(40,"translate"),h.qZA(),h.TgZ(41,"ion-input",21),h.NdJ("ionChange",function(){return h.CHM(n),h.oxw().setAmountPayed()}),h.qZA(),h.qZA(),h.YNc(42,Rn,10,13,"ion-item",22),h.YNc(43,Un,3,0,"ion-item",22),h.TgZ(44,"ion-item"),h.TgZ(45,"ion-label",23),h._uU(46),h.ALo(47,"translate"),h.ALo(48,"translate"),h.qZA(),h._UZ(49,"ion-input",24),h.qZA(),h.TgZ(50,"ion-item"),h.TgZ(51,"ion-label",23),h._uU(52),h.ALo(53,"translate"),h.qZA(),h._UZ(54,"ion-input",25),h.qZA(),h.TgZ(55,"ion-item"),h.TgZ(56,"ion-label",23),h._uU(57),h.ALo(58,"translate"),h.qZA(),h._UZ(59,"ion-textarea",26),h.qZA(),h.TgZ(60,"ion-item"),h.TgZ(61,"ion-label",23),h._uU(62),h.ALo(63,"translate"),h.qZA(),h.TgZ(64,"ion-input",27),h.NdJ("ionChange",function(){h.CHM(n);var e=h.oxw();return e.search(e.form.controls.seed_supplier.value)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(65,"ion-list",28),h.YNc(66,Pn,10,5,"ion-item",8),h.YNc(67,Yn,10,5,"ion-item",29),h.ALo(68,"async"),h.YNc(69,Ln,4,1,"ion-item",8),h.YNc(70,Fn,5,3,"ion-item",22),h.qZA(),h.YNc(71,Qn,2,1,"ion-list",30),h.TgZ(72,"div",7),h.YNc(73,Vn,2,0,"div",8),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("formGroup",i.form),h.xp6(2),h.Q6J("ngIf",i.savingFlag.pending),h.xp6(1),h.Q6J("data",i.dataUpload),h.xp6(4),h.Oqu(h.lcZ(8,31,"DATE")),h.xp6(2),h.Q6J("displayFormat",h.lcZ(10,33,"FORMAT_DATE_MOMENT"))("min",i.minDate.format("YYYY-MM-DD"))("max",i.maxDate.format("YYYY-MM-DD")),h.xp6(6),h.Oqu(h.lcZ(16,35,"QUANTITY")),h.xp6(2),h.Q6J("value",i.numberFormatQuantity.fakeView),h.xp6(4),h.Oqu(h.lcZ(22,37,"UNIT")),h.xp6(4),h.Oqu(h.lcZ(26,39,"PCS")),h.xp6(4),h.Q6J("hidden","con"!=i.form.controls.unit.value),h.xp6(2),h.lnq("",h.lcZ(32,41,"PRICE")," (",h.lcZ(33,43,"CURRENCY_S"),"/",h.lcZ(34,45,"PCS"),")"),h.xp6(5),h.Q6J("hidden","kg"!=i.form.controls.unit.value),h.xp6(2),h.AsE("",h.lcZ(39,47,"PRICE")," (",h.lcZ(40,49,"CURRENCY_S"),"/kg)"),h.xp6(4),h.Q6J("ngIf",(i.form.value.seed_cost_kg>0||i.form.value.seed_cost_individuals>0)&&i.numberFormatQuantity.realValue>0&&i.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",i.totalCost<i.numberFormatPayed.realValue),h.xp6(3),h.AsE("",h.lcZ(47,51,"WEIGHT")," (g/",h.lcZ(48,53,"PCS"),")"),h.xp6(6),h.Oqu(h.lcZ(53,55,"CROP_MOD.DATE_OLD")),h.xp6(5),h.Oqu(h.lcZ(58,57,"NOTE")),h.xp6(5),h.Oqu(h.lcZ(63,59,"SUPPLIER")),h.xp6(4),h.Q6J("ngIf",i.manufacturerSelected),h.xp6(1),h.Q6J("ngForOf",h.lcZ(68,61,i.manufacturer$)),h.xp6(2),h.Q6J("ngIf",i.message),h.xp6(1),h.Q6J("ngIf",i.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",i.settingService.showDebt),h.xp6(2),h.Q6J("ngIf",i.loadingFlag.pending)}}var Hn=function(){var e=function(){function e(t,n,i,o,s,c,l,u){r(this,e),this.modalController=t,this._formBuilder=n,this.toastService=i,this.pondService=o,this.translate=s,this.moneyService=c,this.dbLocalService=l,this.settingService=u,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.numberFormatPrice=new re.y(""),this.numberFormatQuantity=new re.y(""),this.numberFormatPayed=new re.y(""),this.minDate=m().subtract(180,"days"),this.maxDate=m(),this.searchTerms=new fe.xQ,this.message="",this.show=!1,this.form=this._formBuilder.group({seed_quantity:["",a.kI.required],seed_quantity_individuals:[""],seed_supplier:[""],seed_supplier_id:[""],seed_old:[""],seed_cost:[""],seed_cost_individuals:[""],seed_cost_kg:[""],seed_weight:[""],note:[""],seed_date:m().format("YYYY-MM-DD"),unit:["con"],customer:[""],amounts_payed:[""]}),this.listCustomer=[],this.dataUpload={path:"",name:"",base:"",file:null},this.totalCost=0}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.item.seed_cost=parseFloat(this.item.seed_cost.toString().replace(",",".")),this.numberFormatQuantity.setValue(this.item.seed_quantity),this.numberFormatPrice.setValue(this.item.seed_cost),this.createForm(),this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.form.get("customer").valueChanges.pipe((0,ve.b)(300),(0,Ae.x)()).subscribe(function(t){e.getListCustomer()});var t=this.searchTerms.pipe((0,ve.b)(300),(0,Ae.x)(),(0,_e.w)(function(t){return e.getListManufacturer(t)}));this.manufacturer$=t,this.manufacturer$.subscribe(function(t){e.message=t.length>0?"":e.translate.instant("POND_MOD.NO_INFOR"),e.loadingFlag.setResult(!0)});var n=this.dbLocalService.farms.findIndex(function(t){return t.infor.id==e.pondService.pond.farm_id});n>=0&&this.moneyService.setCode(this.dbLocalService.farms[n].infor.code),this.getBill()}},{key:"search",value:function(e){this.searchTerms.next(e)}},{key:"getListCustomer",value:function(){var e=this;this.listCustomer=[],this.moneyService.searchCustomer(this.form.value.customer,"").subscribe(function(t){1==t.status&&(e.listCustomer=t.data.filter(function(t){return t.customer_name!=e.form.value.customer}),console.log(e.listCustomer))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"setCustomerName",value:function(e){this.form.patchValue({customer:e})}},{key:"setAmountPayed",value:function(){"kg"==this.form.controls.unit.value?(console.log(this.form.controls.seed_weight.value),this.numberFormatPayed.setValue(this.form.value.seed_cost_kg*this.numberFormatQuantity.realValue)):this.numberFormatPayed.setValue(this.numberFormatQuantity.realValue*this.form.value.seed_cost_individuals),this.totalCost=this.numberFormatPayed.realValue}},{key:"getListManufacturer",value:function(e){var t=this;return this.loadingFlag.setPending(!0),e.trim()?this.pondService.searchManufacturer(e).pipe((0,Tn.U)(function(e){return e.data.filter(function(e){return!t.manufacturerSelected||e.id!=t.manufacturerSelected.id})})):(this.loadingFlag.setResult(!0),this.message="",(0,Ze.of)([]))}},{key:"createForm",value:function(){this.numberFormatQuantity.setValue(this.item.seed_quantity),this.numberFormatPrice.setValue(this.item.seed_cost),this.form.setValue({seed_quantity:this.numberFormatQuantity.fakeView,seed_quantity_individuals:"",seed_supplier:this.item.supplier,seed_supplier_id:this.item.supplier_id,seed_old:this.item.seed_old,seed_cost:this.numberFormatPrice.fakeView,seed_cost_individuals:+this.item.seed_cost,seed_cost_kg:"",seed_weight:this.item.seed_weight,note:this.item.note,seed_date:m(1e3*this.item.seed_date).format("YYYY-MM-DD"),unit:"con",customer:"",amounts_payed:""}),0!=+this.item.supplier_id&&(this.manufacturerSelected={id:this.item.supplier_id,fullname:this.item.supplier,name:""}),this.totalCost=this.item.seed_quantity*this.item.seed_cost,this.item.image&&(this.dataUpload.path=Nt.bl.FILE_PATH+"/upload/"+this.item.image)}},{key:"onSave",value:function(){var e=this,t=!1,n={id:this.item.id,seed_quantity:this.numberFormatQuantity.realValue,seed_quantity_individuals:this.numberFormatQuantity.realValue,seed_supplier:this.form.value.seed_supplier,seed_supplier_id:this.form.value.seed_supplier_id,seed_old:this.form.value.seed_old,seed_cost:this.form.value.seed_cost,seed_cost_individuals:this.form.value.seed_cost_individuals.toString().replace(",","."),seed_cost_kg:this.form.value.seed_cost_kg.toString().replace(",","."),seed_weight:this.form.value.seed_weight,note:this.form.value.note,seed_date:m(this.form.value.seed_date).valueOf()/1e3,unit:this.form.value.unit,amounts_payed:this.numberFormatPayed.realValue,customer:this.form.value.customer,is_debt:this.settingService.showDebt?1:0};this.manufacturerSelected?(n.seed_supplier=this.manufacturerSelected.fullname,n.seed_supplier_id=this.manufacturerSelected.id):n.seed_supplier=this.form.value.seed_supplier,"kg"==this.form.controls.unit.value?(""!=this.form.controls.seed_weight.value?(n.seed_quantity_individuals=1e3*+n.seed_quantity/+n.seed_weight,n.seed_cost=n.seed_cost_kg*n.seed_weight/1e3):(this.form.controls.seed_weight.setValidators(a.kI.required),this.toastService.warning(this.translate.instant("POND_MOD.ERROR_SIZE")),t=!0),this.form.controls.seed_cost_kg.setValidators(a.kI.required)):(this.form.controls.seed_cost_individuals.setValidators(a.kI.required),n.seed_cost=this.form.value.seed_cost_individuals);var i=new FormData;for(var o in n)i.append(o,n[o]);this.dataUpload.file&&i.append("image",this.dataUpload.file),0==t&&(this.savingFlag.setPending(!0),this.pondService.reqSeasonSeedEdit(i,this.item.id).subscribe(function(t){1!=t.error?(e.toastService.warning(t.message),e.savingFlag.setResult(!0),e.modalController.dismiss(n)):(e.toastService.success(t.message),e.savingFlag.setResult(!1))},function(){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))}))}},{key:"onSelect",value:function(e){console.log(e),this.manufacturerSelected=e,this.form.controls.seed_supplier.setValue(e.fullname),this.form.controls.seed_supplier_id.setValue(e.id)}},{key:"ionViewDidEnter",value:function(){this.show=!0}},{key:"removeSelected",value:function(){this.manufacturerSelected=null,this.form.controls.seed_supplier.setValue(""),this.form.controls.seed_supplier_id.setValue("")}},{key:"getBill",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.moneyService.getBillByAlias("seed_cost_"+this.item.id,"out").toPromise();case 2:(t=e.sent)&&1==+t.status&&(this.numberFormatPayed.setValue(t.data.amounts_payed),this.form.patchValue({amounts_payed:this.numberFormatPayed.fakeView,customer:t.data.customer_name}),t.data.image&&(this.dataUpload.path=Nt.bl.FILE_PATH+"/upload/"+t.data.image));case 4:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(a.qu),h.Y36(x.k),h.Y36(g.p),h.Y36(f.sK),h.Y36(xn.r),h.Y36(se.T),h.Y36(U.R))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-seed-edit"]],decls:13,vars:8,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"ion-text-center"],[4,"ngIf"],[3,"data","toUpload"],["color","primary"],["formControlName","seed_date",3,"displayFormat","min","max"],["size","8"],["color","primary","position","floating"],["required","","formControlName","seed_quantity","type","tel","inputmode","numeric",3,"value","ionChange"],["size","4"],["formControlName","unit",3,"ionChange"],["value","con"],["value","kg"],[3,"hidden"],["formControlName","seed_cost_individuals","type","tel","inputmode","decimal",3,"ionChange"],["formControlName","seed_cost_kg","type","tel","inputmode","decimal",3,"ionChange"],["lines","inset",4,"ngIf"],["position","floating"],["formControlName","seed_weight","type","tel","inputmode","decimal"],["formControlName","seed_old","type","tel","inputmode","decimal"],["rows","2","formControlName","note"],["formControlName","seed_supplier",3,"ionChange"],["lines","none"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],["name","dots"],["lines","inset"],["color","success"],["formControlName","amounts_payed","type","tel","inputmode","numeric",3,"value","ionFocus","ionChange"],["color","danger"],["name","business","slot","start"],[1,"ion-text-wrap"],["color","danger","slot","end",3,"click"],["slot","end",3,"click"],["formControlName","customer"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.onSave()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(12,jn,74,63,"ion-content",5)),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"CROP_MOD.CROP_STOCKING_EDIT")),h.xp6(3),h.Q6J("disabled",(null==t.form?null:t.form.invalid)||t.totalCost<t.numberFormatPayed.realValue),h.xp6(1),h.hij(" ",h.lcZ(11,6,"SAVE")," "),h.xp6(2),h.Q6J("ngIf",t.show))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,o.O5,l.W2,a.JL,a.sg,qn.k,l.jY,l.Ie,l.Q$,l.x4,l.QI,a.JJ,a.u,l.Nd,l.wI,l.pK,l.j9,a.Q7,l.t9,l.n0,l.g2,l.q_,o.sg,l.PQ,l.yW],pipes:[f.X$,o.Ov,o.JJ],styles:[""]}),e}();function Gn(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",32),h.qZA())}function Bn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",33),h.TgZ(2,"ion-label",34),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",35),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).onRemove()}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(4),h.Oqu(i.buyerSelected.name),h.xp6(2),h.Oqu(i.buyerSelected.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"DELETE")," ")}}function zn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",33),h.TgZ(2,"ion-label"),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",36),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).onSelect(e)}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(4),h.Oqu(i.name),h.xp6(2),h.Oqu(i.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"SELECT")," ")}}function $n(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(3),h.Oqu(n.message)}}function Wn(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",37),h.TgZ(1,"ion-label",22),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-input",38),h.NdJ("ionFocus",function(){return h.CHM(n),h.oxw(2).setAmountPayed()})("ionChange",function(e){return h.CHM(n),h.oxw(2).numberFormatPayed.setValue(e.detail.value)}),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(2),h.Oqu(h.lcZ(3,2,"MONEY_MOD.PAYED")),h.xp6(2),h.Q6J("value",i.numberFormatPayed.fakeView)}}function Xn(e,t){1&e&&(h.TgZ(0,"ion-item",37),h.TgZ(1,"ion-text",39),h._uU(2," Chi ph\xed \u0111\xe3 tr\u1ea3 lu\xf4n nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng chi ph\xed "),h.qZA(),h.qZA())}function Kn(e,t){1&e&&(h.TgZ(0,"ion-item",37),h.TgZ(1,"ion-label",22),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"ion-input",40),h.qZA()),2&e&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"MONEY_MOD.CUSTOMER")))}function ei(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text"),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",36),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(3).setCustomerName(e.customer_name)}),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.hij(" ",i.customer_name," "),h.xp6(2),h.hij(" ",h.lcZ(5,2,"SELECT")," ")}}function ti(e,t){if(1&e&&(h.TgZ(0,"ion-list",27),h.YNc(1,ei,6,4,"ion-item",28),h.qZA()),2&e){var n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",n.listCustomer)}}function ni(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",32),h.qZA())}function ii(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-content",6),h.TgZ(1,"div",7),h.YNc(2,Gn,2,0,"div",8),h.qZA(),h.TgZ(3,"app-image-picker",9),h.NdJ("toUpload",function(e){return h.CHM(n),h.oxw().dataUpload=e}),h.qZA(),h.TgZ(4,"div",10),h.TgZ(5,"h1"),h._uU(6),h.ALo(7,"date"),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"h3"),h._uU(10),h.ALo(11,"translate"),h.ALo(12,"translate"),h.qZA(),h.qZA(),h.TgZ(13,"ion-grid"),h.TgZ(14,"ion-row"),h.TgZ(15,"ion-col",11),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label",12),h._uU(18),h.ALo(19,"translate"),h.qZA(),h.TgZ(20,"ion-input",13),h.NdJ("ionInput",function(e){return h.CHM(n),h.oxw().checkChange("size",e)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(21,"ion-col",14),h.TgZ(22,"ion-item"),h.TgZ(23,"ion-label",12),h._uU(24),h.ALo(25,"translate"),h.qZA(),h.TgZ(26,"ion-select",15),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().checkChange("unit",e)}),h.TgZ(27,"ion-select-option",16),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.TgZ(30,"ion-select-option",17),h._uU(31),h.ALo(32,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(33,"ion-row"),h.TgZ(34,"ion-col",18),h.TgZ(35,"ion-item"),h.TgZ(36,"ion-label",19),h._uU(37),h.ALo(38,"translate"),h.qZA(),h.TgZ(39,"ion-input",20),h.NdJ("input",function(e){return h.CHM(n),h.oxw().checkChange("quantity",e)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(40,"ion-col",18),h.TgZ(41,"ion-item"),h.TgZ(42,"ion-label",19),h._uU(43),h.ALo(44,"translate"),h.ALo(45,"translate"),h.qZA(),h.TgZ(46,"ion-input",21),h.NdJ("ionChange",function(e){h.CHM(n);var t=h.oxw();return t.numberFormatPrice.setValue(e.detail.value),t.setAmountPayed()}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(47,"ion-item"),h.TgZ(48,"ion-label",22),h._uU(49),h.ALo(50,"translate"),h.qZA(),h.TgZ(51,"ion-input",23),h.NdJ("ionInput",function(e){return h.CHM(n),h.oxw().checkChange("ratio",e)}),h.qZA(),h.qZA(),h.TgZ(52,"ion-item"),h.TgZ(53,"ion-label",22),h._uU(54),h.ALo(55,"translate"),h.ALo(56,"translate"),h.qZA(),h.TgZ(57,"ion-input",24),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().numberFormatCost.setValue(e.detail.value)}),h.qZA(),h.qZA(),h.TgZ(58,"ion-item"),h.TgZ(59,"ion-label",22),h._uU(60),h.ALo(61,"translate"),h.qZA(),h._UZ(62,"ion-textarea",25),h.qZA(),h.TgZ(63,"ion-item"),h.TgZ(64,"ion-label",22),h._uU(65),h.ALo(66,"translate"),h.qZA(),h.TgZ(67,"ion-input",26),h.NdJ("ionChange",function(){h.CHM(n);var e=h.oxw();return e.search(e.form.controls.buyer.value)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(68,"ion-list",27),h.YNc(69,Bn,10,5,"ion-item",8),h.YNc(70,zn,10,5,"ion-item",28),h.ALo(71,"async"),h.YNc(72,$n,4,1,"ion-item",8),h.qZA(),h.TgZ(73,"ion-list"),h.TgZ(74,"ion-item",27),h.TgZ(75,"ion-label"),h._uU(76),h.ALo(77,"translate"),h.qZA(),h.TgZ(78,"span"),h.TgZ(79,"ion-text",29),h._uU(80),h.ALo(81,"number"),h.qZA(),h._uU(82),h.ALo(83,"translate"),h.qZA(),h.qZA(),h.YNc(84,Wn,5,4,"ion-item",30),h.YNc(85,Xn,3,0,"ion-item",30),h.YNc(86,Kn,5,3,"ion-item",30),h.YNc(87,ti,2,1,"ion-list",31),h.qZA(),h.TgZ(88,"div",7),h.YNc(89,ni,2,0,"div",8),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("formGroup",i.form),h.xp6(2),h.Q6J("ngIf",i.savingFlag.pending),h.xp6(1),h.Q6J("data",i.dataUpload),h.xp6(3),h.Oqu(h.xi3(7,33,1e3*i.item.harvest_date,h.lcZ(8,36,"FORMAT_DATE"))),h.xp6(4),h.lnq("",h.lcZ(11,38,"LIFE-RATIO.SEED")," ",i.seed_quantity," ",h.lcZ(12,40,"PCS"),""),h.xp6(8),h.Oqu(h.lcZ(19,42,"SIZE")),h.xp6(6),h.Oqu(h.lcZ(25,44,"UNIT")),h.xp6(4),h.Oqu(h.lcZ(29,46,"PCS")),h.xp6(3),h.hij("g/",h.lcZ(32,48,"PCS"),""),h.xp6(6),h.hij("",h.lcZ(38,50,"CROP_MOD.HARVEST_QUANTITY")," (kg)"),h.xp6(2),h.Q6J("value",i.numberFormatQuantity.fakeView),h.xp6(4),h.AsE("",h.lcZ(44,52,"PRICE")," (",h.lcZ(45,54,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",i.numberFormatPrice.fakeView),h.xp6(3),h.hij("",h.lcZ(50,56,"CROP_MOD.HARVEST_RATIO")," (%)"),h.xp6(5),h.AsE("",h.lcZ(55,58,"CROP_MOD.HARVEST_COST")," (",h.lcZ(56,60,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",i.numberFormatCost.fakeView),h.xp6(3),h.Oqu(h.lcZ(61,62,"NOTE")),h.xp6(5),h.Oqu(h.lcZ(66,64,"CROP_MOD.HARVEST_CUSTOMER")),h.xp6(4),h.Q6J("ngIf",i.buyerSelected),h.xp6(1),h.Q6J("ngForOf",h.lcZ(71,66,i.manufacturer$)),h.xp6(2),h.Q6J("ngIf",i.message),h.xp6(4),h.Oqu(h.lcZ(77,68,"REVENUE")),h.xp6(4),h.Oqu(h.xi3(81,70,i.numberFormatPrice.realValue*i.numberFormatQuantity.realValue,"0.0-0")),h.xp6(2),h.hij(" ",h.lcZ(83,73,"CURRENCY_S"),""),h.xp6(2),h.Q6J("ngIf",i.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",i.numberFormatPrice.realValue*i.numberFormatQuantity.realValue<i.numberFormatPayed.realValue&&i.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",i.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",i.settingService.showDebt),h.xp6(2),h.Q6J("ngIf",i.loadingFlag.pending)}}var oi=function(){var e=function(){function e(t,n,i,o,a,s,c,l){r(this,e),this.modalController=t,this._formBuilder=n,this.toastService=i,this.pondService=o,this.translate=a,this.dbLocalService=s,this.moneyService=c,this.settingService=l,this.loadingFlag=new p.E,this.savingFlag=new p.E,this.numberFormatPrice=new re.y(""),this.numberFormatQuantity=new re.y(""),this.numberFormatCost=new re.y(""),this.numberFormatPayed=new re.y(""),this.minDate=m().subtract(180,"days"),this.maxDate=m(),this.searchTerms=new fe.xQ,this.message="",this.seed_quantity=0,this.dataUpload={path:"",name:"",base:"",file:null},this.listCustomer=[]}return c(e,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getInfomation();case 2:this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.form.get("customer").valueChanges.pipe((0,ve.b)(300),(0,Ae.x)()).subscribe(function(e){i.getListCustomer()}),t=this.searchTerms.pipe((0,ve.b)(300),(0,Ae.x)(),(0,_e.w)(function(e){return i.getListManufacturer(e)})),this.manufacturer$=t,this.manufacturer$.subscribe(function(e){i.message=e.length>0?"":i.translate.instant("POND_MOD.NO_INFOR"),i.loadingFlag.setResult(!0)}),(n=this.dbLocalService.farms.findIndex(function(e){return e.infor.id==i.pondService.pond.farm_id}))>=0&&this.moneyService.setCode(this.dbLocalService.farms[n].infor.code),console.log(this.dbLocalService.farms[n].infor.code);case 8:case"end":return e.stop()}},e,this)}))}},{key:"getListCustomer",value:function(){var e=this;this.listCustomer=[],this.moneyService.searchCustomer(this.form.value.customer,"").subscribe(function(t){1==t.status&&(e.listCustomer=t.data.filter(function(t){return t.customer_name!=e.form.value.customer}),console.log(e.listCustomer))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"setCustomerName",value:function(e){this.form.patchValue({customer:e})}},{key:"setAmountPayed",value:function(){!this.numberFormatPrice.realValue||!this.numberFormatQuantity.realValue||this.numberFormatPayed.setValue(this.numberFormatPrice.realValue*this.numberFormatQuantity.realValue)}},{key:"search",value:function(e){this.searchTerms.next(e)}},{key:"getInfomation",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pondService.reqSeasonCollectInfo(this.item.id).toPromise();case 2:(t=e.sent).data&&(this.item=t.data,this.buildForm());case 4:case"end":return e.stop()}},e,this)}))}},{key:"getListManufacturer",value:function(e){return this.loadingFlag.setPending(!0),e.trim()?this.pondService.searchManufacturer(e).pipe((0,Tn.U)(function(e){return e.data})):(0,Ze.of)([])}},{key:"checkChange",value:function(e,t){if(this.form.value.size&&this.form.value.unit&&this.form.value.quantity){switch(e){case"unit":var n;n=(1e3/this.form.value.size).toFixed(0),this.form.patchValue({size:n});break;case"size":var i=this.seed_quantity*t.target.value/1e3*(this.form.value.harvest_ratio?this.form.value.harvest_ratio/100:1);"kg"==this.form.value.unit&&(i=this.seed_quantity/t.target.value*(this.form.value.harvest_ratio?this.form.value.harvest_ratio/100:1)),console.log(i),this.numberFormatQuantity.setValue(i.toFixed(0));break;case"quantity":this.numberFormatQuantity.setValue(t.target.value),this.getRatio();break;case"ratio":var o=t.target.value;if(!o)break;i=this.seed_quantity*this.form.value.size/1e3*(o?o/100:1),"kg"==this.form.value.unit&&(i=this.seed_quantity/this.form.value.size*(o?o/100:1)),console.log(i),this.numberFormatQuantity.setValue(i.toFixed(0))}this.setAmountPayed()}}},{key:"getRatio",value:function(){if(this.form.value.size&&this.form.value.unit){console.log(this.numberFormatQuantity);var e=1e3*this.numberFormatQuantity.realValue/this.form.value.size*100/this.seed_quantity;"kg"==this.form.value.unit&&(e=100*this.numberFormatQuantity.realValue*this.form.value.size/this.seed_quantity),console.log(e),this.form.patchValue({harvest_ratio:e.toFixed(0)})}}},{key:"onSelect",value:function(e){this.buyerSelected=e,this.form.controls.buyer.setValue(e.fullname),this.form.controls.buyer_id.setValue(e.id)}},{key:"buildForm",value:function(){this.numberFormatQuantity.setValue(this.item.harvest_quantity),this.numberFormatPrice.setValue(this.item.harvest_price),this.numberFormatCost.setValue(this.item.harvest_cost),this.form=this._formBuilder.group({method:[this.item.method],quantity:[this.item.harvest_quantity,a.kI.required],price:[this.item.harvest_price,a.kI.required],size:[this.item.harvest_size,a.kI.required],buyer:[this.item.buyer],buyer_id:[this.item.buyer_id],harvest_cost:[this.item.harvest_cost],note:[this.item.note],unit:["con",a.kI.required],harvest_ratio:[this.item.ratio,a.kI.required],customer:[""],amounts_payed:[""]}),this.seed_quantity=(100*this.item.harvest_quantity*(1e3/this.item.harvest_size)/this.item.ratio).toFixed(),this.item.image&&(this.dataUpload.path=Nt.bl.FILE_PATH+"/upload/"+this.item.image),this.getBill()}},{key:"onSave",value:function(){var e=this;if(this.validateAllFormFields(this.form),this.form.invalid)return!1;"kg"==this.form.value.unit&&(this.form.value.size=(1e3/this.form.value.size).toFixed(2),this.form.value.unit="con");var t={method:this.form.value.method,quantity:this.numberFormatQuantity.realValue,price:this.numberFormatPrice.realValue,size:this.form.value.size,buyer:this.form.value.buyer,buyer_id:this.form.value.buyer_id,harvest_cost:this.form.value.harvest_cost,harvest_ratio:this.form.value.harvest_ratio,note:this.form.value.note,customer:this.form.value.customer,amounts_payed:this.numberFormatPayed.realValue,is_debt:this.settingService.showDebt?1:0},n=new FormData;for(var i in t)n.append(i,t[i]);this.dataUpload.file&&n.append("image",this.dataUpload.file),this.savingFlag.setPending(!0),this.pondService.reqSeasonCollectEdit(n,this.item.id).subscribe(function(t){1==t.status?(e.toastService.success(t.message),e.modalController.dismiss(e.form.value),e.savingFlag.setResult(!0)):(e.toastService.warning(t.message),e.savingFlag.setResult(!1))},function(){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"validateAllFormFields",value:function(e){var t=this;Object.keys(e.controls).forEach(function(n){var i=e.get(n);i instanceof a.NI?i.markAsTouched({onlySelf:!0}):i instanceof a.cw&&t.validateAllFormFields(i)})}},{key:"onRemove",value:function(){this.buyerSelected=null,this.form.controls.buyer.setValue(""),this.form.controls.buyer_id.setValue("")}},{key:"getBill",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.moneyService.getBillByAlias("harvest_amounts_"+this.item.id,"in").toPromise();case 2:(t=e.sent)&&1==+t.status&&(this.numberFormatPayed.setValue(t.data.amounts_payed),this.form.patchValue({amounts_payed:this.numberFormatPayed.fakeView,customer:t.data.customer_name}),t.data.image&&(this.dataUpload.path=Nt.bl.FILE_PATH+"/upload/"+t.data.image));case 4:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(a.qu),h.Y36(x.k),h.Y36(g.p),h.Y36(f.sK),h.Y36(se.T),h.Y36(xn.r),h.Y36(U.R))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-harvest-edit"]],inputs:{item:"item"},decls:13,vars:8,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"ion-text-center"],[4,"ngIf"],[3,"data","toUpload"],[1,"ion-text-center","ion-padding"],["size","8"],["color","primary","position","floating"],["required","","formControlName","size","type","tel","inputmode","decimal",3,"ionInput"],["size","4"],["formControlName","unit","required","",3,"ionChange"],["value","kg"],["value","con"],["size","6"],["position","floating","color","primary"],["formControlName","quantity","type","tel","inputmode","decimal","required","",3,"value","input"],["formControlName","price","type","tel","inputmode","decimal","required","",3,"value","ionChange"],["position","floating"],["formControlName","harvest_ratio","type","tel","inputmode","decimal",3,"ionInput"],["formControlName","harvest_cost","type","tel","inputmode","decimal",3,"value","ionChange"],["rows","2","formControlName","note"],["formControlName","buyer",3,"ionChange"],["lines","none"],[4,"ngFor","ngForOf"],["color","success"],["lines","inset",4,"ngIf"],["lines","none",4,"ngIf"],["name","dots"],["name","business","slot","start"],[1,"ion-text-wrap"],["color","danger","slot","end",3,"click"],["slot","end",3,"click"],["lines","inset"],["formControlName","amounts_payed","type","tel","inputmode","numeric",3,"value","ionFocus","ionChange"],["color","danger"],["formControlName","customer"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.onSave()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(12,ii,90,75,"ion-content",5)),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,4,"CROP_MOD.HARVEST_EDIT")),h.xp6(3),h.Q6J("disabled",(null==t.form?null:t.form.invalid)||(null==t.form?null:t.form.value.harvest_ratio)>100||t.numberFormatPrice.realValue*t.numberFormatQuantity.realValue<t.numberFormatPayed.realValue),h.xp6(1),h.hij(" ",h.lcZ(11,6,"SAVE")," "),h.xp6(2),h.Q6J("ngIf",t.form))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,o.O5,l.W2,a.JL,a.sg,qn.k,l.jY,l.Nd,l.wI,l.Ie,l.Q$,l.pK,l.j9,a.Q7,a.JJ,a.u,l.t9,l.QI,l.n0,l.g2,l.q_,o.sg,l.yW,l.PQ],pipes:[f.X$,o.uU,o.Ov,o.JJ],styles:[""]}),e}();function ai(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",35),h.qZA())}function ri(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",26),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-input",36),h.NdJ("ionInput",function(e){return h.CHM(n),h.oxw().checkChange("ratio",e)}),h.qZA(),h.qZA()}2&e&&(h.xp6(2),h.hij("",h.lcZ(3,1,"CROP_MOD.HARVEST_RATIO")," (%)"))}function si(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",37),h.TgZ(2,"ion-label",38),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",39),h.NdJ("click",function(){return h.CHM(n),h.oxw().onRemove()}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(4),h.Oqu(i.buyerSelected.name),h.xp6(2),h.Oqu(i.buyerSelected.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"DELETE")," ")}}function ci(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",37),h.TgZ(2,"ion-label"),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",40),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw().onSelect(e)}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(4),h.Oqu(i.name),h.xp6(2),h.Oqu(i.fullname),h.xp6(2),h.hij(" ",h.lcZ(9,3,"SELECT")," ")}}function li(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(n.message)}}function ui(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",41),h.TgZ(1,"ion-label",26),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-input",42),h.NdJ("ionFocus",function(){return h.CHM(n),h.oxw().setAmountPayed()})("ionChange",function(e){return h.CHM(n),h.oxw().numberFormatPayed.setValue(e.detail.value)}),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"MONEY_MOD.PAYED")),h.xp6(2),h.Q6J("value",i.numberFormatPayed.fakeView)}}function di(e,t){1&e&&(h.TgZ(0,"ion-item",41),h.TgZ(1,"ion-text",43),h._uU(2," Chi ph\xed \u0111\xe3 tr\u1ea3 lu\xf4n nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng chi ph\xed "),h.qZA(),h.qZA())}function gi(e,t){1&e&&(h.TgZ(0,"ion-item",41),h.TgZ(1,"ion-label",26),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"ion-input",44),h.qZA()),2&e&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"MONEY_MOD.CUSTOMER")))}function pi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-text"),h._uU(2),h.qZA(),h.TgZ(3,"ion-button",40),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).setCustomerName(e.customer_name)}),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.hij(" ",i.customer_name," "),h.xp6(2),h.hij(" ",h.lcZ(5,2,"SELECT")," ")}}function mi(e,t){if(1&e&&(h.TgZ(0,"ion-list",30),h.YNc(1,pi,6,4,"ion-item",31),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngForOf",n.listCustomer)}}function hi(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",35),h.qZA())}var fi=function(){var e=function(){function e(t,n,i,o,s,c,l,u,d){r(this,e),this.modalController=t,this._formBuilder=n,this.toastService=i,this.pondService=o,this.translate=s,this.router=c,this.dbLocalService=l,this.moneyService=u,this.settingService=d,this.seed_quantity=0,this.weight={total_loss:0,weight:0},this.loadingFlag=new p.E,this.savingFlag=new p.E,this.numberFormatPrice=new re.y(""),this.numberFormatCost=new re.y(""),this.numberFormatQuantity=new re.y(""),this.numberFormatPayed=new re.y(""),this.minDate=m().subtract(180,"days"),this.maxDate=m(),this.searchTerms=new fe.xQ,this.message="",this.revenue=0,this.form=this._formBuilder.group({method:["",a.kI.required],quantity:["",a.kI.required],price:["",a.kI.required],size:["",a.kI.required],buyer:[""],buyer_id:[""],harvest_cost:[""],note:[""],unit:["",a.kI.required],harvest_ratio:["",[a.kI.min(1),a.kI.max(100)]],autoCalculator:[!0],customer:[""],amounts_payed:[""]}),this.dataUpload={path:"",name:"",base:"",file:null},this.listCustomer=[]}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.form.get("customer").valueChanges.pipe((0,ve.b)(300),(0,Ae.x)()).subscribe(function(t){e.getListCustomer()});var t=this.searchTerms.pipe((0,ve.b)(300),(0,Ae.x)(),(0,_e.w)(function(t){return e.getListManufacturer(t)}));this.manufacturer$=t,this.manufacturer$.subscribe(function(t){e.message=t.length>0||e.buyerSelected?"":e.translate.instant("POND_MOD.NOT_FOUND"),e.loadingFlag.setResult(!0)});var n=this.dbLocalService.farms.findIndex(function(t){return t.infor.id==e.pondService.pond.farm_id});n>=0&&this.moneyService.setCode(this.dbLocalService.farms[n].infor.code),this.getWeight()}},{key:"getListCustomer",value:function(){var e=this;this.listCustomer=[],this.moneyService.searchCustomer(this.form.value.customer,"").subscribe(function(t){1==t.status&&(e.listCustomer=t.data.filter(function(t){return t.customer_name!=e.form.value.customer}),console.log(e.listCustomer))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"setCustomerName",value:function(e){this.form.patchValue({customer:e})}},{key:"setAmountPayed",value:function(){!this.numberFormatPrice.realValue||!this.numberFormatQuantity.realValue||this.numberFormatPayed.setValue(this.numberFormatPrice.realValue*this.numberFormatQuantity.realValue)}},{key:"getWeight",value:function(){var e=this;this.pondService.getWeight().subscribe(function(t){1==t.status?(e.weight={total_loss:t.data.total_loss?t.data.total_loss:0,weight:t.data.weight?t.data.weight:0},e.seedTimes.forEach(function(t){e.seed_quantity+=+t.seed_quantity}),e.harvestTimes.forEach(function(t){e.seed_quantity-=1e3*t.harvest_quantity/t.harvest_size}),e.moveTimes.forEach(function(t){t.to_season_code==e.pondService.pond.current_season?(e.seed_quantity+=+t.quantity_individual,t.weight>=e.weight.weight&&(e.weight.weight=t.weight)):e.seed_quantity-=t.quantity_individual}),e.form.patchValue({size:e.weight.weight,unit:"con",method:"end"}),e.numberFormatQuantity.setValue(((e.seed_quantity-e.weight.total_loss)*e.form.value.size/1e3).toFixed(0))):e.toastService.warning(t.message)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"search",value:function(e){this.searchTerms.next(e)}},{key:"getListManufacturer",value:function(e){var t=this;return this.loadingFlag.setPending(!0),e.trim()?this.pondService.searchManufacturer(e).pipe((0,Tn.U)(function(e){return e.data.filter(function(e){return!t.buyerSelected||e.id!=t.buyerSelected.id})})):(this.message="",this.loadingFlag.setResult(!0),(0,Ze.of)([]))}},{key:"onSelect",value:function(e){this.buyerSelected=e,this.form.controls.buyer.setValue(e.fullname),this.form.controls.buyer_id.setValue(e.id),this.message=""}},{key:"onRemove",value:function(){this.buyerSelected=null,this.form.controls.buyer.setValue(""),this.form.controls.buyer_id.setValue("")}},{key:"validateAllFormFields",value:function(e){var t=this;Object.keys(e.controls).forEach(function(n){var i=e.get(n);i instanceof a.NI?i.markAsTouched({onlySelf:!0}):i instanceof a.cw&&t.validateAllFormFields(i)})}},{key:"checkChange",value:function(e,t){if(this.form.value.autoCalculator&&(this.form.value.size||this.form.value.quantity)){switch(e){case"method":var n=(this.seed_quantity-this.weight.total_loss)*(i=this.form.value.size)/1e3;"kg"==this.form.value.unit&&(n=(this.seed_quantity-this.weight.total_loss)/i),this.numberFormatQuantity.setValue(n.toFixed(0)),this.getRatio();break;case"unit":var i=this.form.value.size;i=(1e3/this.form.value.size).toFixed(0),this.form.patchValue({size:i}),this.getRatio();break;case"size":n=(this.seed_quantity-this.weight.total_loss)*t.target.value/1e3*(this.form.value.harvest_ratio?this.form.value.harvest_ratio/100:1),"kg"==this.form.value.unit&&(n=(this.seed_quantity-this.weight.total_loss)/t.target.value*(this.form.value.harvest_ratio?this.form.value.harvest_ratio/100:1)),this.form.patchValue({size:t.target.value}),this.numberFormatQuantity.setValue(n.toFixed(0));break;case"quantity":this.numberFormatQuantity.setValue(t.target.value),this.getRatio();break;case"ratio":var o=t.target.value;if(console.log(o),!o)break;n=(this.seed_quantity-this.weight.total_loss)*this.form.value.size/1e3*(o?o/100:1),"kg"==this.form.value.unit&&(n=(this.seed_quantity-this.weight.total_loss)/this.form.value.size*(o?o/100:1)),this.numberFormatQuantity.setValue(n.toFixed(0))}this.setAmountPayed()}}},{key:"getRatio",value:function(){if(this.form.value.size&&this.form.value.unit){var e=1e3*this.numberFormatQuantity.realValue/this.form.value.size*100/(this.seed_quantity-this.weight.total_loss);"kg"==this.form.value.unit&&(e=100*this.numberFormatQuantity.realValue*this.form.value.size/(this.seed_quantity-this.weight.total_loss)),"end"==this.form.value.method&&(e=100),this.form.patchValue({harvest_ratio:e?e.toFixed(0):0})}}},{key:"onSave",value:function(){var e=this;if(this.validateAllFormFields(this.form),this.form.invalid)return!1;"kg"==this.form.value.unit&&(this.form.value.size=(1e3/this.form.value.size).toFixed(2),this.form.value.unit="con");var t={method:this.form.value.method,quantity:this.numberFormatQuantity.realValue,price:this.numberFormatPrice.realValue,size:this.form.value.size,buyer:this.form.value.buyer,buyer_id:this.form.value.buyer_id,harvest_cost:this.form.value.harvest_cost,harvest_ratio:this.form.value.harvest_ratio,note:this.form.value.note,customer:this.form.value.customer,amounts_payed:this.numberFormatPayed.realValue,is_debt:this.settingService.showDebt?1:0},n=new FormData;for(var i in t)n.append(i,t[i]);this.dataUpload.file&&n.append("image",this.dataUpload.file),this.savingFlag.setPending(!0),this.pondService.reqSeasonCollect(n).subscribe(function(t){if(1==t.status){if(e.toastService.success(t.message),"end"==e.form.value.method){var n=e.dbLocalService.ponds.findIndex(function(t){return t.infor.code===e.pondService.pcode});if(n>=0){var i={infor:e.pondService.pond,devices:[]};i.infor.current_season="",i.infor.species_id=null,i.infor.species=null,i.infor.start_time=null,e.dbLocalService.updateItem("ponds",i,n)}e.pondService.seasonStart=!1,e.modalController.dismiss(e.form.value),e.router.navigateByUrl("pond/"+e.pondService.pcode+"/history")}else e.modalController.dismiss(e.form.value);e.savingFlag.setResult(!0)}else e.toastService.warning(t.message),e.savingFlag.setResult(!1)},function(){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(a.qu),h.Y36(x.k),h.Y36(g.p),h.Y36(f.sK),h.Y36(s.F0),h.Y36(se.T),h.Y36(xn.r),h.Y36(U.R))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-collect"]],inputs:{harvestTimes:"harvestTimes",seedTimes:"seedTimes",moveTimes:"moveTimes"},decls:105,vars:82,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[3,"formGroup"],[1,"ion-text-center"],[4,"ngIf"],[3,"data","toUpload"],["formControlName","autoCalculator","mode","ios"],["color","primary"],["formControlName","method","required","",3,"placeholder","ionChange"],["value","end"],["value","keep"],["size","8"],["color","primary","position","floating"],["required","","formControlName","size","type","tel","inputmode","decimal","required","",3,"ionInput"],["size","4"],["color","primary","position","floating","required",""],["formControlName","unit",3,"ionChange"],["value","kg"],["value","con"],["size","6"],["position","floating","color","primary"],["formControlName","quantity","type","tel","inputmode","decimal","required","",3,"value","ionInput"],["formControlName","price","type","tel","inputmode","decimal","required","",3,"value","ionChange"],["position","floating"],["formControlName","harvest_cost","type","tel","inputmode","decimal",3,"value","ionChange"],["rows","2","formControlName","note"],["formControlName","buyer",3,"ionChange"],["lines","none"],[4,"ngFor","ngForOf"],["color","success"],["lines","inset",4,"ngIf"],["lines","none",4,"ngIf"],["name","dots"],["formControlName","harvest_ratio","type","tel","inputmode","decimal",3,"ionInput"],["name","business","slot","start"],[1,"ion-text-wrap"],["color","danger","slot","end",3,"click"],["slot","end",3,"click"],["lines","inset"],["formControlName","amounts_payed","type","tel","inputmode","numeric",3,"value","ionFocus","ionChange"],["color","danger"],["formControlName","customer"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.onSave()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content",5),h.TgZ(13,"div",6),h.YNc(14,ai,2,0,"div",7),h.qZA(),h.TgZ(15,"app-image-picker",8),h.NdJ("toUpload",function(e){return t.dataUpload=e}),h.qZA(),h.TgZ(16,"ion-grid"),h.TgZ(17,"ion-item"),h.TgZ(18,"ion-label"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h._UZ(21,"ion-toggle",9),h.qZA(),h.TgZ(22,"ion-item"),h.TgZ(23,"ion-label",10),h._uU(24),h.ALo(25,"translate"),h.qZA(),h.TgZ(26,"ion-select",11),h.NdJ("ionChange",function(e){return t.checkChange("method",e)}),h.ALo(27,"translate"),h.TgZ(28,"ion-select-option",12),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.TgZ(31,"ion-select-option",13),h._uU(32),h.ALo(33,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(34,"ion-row"),h.TgZ(35,"ion-col",14),h.TgZ(36,"ion-item"),h.TgZ(37,"ion-label",15),h._uU(38),h.ALo(39,"translate"),h.qZA(),h.TgZ(40,"ion-input",16),h.NdJ("ionInput",function(e){return t.checkChange("size",e)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(41,"ion-col",17),h.TgZ(42,"ion-item"),h.TgZ(43,"ion-label",18),h._uU(44),h.ALo(45,"translate"),h.qZA(),h.TgZ(46,"ion-select",19),h.NdJ("ionChange",function(e){return t.checkChange("unit",e)}),h.TgZ(47,"ion-select-option",20),h._uU(48),h.ALo(49,"translate"),h.qZA(),h.TgZ(50,"ion-select-option",21),h._uU(51),h.ALo(52,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(53,"ion-row"),h.TgZ(54,"ion-col",22),h.TgZ(55,"ion-item"),h.TgZ(56,"ion-label",23),h._uU(57),h.ALo(58,"translate"),h.qZA(),h.TgZ(59,"ion-input",24),h.NdJ("ionInput",function(e){return t.checkChange("quantity",e)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(60,"ion-col",22),h.TgZ(61,"ion-item"),h.TgZ(62,"ion-label",23),h._uU(63),h.ALo(64,"translate"),h.ALo(65,"translate"),h.qZA(),h.TgZ(66,"ion-input",25),h.NdJ("ionChange",function(e){return t.numberFormatPrice.setValue(e.detail.value),t.setAmountPayed()}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(67,ri,5,3,"ion-item",7),h.TgZ(68,"ion-item"),h.TgZ(69,"ion-label",26),h._uU(70),h.ALo(71,"translate"),h.ALo(72,"translate"),h.qZA(),h.TgZ(73,"ion-input",27),h.NdJ("ionChange",function(e){return t.numberFormatCost.setValue(e.detail.value)}),h.qZA(),h.qZA(),h.TgZ(74,"ion-item"),h.TgZ(75,"ion-label",26),h._uU(76),h.ALo(77,"translate"),h.qZA(),h._UZ(78,"ion-textarea",28),h.qZA(),h.TgZ(79,"ion-item"),h.TgZ(80,"ion-label",26),h._uU(81),h.ALo(82,"translate"),h.qZA(),h.TgZ(83,"ion-input",29),h.NdJ("ionChange",function(){return t.search(t.form.controls.buyer.value)}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(84,"ion-list",30),h.YNc(85,si,10,5,"ion-item",7),h.YNc(86,ci,10,5,"ion-item",31),h.ALo(87,"async"),h.YNc(88,li,4,1,"ion-item",7),h.qZA(),h.TgZ(89,"ion-item",30),h.TgZ(90,"ion-label"),h._uU(91),h.ALo(92,"translate"),h.qZA(),h.TgZ(93,"span"),h.TgZ(94,"ion-text",32),h._uU(95),h.ALo(96,"number"),h.qZA(),h._uU(97),h.ALo(98,"translate"),h.qZA(),h.qZA(),h.YNc(99,ui,5,4,"ion-item",33),h.YNc(100,di,3,0,"ion-item",33),h.YNc(101,gi,5,3,"ion-item",33),h.YNc(102,mi,2,1,"ion-list",34),h.TgZ(103,"div",6),h.YNc(104,hi,2,0,"div",7),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,37,"CROP_MOD.HARVEST")),h.xp6(3),h.Q6J("disabled",(null==t.form?null:t.form.invalid)||"keep"==t.form.value&&(!t.form.value.harvest_ratio||t.form.value.harvest_ratio>100)||t.numberFormatPrice.realValue*t.numberFormatQuantity.realValue<t.numberFormatPayed.realValue),h.xp6(1),h.hij(" ",h.lcZ(11,39,"SAVE")," "),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(2),h.Q6J("ngIf",t.savingFlag.pending),h.xp6(1),h.Q6J("data",t.dataUpload),h.xp6(4),h.Oqu(h.lcZ(20,41,"POND_MOD.AUTO_FOR_DAILY")),h.xp6(5),h.Oqu(h.lcZ(25,43,"CROP_MOD.HARVEST_FORM")),h.xp6(2),h.Q6J("placeholder",h.lcZ(27,45,"SELECT")),h.xp6(3),h.Oqu(h.lcZ(30,47,"CROP_MOD.HARVEST_FULL")),h.xp6(3),h.Oqu(h.lcZ(33,49,"CROP_MOD.HARVEST_PARTIAL")),h.xp6(6),h.Oqu(h.lcZ(39,51,"SIZE")),h.xp6(6),h.Oqu(h.lcZ(45,53,"UNIT")),h.xp6(4),h.hij("",h.lcZ(49,55,"PCS"),"/kg"),h.xp6(3),h.hij("g/",h.lcZ(52,57,"PCS"),""),h.xp6(6),h.hij("",h.lcZ(58,59,"CROP_MOD.HARVEST_QUANTITY")," (kg)"),h.xp6(2),h.Q6J("value",t.numberFormatQuantity.fakeView),h.xp6(4),h.AsE("",h.lcZ(64,61,"PRICE")," (",h.lcZ(65,63,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",t.numberFormatPrice.fakeView),h.xp6(1),h.Q6J("ngIf","keep"==t.form.controls.method.value),h.xp6(3),h.AsE("",h.lcZ(71,65,"CROP_MOD.HARVEST_COST")," (",h.lcZ(72,67,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",t.numberFormatCost.fakeView),h.xp6(3),h.Oqu(h.lcZ(77,69,"NOTE")),h.xp6(5),h.Oqu(h.lcZ(82,71,"CROP_MOD.HARVEST_CUSTOMER")),h.xp6(4),h.Q6J("ngIf",t.buyerSelected),h.xp6(1),h.Q6J("ngForOf",h.lcZ(87,73,t.manufacturer$)),h.xp6(2),h.Q6J("ngIf",t.message),h.xp6(3),h.Oqu(h.lcZ(92,75,"REVENUE")),h.xp6(4),h.Oqu(h.xi3(96,77,t.numberFormatPrice.realValue*t.numberFormatQuantity.realValue,"0.0-0")),h.xp6(2),h.hij(" ",h.lcZ(98,80,"CURRENCY_S"),""),h.xp6(2),h.Q6J("ngIf",t.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",t.numberFormatPrice.realValue*t.numberFormatQuantity.realValue<t.numberFormatPayed.realValue&&t.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",t.settingService.showDebt),h.xp6(1),h.Q6J("ngIf",t.settingService.showDebt),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,a.JL,a.sg,o.O5,qn.k,l.jY,l.Ie,l.Q$,l.ho,l.w,a.JJ,a.u,l.t9,l.QI,a.Q7,l.n0,l.Nd,l.wI,l.pK,l.j9,l.g2,l.q_,o.sg,l.yW,l.PQ],pipes:[f.X$,o.Ov,o.JJ],styles:[""]}),e}(),Zi=function(){return["company_manager","farm_manager","pond_operator","pond_manager"]};function vi(e,t){if(1&e&&h._UZ(0,"ion-icon",9),2&e){var n=h.oxw();h.Q6J("appPermission",h.DdM(2,Zi))("currentPermission",n.pondService.permission)}}function Ai(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",10),h.NdJ("click",function(){return h.CHM(n),h.oxw().removeBlock()}),h.TgZ(1,"ion-button",11),h._UZ(2,"ion-icon",12),h.qZA(),h.qZA()}}var _i=function(){return[]},Ti=function(){return["history"]};function xi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",13),h.TgZ(1,"ion-label"),h._uU(2,"Qu\u1ea3n l\xfd"),h.qZA(),h.TgZ(3,"ion-button",14),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw();return t.enableSort?e.stopPropagation():t.openSeasonCancel()}),h._uU(4," H\u1ee7y v\u1ee5 "),h.qZA(),h.TgZ(5,"ion-button",15),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw();return t.enableSort?e.stopPropagation():t.presentMove()}),h._uU(6," Chuy\u1ec3n \u0111i "),h.qZA(),h.TgZ(7,"ion-button",16),h._uU(8," L\u1ecbch s\u1eed "),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("appPermission",h.DdM(4,Zi))("currentPermission",i.pondService.permission),h.xp6(5),h.Q6J("disabled",0==i.seedTimes.length&&0==i.moveTimes.length),h.xp6(2),h.Q6J("routerLink",i.enableSort?h.DdM(5,_i):h.DdM(6,Ti))}}function qi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"date"),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"span",23),h._uU(6),h.ALo(7,"number"),h.qZA(),h.TgZ(8,"ion-button",24),h.NdJ("click",function(e){var t=h.CHM(n),i=t.$implicit,o=t.index,a=h.oxw(2);return a.enableSort?e.stopPropagation():a.presentSeedEdit(i,o)}),h._UZ(9,"ion-icon",25),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw(2);h.xp6(2),h.hij(" ",h.xi3(3,5,1e3*i.seed_date,h.lcZ(4,8,"FORMAT_DATE_S"))," "),h.xp6(4),h.Oqu(h.xi3(7,10,i.seed_quantity,"1.0-0")),h.xp6(2),h.Q6J("appPermission",h.DdM(13,Zi))("currentPermission",o.pondService.permission)("disabled",!i.id)}}function Oi(e,t){1&e&&h._UZ(0,"ion-icon",28)}function bi(e,t){1&e&&h._UZ(0,"ion-icon",29)}function Di(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.YNc(1,Oi,1,0,"ion-icon",26),h.YNc(2,bi,1,0,"ion-icon",27),h.TgZ(3,"ion-label"),h._uU(4),h.ALo(5,"date"),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"span",23),h._uU(8),h.ALo(9,"number"),h.qZA(),h.qZA()),2&e){var n=t.$implicit,i=h.oxw(3);h.xp6(1),h.Q6J("ngIf",n.from_season_code!=i.pondService.pond.current_season),h.xp6(1),h.Q6J("ngIf",n.from_season_code==i.pondService.pond.current_season),h.xp6(2),h.hij(" ",h.xi3(5,4,1e3*n.add_time,h.lcZ(6,7,"FORMAT_DATE_S"))," "),h.xp6(4),h.Oqu(h.xi3(9,9,n.quantity_individual,"1.0-0"))}}function yi(e,t){if(1&e&&(h.TgZ(0,"ion-list",17),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-label"),h.TgZ(3,"p"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA(),h.YNc(6,Di,10,12,"ion-item",20),h.qZA()),2&e){var n=h.oxw(2);h.xp6(4),h.Oqu(h.lcZ(5,2,"CROP_MOD.MOVE_IN")),h.xp6(2),h.Q6J("ngForOf",n.moveTimes)}}function Si(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"date"),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"span",23),h._uU(6),h.ALo(7,"number"),h.qZA(),h.TgZ(8,"ion-button",24),h.NdJ("click",function(e){var t=h.CHM(n),i=t.$implicit,o=t.index,a=h.oxw(3);return a.enableSort?e.stopPropagation():a.presentHarvestEdit(i,o)}),h._UZ(9,"ion-icon",25),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw(3);h.xp6(2),h.hij(" ",h.xi3(3,5,1e3*i.harvest_date,h.lcZ(4,8,"FORMAT_DATE_S"))," "),h.xp6(4),h.Oqu(h.xi3(7,10,i.harvest_quantity,"1.0-0")),h.xp6(2),h.Q6J("appPermission",h.DdM(13,Zi))("currentPermission",o.pondService.permission)("disabled",!i.id)}}function Ci(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-list",30),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-label"),h.TgZ(3,"p"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.TgZ(6,"ion-button",18),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(2);return t.enableSort?e.stopPropagation():t.presentCollect()}),h._UZ(7,"ion-icon",19),h.qZA(),h.qZA(),h.YNc(8,Si,10,14,"ion-item",20),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(4),h.Oqu(h.lcZ(5,4,"CROP_MOD.HARVEST")),h.xp6(2),h.Q6J("appPermission",h.DdM(6,Zi))("currentPermission",i.pondService.permission),h.xp6(2),h.Q6J("ngForOf",i.harvestTimes)}}function wi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div"),h.TgZ(1,"ion-list",17),h.TgZ(2,"ion-item"),h.TgZ(3,"ion-label"),h.TgZ(4,"p"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",18),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw();return t.enableSort?e.stopPropagation():t.presentSeed()}),h._UZ(8,"ion-icon",19),h.qZA(),h.qZA(),h.YNc(9,qi,10,14,"ion-item",20),h.qZA(),h.YNc(10,yi,7,4,"ion-list",21),h.YNc(11,Ci,9,7,"ion-list",22),h.qZA()}if(2&e){var i=h.oxw();h.xp6(5),h.Oqu(h.lcZ(6,6,"CROP_MOD.CROP_STOCKING")),h.xp6(2),h.Q6J("appPermission",h.DdM(8,Zi))("currentPermission",i.pondService.permission),h.xp6(2),h.Q6J("ngForOf",i.seedTimes),h.xp6(1),h.Q6J("ngIf",i.moveTimes.length>0),h.xp6(1),h.Q6J("ngIf",i.seedTimes.length>0||i.moveTimes.length>0)}}function ki(e,t){if(1&e&&(h.TgZ(0,"p"),h._uU(1),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Oqu(n.message)}}function Ni(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",31),h.qZA())}function Ei(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",32),h.TgZ(1,"ion-button",33),h.NdJ("click",function(){return h.CHM(n),h.oxw().upBlockProperty()}),h._UZ(2,"ion-icon",34),h.qZA(),h.TgZ(3,"ion-button",33),h.NdJ("click",function(){return h.CHM(n),h.oxw().downBlockProperty()}),h._UZ(4,"ion-icon",35),h.qZA(),h.qZA()}}var Mi=function(e){return[e]},Ii=function(){var e=function(){function e(t,n,i,o){r(this,e),this.pondService=t,this.modalController=n,this.translate=i,this.router=o,this.loadingFlag=new p.E,this.message="",this.seedTimes=[],this.moveTimes=[],this.harvestTimes=[],this.eventUp=new h.vpe,this.eventDown=new h.vpe,this.eventRemove=new h.vpe}return c(e,[{key:"ngOnInit",value:function(){this.getData(),console.log(this.pondService.seasonInfo)}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadDependency().subscribe(function(t){console.log(t),0==t.status?e.message=t.error:(e.harvestTimes=t.data.harvest,e.seedTimes=t.data.seed,e.moveTimes=t.data.move),e.loadingFlag.setResult(!0)},function(){e.message=e.translate.instant("ERROR_CONNECT"),e.loadingFlag.setResult(!1)})}},{key:"presentSeed",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Mn});case 2:return(t=e.sent).onDidDismiss().then(function(e){e.data&&("kg"==e.data.unit&&(e.data.seed_quantity=e.data.seed_quantity_individuals),n.seedTimes.push(e.data))}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentSeedEdit",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:Hn,componentProps:{item:e}});case 2:return(i=n.sent).onDidDismiss().then(function(e){e.data&&("kg"==e.data.unit&&(e.data.seed_quantity=e.data.seed_quantity_individuals),o.seedTimes[t]=e.data,o.seedTimes[t].supplier=e.data.seed_supplier,o.seedTimes[t].supplier_id=e.data.seed_supplier_id,o.seedTimes[t].seed_date=e.data.seed_date)}),n.next=6,i.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"presentCollect",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:fi,componentProps:{harvestTimes:this.harvestTimes,seedTimes:this.seedTimes,moveTimes:this.moveTimes}});case 2:return(t=e.sent).onDidDismiss().then(function(e){if(e.data){var t={harvest_date:m().valueOf()/1e3,harvest_quantity:new re.y(e.data.quantity).realValue};n.harvestTimes.push(t)}}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentHarvestEdit",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:oi,componentProps:{item:e}});case 2:return(i=n.sent).onDidDismiss().then(function(e){e.data&&(o.harvestTimes[t].harvest_quantity=new re.y(e.data.harvest_quantity).realValue)}),n.next=6,i.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"openSeasonCancel",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:le});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentMove",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ee,componentProps:{harvestTimes:this.harvestTimes,seedTimes:this.seedTimes,moveTimes:this.moveTimes}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"upBlockProperty",value:function(){this.eventUp.emit(this.index)}},{key:"downBlockProperty",value:function(){this.eventDown.emit(this.index)}},{key:"removeBlock",value:function(){this.eventRemove.emit(this.index)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(g.p),h.Y36(l.IN),h.Y36(f.sK),h.Y36(s.F0))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-info"]],inputs:{enableSort:"enableSort",index:"index"},outputs:{eventUp:"eventUp",eventDown:"eventDown",eventRemove:"eventRemove"},decls:16,vars:15,consts:[["mode","ios",3,"ngClass"],[1,"season",3,"routerLink"],["name","archive-outline",1,"icon-f"],["class","icon-detail","name","chevron-forward-outline",3,"appPermission","currentPermission",4,"ngIf"],["class","btnRemoveBlock",3,"click",4,"ngIf"],["lines","full",3,"appPermission","currentPermission",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center"],["class","ion-float-end",4,"ngIf"],["name","chevron-forward-outline",1,"icon-detail",3,"appPermission","currentPermission"],[1,"btnRemoveBlock",3,"click"],["size","small","color","light"],["name","close"],["lines","full",3,"appPermission","currentPermission"],["slot","end","color","danger","fill","outline",3,"click"],["slot","end","fill","outline",3,"disabled","click"],["slot","end","fill","outline",3,"routerLink"],["lines","none","mode","ios"],["shape","round","fill","clear","size","default","slot","end",3,"appPermission","currentPermission","click"],["name","add-circle-outline","slot","icon-only"],[4,"ngFor","ngForOf"],["lines","none","mode","ios",4,"ngIf"],["lines","none",4,"ngIf"],["slot","end",1,"ion-margin"],["slot","end","shape","round","fill","clear","size","default",3,"appPermission","currentPermission","disabled","click"],["src","assets/icon/edit-24px.svg","slot","icon-only"],["slot","start","name","log-in-outline",4,"ngIf"],["slot","start","name","log-out-outline",4,"ngIf"],["slot","start","name","log-in-outline"],["slot","start","name","log-out-outline"],["lines","none"],["name","dots"],[1,"ion-float-end"],["size","small","color","tertiary",3,"click"],["name","chevron-up-circle-outline"],["name","chevron-down-circle-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card",0),h.TgZ(2,"ion-card-header",1),h.TgZ(3,"ion-card-subtitle"),h._UZ(4,"ion-icon",2),h._uU(5),h.ALo(6,"translate"),h.YNc(7,vi,1,3,"ion-icon",3),h.qZA(),h.YNc(8,Ai,3,0,"ion-buttons",4),h.qZA(),h.YNc(9,xi,9,7,"ion-item",5),h.YNc(10,wi,12,9,"div",6),h.YNc(11,ki,2,1,"p",6),h.TgZ(12,"div",7),h.YNc(13,Ni,2,0,"div",6),h.qZA(),h.TgZ(14,"div"),h.YNc(15,Ei,5,0,"ion-buttons",8),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(1),h.Q6J("ngClass",t.enableSort?"jiggleBlock":""),h.xp6(1),h.Q6J("routerLink",t.enableSort?h.DdM(12,_i):h.VKq(13,Mi,"history/"+t.pondService.pond.current_season)),h.xp6(3),h.hij(" ",h.lcZ(6,10,"CROP")," "),h.xp6(2),h.Q6J("ngIf",!t.enableSort),h.xp6(1),h.Q6J("ngIf",t.enableSort),h.xp6(1),h.Q6J("ngIf",!t.enableSort),h.xp6(1),h.Q6J("ngIf",!t.enableSort),h.xp6(1),h.Q6J("ngIf",t.message),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(2),h.Q6J("ngIf",t.enableSort))},directives:[l.PM,o.mk,l.Zi,l.YI,s.rH,l.tO,l.gu,o.O5,Ot.l,l.Sm,l.YG,l.Ie,l.Q$,l.q_,o.sg,l.PQ],pipes:[f.X$,o.uU,o.JJ],styles:["[_nghost-%COMP%]   .season[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#0078d7,#3dc2ff)}[_nghost-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff!important;padding-left:3em}[_nghost-%COMP%]   ion-icon.icon-f[_ngcontent-%COMP%]{font-size:2em;position:absolute;left:0;top:-.2em}[_nghost-%COMP%]   .jiggleBlock[_ngcontent-%COMP%]{animation:jiggle .4s infinite;-webkit-animation:jiggle .4s infinite;-moz-animation-duration:.4s;-moz-animation-name:jiggle;-moz-animation-iteration-count:infinite;-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg)}@keyframes jiggle{0%{transform:rotate(-1deg)}50%{transform:rotate(1deg)}}@-webkit-keyframes jiggle{0%{-webkit-transform:rotate(-1deg)}50%{-webkit-transform:rotate(1deg)}}[_nghost-%COMP%]   .btnRemoveBlock[_ngcontent-%COMP%]{position:absolute;top:0;right:0}[_nghost-%COMP%]   .disableEvent[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e}(),Ri=i(35498),Ui=i(18409);function Pi(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",10),h.qZA())}function Yi(e,t){if(1&e&&h._UZ(0,"div",11),2&e){var n=h.oxw();h.Q6J("options",n.option)("merge",n.dataUpdate)}}var Li=function(){var e=function(){function e(t,n,i){var o=this;r(this,e),this.modalController=t,this.pondService=n,this.translate=i,this.loadingFlag=new p.E,this.dataRaw=[],this.date=[],this.costFeed=[],this.costBlend=[],this.costEnviro=[],this.costOther=[],this.costAccounting=[],this.costWater=[],this.pageLoaded=0,this.loadDisabled=!1,this.show=!1,this.option={tooltip:{trigger:"axis",formatter:function(e){var t=m(e[0].axisValue).format(o.translate.instant("FORMAT_DATE_MOMENT"))+"<br/>";return e.forEach(function(e){var n=(new Intl.NumberFormat).format(parseInt(e.value));t+=e.marker+e.seriesName+" : "+n+"<br>"}),t},axisPointer:{animation:!0}},legend:{data:[this.translate.instant("POND_MOD.FEED"),this.translate.instant("POND_MOD.FEED_SUPPLEMENT"),this.translate.instant("POND_MOD.CHEMICAL_TREATMENT"),this.translate.instant("POND_MOD.OTHER"),this.translate.instant("POND_MOD.WATER_TREAMENT")]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{data:[],axisLabel:{formatter:function(e){return new Date(e).getDate()}}}],yAxis:[{type:"value"}],series:[{name:this.translate.instant("POND_MOD.FEED"),type:"line",stack:"a",areaStyle:{},data:[]},{name:this.translate.instant("POND_MOD.FEED_SUPPLEMENT"),type:"line",stack:"a",areaStyle:{},data:[]},{name:this.translate.instant("POND_MOD.CHEMICAL_TREATMENT"),type:"line",stack:"a",areaStyle:{},data:[]},{name:this.translate.instant("POND_MOD.OTHER"),type:"line",stack:"a",areaStyle:{},data:[]},{name:this.translate.instant("POND_MOD.COST_ACCOUTING"),type:"line",stack:"a",areaStyle:{},data:[]},{name:this.translate.instant("POND_MOD.WATER_TREAMENT"),type:"line",stack:"a",areaStyle:{},data:[]}]}}return c(e,[{key:"ngOnInit",value:function(){this.getData(0)}},{key:"getData",value:function(e){var t=this;this.loadingFlag.setStart(!0),this.pondService.loadDailyPaging({pageIndex:e,pageSize:30},m().format("YYYY-MM-DD")).subscribe(function(e){e.data?(t.dataRaw=e.data,t.prepareData(t.dataRaw),t.loadingFlag.setResult(!0),t.pageLoaded++,e.data.length<30&&(t.loadDisabled=!0)):t.loadingFlag.setResult(!1)},function(e){t.loadingFlag.setResult(!1),console.log(e)})}},{key:"prepareData",value:function(e){var t=this;e.forEach(function(e){t.costFeed.unshift(e.feed_cost),t.costBlend.unshift(e.cost_blend),t.costEnviro.unshift(e.cost_enviro),t.costOther.unshift(e.cost_other),t.costWater.unshift(e.cost_water),t.costAccounting.unshift(e.amounts),t.date.unshift(e.date)}),this.dataUpdate={xAxis:[{data:this.date}],series:[{data:this.costFeed},{data:this.costBlend},{data:this.costEnviro},{data:this.costOther},{data:this.costAccounting},{data:this.costWater}]}}},{key:"loadMore",value:function(){this.getData(this.pageLoaded)}},{key:"ionViewDidEnter",value:function(){this.show=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-cost"]],inputs:{item:"item"},decls:25,vars:18,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-text-center"],[1,"title","ion-padding"],["color","danger"],[4,"ngIf"],["echarts","",3,"options","merge",4,"ngIf"],["shape","round","size","small",3,"disabled","click"],["name","arrow-back","slot","start"],["name","dots"],["echarts","",3,"options","merge"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.TgZ(10,"h1",4),h.TgZ(11,"ion-text",5),h._uU(12),h.ALo(13,"countNumerPipe"),h.ALo(14,"translate"),h.qZA(),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.qZA(),h.TgZ(17,"div",3),h.YNc(18,Pi,2,0,"div",6),h.qZA(),h.YNc(19,Yi,1,2,"div",7),h.TgZ(20,"div",3),h.TgZ(21,"ion-button",8),h.NdJ("click",function(){return t.loadMore()}),h._UZ(22,"ion-icon",9),h._uU(23),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,7,"POND_MOD.COST_REPORT")),h.xp6(6),h.Oqu(h.xi3(13,9,t.item,h.lcZ(14,12,"FORMAT_COUNTER_KM"))),h.xp6(3),h.hij(" ",h.lcZ(16,14,"CURRENCY_S"),""),h.xp6(3),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(1),h.Q6J("ngIf",t.show),h.xp6(2),h.Q6J("disabled",t.loadDisabled),h.xp6(2),h.hij(" ",h.lcZ(24,16,"MORE")," "))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.yW,o.O5,l.PQ,u._w],pipes:[f.X$,Ui.u],styles:[""]}),e}();function Fi(e,t){1&e&&h._UZ(0,"ion-icon",7)}function Ji(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",8),h.NdJ("click",function(){return h.CHM(n),h.oxw().removeBlock()}),h.TgZ(1,"ion-button",9),h._UZ(2,"ion-icon",10),h.qZA(),h.qZA()}}function Qi(e,t){if(1&e&&(h.TgZ(0,"ion-card-content"),h.TgZ(1,"p"),h._uU(2),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(2),h.Oqu(n.message)}}function Vi(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",15),h.qZA())}function ji(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card-content",11),h.TgZ(2,"span"),h.TgZ(3,"ion-text",12),h._uU(4),h.ALo(5,"countNumerPipe"),h.ALo(6,"translate"),h.qZA(),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.qZA(),h._UZ(9,"div",13),h.YNc(10,Qi,3,1,"ion-card-content",5),h.TgZ(11,"div",14),h.YNc(12,Vi,2,0,"div",5),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(4),h.Oqu(h.xi3(5,6,n.totalCost,h.lcZ(6,9,"FORMAT_COUNTER_KMB"))),h.xp6(3),h.hij(" ",h.lcZ(8,11,"CURRENCY_S")," "),h.xp6(2),h.Q6J("options",n.options)("merge",n.dataUpdate),h.xp6(1),h.Q6J("ngIf",n.message),h.xp6(2),h.Q6J("ngIf",n.loadingFlag.pending)}}function Hi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",16),h.TgZ(1,"ion-button",17),h.NdJ("click",function(){return h.CHM(n),h.oxw().upBlockProperty()}),h._UZ(2,"ion-icon",18),h.qZA(),h.TgZ(3,"ion-button",17),h.NdJ("click",function(){return h.CHM(n),h.oxw().downBlockProperty()}),h._UZ(4,"ion-icon",19),h.qZA(),h.qZA()}}var Gi=function(){var e=function(){function e(t,n,i){r(this,e),this.pondService=t,this.modalController=n,this.translate=i,this.loadingFlag=new p.E,this.eventUp=new h.vpe,this.eventDown=new h.vpe,this.eventRemove=new h.vpe,this.options={tooltip:{trigger:"item",formatter:function(e){return"".concat(e.seriesName,"<br />\n                ").concat(e.name,": ").concat((new Intl.NumberFormat).format(e.data.value)," (").concat(e.percent,"%)<br />")},position:["20%","50%"]},series:[{name:this.translate.instant("POND_MOD.COST"),type:"pie",radius:"55%",data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},this.totalCost=0}return c(e,[{key:"ngOnInit",value:function(){this.loadCost(),console.log(this.enableSort)}},{key:"ngOnChanges",value:function(e){e.enableSort&&(this.enableSort=e.enableSort.currentValue)}},{key:"loadCost",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.getTotalCost().subscribe(function(t){1==t.status?(e.totalCost=t.data.cost.feed+t.data.cost.blend+t.data.cost.enviroment+t.data.cost.seed+t.data.cost.other+ +t.data.cost.record.amounts+t.data.cost.water,e.dataUpdate={series:[{data:[{name:e.translate.instant("POND_MOD.FEED"),value:t.data.cost.feed},{name:e.translate.instant("POND_MOD.FEED_SUPPLEMENT"),value:t.data.cost.blend},{name:e.translate.instant("POND_MOD.CHEMICAL_TREATMENT"),value:t.data.cost.enviroment},{name:e.translate.instant("POND_MOD.SEED"),value:t.data.cost.seed},{name:e.translate.instant("POND_MOD.WATER_TREAMENT"),value:t.data.cost.water},{name:e.translate.instant("POND_MOD.OTHER"),value:t.data.cost.other},{name:e.translate.instant("POND_MOD.COST_ACCOUTING"),value:t.data.cost.record.amounts}]}]}):e.message=t.error,e.loadingFlag.setResult(!0)})}},{key:"presentCost",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Li,componentProps:{item:this.totalCost}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"upBlockProperty",value:function(){this.eventUp.emit(this.index)}},{key:"downBlockProperty",value:function(){this.eventDown.emit(this.index)}},{key:"removeBlock",value:function(){this.eventRemove.emit(this.index)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(g.p),h.Y36(l.IN),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-daily-cost-info"]],inputs:{enableSort:"enableSort",index:"index"},outputs:{eventUp:"eventUp",eventDown:"eventDown",eventRemove:"eventRemove"},features:[h.TTD],decls:12,vars:8,consts:[["mode","ios",3,"ngClass"],[1,"cost",3,"click"],["name","cash-outline",1,"icon-f"],["class","icon-detail","name","chevron-forward-outline",4,"ngIf"],["class","btnRemoveBlock",3,"click",4,"ngIf"],[4,"ngIf"],["class","ion-float-end",4,"ngIf"],["name","chevron-forward-outline",1,"icon-detail"],[1,"btnRemoveBlock",3,"click"],["size","small","color","light"],["name","close"],[1,"ion-text-center","total"],["color","danger",1,"total-number"],["echarts","",3,"options","merge"],[1,"ion-text-center"],["name","dots"],[1,"ion-float-end"],["size","small","color","tertiary",3,"click"],["name","chevron-up-circle-outline"],["name","chevron-down-circle-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card",0),h.TgZ(2,"ion-card-header",1),h.NdJ("click",function(e){return t.enableSort?e.stopPropagation():t.presentCost()}),h.TgZ(3,"ion-card-subtitle"),h._UZ(4,"ion-icon",2),h._uU(5),h.ALo(6,"translate"),h.YNc(7,Fi,1,0,"ion-icon",3),h.qZA(),h.YNc(8,Ji,3,0,"ion-buttons",4),h.qZA(),h.YNc(9,ji,13,13,"div",5),h.TgZ(10,"div"),h.YNc(11,Hi,5,0,"ion-buttons",6),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(1),h.Q6J("ngClass",t.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(6,6,"COST")," "),h.xp6(2),h.Q6J("ngIf",!t.enableSort),h.xp6(1),h.Q6J("ngIf",t.enableSort),h.xp6(1),h.Q6J("ngIf",!t.enableSort),h.xp6(2),h.Q6J("ngIf",t.enableSort))},directives:[l.PM,o.mk,l.Zi,l.tO,l.gu,o.O5,l.Sm,l.YG,l.FN,l.yW,u._w,l.PQ],pipes:[f.X$,Ui.u],styles:["[_nghost-%COMP%]   .cost[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#d13438,#3dc2ff)}[_nghost-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff!important;padding-left:3em}[_nghost-%COMP%]   ion-icon.icon-f[_ngcontent-%COMP%]{font-size:2em;position:absolute;left:0;top:-.2em}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]{margin:1em 0 0}[_nghost-%COMP%]   .total-number[_ngcontent-%COMP%]{font-size:2em;font-weight:bold}[_nghost-%COMP%]   .jiggleBlock[_ngcontent-%COMP%]{animation:jiggle .4s infinite;-webkit-animation:jiggle .4s infinite;-moz-animation-duration:.4s;-moz-animation-name:jiggle;-moz-animation-iteration-count:infinite;-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg)}@keyframes jiggle{0%{transform:rotate(-1deg)}50%{transform:rotate(1deg)}}@-webkit-keyframes jiggle{0%{-webkit-transform:rotate(-1deg)}50%{-webkit-transform:rotate(1deg)}}[_nghost-%COMP%]   .btnRemoveBlock[_ngcontent-%COMP%]{position:absolute;top:0;right:0}[_nghost-%COMP%]   .disableEvent[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e}();function Bi(e,t){1&e&&h._UZ(0,"ion-icon",17)}function zi(e,t){1&e&&h._UZ(0,"ion-icon",18)}var $i=function(){return["company_manager","farm_manager","farm_operation","pond_manager","pond_operator"]};function Wi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",19),h.TgZ(1,"ion-button",3),h.NdJ("click",function(e){return h.CHM(n),h.oxw().presentPopoverMenu(e)}),h._UZ(2,"ion-icon",20),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("appPermission",h.DdM(2,$i))("currentPermission",i.pondService.permission)}}function Xi(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",21),h.NdJ("click",function(){return h.CHM(n),h.oxw().saveProperty()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"POND_MOD.SAVE")," "))}function Ki(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-refresher",22),h.NdJ("ionRefresh",function(e){return h.CHM(n),h.oxw().doRefresh(e)}),h._UZ(1,"ion-refresher-content"),h.qZA()}}function eo(e,t){1&e&&(h.TgZ(0,"div",23),h._UZ(1,"ion-spinner",24),h.qZA())}function to(e,t){if(1&e&&(h.TgZ(0,"ion-card",25),h.TgZ(1,"ion-card-content"),h.TgZ(2,"p"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.AsE("",h.lcZ(4,2,"POND_MOD.LAST_UPDATE")," ",n.lastTimeUpdate.fromNow(),"")}}function no(e,t){1&e&&(h.TgZ(0,"ion-card",26),h.TgZ(1,"ion-card-content"),h.TgZ(2,"p"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,1,"POND_MOD.HAVE_NOT_ENTERED")))}function io(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-chip",33),h.NdJ("click",function(e){return h.CHM(n),h.oxw(3).presentHealthUpdate(e)}),h.TgZ(1,"ion-label"),h._uU(2),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.Q6J("disabled",0==i.id),h.xp6(2),h.Oqu(i.name)}}var oo=function(){return["company_manager","farm_manager","farm_operation","farm_lab","pond_manager","pond_operator"]};function ao(e,t){if(1&e&&(h.TgZ(0,"ion-card",25),h.TgZ(1,"ion-card-header",29),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",30),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.TgZ(6,"ion-card-content",31),h.YNc(7,io,3,2,"ion-chip",32),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(4),h.hij(" ",h.lcZ(5,4,"DISEASE.DISEASE")," "),h.xp6(2),h.Q6J("appPermission",h.DdM(6,oo))("permissionAction",n.pondService.permission),h.xp6(1),h.Q6J("ngForOf",n.disease)}}function ro(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h.TgZ(3,"small"),h._uU(4),h.qZA(),h.qZA(),h.TgZ(5,"h3"),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(4),h.Oqu(n.time),h.xp6(2),h.Oqu(n.message)}}function so(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",34),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).presentAlert()}),h.TgZ(1,"ion-card-header"),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",35),h._uU(4),h.ALo(5,"translate"),h._UZ(6,"ion-icon",36),h.qZA(),h.qZA(),h.TgZ(7,"ion-list",37),h.YNc(8,ro,7,2,"ion-item",38),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(4),h.hij(" ",h.lcZ(5,2,"WARNING")," "),h.xp6(4),h.Q6J("ngForOf",i.alertItems)}}function co(e,t){1&e&&h._UZ(0,"app-pond-lab")}function lo(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h.TgZ(3,"small"),h._uU(4),h.qZA(),h.qZA(),h.TgZ(5,"h3"),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(4),h.Oqu(n.vendor_name),h.xp6(2),h.Oqu(n.message)}}function uo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",39),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).presentSuggest()}),h.TgZ(1,"ion-card-header",40),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",41),h._uU(4),h.ALo(5,"translate"),h._UZ(6,"ion-icon",42),h.qZA(),h.qZA(),h.TgZ(7,"ion-list",43),h.YNc(8,lo,7,2,"ion-item",38),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(4),h.hij(" ",h.lcZ(5,2,"SUGGEST")," "),h.xp6(4),h.Q6J("ngForOf",i.suggestItems)}}function go(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,ao,8,7,"ion-card",11),h.YNc(2,so,9,4,"ion-card",27),h.YNc(3,co,1,0,"app-pond-lab",13),h.YNc(4,uo,9,4,"ion-card",28),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",(1==(null==n.pondService.pond?null:n.pondService.pond.warning)||n.disease.length>0)&&"pond"==n.pondService.pond.type),h.xp6(1),h.Q6J("ngIf",(null==n.alertItems?null:n.alertItems.length)>0&&"pond"==n.pondService.pond.type),h.xp6(1),h.Q6J("ngIf","pond"==n.pondService.pond.type),h.xp6(1),h.Q6J("ngIf",(null==n.suggestItems?null:n.suggestItems.length)>0&&"pond"==n.pondService.pond.type)}}function po(e,t){1&e&&h._UZ(0,"ion-icon",36)}function mo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function ho(e,t){1&e&&(h.TgZ(0,"div",61),h._UZ(1,"ion-spinner",24),h.qZA())}function fo(e,t){1&e&&(h.TgZ(0,"div"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"WEATHER_MOD.NO_WEATHER")," "))}function Zo(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"div"),h.TgZ(2,"p"),h._uU(3),h.ALo(4,"translate"),h.TgZ(5,"ion-text",62),h._uU(6),h.TgZ(7,"sup"),h.TgZ(8,"small"),h._uU(9,"o"),h.qZA(),h.qZA(),h._uU(10,"C"),h.qZA(),h._uU(11),h.ALo(12,"translate"),h.TgZ(13,"ion-text",62),h._uU(14),h.TgZ(15,"sup"),h.TgZ(16,"small"),h._uU(17,"o"),h.qZA(),h.qZA(),h._uU(18,"C"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"div"),h.TgZ(20,"p"),h._uU(21),h.ALo(22,"translate"),h.ALo(23,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw(5);h.xp6(3),h.hij("",h.lcZ(4,9,"WEATHER_MOD.WEATHER_TODAY")," "),h.xp6(2),h.Q6J("color",n.weatherData.temp>28?"danger":"success"),h.xp6(1),h.hij(" ",n.weatherData.temp,""),h.xp6(5),h.hij(", ",h.lcZ(12,11,"WEATHER_MOD.WEATHER_TODAY_MAX")," "),h.xp6(2),h.Q6J("color",n.weatherData.temp_max>28?"danger":"success"),h.xp6(1),h.hij(" ",n.weatherData.temp_max," "),h.xp6(7),h.lnq(" ",h.lcZ(22,13,"WEATHER_MOD.WEATHER_TODAY_MES")," ",n.weatherData.weather," ",h.lcZ(23,15,"WEATHER_MOD.WEATHER_TODAY_MES_END")," ")}}function vo(e,t){if(1&e&&(h.TgZ(0,"ion-card-content",59),h.YNc(1,ho,2,0,"div",60),h.YNc(2,fo,3,3,"div",13),h.YNc(3,Zo,24,17,"div",13),h.qZA()),2&e){var n=h.oxw(4);h.xp6(1),h.Q6J("ngIf",n.loadingWeatherFlag.pending),h.xp6(1),h.Q6J("ngIf",!n.weatherData),h.xp6(1),h.Q6J("ngIf",n.weatherData)}}function Ao(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function _o(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",49),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentWeatherPredict()}),h.TgZ(1,"ion-card-header",50),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",51),h._uU(4),h.ALo(5,"translate"),h.YNc(6,po,1,0,"ion-icon",52),h.qZA(),h.YNc(7,mo,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,vo,4,3,"ion-card-content",54),h.TgZ(9,"div"),h.YNc(10,Ao,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,6,"WEATHER_MOD.TITLE")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function To(e,t){1&e&&h._UZ(0,"ion-icon",36)}function xo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function qo(e,t){1&e&&(h.TgZ(0,"ion-card-content",61),h.TgZ(1,"p",72),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.qZA()),2&e&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"PHOTO_MOD.NOT_UPDATE_PHOTO")))}function Oo(e,t){if(1&e&&(h.TgZ(0,"div",73),h._UZ(1,"img",74),h.qZA()),2&e){var n=h.oxw(5);h.xp6(1),h.Q6J("src",n.SITE_IMAGE+(null==n.todayItem?null:n.todayItem.image),h.LSH)}}function bo(e,t){if(1&e&&(h.TgZ(0,"ion-card-content"),h.TgZ(1,"p"),h._uU(2),h.qZA(),h.qZA()),2&e){var n=h.oxw(5);h.xp6(2),h.Oqu(n.todayItem.description)}}function Do(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,qo,4,3,"ion-card-content",60),h.YNc(2,Oo,2,1,"div",71),h.YNc(3,bo,3,1,"ion-card-content",13),h.qZA()),2&e){var n=h.oxw(4);h.xp6(1),h.Q6J("ngIf",!(null!=n.todayItem&&n.todayItem.image||n.enableSort)),h.xp6(1),h.Q6J("ngIf",null==n.todayItem?null:n.todayItem.image),h.xp6(1),h.Q6J("ngIf",null==n.todayItem?null:n.todayItem.description)}}function yo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",75),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(4);return t.enableSort?e.stopPropagation():t.openUploadImage()}),h._UZ(1,"ion-icon",76),h.qZA()}if(2&e){var i=h.oxw(4);h.Q6J("appPermission",h.DdM(2,oo))("currentPermission",i.pondService.permission)}}function So(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function Co(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",67),h.TgZ(1,"ion-card-header",68),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.openDailyPhoto()}),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",69),h._uU(4),h.ALo(5,"translate"),h.YNc(6,To,1,0,"ion-icon",52),h.qZA(),h.YNc(7,xo,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,Do,4,3,"div",13),h.TgZ(9,"div"),h.YNc(10,yo,2,3,"ion-button",70),h.YNc(11,So,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,7,"PHOTO_MOD.DAILY_PHOTO")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort)}}function wo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function ko(e,t){1&e&&(h.TgZ(0,"ion-row"),h._UZ(1,"ion-progress-bar",86),h.qZA())}var No=function(e){return{color:e}};function Eo(e,t){if(1&e&&(h.TgZ(0,"div",89),h.TgZ(1,"div",90),h.TgZ(2,"span",91),h._uU(3),h.qZA(),h.qZA(),h.TgZ(4,"div",90),h.TgZ(5,"b",92),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit,i=h.oxw().$implicit,o=h.oxw(5);h.xp6(1),h.Q6J("ngStyle",h.VKq(4,No,o.calculateColor(null==i.value.indexs[n]||null==i.value.indexs[n].ui?null:i.value.indexs[n].ui.color))),h.xp6(2),h.hij(" ",null==i.value.indexs[n].ui?null:i.value.indexs[n].ui.label," "),h.xp6(1),h.Q6J("ngStyle",h.VKq(6,No,o.calculateColor(null==i.value.indexs[n]||null==i.value.indexs[n].ui?null:i.value.indexs[n].ui.color))),h.xp6(2),h.Oqu(i.value.indexs[n].last.value)}}function Mo(e,t){if(1&e&&(h.TgZ(0,"ion-col",87),h.YNc(1,Eo,7,8,"div",88),h.qZA()),2&e){var n=t.$implicit,i=h.oxw().$implicit;h.xp6(1),h.Q6J("ngIf",i.value.indexs[n].ui)}}function Io(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",3),h.NdJ("click",function(e){var t=h.CHM(n).$implicit,i=h.oxw(5);return i.enableSort?e.stopPropagation():i.presentPubDetail(t.value)}),h.TgZ(1,"ion-item"),h._UZ(2,"ion-icon",82),h.TgZ(3,"label"),h._uU(4),h.qZA(),h._UZ(5,"ion-icon",83),h.qZA(),h.TgZ(6,"ion-item"),h.TgZ(7,"small"),h._uU(8),h.qZA(),h.qZA(),h.TgZ(9,"ion-grid"),h.YNc(10,ko,2,0,"ion-row",13),h.TgZ(11,"ion-row",84),h.YNc(12,Mo,2,1,"ion-col",85),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw(5);h.xp6(4),h.Oqu(i.value.name),h.xp6(4),h.Oqu(o.getMomentTime(i.value.last)),h.xp6(2),h.Q6J("ngIf",o.loadingDevice.pending),h.xp6(2),h.Q6J("ngForOf",i.value.listIndexLabel)}}function Ro(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",93),h.NdJ("click",function(e){var t=h.CHM(n).$implicit,i=h.oxw(5);return i.enableSort?e.stopPropagation():i.presentSubDetail(t.value)}),h._UZ(1,"ion-icon",94),h.TgZ(2,"label"),h._uU(3),h.qZA(),h._UZ(4,"ion-icon",83),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(3),h.Oqu(i.value.name)}}function Uo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",93),h.NdJ("click",function(e){var t=h.CHM(n).$implicit,i=h.oxw(5);return i.enableSort?e.stopPropagation():i.presentFeedDetail(t.key)}),h._UZ(1,"ion-icon",95),h.TgZ(2,"label"),h._uU(3),h.qZA(),h._UZ(4,"ion-icon",83),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(3),h.Oqu(i.value.name)}}function Po(e,t){if(1&e&&(h.TgZ(0,"ion-list",43),h.YNc(1,Io,13,4,"div",80),h.ALo(2,"keyvalue"),h.YNc(3,Ro,5,1,"ion-item",81),h.ALo(4,"keyvalue"),h.YNc(5,Uo,5,1,"ion-item",81),h.ALo(6,"keyvalue"),h.qZA()),2&e){var n=h.oxw(4);h.xp6(1),h.Q6J("ngForOf",h.lcZ(2,3,n.pubs)),h.xp6(2),h.Q6J("ngForOf",h.lcZ(4,5,n.subs)),h.xp6(2),h.Q6J("ngForOf",h.lcZ(6,7,n.feedings))}}function Yo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function Lo(e,t){if(1&e&&(h.TgZ(0,"ion-card",67),h.TgZ(1,"ion-card-header",77),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",78),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.YNc(6,wo,3,0,"ion-buttons",53),h.qZA(),h.YNc(7,Po,7,9,"ion-list",79),h.TgZ(8,"div"),h.YNc(9,Yo,5,0,"ion-buttons",55),h.qZA(),h.qZA()),2&e){var n=h.oxw(3);h.Q6J("ngClass",n.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,5,"DEVICE")," "),h.xp6(2),h.Q6J("ngIf",n.enableSort),h.xp6(1),h.Q6J("ngIf",!n.enableSort),h.xp6(2),h.Q6J("ngIf",n.enableSort)}}function Fo(e,t){1&e&&h._UZ(0,"ion-icon",36)}function Jo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function Qo(e,t){if(1&e&&(h.TgZ(0,"ion-list",37),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-label"),h.TgZ(3,"h3"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.TgZ(6,"span",99),h._uU(7),h.ALo(8,"number"),h.TgZ(9,"small"),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-item"),h.TgZ(13,"ion-label"),h.TgZ(14,"h3"),h._uU(15),h.ALo(16,"translate"),h.TgZ(17,"small"),h._uU(18),h.ALo(19,"number"),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(21,"span",99),h._uU(22),h.ALo(23,"number"),h.TgZ(24,"small"),h._uU(25,"g"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(26,"ion-item"),h.TgZ(27,"ion-label"),h.TgZ(28,"h3"),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.qZA(),h.TgZ(31,"span",99),h._uU(32),h.TgZ(33,"small"),h._uU(34),h.ALo(35,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(36,"ion-item"),h.TgZ(37,"ion-label"),h.TgZ(38,"h3"),h._uU(39),h.ALo(40,"translate"),h.qZA(),h.qZA(),h.TgZ(41,"span",99),h._uU(42),h.ALo(43,"number"),h.TgZ(44,"small"),h._uU(45),h.ALo(46,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(47,"ion-item"),h.TgZ(48,"ion-label"),h.TgZ(49,"h3"),h._uU(50),h.ALo(51,"translate"),h.qZA(),h.qZA(),h.TgZ(52,"span",99),h._uU(53),h.qZA(),h.qZA(),h.TgZ(54,"ion-item"),h.TgZ(55,"ion-label"),h.TgZ(56,"h3"),h._uU(57,"FCR"),h.qZA(),h.qZA(),h.TgZ(58,"span",99),h._uU(59),h.ALo(60,"number"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw(4);h.xp6(4),h.Oqu(h.lcZ(5,16,"POND_MOD.OLD")),h.xp6(3),h.hij("",h.xi3(8,18,n.estimate.old,"0.0-1")," "),h.xp6(3),h.Oqu(h.lcZ(11,21,"POND_MOD.DAY")),h.xp6(5),h.hij("",h.lcZ(16,23,"POND_MOD.SIZE")," "),h.xp6(3),h.AsE("(",h.xi3(19,25,1e3/n.estimate.weight,"1.0-1")," ",h.lcZ(20,28,"PCS"),"/kg)"),h.xp6(4),h.hij("",h.xi3(23,30,n.estimate.weight,"1.0-1")," "),h.xp6(7),h.Oqu(h.lcZ(30,33,"POND_MOD.NUMBER_OF_ANIMALS")),h.xp6(3),h.hij("",n.estimate.quantity_pcs," "),h.xp6(2),h.Oqu(h.lcZ(35,35,"PCS")),h.xp6(5),h.Oqu(h.lcZ(40,37,"POND_MOD.QUANTITY")),h.xp6(3),h.hij("",h.xi3(43,39,n.estimate.quantity/1e3,"1.0-2")," "),h.xp6(3),h.Oqu(h.lcZ(46,42,"POND_MOD.TON")),h.xp6(5),h.Oqu(h.lcZ(51,44,"POND_MOD.FEED")),h.xp6(3),h.hij("",n.estimate.feed," "),h.xp6(6),h.Oqu(h.xi3(60,46,n.estimate.FCR,"1.0-2"))}}function Vo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function jo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",49),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentEstimate()}),h.TgZ(1,"ion-card-header",96),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",97),h._uU(4),h.ALo(5,"translate"),h.YNc(6,Fo,1,0,"ion-icon",52),h.qZA(),h.YNc(7,Jo,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,Qo,61,49,"ion-list",98),h.TgZ(9,"div"),h.YNc(10,Vo,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,6,"POND_MOD.ESTIMATE")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function Ho(e,t){1&e&&h._UZ(0,"ion-icon",36)}function Go(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function Bo(e,t){1&e&&h._UZ(0,"ion-icon",110)}function zo(e,t){if(1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(1),h.Oqu(h.xi3(2,1,n.values[0],"1.0-1"))}}var $o=function(e){return{"border-color":e}},Wo=function(){return["company_manager","farm_manager","farm_operation","farm_lab","pond_operator","pond_manager"]};function Xo(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",106),h.TgZ(1,"div",107),h.NdJ("click",function(e){var t=h.CHM(n).$implicit,i=h.oxw(5);return i.enableSort?e.stopPropagation():i.presentParameterUpdate(e,t)}),h.TgZ(2,"div",108),h.YNc(3,Bo,1,0,"ion-icon",109),h.YNc(4,zo,3,4,"span",13),h.qZA(),h.qZA(),h.TgZ(5,"div",90),h.TgZ(6,"small"),h.TgZ(7,"b"),h._uU(8),h.ALo(9,"translate"),h.ALo(10,"uppercase"),h.qZA(),h.qZA(),h.qZA(),h._UZ(11,"ion-ripple-effect"),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw(5);h.Q6J("ngStyle",h.VKq(12,$o,i.colorStr)),h.xp6(1),h.Q6J("appPermission",h.DdM(14,Wo))("permissionAction",o.pondService.permission),h.xp6(1),h.Q6J("ngStyle",h.VKq(15,No,i.colorStr)),h.xp6(1),h.Q6J("ngIf",!i.values[0]||0==i.values[0]),h.xp6(1),h.Q6J("ngIf",i.values[0]&&0!=i.values[0]),h.xp6(1),h.Q6J("ngStyle",h.VKq(17,No,i.colorStr)),h.xp6(3),h.Oqu(h.lcZ(9,8,h.lcZ(10,10,"POND_MOD.PARAM."+i.name)))}}function Ko(e,t){if(1&e&&(h.TgZ(0,"div",104),h.YNc(1,Xo,12,19,"div",105),h.qZA()),2&e){var n=h.oxw(4);h.xp6(1),h.Q6J("ngForOf",n.pondService.trackingObjects)}}function ea(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",111),h.TgZ(1,"ion-button",112),h.NdJ("click",function(){return h.CHM(n),h.oxw(4).presentAlertParamsConfig()}),h._UZ(2,"ion-icon",113),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(4);h.xp6(1),h.Q6J("appPermission",h.DdM(5,oo))("currentPermission",i.pondService.permission),h.xp6(2),h.hij(" ",h.lcZ(4,3,"SETTINGS")," ")}}function ta(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function na(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",67),h.TgZ(1,"ion-card-header",100),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentParameter()}),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",101),h._uU(4),h.ALo(5,"translate"),h.YNc(6,Ho,1,0,"ion-icon",52),h.qZA(),h.YNc(7,Go,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,Ko,2,1,"div",102),h.YNc(9,ea,5,6,"div",103),h.TgZ(10,"div"),h.YNc(11,ta,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,7,"POND_MOD.ENVIROMENT")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function ia(e,t){1&e&&h._UZ(0,"ion-icon",36)}function oa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function aa(e,t){1&e&&h._UZ(0,"ion-icon",110)}function ra(e,t){if(1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"number"),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(1),h.Oqu(h.xi3(2,1,n.quantity,"1.0-1"))}}function sa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",118),h.TgZ(1,"div",107),h.NdJ("click",function(e){var t=h.CHM(n).index,i=h.oxw(5);return i.enableSort?e.stopPropagation():i.presentFeedUpdate(e,t)}),h.TgZ(2,"div",92),h.YNc(3,aa,1,0,"ion-icon",109),h.YNc(4,ra,3,4,"span",13),h.qZA(),h.qZA(),h.TgZ(5,"div"),h.TgZ(6,"small"),h.TgZ(7,"b"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.qZA(),h._UZ(10,"ion-ripple-effect"),h.qZA()}if(2&e){var i=t.$implicit,o=t.index,a=h.oxw(5);h.xp6(1),h.Q6J("appPermission",h.DdM(8,Wo))("permissionAction",a.pondService.permission),h.xp6(2),h.Q6J("ngIf",!i.quantity||0==i.quantity),h.xp6(1),h.Q6J("ngIf",i.quantity&&0!=i.quantity),h.xp6(4),h.AsE("",h.lcZ(9,6,"POND_MOD.REPAST")," ",o+1,"")}}function ca(e,t){if(1&e&&(h.TgZ(0,"div",104),h.YNc(1,sa,11,9,"div",117),h.qZA()),2&e){var n=h.oxw(4);h.xp6(1),h.Q6J("ngForOf",n.feed)}}function la(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",111),h.TgZ(1,"ion-button",112),h.NdJ("click",function(){return h.CHM(n),h.oxw(4).presentAlertFeedConfig()}),h._UZ(2,"ion-icon",113),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(4);h.xp6(1),h.Q6J("appPermission",h.DdM(5,oo))("currentPermission",i.pondService.permission),h.xp6(2),h.hij(" ",h.lcZ(4,3,"SETTINGS")," ")}}function ua(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function da(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",67),h.TgZ(1,"ion-card-header",114),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentFeed()}),h.TgZ(2,"ion-card-subtitle"),h.TgZ(3,"span"),h._UZ(4,"ion-icon",115),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"span"),h.TgZ(8,"span",116),h._uU(9),h.ALo(10,"uppercase"),h.ALo(11,"number"),h.qZA(),h.YNc(12,ia,1,0,"ion-icon",52),h.qZA(),h.qZA(),h.YNc(13,oa,3,0,"ion-buttons",53),h.qZA(),h.YNc(14,ca,2,1,"div",102),h.YNc(15,la,5,6,"div",103),h.TgZ(16,"div"),h.YNc(17,ua,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(5),h.hij(" ",h.lcZ(6,8,"POND_MOD.FEED")," "),h.xp6(4),h.hij("",h.lcZ(10,10,h.xi3(11,12,i.totalFeed,"1.0-1"))," kg"),h.xp6(3),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function ga(e,t){1&e&&h._UZ(0,"ion-icon",36)}function pa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function ma(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",123),h.TgZ(1,"div",107),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(5);return t.enableSort?e.stopPropagation():t.presentEnviromentUpdate(e)}),h.TgZ(2,"div",92),h.TgZ(3,"span"),h._uU(4),h.ALo(5,"number"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(6,"div"),h.TgZ(7,"small"),h.TgZ(8,"b"),h._uU(9),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw(5);h.xp6(1),h.Q6J("appPermission",h.DdM(7,Wo))("permissionAction",o.pondService.permission),h.xp6(3),h.Oqu(h.xi3(5,4,i.quantity,"1.0-1")),h.xp6(5),h.Oqu(i.product_name)}}function ha(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",124),h.TgZ(1,"div",107),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(5);return t.enableSort?e.stopPropagation():t.presentEnviromentUpdate(e)}),h.TgZ(2,"div",92),h._UZ(3,"ion-icon",110),h.qZA(),h.qZA(),h.TgZ(4,"div"),h.TgZ(5,"small"),h.TgZ(6,"b"),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.qZA(),h.qZA(),h._UZ(9,"ion-ripple-effect"),h.qZA()}if(2&e){var i=h.oxw(5);h.xp6(1),h.Q6J("appPermission",h.DdM(5,Wo))("permissionAction",i.pondService.permission),h.xp6(6),h.hij(" ",h.lcZ(8,3,"POND_MOD.NO_ITEM"),"")}}function fa(e,t){if(1&e&&(h.TgZ(0,"div",104),h.YNc(1,ma,10,8,"div",121),h.YNc(2,ha,10,6,"div",122),h.qZA()),2&e){var n=h.oxw(4);h.xp6(1),h.Q6J("ngForOf",null==n.todayItem?null:n.todayItem.enviroment),h.xp6(1),h.Q6J("ngIf",!n.todayItem||!n.todayItem.enviroment||0==(null==n.todayItem.enviroment?null:n.todayItem.enviroment.length))}}function Za(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function va(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",67),h.TgZ(1,"ion-card-header",119),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentEnviroment()}),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",120),h._uU(4),h.ALo(5,"translate"),h.YNc(6,ga,1,0,"ion-icon",52),h.qZA(),h.YNc(7,pa,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,fa,3,2,"div",102),h.TgZ(9,"div"),h.YNc(10,Za,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,6,"POND_MOD.CHEMICAL_TREATMENT")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function Aa(e,t){1&e&&h._UZ(0,"ion-icon",36)}function _a(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function Ta(e,t){if(1&e&&(h.TgZ(0,"ion-grid"),h.TgZ(1,"ion-row",84),h.TgZ(2,"ion-col",127),h.TgZ(3,"p"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"ion-label",128),h._uU(7),h.ALo(8,"number"),h.qZA(),h.qZA(),h.TgZ(9,"ion-col",127),h.TgZ(10,"p"),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.TgZ(13,"ion-label",129),h._uU(14),h.ALo(15,"number"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw(4);h.xp6(4),h.hij(" ",h.lcZ(5,4,"WEIGHT")," "),h.xp6(3),h.hij(" ",h.xi3(8,6,null==n.todayItem?null:n.todayItem.weight,"1.0-1")," g "),h.xp6(4),h.hij(" ",h.lcZ(12,9,"POND_MOD.LOSS")," "),h.xp6(3),h.hij(" ",h.xi3(15,11,(null==n.todayItem?null:n.todayItem.loss)*(null==n.todayItem?null:n.todayItem.weight)/1e3,"1.0-1")," kg ")}}function xa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-list",43),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-label",130),h._uU(3),h.ALo(4,"translate"),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",131),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(4);return t.enableSort?e.stopPropagation():t.presentHealthUpdate(e)}),h._UZ(8,"ion-icon",76),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(4);h.xp6(3),h.hij(" ",h.lcZ(4,4,"POND_MOD.DESEASE")," "),h.xp6(3),h.Oqu(null==i.todayItem?null:i.todayItem.note_health),h.xp6(1),h.Q6J("appPermission",h.DdM(6,oo))("currentPermission",i.pondService.permission)}}function qa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function Oa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",49),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentHealth()}),h.TgZ(1,"ion-card-header",125),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",126),h._uU(4),h.ALo(5,"translate"),h.YNc(6,Aa,1,0,"ion-icon",52),h.qZA(),h.YNc(7,_a,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,Ta,16,14,"ion-grid",13),h.YNc(9,xa,9,7,"ion-list",79),h.TgZ(10,"div"),h.YNc(11,qa,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,7,"POND_MOD.HEALTH")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function ba(e,t){1&e&&h._UZ(0,"ion-icon",36)}function Da(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",56),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).removeBlock(e)}),h.TgZ(1,"ion-button",57),h._UZ(2,"ion-icon",58),h.qZA(),h.qZA()}}function ya(e,t){if(1&e&&(h.TgZ(0,"ion-grid",135),h.TgZ(1,"ion-row",84),h.TgZ(2,"ion-col",127),h.TgZ(3,"p"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"ion-label",128),h._uU(7),h.ALo(8,"number"),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.TgZ(10,"ion-col",127),h.TgZ(11,"p"),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.TgZ(14,"ion-label",136),h._uU(15),h.ALo(16,"number"),h.ALo(17,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw(4);h.Q6J("appPermission",h.DdM(22,oo))("currentPermission",n.pondService.permission),h.xp6(4),h.hij(" ",h.lcZ(5,8,"POND_MOD.OTHER_INCOME")," "),h.xp6(3),h.AsE(" ",h.xi3(8,10,null==n.todayItem?null:n.todayItem.income,"1.0-1")," ",h.lcZ(9,13,"CURRENCY_S")," "),h.xp6(5),h.hij(" ",h.lcZ(13,15,"POND_MOD.OTHER_EXPENSE")," "),h.xp6(3),h.AsE(" ",h.xi3(16,17,null==n.todayItem?null:n.todayItem.cost_other,"1.0-1")," ",h.lcZ(17,20,"CURRENCY_S")," ")}}function Sa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-list",43),h.TgZ(1,"ion-item",135),h.TgZ(2,"ion-label",130),h._uU(3),h.ALo(4,"translate"),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"ion-button",137),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(4);return t.enableSort?e.stopPropagation():t.presentNoteUpdate(e)}),h._UZ(8,"ion-icon",76),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(4);h.xp6(1),h.Q6J("appPermission",h.DdM(6,oo))("currentPermission",i.pondService.permission),h.xp6(2),h.hij(" ",h.lcZ(4,4,"NOTE")," "),h.xp6(3),h.Oqu(null==i.todayItem?null:i.todayItem.note_general)}}function Ca(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-buttons",63),h.TgZ(1,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).upBlockProperty(e)}),h._UZ(2,"ion-icon",65),h.qZA(),h.TgZ(3,"ion-button",64),h.NdJ("click",function(){h.CHM(n);var e=h.oxw(2).index;return h.oxw(2).downBlockProperty(e)}),h._UZ(4,"ion-icon",66),h.qZA(),h.qZA()}}function wa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-card",49),h.NdJ("click",function(e){h.CHM(n);var t=h.oxw(3);return t.enableSort?e.stopPropagation():t.presentNote()}),h.TgZ(1,"ion-card-header",132),h.TgZ(2,"ion-card-subtitle"),h._UZ(3,"ion-icon",133),h._uU(4),h.ALo(5,"translate"),h.YNc(6,ba,1,0,"ion-icon",52),h.qZA(),h.YNc(7,Da,3,0,"ion-buttons",53),h.qZA(),h.YNc(8,ya,18,23,"ion-grid",134),h.YNc(9,Sa,9,7,"ion-list",79),h.TgZ(10,"div"),h.YNc(11,Ca,5,0,"ion-buttons",55),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(3);h.Q6J("ngClass",i.enableSort?"jiggleBlock":""),h.xp6(4),h.hij(" ",h.lcZ(5,7,"POND_MOD.NOTE")," "),h.xp6(2),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(1),h.Q6J("ngIf",!i.enableSort),h.xp6(2),h.Q6J("ngIf",i.enableSort)}}function ka(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"app-pond-procedure",138),h.NdJ("eventUp",function(e){return h.CHM(n),h.oxw(3).upBlockProperty(e)})("eventDown",function(e){return h.CHM(n),h.oxw(3).downBlockProperty(e)})("eventRemove",function(e){return h.CHM(n),h.oxw(3).removeBlock(e)}),h.qZA()}if(2&e){var i=h.oxw().index,o=h.oxw(2);h.Q6J("enableSort",o.enableSort)("index",i)}}function Na(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"app-pond-todo-info",138),h.NdJ("eventUp",function(e){return h.CHM(n),h.oxw(3).upBlockProperty(e)})("eventDown",function(e){return h.CHM(n),h.oxw(3).downBlockProperty(e)})("eventRemove",function(e){return h.CHM(n),h.oxw(3).removeBlock(e)}),h.qZA()}if(2&e){var i=h.oxw().index,o=h.oxw(2);h.Q6J("enableSort",o.enableSort)("index",i)}}function Ea(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"app-season-info",138),h.NdJ("eventUp",function(e){return h.CHM(n),h.oxw(3).upBlockProperty(e)})("eventDown",function(e){return h.CHM(n),h.oxw(3).downBlockProperty(e)})("eventRemove",function(e){return h.CHM(n),h.oxw(3).removeBlock(e)}),h.qZA()}if(2&e){var i=h.oxw().index,o=h.oxw(2);h.Q6J("enableSort",o.enableSort)("index",i)}}function Ma(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"app-treatment",138),h.NdJ("eventUp",function(e){return h.CHM(n),h.oxw(3).upBlockProperty(e)})("eventDown",function(e){return h.CHM(n),h.oxw(3).downBlockProperty(e)})("eventRemove",function(e){return h.CHM(n),h.oxw(3).removeBlock(e)}),h.qZA()}if(2&e){var i=h.oxw().index,o=h.oxw(2);h.Q6J("enableSort",o.enableSort)("index",i)}}var Ia=function(){return["company_manager","farm_manager","farm_operation","keeper_manager","pond_operator"]};function Ra(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"app-daily-cost-info",139),h.NdJ("eventUp",function(e){return h.CHM(n),h.oxw(3).upBlockProperty(e)})("eventDown",function(e){return h.CHM(n),h.oxw(3).downBlockProperty(e)})("eventRemove",function(e){return h.CHM(n),h.oxw(3).removeBlock(e)}),h.qZA()}if(2&e){var i=h.oxw().index,o=h.oxw(2);h.Q6J("appPermission",h.DdM(4,Ia))("currentPermission",o.pondService.permission)("enableSort",o.enableSort)("index",i)}}function Ua(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,_o,11,8,"ion-card",45),h.YNc(2,Co,12,9,"ion-card",46),h.YNc(3,Lo,10,7,"ion-card",46),h.YNc(4,jo,11,8,"ion-card",45),h.YNc(5,na,12,9,"ion-card",46),h.YNc(6,da,18,15,"ion-card",46),h.YNc(7,va,11,8,"ion-card",46),h.YNc(8,Oa,12,9,"ion-card",45),h.YNc(9,wa,12,9,"ion-card",45),h.YNc(10,ka,1,2,"app-pond-procedure",47),h.YNc(11,Na,1,2,"app-pond-todo-info",47),h.YNc(12,Ea,1,2,"app-season-info",47),h.YNc(13,Ma,1,2,"app-treatment",47),h.YNc(14,Ra,1,5,"app-daily-cost-info",48),h.qZA()),2&e){var n=t.$implicit,i=h.oxw(2);h.xp6(1),h.Q6J("ngIf","weather"==n),h.xp6(1),h.Q6J("ngIf","photo"==n),h.xp6(1),h.Q6J("ngIf",i.showDevice&&"device"==n),h.xp6(1),h.Q6J("ngIf",i.estimate&&"estimate"==n),h.xp6(1),h.Q6J("ngIf",(null==i.pondService.trackingObjects?null:i.pondService.trackingObjects.length)&&"param"==n),h.xp6(1),h.Q6J("ngIf","feed"==n),h.xp6(1),h.Q6J("ngIf","enviroment"==n),h.xp6(1),h.Q6J("ngIf","health"==n),h.xp6(1),h.Q6J("ngIf","note"==n),h.xp6(1),h.Q6J("ngIf","procedure"==n),h.xp6(1),h.Q6J("ngIf","todo"==n),h.xp6(1),h.Q6J("ngIf","season"==n),h.xp6(1),h.Q6J("ngIf","water_treatment"==n),h.xp6(1),h.Q6J("ngIf","cost"==n)}}var Pa=function(e){return{disabled:e,fallbackOnBody:!0,easing:"cubic-bezier(1, 0, 0, 1)"}};function Ya(e,t){if(1&e&&(h.TgZ(0,"div",44),h.YNc(1,Ua,15,14,"div",38),h.qZA()),2&e){var n=h.oxw();h.Q6J("sortablejs",n.propertyBlock)("sortablejsOptions",h.VKq(3,Pa,!n.enableSort)),h.xp6(1),h.Q6J("ngForOf",n.propertyBlock)}}function La(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card",25),h.TgZ(2,"ion-card-content",61),h.TgZ(3,"p",140),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"ion-button",141),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(4),h.Oqu(h.lcZ(5,5,"POND_MOD.THIS_POND_HAVE_NOT_SEASON")),h.xp6(2),h.MGl("routerLink","/pond/",n.pondService.pcode,"/season-create"),h.Q6J("appPermission",h.DdM(9,oo))("currentPermission",n.pondService.permission),h.xp6(1),h.hij(" ",h.lcZ(8,7,"POND_MOD.SEASON_CREATE")," ")}}function Fa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",142),h.TgZ(1,"ion-button",143),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentInfo()}),h._UZ(2,"ion-icon",144),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.Q6J("appPermission",h.DdM(5,oo))("currentPermission",i.pondService.permission),h.xp6(3),h.hij(" ",h.lcZ(4,3,"POND_MOD.SETTING_AND_CONFIG")," ")}}function Ja(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-fab",145),h.TgZ(1,"ion-fab-button",146),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentSuggestAdd()}),h._UZ(2,"ion-icon",147),h.qZA(),h.qZA()}}var Qa=function(){var t=function(){function t(e,n,i,o,a,s,c,l,u,d,g,h,f,Z,v){r(this,t),this.modalController=e,this.pondService=n,this.toastService=i,this.route=o,this.translate=a,this.tour=s,this.iotService=c,this.afs=l,this.router=u,this.cd=d,this.dblocalService=g,this.service=h,this.geoLocation=f,this.popoverController=Z,this.alertController=v,this.loadingFlag=new p.E,this.componentLoaded=[],this.favorited=!1,this.feed=[],this.totalFeed=0,this.lastTimeUpdate=m(),this.noItem=!1,this.now=(new Date).valueOf()/1e3,this.showDevice=!1,this.devices=[],this.loadingDevice=new p.E,this.disease=[],this.SITE_IMAGE=Nt.bl.FILE_PATH,this.loadingWeatherFlag=new p.E,this.farmLocation={lng:0,lat:0},this.propertyBlock=[],this.enableSort=!1,this.arrSwap=["",""],this.keyBlock=["weather","device","photo","estimate","param","feed","enviroment","health","note","procedure","todo","season","cost","water_treatment"],this.labelBlock=["Th\u1eddi ti\u1ebft","Thi\u1ebft b\u1ecb","H\xecnh \u1ea3nh","Th\u1ed1ng k\xea","Ch\u1ec9 s\u1ed1 m\xf4i tr\u01b0\u1eddng","Cho \u0103n","H\xf3a ch\u1ea5t x\u1eed l\xfd","S\u1ee9c kh\u1ecfe","Ghi ch\xfa","Quy tr\xecnh nu\xf4i","C\u1ea7n l\xe0m","M\xf9a v\u1ee5","Chi ph\xed"],this.paramKey=["ph_am","ph_pm","oxy","temperature","nh3","no2","h2s","salinity","clarity","kh","ca","mg","orp","vibrio","algae"],this.pondService.reloadSeason$=new kt.X(0),this.labelBlock=[this.translate.instant("WEATHER_MOD.TITLE"),this.translate.instant("DEVICE"),this.translate.instant("PHOTO_MOD.DAILY_PHOTO"),this.translate.instant("POND_MOD.ESTIMATE"),this.translate.instant("POND_MOD.ENVIROMENT"),this.translate.instant("POND_MOD.FEED"),this.translate.instant("POND_MOD.CHEMICAL_TREATMENT"),this.translate.instant("POND_MOD.HEALTH"),this.translate.instant("POND_MOD.NOTE"),this.translate.instant("POND_MOD.PROCEDURE"),this.translate.instant("POND_MOD.TODO"),this.translate.instant("POND_MOD.SEASON"),this.translate.instant("POND_MOD.COST")]}return c(t,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pcode=this.route.snapshot.paramMap.get("id"),this.pondService.setCode(this.pcode),this.iotService.setPondCode(this.pcode),e.next=5,this.dblocalService.getLocalData();case 5:this.checkDBLocal(),this.getPond(),this.loadAlerNow(),this.loadSuggestNow(),this.loadSeasonData(),this.pondService.reloadSeason$.subscribe(function(){t.loadSeasonData()});case 11:case"end":return e.stop()}},e,this)}))}},{key:"doRefresh",value:function(e){this.getPond(),this.loadDevice(),this.loadAlerNow(),this.loadSuggestNow(),this.loadSeasonData(),this.loadWeather(),this.pondService.reloadSeason$.next(1),e.target.complete()}},{key:"checkDBLocal",value:function(){var e,t=this;if(this.pondLocalIndex=this.dblocalService.ponds.findIndex(function(e){return e.infor.code===t.pcode}),this.pondLocalIndex>=0){var n=this.dblocalService.farms.findIndex(function(e){return e.infor.id==t.dblocalService.ponds[t.pondLocalIndex].infor.farm_id});n>=0&&(this.farmLocation={lng:this.dblocalService.farms[n].infor.longitude,lat:this.dblocalService.farms[n].infor.latitude}),console.log(this.dblocalService.ponds[this.pondLocalIndex].infor),this.loadWeather(),this.pondService.setPond(this.dblocalService.ponds[this.pondLocalIndex].infor),this.pondService.setPermission(this.dblocalService.ponds[this.pondLocalIndex].infor.permission),this.favorited=this.dblocalService.ponds[this.pondLocalIndex].favorite,this.devices=null===(e=this.dblocalService.ponds[this.pondLocalIndex])||void 0===e?void 0:e.devices;var i=[],o=[];this.pubs={},this.subs={},this.feedings={},this.devices.forEach(function(e){"envisor"==e.type?(t.pubs[e.device_id_fb]={},i.push(e.device_id_fb),t.pubs[e.device_id_fb]=e):"cabinet"==e.type?(t.subs[e.device_id_fb]={},o.push(e.device_id_fb),t.subs[e.device_id_fb]=e):"feeding"==e.type&&(t.feedings[e.device_id_fb]={},t.feedings[e.device_id_fb]=e)}),0==i.length&&0==o.length&&0==Object.keys(this.feedings).length?this.loadDevice():(this.showDevice=!0,this.loadDataDevice(i))}else this.getPond(),this.favorited=!1}},{key:"loadDevice",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iotService.list().catch(function(){o.toastService.danger(o.translate.instant("ERROR_CONNECT"))});case 2:(t=e.sent)&&1==t.status?(n=[],i=[],this.pubs={},this.subs={},this.feedings={},this.devices=[],t.data.forEach(function(e){o.devices.push(e),"envisor"==e.type?(o.pubs[e.device_id_fb]={},n.push(e.device_id_fb),o.pubs[e.device_id_fb]=e):"cabinet"==e.type?(o.subs[e.device_id_fb]={},i.push(e.device_id_fb),o.subs[e.device_id_fb]=e):"feeding"==e.type&&(o.feedings[e.device_id_fb]={},o.feedings[e.device_id_fb]=e)}),this.showDevice=0!=n.length||0!=i.length||0!=Object.keys(this.feedings).length,this.pondLocalIndex>=0&&this.dblocalService.updateItem("ponds",{infor:this.pondService.pond,favorite:this.favorited,devices:this.devices},this.pondLocalIndex),this.loadDataDevice(n)):t&&0==t.status&&this.toastService.warning(t.error);case 4:case"end":return e.stop()}},e,this)}))}},{key:"loadDataDevice",value:function(t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,a,r,s,c=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.loadingDevice.setPending(!0),i=0,!(t.length>0)){n.next=22;break}return n.next=5,this.afs.collection("pub",function(e){return e.where("__name__","in",t)}).get().toPromise();case 5:o=n.sent,a=e(o.docs),n.prev=7,s=regeneratorRuntime.mark(function n(){var o,a,s,l,u,d;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=r.value,a=o.id,n.next=4,o.ref.collection("factors").get();case 4:s=n.sent,c.pubs[a].indexs={},c.pubs[a].listIndexLabel=[],c.pubs[a].last=0,l=e(s.docs);try{for(l.s();!(u=l.n()).done;)d=u.value,console.log(a,":",d.data().name),c.pubs[a].indexs[d.data().name]={},c.pubs[a].listIndexLabel.push(d.data().name)}catch(g){l.e(g)}finally{l.f()}c.pubs[a].listIndexLabel.sort(),o.ref.collection("factors").onSnapshot(function(e){e.forEach(function(e){var t=e.data();e.ref.collection("data").limit(1).orderBy("time","desc").onSnapshot(function(e){e.forEach(function(e){var n=e.data().time.toMillis();parseInt(n)>parseInt(c.pubs[a].last)&&(c.pubs[a].last=n),c.pubs[a].indexs[t.name].ui=t.ui,c.pubs[a].indexs[t.name].last=e.data()})})})}),(i+=1)==t.length&&(c.cd.detectChanges(),c.loadingDevice.setResult(!0));case 9:case"end":return n.stop()}},n)}),a.s();case 10:if((r=a.n()).done){n.next=14;break}return n.delegateYield(s(),"t0",12);case 12:n.next=10;break;case 14:n.next=19;break;case 16:n.prev=16,n.t1=n.catch(7),a.e(n.t1);case 19:return n.prev=19,a.f(),n.finish(19);case 22:case"end":return n.stop()}},n,this,[[7,16,19,22]])}))}},{key:"presentPubDetail",value:function(e){this.router.navigateByUrl("pond/"+this.pondService.pcode+"/pub/"+e.device_id_fb)}},{key:"presentSubDetail",value:function(e){this.router.navigateByUrl("pond/"+this.pondService.pcode+"/sub/"+e.device_id_fb)}},{key:"presentFeedDetail",value:function(e){this.router.navigateByUrl("pond/"+this.pondService.pcode+"/feed/"+e)}},{key:"calculateColor",value:function(e){return e||"#244988"}},{key:"ionViewDidEnter",value:function(){}},{key:"ngOnDestroy",value:function(){this.pondService.destroy(),this.pondService.reloadSeason$.unsubscribe()}},{key:"getPond",value:function(){var e=this;this.pondService.loadPond().pipe().subscribe(function(t){0==t.status?e.toastService.warning(t.error):(e.pondService.setPond(t.data),(!t.permission||"keeper_manager"==t.permission)&&t.farm_lab&&(t.permission=t.farm_lab.permission),e.pondService.setPermission(t.permission),e.pondService.labPermission=t.farm_lab,t.data.in_lab&&(e.pondService.pondInLab=!0),console.log(e.pondService.pondInLab))},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"loadSeasonData",value:function(){var e=this;this.pondService.loadToday().subscribe(function(t){if(t.start_season){e.pondService.seasonStart=!0,e.pondService.seasonStartTime=m(1e3*t.season.start_time),e.pondService.setTracking(t.season.tracking_factor,t.season.feed_no),e.seasonInfo=t.season,e.pondService.seasonInfo.seedQuantity=t.season.seed_quantity,e.propertyBlock=""!=e.seasonInfo.config_block?e.seasonInfo.config_block.split(","):e.keyBlock,console.log("response"),t.lastday.length>0?(e.readValueParamOfDay(t.lastday[0]),e.todayItem=t.lastday[0],e.SITE_IMAGE=Nt.bl.FILE_PATH,e.SITE_IMAGE+="/upload/season/"+e.seasonInfo.code+"/ge_image/",e.lastTimeUpdate=e.todayItem.edit_time>0?m(new Date(1e3*e.todayItem.edit_time)):e.todayItem.time>0?m(new Date(1e3*e.todayItem.time)):m()):(e.todayItem=e.pondService.createNotExistDay(),e.noItem=!0),t.estimate&&(e.processEstimate(t.estimate),e.estimateProcedure=t.estimate.procedure);var n=e.dblocalService.ponds.findIndex(function(t){return t.infor.code===e.pondService.pcode}),i=e.pondService.pond;i.permission=e.pondService.permission,"undefined"!==e.seasonInfo?(i.seed_date=e.seasonInfo.seed_date,i.current_season=e.seasonInfo.code,i.start_time=e.seasonInfo.start_time):(i.seed_date=0,i.current_season="",i.start_time=0),n<0?(e.dblocalService.addItem("ponds",{infor:i,devices:e.devices}),e.pondLocalIndex=e.dblocalService.ponds.length):(e.pondLocalIndex=n,console.log(n),e.dblocalService.updateItem("ponds",{infor:i,favorite:e.favorited,devices:e.devices},n)),e.processFeed(),t.disease.length>0&&(e.disease=t.disease)}},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"readValueParamOfDay",value:function(e){var t=this;this.pondService.trackingObjects.forEach(function(n,i){t.pondService.trackingObjects[i].values.push(e[n.key])})}},{key:"processFeed",value:function(){var e=this;this.feed=[],this.totalFeed=0;for(var t=1;t<=this.pondService.numRepast;t++)this.feed.push([]);console.log(this.feed),this.todayItem.feed&&(console.log(this.todayItem.feed),this.todayItem.feed.forEach(function(t){var n=0;t.times<=e.feed.length&&(e.feed[t.times-1].quantity&&(n=e.feed[t.times-1].quantity),e.feed[t.times-1]={quantity:n+Number(t.quantity)*t.packing}),e.totalFeed+=+t.quantity*t.packing}))}},{key:"processEstimate",value:function(e){this.estimate={},this.estimate.old=Math.round((this.now-this.seasonInfo.seed_date)/86400);var t=0;if(this.estimate.totalSeedWeight=e.sum.total_seed_weight>0?e.sum.total_seed_weight:+this.seasonInfo.seed_weight*(parseInt(this.seasonInfo.seed_quantity)-parseInt(e.sum.loss))/1e3,e.sum.feed_today=e.sum.feed_today?e.sum.feed_today:0,console.log(e),e.weight.length>0){if(0==(t=m(this.lastTimeUpdate).diff(m(e.weight[0].date),"days")))this.estimate.weight=null!=e.weight[0].weight?e.weight[0].weight:this.seasonInfo.seed_weight,this.estimate.grow_speed=null!=e.procedure?e.procedure.grow_speed:0,console.log("jo:"+this.estimate.weight);else if(e.weight.length<2)this.estimate.grow_speed=(e.weight[0].weight-this.seasonInfo.seed_weight)/this.estimate.old,this.estimate.weight=this.estimate.grow_speed*t+parseInt(e.weight[0].weight),console.log(this.estimate.weight);else{var n=m(e.weight[0].date).diff(m(e.weight[1].date),"days");console.log(n),this.estimate.grow_speed=(e.weight[0].weight-e.weight[1].weight)/n,this.estimate.weight=this.estimate.grow_speed*t+parseInt(e.weight[0].weight),console.log(this.estimate.weight)}this.estimate.quantity_pcs=parseInt(this.seasonInfo.seed_quantity)-parseInt(e.sum.loss),this.estimate.quantity=parseInt(this.estimate.weight)*parseInt(this.estimate.quantity_pcs)/1e3,this.estimate.FCR=e.sum.feed_today/(this.estimate.quantity-this.estimate.totalSeedWeight),this.estimate.feed=parseInt(e.sum.feed_today),0==+this.estimate.grow_speed&&(this.estimate.grow_speed=(e.weight[0].weight-this.seasonInfo.seed_weight)/this.estimate.old)}else e.procedure?(this.estimate.grow_speed=e.procedure.grow_speed,this.estimate.weight=this.estimate.old<e.procedure.culture_day?this.estimate.grow_speed*this.estimate.old+parseFloat(this.seasonInfo.seed_weight):this.estimate.grow_speed*e.procedure.culture_day+parseFloat(this.seasonInfo.seed_weight)):(this.estimate.grow_speed=0,this.estimate.weight=this.seasonInfo.seed_weight),this.estimate.quantity_pcs=parseInt(this.seasonInfo.seed_quantity),this.estimate.quantity=parseFloat(this.estimate.weight)*parseInt(this.estimate.quantity_pcs)/1e3,this.estimate.FCR=e.sum.feed_today/(this.estimate.quantity-this.estimate.totalSeedWeight),this.estimate.feed=e.sum.feed_today;console.log(this.estimate)}},{key:"presentEstimate",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ct,componentProps:{data:this.estimate,procedure:this.estimateProcedure,season:this.seasonInfo}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentInfo",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ve,componentProps:{subs:this.subs,pubs:this.pubs,feedings:this.feedings,showDevice:this.showDevice,pondLocalIndex:this.pondLocalIndex}});case 2:return(t=e.sent).onDidDismiss().then(function(e){}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentAlert",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:T});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"loadAlerNow",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.getAlertNow().pipe().subscribe(function(t){t.error||(e.alertItems=t.data.map(function(e){return e.time=m(1e3*e.add_time).fromNow(),e}),e.alertItems=e.alertItems.slice(0,3)),e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"presentSuggest",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:M});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"loadSuggestNow",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.getSuggestNow().pipe().subscribe(function(t){t.error||(e.suggestItems=t.data.map(function(e){return e.time=m(1e3*e.add_time).fromNow(),e}),e.suggestItems=e.suggestItems.slice(0,3)),e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"presentParameter",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:k});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentDisease",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:wt,componentProps:{timeStartStamp:this.seasonInfo.add_time,timeEndStamp:this.todayItem.time,item:t}});case 2:return(i=n.sent).onDidDismiss().then(function(t){t.data&&o.disease.splice(e,1)}),n.next=6,i.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"presentParameterUpdate",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.target&&e.stopPropagation(),n.next=3,this.modalController.create({component:b,componentProps:{factor:t}});case 3:return(i=n.sent).onDidDismiss().then(function(e){if(e.data){console.log(e.data),o.todayItem[t.key]=e.data.value;var n=o.pondService.trackingObjects.findIndex(function(e){return e.key==t.key});o.pondService.trackingObjects[n].values[0]=parseFloat(e.data.value.toString().replace(",",".")),o.lastTimeUpdate=m()}}),n.next=7,i.present();case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}},n,this)}))}},{key:"presentFeed",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:G});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentFeedUpdate",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(this.todayItem),e.target&&e.stopPropagation(),n.next=3,this.modalController.create({component:it,componentProps:{repast:t,item:this.todayItem}});case 3:return(i=n.sent).onDidDismiss().then(function(e){e.data&&e.data.date==m().format("YYYY-MM-DD")&&(o.totalFeed=0,console.log(e.data),e.data.repast.forEach(function(t,n){var i=0;o.feed[n].quantity=0,t.feeds.forEach(function(e){i+=Number(e.quantity*e.packing),o.feed[n].quantity+=+e.quantity*e.packing}),o.totalFeed+=+i,console.log(o.feed[n]),o.converRepastToItem(e.data)}),o.lastTimeUpdate=m())}),n.next=7,i.present();case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}},n,this)}))}},{key:"converRepastToItem",value:function(e){var t=[];e.repast.forEach(function(e,n){e.feeds.forEach(function(e){t.push({times:n+1,product_id:e.kind,quantity:e.quantity,type:1})})}),this.todayItem.feed=t,this.todayItem.blend=[],this.todayItem.date=e.date}},{key:"presentEnviroment",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:W});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentEnviromentUpdate",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.target&&e.stopPropagation(),t.next=3,this.modalController.create({component:ct,componentProps:{item:this.todayItem}});case 3:return(n=t.sent).onDidDismiss().then(function(e){e.data&&(Object.assign(i.todayItem,{enviroment:e.data}),i.lastTimeUpdate=m())}),t.next=7,n.present();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}))}},{key:"presentHealth",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:oe});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentHealthUpdate",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.target&&e.stopPropagation(),t.next=3,this.modalController.create({component:pt,componentProps:{item:this.todayItem,disease:this.disease}});case 3:return(n=t.sent).onDidDismiss().then(function(e){console.log(e.data),console.log(i.todayItem.date),e.data&&e.data.date==i.todayItem.date&&(i.todayItem.loss=e.data.loss,i.todayItem.weight=e.data.weight,i.todayItem.note_health=e.data.note,i.disease=[],console.log(e.data),e.data.disease.length>0?(e.data.disease.forEach(function(e){0==i.disease.filter(function(t){return t.disease_name==e.name}).length&&i.disease.push({id:0,disease_id:e.id,name:e.name,processed:0})}),i.pondService.pond.warning=1):i.pondService.pond.warning=0,i.lastTimeUpdate=m())}),t.next=7,n.present();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}))}},{key:"presentNote",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:qt});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentNoteUpdate",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.target&&e.stopPropagation(),t.next=3,this.modalController.create({component:mt,componentProps:{item:this.todayItem}});case 3:return(n=t.sent).onDidDismiss().then(function(e){e.data&&(i.todayItem.cost_other=e.data.cost,i.todayItem.income=e.data.income,i.todayItem.note_general=e.data.note,i.lastTimeUpdate=m())}),t.next=7,n.present();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}))}},{key:"presentSuggestAdd",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Zt});case 2:return(t=e.sent).onDidDismiss().then(function(e){}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"loadComponent",value:function(e){this.componentLoaded.push(!0),0==this.seasonInfo.procedure_id&&this.componentLoaded.push(!0),e.target.complete(),console.log(this.componentLoaded.length),this.componentLoaded.length>=4&&(e.target.disabled=!0)}},{key:"addFavorite",value:function(){this.favorited?(this.dblocalService.removeFavorite(this.pondService.pond),this.favorited=!1,this.toastService.success(this.translate.instant("POND_MOD.FAVORITE_REMOVED"))):(this.dblocalService.addFavorite(this.pondService.pond),this.toastService.success(this.translate.instant("POND_MOD.FAVORITE_ADDED")),this.favorited=!0)}},{key:"getMomentTime",value:function(e){return m(e).fromNow()}},{key:"loadWeather",value:function(){var e=this;this.farmLocation.lat&&this.farmLocation.lng?this.requestWeather():this.geoLocation.getCurrentPosition().then(function(t){e.farmLocation={lng:t.coords.longitude,lat:t.coords.latitude},e.requestWeather()}).catch(function(t){e.toastService.warning(e.translate.instant("ASSISTANT.NEED_PER_LOCALTION"))})}},{key:"requestWeather",value:function(){var e=this;this.loadingWeatherFlag.setPending(!0),this.service.getWeatherToday(this.farmLocation.lat,this.farmLocation.lng).pipe().subscribe(function(t){e.processWeatherData(t),e.loadingWeatherFlag.setResult(!0)},function(t){e.loadingWeatherFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"processWeatherData",value:function(e){this.weatherWeekData=e.daily;var t=e.daily[0];this.weatherData={temp:(t.temp.day-273.15).toFixed(2),temp_max:(t.temp.max-273.15).toFixed(2),weather:t.weather[0].description,icon:"http://openweathermap.org/img/w/".concat(t.weather[0].icon,".png")}}},{key:"presentWeatherPredict",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.weatherWeekData){e.next=8;break}return e.next=3,this.modalController.create({component:Rt.J,componentProps:{data:this.weatherWeekData}});case 3:return e.next=5,e.sent.present();case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=void 0;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}},e,this)}))}},{key:"openUploadImage",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:It.a,cssClass:"my-custom-class",componentProps:{inforDaily:this.todayItem,scode:this.seasonInfo.code}});case 2:return(t=e.sent).onDidDismiss().then(function(e){e.data&&e.data.date==n.todayItem.date&&(n.todayItem.image=e.data.image?e.data.image:n.todayItem.image,n.todayItem.description=e.data.description,n.lastTimeUpdate=m())}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"openDailyPhoto",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Mt.F,cssClass:"my-custom-class",componentProps:{inforDaily:this.todayItem,scode:this.seasonInfo.code}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentPopoverMenu",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:Pt.A,cssClass:"my-custom-class",event:e,translucent:!0});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.next=7,n.onDidDismiss();case 7:i=t.sent,null!=(o=i.data)&&("setting"==o?this.presentInfo():"sort"==o?this.enableSort=!0:"add-item"==o&&this.presentAlertAddBlock());case 10:case"end":return t.stop()}},t,this)}))}},{key:"checkJson",value:function(e){return!!/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}},{key:"removeBlock",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("POND_MOD.CONFIRM"),message:this.translate.instant("POND_MOD.CONFIRM_DELETE"),buttons:[{text:"NO",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"OK",handler:function(){n.propertyBlock.splice(e,1)}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"saveProperty",value:function(){var e=this;this.pondService.updateConfigBlock(this.seasonInfo.code,{config:this.propertyBlock}).subscribe(function(t){1==t.status?(e.toastService.success(e.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),e.enableSort=!1,e.loadingFlag.setResult(!0)):(e.toastService.warning(t.error),e.enableSort=!1,e.propertyBlock=""!=e.seasonInfo.config_block?e.seasonInfo.config_block.split(","):e.keyBlock)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"addProperty",value:function(e){var t=this;this.propertyBlock.unshift(e),this.pondService.updateConfigBlock(this.seasonInfo.code,{config:this.propertyBlock}).subscribe(function(e){1==e.status?(t.toastService.success(t.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),t.loadingFlag.setResult(!0)):(t.toastService.warning(e.error),t.propertyBlock.splice(0,1))},function(e){t.loadingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"upBlockProperty",value:function(e){if(0!=e){var t=this.propertyBlock[e-1];this.propertyBlock[e-1]=this.propertyBlock[e],this.propertyBlock[e]=t,this.arrSwap=[this.propertyBlock[e-1],this.propertyBlock[e]]}}},{key:"downBlockProperty",value:function(e){if(e!=this.propertyBlock.length-1){var t=this.propertyBlock[e+1];this.propertyBlock[e+1]=this.propertyBlock[e],this.propertyBlock[e]=t,this.arrSwap=[this.propertyBlock[e],this.propertyBlock[e+1]]}}},{key:"presentAlertAddBlock",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n=this,this.keyBlock.forEach(function(e,i){!n.propertyBlock.includes(e)&&"water_treatment"!==e&&t.push({name:"radio"+i,type:"radio",label:n.labelBlock[i],value:e})}),0==t.length){e.next=9;break}return e.next=5,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("POND_MOD.ADD_ITEM"),inputs:t,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){e&&i.addProperty(e)}}]});case 5:return e.next=7,e.sent.present();case 7:e.next=10;break;case 9:this.toastService.warning(this.translate.instant("POND_MOD.EMPTY_ITEM"));case 10:case"end":return e.stop()}},e,this)}))}},{key:"presentAlertParamsConfig",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.paramKey.forEach(function(e){t.push({name:e,type:"checkbox",label:n.translate.instant("POND_MOD.PARAM."+e.toUpperCase()),value:e,checked:!!n.pondService.trackingPamameters.includes(e)})}),e.next=4,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("SETTINGS"),inputs:t,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){n.pondService.updateConfigSeason("param",{listParam:e}).subscribe(function(t){1==t.status?(n.pondService.setTracking(n.getNewFactor(e),n.seasonInfo.feed_no),n.readValueParamOfDay(n.todayItem),n.toastService.success(n.translate.instant("WALL.UPDATE_SUCCESS"))):n.toastService.warning(t.error)},function(){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))})}}]});case 4:return e.next=6,e.sent.present();case 6:case"end":return e.stop()}},e,this)}))}},{key:"getNewFactor",value:function(e){for(var t=e.join(","),n=1;n<=this.seasonInfo.feed_no;n++)t+=",feed"+n;return","==t[0]&&(t=t.substring(1)),t}},{key:"presentAlertFeedConfig",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("SETTINGS"),inputs:[{name:"feed_no",type:"number",id:"feed_no",value:this.seasonInfo.feed_no,placeholder:this.translate.instant("POND_MOD.REPAST")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.pondService.updateConfigSeason("feed",e).subscribe(function(n){1==n.status?(t.seasonInfo.feed_no=e.feed_no,t.pondService.setTracking(t.getNewFactor(t.pondService.trackingPamameters),t.seasonInfo.feed_no),t.processFeed(),t.readValueParamOfDay(t.todayItem),t.toastService.success(t.translate.instant("WALL.UPDATE_SUCCESS"))):t.toastService.warning(n.error)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(s.gz),h.Y36(f.sK),h.Y36(Yt.M),h.Y36(Me.d),h.Y36(Lt.ST),h.Y36(s.F0),h.Y36(h.sBO),h.Y36(se.T),h.Y36(Et.F),h.Y36(Ut.b),h.Y36(l.Dh),h.Y36(l.Br))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-pond"]],viewQuery:function(e,t){var n;(1&e&&(h.Gf(l.ju,5),h.Gf(l.W2,5)),2&e)&&(h.iGM(n=h.CRH())&&(t.infiniteScroll=n.first),h.iGM(n=h.CRH())&&(t.content=n.first))},decls:24,vars:14,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["slot","end"],[3,"click"],["color","primary","slot","icon-only","name","star-outline",4,"ngIf"],["slot","icon-only","name","star",4,"ngIf"],["class","btnSort","slot","end",3,"appPermission","currentPermission",4,"ngIf"],[1,"title"],["slot","end","fill","clear",3,"click",4,"ngIf"],["slot","fixed",3,"ionRefresh",4,"ngIf"],["class","spiner-loading",4,"ngIf"],["mode","ios",4,"ngIf"],["mode","ios","color","secondary",4,"ngIf"],[4,"ngIf"],[3,"sortablejs","sortablejsOptions",4,"ngIf"],["class","ion-padding-bottom",3,"appPermission","currentPermission",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["color","primary","slot","icon-only","name","star-outline"],["slot","icon-only","name","star"],["slot","end",1,"btnSort",3,"appPermission","currentPermission"],["slot","icon-only","ios","ellipsis-vertical","md","ellipsis-vertical"],["slot","end","fill","clear",3,"click"],["slot","fixed",3,"ionRefresh"],[1,"spiner-loading"],["name","dots"],["mode","ios"],["mode","ios","color","secondary"],["color","danger","mode","ios",3,"click",4,"ngIf"],["mode","ios",3,"click",4,"ngIf"],["color","warning"],["name","bug-outline",1,"icon-f"],[1,"ion-margin-top",3,"appPermission","permissionAction"],["outline","","color","danger",3,"disabled","click",4,"ngFor","ngForOf"],["outline","","color","danger",3,"disabled","click"],["color","danger","mode","ios",3,"click"],["name","warning-outline",1,"icon-f"],["name","chevron-forward-outline",1,"icon-detail"],["lines","none"],[4,"ngFor","ngForOf"],["mode","ios",3,"click"],["color","success"],["name","bulb-outline",1,"icon-f"],["color","primary","name","chevron-forward-outline",1,"icon-detail"],["lines","none","mode","ios"],[3,"sortablejs","sortablejsOptions"],["mode","ios",3,"ngClass","click",4,"ngIf"],["mode","ios",3,"ngClass",4,"ngIf"],[3,"enableSort","index","eventUp","eventDown","eventRemove",4,"ngIf"],[3,"appPermission","currentPermission","enableSort","index","eventUp","eventDown","eventRemove",4,"ngIf"],["mode","ios",3,"ngClass","click"],[1,"forcast"],["name","partly-sunny-outline",1,"icon-f"],["class","icon-detail","name","chevron-forward-outline",4,"ngIf"],["class","btnRemoveBlock",3,"click",4,"ngIf"],["class","ion-text-left ion-margin-top",4,"ngIf"],["class","ion-float-end",4,"ngIf"],[1,"btnRemoveBlock",3,"click"],["size","small","color","light"],["name","close"],[1,"ion-text-left","ion-margin-top"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"],[3,"color"],[1,"ion-float-end"],["size","small","color","tertiary",3,"click"],["name","chevron-up-circle-outline"],["name","chevron-down-circle-outline"],["mode","ios",3,"ngClass"],[1,"photo",3,"click"],["name","camera-outline",1,"icon-f"],["class","ion-float-right","slot","end","shape","round","fill","clear","size","default",3,"appPermission","currentPermission","click",4,"ngIf"],["class","boxPhoto",4,"ngIf"],[1,"ion-padding-top"],[1,"boxPhoto"],[1,"photoDaily",3,"src"],["slot","end","shape","round","fill","clear","size","default",1,"ion-float-right",3,"appPermission","currentPermission","click"],["name","add-circle-outline","slot","icon-only"],[1,"device"],["name","hardware-chip-outline",1,"icon-f"],["lines","none","mode","ios",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["class","ion-margin-bottom",3,"click",4,"ngFor","ngForOf"],["src","assets/icon/envisor.svg","slot","start"],["slot","end","name","chevron-forward-outline"],[1,"ion-align-items-start"],["size","6","size-md","3","class","ion-text-center",4,"ngFor","ngForOf"],["type","indeterminate"],["size","6","size-md","3",1,"ion-text-center"],["class","box",4,"ngIf"],[1,"box"],[3,"ngStyle"],[1,"item-device"],[1,"value"],[1,"ion-margin-bottom",3,"click"],["src","assets/icon/cabinet.svg","slot","start"],["src","assets/icon/feeding.svg","slot","start"],[1,"estimate"],["name","medical-outline",1,"icon-f"],["lines","none",4,"ngIf"],["slot","end",1,"ion-margin"],[1,"param",3,"click"],["src","assets/icon/gauser.svg",1,"icon-f"],["class","block",4,"ngIf"],["class","ion-float-right",4,"ngIf"],[1,"block"],["class","elementBlock ion-activatable ripple-parent",3,"ngStyle",4,"ngFor","ngForOf"],[1,"elementBlock","ion-activatable","ripple-parent",3,"ngStyle"],[1,"detailElement",3,"appPermission","permissionAction","click"],[1,"value",3,"ngStyle"],["name","add-outline",4,"ngIf"],["name","add-outline"],[1,"ion-float-right"],["size","small","color","light",3,"appPermission","currentPermission","click"],["name","build"],[1,"feed",3,"click"],["src","assets/icon/fertilizer.svg",1,"icon-f"],[1,"totalResult"],["class","elementBlock styleFeed ion-activatable ripple-parent",4,"ngFor","ngForOf"],[1,"elementBlock","styleFeed","ion-activatable","ripple-parent"],[1,"enviro",3,"click"],["name","water-outline",1,"icon-f"],["class","elementBlock styleEnviro",4,"ngFor","ngForOf"],["class","elementBlock styleEnviro ion-activatable ripple-parent",4,"ngIf"],[1,"elementBlock","styleEnviro"],[1,"elementBlock","styleEnviro","ion-activatable","ripple-parent"],[1,"health"],["name","heart-outline",1,"icon-f"],["size","6","size-md","6",1,"ion-text-center"],["color","success",1,"labelBigSize"],["color","danger",1,"labelBigSize"],[1,"ion-text-wrap"],["slot","end","shape","round","fill","clear","size","default",3,"appPermission","currentPermission","click"],[1,"note"],["name","clipboard-outline",1,"icon-f"],[3,"appPermission","currentPermission",4,"ngIf"],[3,"appPermission","currentPermission"],["color","warning",1,"labelBigSize"],["slot","end","shape","round","fill","clear","size","default",3,"click"],[3,"enableSort","index","eventUp","eventDown","eventRemove"],[3,"appPermission","currentPermission","enableSort","index","eventUp","eventDown","eventRemove"],[1,"ion-padding"],["shape","round","color","primary",3,"routerLink","appPermission","currentPermission"],[1,"ion-padding-bottom",3,"appPermission","currentPermission"],["color","medium","expand","block","shape","round","fill","clear",3,"click"],["name","cog-outline","slot","start"],["vertical","bottom","horizontal","end","slot","fixed"],["color","secondary",3,"click"],["name","chatbubbles-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h._UZ(3,"ion-back-button",1),h.qZA(),h.TgZ(4,"ion-buttons",2),h.TgZ(5,"ion-button",3),h.NdJ("click",function(){return t.addFavorite()}),h.YNc(6,Bi,1,0,"ion-icon",4),h.YNc(7,zi,1,0,"ion-icon",5),h.qZA(),h.qZA(),h.YNc(8,Wi,3,3,"ion-buttons",6),h.TgZ(9,"ion-title",7),h._uU(10),h.qZA(),h.YNc(11,Xi,3,3,"ion-button",8),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.YNc(13,Ki,2,0,"ion-refresher",9),h.TgZ(14,"div"),h.YNc(15,eo,2,0,"div",10),h.YNc(16,to,5,4,"ion-card",11),h.YNc(17,no,5,3,"ion-card",12),h.YNc(18,go,5,4,"div",13),h.YNc(19,Ya,2,5,"div",14),h.qZA(),h.TgZ(20,"div"),h.YNc(21,La,9,10,"div",13),h.qZA(),h.YNc(22,Fa,5,6,"div",15),h.YNc(23,Ja,3,0,"ion-fab",16),h.qZA()),2&e&&(h.xp6(6),h.Q6J("ngIf",!t.favorited),h.xp6(1),h.Q6J("ngIf",t.favorited),h.xp6(1),h.Q6J("ngIf",!t.enableSort),h.xp6(2),h.Oqu(null==t.pondService||null==t.pondService.pond?null:t.pondService.pond.name),h.xp6(1),h.Q6J("ngIf",t.enableSort),h.xp6(2),h.Q6J("ngIf",!t.enableSort),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(1),h.Q6J("ngIf",!t.noItem&&t.pondService.seasonStart),h.xp6(1),h.Q6J("ngIf",t.noItem),h.xp6(1),h.Q6J("ngIf",t.pondService.seasonStart),h.xp6(1),h.Q6J("ngIf",t.pondService.seasonStart),h.xp6(2),h.Q6J("ngIf",!t.pondService.seasonStart&&!t.loadingFlag.pending),h.xp6(1),h.Q6J("ngIf",!t.enableSort),h.xp6(1),h.Q6J("ngIf","pond_expert"==t.pondService.permission))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.YG,o.O5,l.wd,l.W2,l.gu,Ot.l,l.nJ,l.Wo,l.PQ,l.PM,l.FN,l.Zi,l.tO,o.sg,l.hM,l.Q$,l.q_,l.Ie,Ft.r,Jt.QN,o.mk,l.yW,l.jY,l.Nd,l.X7,l.wI,o.PC,l.H$,rn,_n,Ii,Ri.f,Gi,l.YI,s.rH,l.IJ,l.W4],pipes:[f.X$,o.Nd,o.JJ,o.gd],styles:["[_nghost-%COMP%]   h6[_ngcontent-%COMP%]{padding:20px}[_nghost-%COMP%]   ion-col[_ngcontent-%COMP%]{-webkit-padding-end:2px!important;padding-inline-end:2px!important;-webkit-padding-start:2px!important;padding-inline-start:2px!important}[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1rem}[_nghost-%COMP%]   .item-device[_ngcontent-%COMP%]{font-size:small;text-transform:uppercase}[_nghost-%COMP%]   .unit-device[_ngcontent-%COMP%]{font-size:65%;font-family:Atomic}[_nghost-%COMP%]   .box[_ngcontent-%COMP%]{height:100%;margin-bottom:1em}[_nghost-%COMP%]   .value[_ngcontent-%COMP%]{font-family:Atomic}[_nghost-%COMP%]   .device[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#FF8C00,#3dc2ff)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#498205,#3dc2ff)}[_nghost-%COMP%]   .note[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#ffb900,#3dc2ff)}[_nghost-%COMP%]   .feed[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#ca5010,#3dc2ff)}[_nghost-%COMP%]   .feed[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{display:flex;justify-content:space-between}[_nghost-%COMP%]   .feed[_ngcontent-%COMP%]   .totalResult[_ngcontent-%COMP%]{font-size:1rem}[_nghost-%COMP%]   .cost[_ngcontent-%COMP%]{background-color:#ffcdd2!important}[_nghost-%COMP%]   .param[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#00cc6a,#3dc2ff)}[_nghost-%COMP%]   .enviro[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#00B294,#3dc2ff)}[_nghost-%COMP%]   .estimate[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#767676,#3dc2ff)}[_nghost-%COMP%]   .forcast[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#ec2727,#f0de0a)}[_nghost-%COMP%]   .photo[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#0042cc,#75afe9)}[_nghost-%COMP%]   .boxPhoto[_ngcontent-%COMP%]{width:100%;padding:20px 20px 0}[_nghost-%COMP%]   .photoDaily[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .labelBigSize[_ngcontent-%COMP%]{font-size:1.5rem}[_nghost-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff!important;padding-left:3em}[_nghost-%COMP%]   ion-icon.icon-f[_ngcontent-%COMP%]{font-size:2em;position:absolute;left:0;top:-.2em}[_nghost-%COMP%]   .jiggleBlock[_ngcontent-%COMP%]{animation:jiggle .4s infinite,myMoveUp .5s;-webkit-animation:jiggle .4s infinite,myMoveUp .5s;-moz-animation-duration:.4s,myMoveUp .5s;-moz-animation-name:jiggle;-moz-animation-iteration-count:infinite,myMoveUp .5s;-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg)}@keyframes jiggle{0%{transform:rotate(-1deg)}50%{transform:rotate(1deg)}}@-webkit-keyframes jiggle{0%{-webkit-transform:rotate(-1deg)}50%{-webkit-transform:rotate(1deg)}}[_nghost-%COMP%]   .btnRemoveBlock[_ngcontent-%COMP%]{position:absolute;top:0;right:0}[_nghost-%COMP%]   .disableEvent[_ngcontent-%COMP%]{pointer-events:none!important}[_nghost-%COMP%]   .moveUp[_ngcontent-%COMP%]{-webkit-animation:myMoveUp;animation:myMoveUp;-webkit-animation-duration:.5s;animation-duration:.5s}@-webkit-keyframes myMoveUp{0%{top:65px}to{top:0px}}@keyframes myMoveUp{0%{top:65px}to{top:0px}}[_nghost-%COMP%]   .moveDown[_ngcontent-%COMP%]{-webkit-animation:myMoveUp;animation:myMoveUp;-webkit-animation-duration:.5s;animation-duration:.5s}@-webkit-keyframes myMoveDown{0%{bottom:65px}to{bottom:0px}}@keyframes myMoveDown{0%{bottom:65px}to{bottom:0px}}[_nghost-%COMP%]   .btnSort[_ngcontent-%COMP%]{display:flex!important}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]{padding-left:16px;overflow:auto;white-space:nowrap;margin-bottom:16px;margin-top:16px}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]   .elementBlock[_ngcontent-%COMP%]{margin:5px;width:100%;border-radius:16px;display:inline-block;position:relative;max-height:95px;max-width:95px;text-align:center;padding-top:5px;padding-bottom:5px;border-style:solid;border-width:1px}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]   .detailElement[_ngcontent-%COMP%]{border-radius:16px;max-width:200px;max-height:120px;font-size:2rem}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]   .dailyOld[_ngcontent-%COMP%]{position:absolute;bottom:0%;padding:5px;border-radius:0 16px;background-color:#fff}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:16px}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]   .styleFeed[_ngcontent-%COMP%]{color:#ca5010;border-color:#ca5010}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]   .styleEnviro[_ngcontent-%COMP%]{color:#00b294;border-color:#00b294}[_nghost-%COMP%]   .block[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}[_nghost-%COMP%]   ion-ripple-effect[_ngcontent-%COMP%]{border-radius:16px}"]}),t}();function Va(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",10),h.TgZ(2,"h3"),h._uU(3),h.qZA(),h.TgZ(4,"p"),h._uU(5),h.ALo(6,"translate"),h.ALo(7,"translate"),h.TgZ(8,"sup"),h._uU(9,"2"),h.qZA(),h.qZA(),h.TgZ(10,"p"),h._uU(11),h.qZA(),h.qZA(),h._UZ(12,"ion-radio",11),h.qZA()),2&e){var n=t.$implicit;h.xp6(3),h.Oqu(n.name),h.xp6(2),h.lnq("",h.lcZ(6,6,"POND_MOD.DENSITY")," ",n.density," ",h.lcZ(7,8,"POND_MOD.ANIMAL"),"/m"),h.xp6(6),h.Oqu(n.description),h.xp6(1),h.s9C("value",n.id)}}function ja(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-list"),h.TgZ(1,"ion-radio-group",8),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().radioChange(e)}),h.YNc(2,Va,13,10,"ion-item",9),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(2),h.Q6J("ngForOf",i.data)}}function Ha(e,t){1&e&&(h.TgZ(0,"div",5),h.TgZ(1,"ion-text",12),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.qZA()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"POND_MOD.NOT_YET")," "))}var Ga=function(){var e=function(){function e(t){r(this,e),this.modalCtrl=t}return c(e,[{key:"ngOnInit",value:function(){}},{key:"dismiss",value:function(){this.modalCtrl.dismiss()}},{key:"save",value:function(){this.procedureIdSelected&&this.modalCtrl.dismiss({id:this.procedureIdSelected})}},{key:"radioChange",value:function(e){this.procedureIdSelected=e.detail.value}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-procedure-list"]],inputs:{data:"data",species:"species"},decls:20,vars:13,consts:[["slot","start"],[3,"click"],["name","close","slot","icon-only"],["slot","end"],[3,"disabled","click"],[1,"ion-text-center"],[4,"ngIf"],["class","ion-text-center",4,"ngIf"],[3,"ionChange"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","start",3,"value"],["color","medium"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h._UZ(13,"ion-searchbar"),h.TgZ(14,"div",5),h.TgZ(15,"i"),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.qZA(),h.YNc(18,ja,3,1,"ion-list",6),h.YNc(19,Ha,4,3,"div",7),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,7,"POND_MOD.CHOOSE_PROCEDURE")),h.xp6(3),h.Q6J("disabled",!t.procedureIdSelected),h.xp6(1),h.hij(" ",h.lcZ(11,9,"POND_MOD.SELECT")," "),h.xp6(6),h.AsE("",h.lcZ(17,11,"POND_MOD.PROCEDURE")," ",null==t.species?null:t.species.name,""),h.xp6(2),h.Q6J("ngIf",t.data),h.xp6(1),h.Q6J("ngIf",!((null==t.data?null:t.data.length)>0)))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.VI,l.j9,o.O5,l.q_,l.se,l.QI,o.sg,l.Ie,l.Q$,l.B7,l.U5,l.yW],pipes:[f.X$],styles:[""]}),e}(),Ba=i(6099),za=["slides"];function $a(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",34),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.species_id),h.xp6(1),h.Oqu(n.name)}}function Wa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",25),h.TgZ(1,"ion-item",26),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h._UZ(5,"ion-datetime",27),h.ALo(6,"translate"),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-item",26),h.TgZ(9,"ion-label",15),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.TgZ(12,"ion-select",28),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().selectSpecies(e.detail.value)}),h.ALo(13,"translate"),h.YNc(14,$a,2,2,"ion-select-option",29),h.qZA(),h.qZA(),h.TgZ(15,"ion-item",26),h.TgZ(16,"ion-label",15),h._uU(17),h.ALo(18,"translate"),h.qZA(),h.TgZ(19,"ion-select",30),h.ALo(20,"translate"),h.TgZ(21,"ion-select-option",31),h._uU(22),h.ALo(23,"translate"),h.qZA(),h.TgZ(24,"ion-select-option",32),h._uU(25),h.ALo(26,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(27,"ion-item",26),h.TgZ(28,"ion-label",15),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.TgZ(31,"ion-input",33),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().formatCost(e)}),h.qZA(),h.qZA(),h.TgZ(32,"p",8),h._uU(33),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-button",24),h.NdJ("click",function(){return h.CHM(n),h.oxw(),h.MAs(9).slideNext()}),h._uU(36),h.ALo(37,"translate"),h._UZ(38,"ion-icon",12),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,18,"POND_MOD.SEASON_CREATE_DATE")),h.xp6(2),h.Q6J("displayFormat",h.lcZ(6,20,"FORMAT_DATE_MOMENT"))("placeholder",h.lcZ(7,22,"SELECT_DATE"))("min",i.minDate.format("YYYY-MM-DD"))("max",i.maxDate.format("YYYY-MM-DD")),h.xp6(5),h.Oqu(h.lcZ(11,24,"SPECIES")),h.xp6(2),h.s9C("value",i.form.value.form1.species),h.Q6J("placeholder",h.lcZ(13,26,"POND_MOD.SELECT_SPECIES")),h.xp6(2),h.Q6J("ngForOf",i.species),h.xp6(3),h.Oqu(h.lcZ(18,28,"POND_MOD.TYPE_SEASON")),h.xp6(2),h.Q6J("placeholder",h.lcZ(20,30,"POND_MOD.SELECT_TYPE_SEASON")),h.xp6(3),h.Oqu(h.lcZ(23,32,"POND_MOD.TYPE_SEASON_INTENSIVE")),h.xp6(3),h.Oqu(h.lcZ(26,34,"POND_MOD.TYPE_SEASON_EXTENSIVE")),h.xp6(4),h.Oqu(h.lcZ(30,36,"POND_MOD.PREPARED_CODE")),h.xp6(2),h.Q6J("value",i.numberFormatCost.fakeView),h.xp6(2),h.hij(" ",h.lcZ(34,38,"POND_MOD.NOTE_PREPARE")," "),h.xp6(2),h.Q6J("disabled",i.form.controls.form1.invalid),h.xp6(1),h.hij(" ",h.lcZ(37,40,"NEXT")," ")}}function Xa(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",26),h.TgZ(1,"ion-label"),h.TgZ(2,"ion-text",35),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.qZA(),h.TgZ(5,"p",36),h._uU(6),h.ALo(7,"translate"),h.ALo(8,"translate"),h.TgZ(9,"sup"),h._uU(10,"2"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"ion-button",37),h.NdJ("click",function(){return h.CHM(n),h.oxw().procedueIndexSelected=-1}),h._UZ(12,"ion-icon",38),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(4),h.Oqu(i.procedures[i.procedueIndexSelected].name),h.xp6(2),h.lnq("",h.lcZ(7,4,"POND_MOD.DENSITY")," ",i.procedures[i.procedueIndexSelected].density," ",h.lcZ(8,6,"POND_MOD.ANIMAL"),"/m")}}function Ka(e,t){1&e&&(h.TgZ(0,"div",39),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"CROP_MOD.MAX_FEED_PER_DAY_RANGE")," "))}function er(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-col",40),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-label",35),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"uppercase"),h.qZA(),h.TgZ(6,"ion-checkbox",41),h.NdJ("ionChange",function(){var e=h.CHM(n).index;return h.oxw().removeParam(e)}),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.Q6J("@flyInOut","in"),h.xp6(3),h.Oqu(h.lcZ(4,5,h.lcZ(5,7,"POND_MOD.PARAM."+i.name))),h.xp6(3),h.s9C("formControlName",i.key),h.Q6J("ngModel",!0)("checked",!0)}}var tr=function(){var e=function(){function e(t,n,i,o,s,c,l,u){var d=this;r(this,e),this._navCtr=t,this.modalController=n,this._formBuilder=i,this.pondService=o,this.toastService=s,this.translate=c,this.alertController=l,this.dbLocalService=u,this.numberFormatCost=new re.y(""),this.saving=new p.E,this.trackingString="",this.trackingGeneralObjects=[],this.trackingAdvanceObjects=[],this.trackingAll=[],this.trackingSelected=[],this.trackingFormsGen={},this.trackingFormsAdv={},this.countTracking=0,this.dateForm=new a.NI(m().format("YYYY-MM-DD")),this.maxDate=m(),this.minDate=m().subtract(180,"days"),this.procedueIndexSelected=-1,Ba.Cs.forEach(function(e){d.trackingFormsGen[e]=new a.NI;var t=(new Ba.hz).mapByKey(e);d.trackingGeneralObjects.push(new Ba.d2(e,t.name,t.colorCls,t.colorStr,t.unit,t.max,t.min))}),Ba.SV.forEach(function(e){d.trackingFormsAdv[e]=new a.NI;var t=(new Ba.hz).mapByKey(e);d.trackingAdvanceObjects.push(new Ba.d2(e,t.name,t.colorCls,t.colorStr,t.unit,t.max,t.min))}),this.trackingAll=this.trackingGeneralObjects.concat(this.trackingAdvanceObjects),this.form=this._formBuilder.group({form1:this._formBuilder.group({date:this.dateForm,species:["",a.kI.required],type_season:["intensive",a.kI.required],cost:["",a.kI.required]}),form2:this._formBuilder.group({procedure:[""]}),form3:this._formBuilder.group({repast:["",[a.kI.required,a.kI.min(0),a.kI.max(10)]]}),form4:this._formBuilder.group(Object.assign(this.trackingFormsGen,this.trackingFormsAdv))})}return c(e,[{key:"ngOnInit",value:function(){this.getSeason()}},{key:"save",value:function(){var e=this;console.log(this.form.value),this.trackingSelected.forEach(function(t){e.trackingString+=t.key+","}),this.saving.setPending(!0);var t={pid:this.pondService.pond.id,tracking_factor:this.trackingString,date:m(this.form.value.form1.date).unix(),feed_no:this.form.value.form3.repast,procedure:0,species:this.form.value.form1.species,type_season:this.form.value.form1.type_season,prepare_cost:this.form.value.form1.cost};this.procedueIndexSelected>=0&&(t.procedure=this.procedures[this.procedueIndexSelected].id),this.pondService.saveSeason(t).subscribe(function(n){if(n.error||1!=n.status)e.toastService.warning(n.message),e.saving.setResult(!1);else{var i=e.dbLocalService.ponds.findIndex(function(t){return t.infor.code===e.pondService.pcode});if(i>=0){var o={infor:e.pondService.pond,devices:[]};o.infor.current_season=n.season_code,o.infor.species_id=parseInt(e.speciesSelected.id),o.infor.species=e.speciesSelected.name,o.infor.start_time=t.date,e.dbLocalService.updateItem("ponds",o,i)}e.pondService.seasonStart=!1,e.pondService.reloadSeason$.next(1),e.saving.setResult(!0),e._navCtr.pop()}},function(){e.translate.get("CONNECT_ERROR").subscribe(function(t){e.toastService.danger(t)}),e.saving.setResult(!1)})}},{key:"openProcedureList",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ga,componentProps:{data:this.procedures_filtered,species:this.speciesSelected}});case 2:return(t=e.sent).onDidDismiss().then(function(e){console.log(e),e.data&&(n.procedueIndexSelected=n.procedures.findIndex(function(t){return t.id===e.data.id}),console.log(n.procedures),console.log(n.procedueIndexSelected))}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"formatCost",value:function(e){this.numberFormatCost.setValue(e.detail.value)}},{key:"getSeason",value:function(){var e=this;this.pondService.reqSeason().subscribe(function(t){1==t.status?(console.log(t),e.species=t.data.species,e.procedures=t.data.procedures,t.data.species.filter(function(e){return!0===e.recently}).map(function(t){e.selectSpecies(t.species_id),console.log("helo"),e.form.get("form1.species").patchValue(t.species_id),e.form.get("form2.procedure").setValue(t.procedure_id),e.procedueIndexSelected=e.procedures.findIndex(function(e){return e.id===t.procedure_id})})):e.toastService.warning(t.message)},function(){e.translate.get("CONNECT_ERROR").subscribe(function(t){e.toastService.danger(t)})})}},{key:"selectSpecies",value:function(e){var t=this;console.log(e),this.species.filter(function(t){return t.id==e}).map(function(e){t.form.get("form3.repast").setValue(e.no_feeding),e.tracking_factor.split(",").forEach(function(e){var n=t.trackingAll.findIndex(function(t){return t.key===e});n>-1&&(t.trackingSelected.push(t.trackingAll[n]),t.trackingAll.splice(n,1))})}),this.procedures_filtered=this.procedures.filter(function(t){if(t.species_id==e)return t}),this.speciesSelected=this.species[this.species.findIndex(function(t){return t.id===e})]}},{key:"addParam",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.trackingAll.forEach(function(e){t.push({name:e.name,label:n.translate.instant("POND_MOD.PARAM."+e.name.toUpperCase()),type:"checkbox",value:e.key})}),e.next=4,this.alertController.create({header:this.translate.instant("POND_MOD.INDEX"),inputs:t,buttons:[{text:this.translate.instant("OPTION.CANCEL"),role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){if(console.log(e),!e)return!1;e.forEach(function(e){var t=n.trackingAll.findIndex(function(t){return t.key===e});n.trackingSelected.push(n.trackingAll[t]),n.trackingAll.splice(t,1)})}}]});case 4:return e.next=6,e.sent.present();case 6:case"end":return e.stop()}},e,this)}))}},{key:"removeParam",value:function(e){var t=this.trackingSelected[e];this.trackingSelected.splice(e,1),this.trackingAll.push(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.SH),h.Y36(l.IN),h.Y36(a.qu),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(l.Br),h.Y36(se.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-create"]],viewQuery:function(e,t){var n;(1&e&&h.Gf(za,5),2&e)&&(h.iGM(n=h.CRH())&&(t.slides=n.first))},decls:62,vars:42,consts:[["slot","start"],["text","","defaultHref","tabs"],[3,"formGroup"],["slides",""],["class","w-100 ion-padding","formGroupName","form1",4,"ngIf"],["formGroupName","form2",1,"w-100","ion-padding"],["color","primary","fill","outline","shape","round",3,"click"],["lines","inset",4,"ngIf"],[1,"tip"],["shape","round","fill","clear",3,"click"],["slot","start","name","arrow-back"],["shape","round",3,"click"],["slot","end","name","arrow-forward"],[1,"w-100","ion-padding"],["lines","inset","formGroupName","form3"],["position","floating"],["type","number","min","0","max","6","inputmode","numeric","formControlName","repast"],["class","text-form-dirty",4,"ngIf"],["lines","none"],["slot","end","size","small","fill","clear",3,"click"],["slot","start","name","add"],["formGroupName","form4"],["size","6",4,"ngFor","ngForOf"],[1,"ion-padding"],["shape","round",3,"disabled","click"],["formGroupName","form1",1,"w-100","ion-padding"],["lines","inset"],["formControlName","date",3,"displayFormat","placeholder","min","max"],["formControlName","species","okText","Ok","cancelText","Dismiss",3,"value","placeholder","ionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","type_season","okText","Ok","cancelText","Dismiss",3,"placeholder"],["value","intensive"],["value","extensive"],["formControlName","cost","inputmode","numeric",3,"value","ionChange"],[3,"value"],["color","primary"],[1,"p-info"],["slot","end","fill","clear","color","medium",3,"click"],["slot","icon-only","name","remove-circle-outline"],[1,"text-form-dirty"],["size","6"],["slot","end",3,"formControlName","ngModel","checked","ionChange"]],template:function(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h._UZ(3,"ion-back-button",1),h.qZA(),h.TgZ(4,"ion-title"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"ion-content",2),h.TgZ(8,"ion-slides",null,3),h.TgZ(10,"ion-slide"),h.YNc(11,Wa,39,42,"div",4),h.qZA(),h.TgZ(12,"ion-slide"),h.TgZ(13,"div",5),h.TgZ(14,"ion-button",6),h.NdJ("click",function(){return t.openProcedureList()}),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.YNc(17,Xa,13,8,"ion-item",7),h.TgZ(18,"p",8),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.TgZ(21,"ion-button",9),h.NdJ("click",function(){return h.CHM(n),h.MAs(9).slidePrev()}),h._UZ(22,"ion-icon",10),h._uU(23),h.ALo(24,"translate"),h.qZA(),h.TgZ(25,"ion-button",11),h.NdJ("click",function(){return h.CHM(n),h.MAs(9).slideNext()}),h._uU(26),h.ALo(27,"translate"),h._UZ(28,"ion-icon",12),h.qZA(),h.qZA(),h.qZA(),h.TgZ(29,"ion-slide"),h.TgZ(30,"div",13),h.TgZ(31,"h1"),h._uU(32),h.ALo(33,"translate"),h.qZA(),h.TgZ(34,"p",8),h._uU(35),h.ALo(36,"translate"),h.qZA(),h.TgZ(37,"ion-item",14),h.TgZ(38,"ion-label",15),h._uU(39),h.ALo(40,"translate"),h.qZA(),h._UZ(41,"ion-input",16),h.YNc(42,Ka,3,3,"div",17),h.qZA(),h.TgZ(43,"ion-item",18),h.TgZ(44,"ion-label"),h._uU(45),h.ALo(46,"translate"),h.qZA(),h.TgZ(47,"ion-button",19),h.NdJ("click",function(){return t.addParam()}),h._UZ(48,"ion-icon",20),h._uU(49),h.ALo(50,"translate"),h.qZA(),h.qZA(),h.TgZ(51,"ion-grid",21),h.TgZ(52,"ion-row"),h.YNc(53,er,7,9,"ion-col",22),h.qZA(),h.qZA(),h.TgZ(54,"div",23),h.TgZ(55,"ion-button",9),h.NdJ("click",function(){return h.CHM(n),h.MAs(9).slidePrev()}),h._UZ(56,"ion-icon",10),h._uU(57),h.ALo(58,"translate"),h.qZA(),h.TgZ(59,"ion-button",24),h.NdJ("click",function(){return t.save()}),h._uU(60),h.ALo(61,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}2&e&&(h.xp6(5),h.Oqu(h.lcZ(6,18,"POND_MOD.SEASON_CREATE")),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(4),h.Q6J("ngIf",t.species&&t.species.length),h.xp6(4),h.hij("",h.lcZ(16,20,"POND_MOD.SELECT_PROCEDURE")," "),h.xp6(2),h.Q6J("ngIf",-1!=t.procedueIndexSelected),h.xp6(2),h.hij(" ",h.lcZ(20,22,"POND_MOD.NOTE_ADD_PRO")," "),h.xp6(4),h.hij(" ",h.lcZ(24,24,"BACK")," "),h.xp6(3),h.hij("",h.lcZ(27,26,"NEXT")," "),h.xp6(6),h.Oqu(h.lcZ(33,28,"POND_MOD.CAREFUL")),h.xp6(3),h.hij(" ",h.lcZ(36,30,"POND_MOD.NOTE_CAREFUL")," "),h.xp6(4),h.Oqu(h.lcZ(40,32,"POND_MOD.MAX_FEED")),h.xp6(3),h.Q6J("ngIf",t.form.get("form3.repast").invalid&&(t.form.get("form3.repast").dirty||t.form.get("form3.repast").touched)),h.xp6(3),h.hij(" ",h.lcZ(46,34,"POND_MOD.WATER_QUANLITY_INDEX")," "),h.xp6(4),h.hij(" ",h.lcZ(50,36,"POND_MOD.ADD")," "),h.xp6(4),h.Q6J("ngForOf",t.trackingSelected),h.xp6(4),h.hij("",h.lcZ(58,38,"BACK")," "),h.xp6(2),h.Q6J("disabled",t.form.invalid),h.xp6(1),h.Oqu(h.lcZ(61,40,"CONFIRM")))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.W2,a.JL,a.sg,l.Hr,l.A$,o.O5,a.x0,l.YG,l.gu,l.Ie,l.Q$,l.pK,l.as,a.JJ,a.u,l.jY,l.Nd,o.sg,l.x4,l.QI,l.t9,l.n0,l.j9,l.yW,l.wI,l.nz,l.w],pipes:[f.X$,o.gd],styles:["[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .w-100[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:.6em;font-style:italic;padding:10px}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .p-info[_ngcontent-%COMP%]{padding:5px 0}"],data:{animation:[(0,je.X$)("flyInOut",[(0,je.SB)("in",(0,je.oB)({width:"100%",transform:"translateX(0)",opacity:1})),(0,je.eR)("void => *",[(0,je.oB)({width:0,transform:"translateX(50px)",opacity:0}),(0,je.jt)(300)]),(0,je.eR)("* => void",[(0,je.ru)([(0,je.jt)("0.3s ease",(0,je.oB)({transform:"translateX(50px)",width:10})),(0,je.jt)("0.3s 0.2s ease",(0,je.oB)({opacity:0}))])])])]}}),e}(),nr=i(24879),ir=i(66031),or=i(54438),ar=i(53306);function rr(e,t){1&e&&(h.TgZ(0,"div",6),h._UZ(1,"ion-spinner",7),h.qZA())}function sr(e,t){if(1&e&&(h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-label"),h.TgZ(3,"h3"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"p"),h._uU(7),h.ALo(8,"date"),h.ALo(9,"translate"),h.ALo(10,"date"),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-item"),h.TgZ(13,"ion-label"),h.TgZ(14,"h3"),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.TgZ(17,"p"),h._uU(18),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"ion-item"),h.TgZ(20,"ion-label"),h.TgZ(21,"h3"),h._uU(22),h.ALo(23,"translate"),h.qZA(),h.TgZ(24,"p"),h._uU(25),h.ALo(26,"number"),h.TgZ(27,"sup"),h._uU(28,"3"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(29,"ion-item"),h.TgZ(30,"ion-label"),h.TgZ(31,"h3"),h._uU(32),h.ALo(33,"translate"),h.qZA(),h.TgZ(34,"p"),h._uU(35),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(4),h.Oqu(h.lcZ(5,11,"POND_MOD.SEASON")),h.xp6(3),h.AsE("",h.xi3(8,13,1e3*(null==n.itemData.season?null:n.itemData.season.start_time),h.lcZ(9,16,"FORMAT_DATE"))," - ",h.xi3(10,18,1e3*(null==n.itemData.season?null:n.itemData.season.end_time),h.lcZ(11,21,"FORMAT_DATE"))," "),h.xp6(8),h.Oqu(h.lcZ(16,23,"POND_MOD.FARM")),h.xp6(3),h.Oqu(n.itemData.farm.name),h.xp6(4),h.Oqu(h.lcZ(23,25,"POND_MOD.POND")),h.xp6(3),h.lnq("",n.itemData.pond.name,": ",h.xi3(26,27,n.itemData.pond.area,".0-2")," x ",n.itemData.pond.deep," m"),h.xp6(7),h.Oqu(h.lcZ(33,30,"POND_MOD.STOCKING")),h.xp6(3),h.Oqu(n.itemData.species.name)}}function cr(e,t){if(1&e&&(h.TgZ(0,"ion-item-group"),h.TgZ(1,"ion-item-divider"),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"date"),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.TgZ(7,"ion-item"),h.TgZ(8,"ion-label"),h.TgZ(9,"h3"),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.TgZ(12,"p",11),h._uU(13),h.ALo(14,"number"),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"p",11),h._uU(22),h.ALo(23,"number"),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.TgZ(25,"ion-item"),h.TgZ(26,"ion-label"),h.TgZ(27,"h3"),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.qZA(),h.TgZ(30,"p",11),h._uU(31),h.ALo(32,"number"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(3),h.AsE(" ",h.lcZ(4,10,"POND_MOD.SEED")," ",h.xi3(5,12,1e3*n.seed_date,h.lcZ(6,15,"FORMAT_DATE"))," "),h.xp6(7),h.Oqu(h.lcZ(11,17,"POND_MOD.QUANTITY")),h.xp6(3),h.AsE("",h.xi3(14,19,n.seed_quantity,".0-2")," ",h.lcZ(15,22,"POND_MOD.ANIMAL"),""),h.xp6(6),h.Oqu(h.lcZ(20,24,"POND_MOD.SIZE")),h.xp6(3),h.AsE("",h.xi3(23,26,n.seed_weight,".0-2")," gr/",h.lcZ(24,29,"PCS"),""),h.xp6(6),h.Oqu(h.lcZ(29,31,"POND_MOD.TOTAL")),h.xp6(3),h.hij("",h.xi3(32,33,n.seed_weight*n.seed_quantity/1e3,".0-2")," kg")}}function lr(e,t){if(1&e&&(h.TgZ(0,"ion-item-group"),h.TgZ(1,"ion-item-divider"),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"date"),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.TgZ(7,"ion-item"),h.TgZ(8,"ion-label"),h.TgZ(9,"h3"),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.TgZ(12,"p",11),h._uU(13),h.ALo(14,"number"),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"p",11),h._uU(22),h.ALo(23,"number"),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.TgZ(25,"ion-item"),h.TgZ(26,"ion-label"),h.TgZ(27,"h3"),h._uU(28,"FCR"),h.qZA(),h.qZA(),h.TgZ(29,"p",11),h._uU(30),h.qZA(),h.qZA(),h.TgZ(31,"ion-item"),h.TgZ(32,"ion-label"),h.TgZ(33,"h3"),h._uU(34),h.ALo(35,"translate"),h.qZA(),h.qZA(),h.TgZ(36,"p",11),h._uU(37),h.ALo(38,"number"),h.qZA(),h.qZA(),h.TgZ(39,"ion-item"),h.TgZ(40,"ion-label"),h.TgZ(41,"h3"),h._uU(42),h.ALo(43,"translate"),h.qZA(),h.qZA(),h.TgZ(44,"p",11),h.TgZ(45,"ion-text",12),h._uU(46),h.ALo(47,"number"),h.qZA(),h._uU(48),h.ALo(49,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(3),h.AsE(" ",h.lcZ(4,14,"POND_MOD.MOVING")," ",h.xi3(5,16,1e3*n.add_time,h.lcZ(6,19,"FORMAT_DATE"))," "),h.xp6(7),h.Oqu(h.lcZ(11,21,"POND_MOD.QUANTITY")),h.xp6(3),h.AsE("",h.xi3(14,23,n.quantity_individual,".0-2")," ",h.lcZ(15,26,"POND_MOD.ANIMAL"),""),h.xp6(6),h.Oqu(h.lcZ(20,28,"POND_MOD.SIZE")),h.xp6(3),h.AsE("",h.xi3(23,30,n.weight,".0-2")," gr/",h.lcZ(24,33,"PCS"),""),h.xp6(8),h.hij(" ",n.fcr," "),h.xp6(4),h.Oqu(h.lcZ(35,35,"POND_MOD.TOTAL")),h.xp6(3),h.hij("",h.xi3(38,37,n.quantity_kg,".0-2")," kg"),h.xp6(5),h.Oqu(h.lcZ(43,40,"POND_MOD.TRANS_COST")),h.xp6(4),h.Oqu(h.xi3(47,42,n.move_cost,".0-3")),h.xp6(2),h.hij(" ",h.lcZ(49,45,"CURRENCY_S")," ")}}function ur(e,t){if(1&e&&(h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-list-header",9),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.YNc(5,cr,33,36,"ion-item-group",10),h.YNc(6,lr,50,47,"ion-item-group",10),h.TgZ(7,"ion-item-divider"),h.TgZ(8,"ion-label"),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA(),h.TgZ(11,"ion-item"),h.TgZ(12,"ion-label"),h.TgZ(13,"h3"),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"p",11),h._uU(17),h.ALo(18,"number"),h.ALo(19,"translate"),h.qZA(),h.qZA(),h.TgZ(20,"ion-item"),h.TgZ(21,"ion-label"),h.TgZ(22,"h3"),h._uU(23),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.TgZ(25,"p",11),h._uU(26),h.ALo(27,"number"),h.ALo(28,"translate"),h.TgZ(29,"sup"),h._uU(30,"2"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(31,"ion-item"),h.TgZ(32,"ion-label"),h.TgZ(33,"h3"),h._uU(34),h.ALo(35,"translate"),h.qZA(),h.qZA(),h.TgZ(36,"p",11),h._uU(37),h.ALo(38,"number"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,12,"POND_MOD.STOCKING")),h.xp6(2),h.Q6J("ngForOf",n.itemData.seed_list),h.xp6(1),h.Q6J("ngForOf",n.moveIn),h.xp6(3),h.hij(" ",h.lcZ(10,14,"POND_MOD.SUM")," "),h.xp6(5),h.Oqu(h.lcZ(15,16,"POND_MOD.QUANTITY")),h.xp6(3),h.AsE("",h.xi3(18,18,n.seedQuantity,".0-2")," ",h.lcZ(19,21,"POND_MOD.ANIMAL"),""),h.xp6(6),h.Oqu(h.lcZ(24,23,"POND_MOD.DENSITY")),h.xp6(3),h.AsE("",h.xi3(27,25,n.seedQuantity/n.itemData.pond.area,".0-2")," ",h.lcZ(28,28,"PCS"),"/m"),h.xp6(8),h.Oqu(h.lcZ(35,30,"POND_MOD.TOTAL")),h.xp6(3),h.hij("",h.xi3(38,32,n.seedWeight/1e3,".0-2")," kg")}}function dr(e,t){if(1&e&&(h.TgZ(0,"ion-item-group"),h.TgZ(1,"ion-item-divider"),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"date"),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.TgZ(7,"ion-item"),h.TgZ(8,"ion-label"),h.TgZ(9,"h3"),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.TgZ(12,"p",11),h._uU(13),h.ALo(14,"number"),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"p",11),h._uU(22),h.ALo(23,"number"),h.ALo(24,"translate"),h.ALo(25,"number"),h.ALo(26,"translate"),h.qZA(),h.qZA(),h.TgZ(27,"ion-item"),h.TgZ(28,"ion-label"),h.TgZ(29,"h3"),h._uU(30),h.ALo(31,"translate"),h.qZA(),h.qZA(),h.TgZ(32,"p",11),h._uU(33),h.ALo(34,"number"),h.ALo(35,"translate"),h.qZA(),h.qZA(),h.TgZ(36,"ion-item"),h.TgZ(37,"ion-label"),h.TgZ(38,"h3"),h._uU(39),h.ALo(40,"translate"),h.qZA(),h.qZA(),h.TgZ(41,"p",11),h._uU(42),h.ALo(43,"number"),h.ALo(44,"translate"),h.qZA(),h.qZA(),h.TgZ(45,"ion-item"),h.TgZ(46,"ion-label"),h.TgZ(47,"h3"),h._uU(48),h.ALo(49,"translate"),h.qZA(),h.qZA(),h.TgZ(50,"p",11),h._uU(51),h.ALo(52,"number"),h.qZA(),h.qZA(),h.TgZ(53,"ion-item"),h.TgZ(54,"ion-label"),h.TgZ(55,"h3"),h._uU(56,"FCR"),h.qZA(),h.qZA(),h.TgZ(57,"p",11),h._uU(58),h.qZA(),h.qZA(),h.TgZ(59,"ion-item"),h.TgZ(60,"ion-label"),h.TgZ(61,"h3"),h._uU(62),h.ALo(63,"translate"),h.qZA(),h.qZA(),h.TgZ(64,"p",11),h.TgZ(65,"ion-text",12),h._uU(66),h.ALo(67,"number"),h.qZA(),h._uU(68),h.ALo(69,"translate"),h.qZA(),h.qZA(),h.TgZ(70,"ion-item"),h.TgZ(71,"ion-label"),h.TgZ(72,"h3"),h._uU(73),h.ALo(74,"translate"),h.qZA(),h.qZA(),h.TgZ(75,"p",11),h.TgZ(76,"ion-text",12),h._uU(77),h.ALo(78,"number"),h.qZA(),h._uU(79),h.ALo(80,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit,i=h.oxw(2);h.xp6(3),h.AsE(" ",h.lcZ(4,25,"POND_MOD.HARVEST")," ",h.xi3(5,27,1e3*n.harvest_date,h.lcZ(6,30,"FORMAT_DATE"))," "),h.xp6(7),h.Oqu(h.lcZ(11,32,"POND_MOD.CULTURE_PEROID")),h.xp6(3),h.AsE("",h.xi3(14,34,(n.harvest_date-(null==i.itemData.season?null:i.itemData.season.seed_date))/86400,".0-0")," ",h.lcZ(15,37,"DAYS")," "),h.xp6(6),h.Oqu(h.lcZ(20,39,"POND_MOD.AVERAGE_SIZE")),h.xp6(3),h.HOy("",h.xi3(23,41,n.harvest_size,".0-2")," gr/",h.lcZ(24,44,"PCS")," (",h.xi3(25,46,1e3/n.harvest_size,".0-2")," ",h.lcZ(26,49,"PCS"),"/kg)"),h.xp6(8),h.Oqu(h.lcZ(31,51,"POND_MOD.PRICE")),h.xp6(3),h.AsE("",h.xi3(34,53,n.harvest_price,".0-2")," ",h.lcZ(35,56,"CURRENCY_S"),"/kg"),h.xp6(6),h.Oqu(h.lcZ(40,58,"POND_MOD.QUANTITY")),h.xp6(3),h.AsE("",h.xi3(43,60,1e3*n.harvest_quantity/n.harvest_size,".0-0")," ",h.lcZ(44,63,"PCS")," "),h.xp6(6),h.Oqu(h.lcZ(49,65,"POND_MOD.BIOMASS")),h.xp6(3),h.hij("",h.xi3(52,67,n.harvest_quantity,".0-2")," kg"),h.xp6(7),h.hij(" ",n.fcr," "),h.xp6(4),h.Oqu(h.lcZ(63,70,"CROP_MOD.HARVEST_COST")),h.xp6(4),h.Oqu(h.xi3(67,72,n.harvest_cost,".0-3")),h.xp6(2),h.hij(" ",h.lcZ(69,75,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(74,77,"POND_MOD.PRICE_PRODUCTION")),h.xp6(4),h.Oqu(h.xi3(78,79,n.cost/n.harvest_quantity,".0-0")),h.xp6(2),h.hij(" ",h.lcZ(80,82,"CURRENCY_S"),"/kg ")}}function gr(e,t){if(1&e&&(h.TgZ(0,"ion-item-group"),h.TgZ(1,"ion-item-divider"),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"date"),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.TgZ(7,"ion-item"),h.TgZ(8,"ion-label"),h.TgZ(9,"h3"),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.TgZ(12,"p",11),h._uU(13),h.ALo(14,"number"),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"p",11),h._uU(22),h.ALo(23,"number"),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.TgZ(25,"ion-item"),h.TgZ(26,"ion-label"),h.TgZ(27,"h3"),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.qZA(),h.TgZ(30,"p",11),h._uU(31),h.ALo(32,"number"),h.ALo(33,"translate"),h.qZA(),h.qZA(),h.TgZ(34,"ion-item"),h.TgZ(35,"ion-label"),h.TgZ(36,"h3"),h._uU(37),h.ALo(38,"translate"),h.qZA(),h.qZA(),h.TgZ(39,"p",11),h._uU(40),h.ALo(41,"number"),h.qZA(),h.qZA(),h.TgZ(42,"ion-item"),h.TgZ(43,"ion-label"),h.TgZ(44,"h3"),h._uU(45,"FCR"),h.qZA(),h.qZA(),h.TgZ(46,"p",11),h._uU(47),h.qZA(),h.qZA(),h.TgZ(48,"ion-item"),h.TgZ(49,"ion-label"),h.TgZ(50,"h3"),h._uU(51),h.ALo(52,"translate"),h.qZA(),h.qZA(),h.TgZ(53,"p",11),h.TgZ(54,"ion-text",12),h._uU(55),h.ALo(56,"number"),h.qZA(),h._uU(57),h.ALo(58,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit,i=h.oxw(2);h.xp6(3),h.AsE(" ",h.lcZ(4,17,"POND_MOD.MOVING")," ",h.xi3(5,19,1e3*n.add_time,h.lcZ(6,22,"FORMAT_DATE"))," "),h.xp6(7),h.Oqu(h.lcZ(11,24,"POND_MOD.CULTURE_PEROID")),h.xp6(3),h.AsE("",h.xi3(14,26,(n.add_time-(null==i.itemData.season?null:i.itemData.season.seed_date))/86400,".0-0")," ",h.lcZ(15,29,"DAYS")," "),h.xp6(6),h.Oqu(h.lcZ(20,31,"POND_MOD.QUANTITY")),h.xp6(3),h.AsE("",h.xi3(23,33,n.quantity_individual,".0-0")," ",h.lcZ(24,36,"POND_MOD.ANIMAL"),""),h.xp6(6),h.Oqu(h.lcZ(29,38,"POND_MOD.SIZE")),h.xp6(3),h.AsE("",h.xi3(32,40,n.weight,".0-2")," gr/",h.lcZ(33,43,"PCS"),""),h.xp6(6),h.Oqu(h.lcZ(38,45,"POND_MOD.BIOMASS")),h.xp6(3),h.hij("",h.xi3(41,47,n.quantity_kg,".0-2")," kg"),h.xp6(7),h.hij(" ",n.fcr," "),h.xp6(4),h.Oqu(h.lcZ(52,50,"POND_MOD.TRANS_COST")),h.xp6(4),h.Oqu(h.xi3(56,52,n.move_cost,".0-3")),h.xp6(2),h.hij(" ",h.lcZ(58,55,"CURRENCY_S")," ")}}function pr(e,t){if(1&e&&(h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-list-header",9),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.YNc(5,dr,81,84,"ion-item-group",10),h.YNc(6,gr,59,57,"ion-item-group",10),h.TgZ(7,"ion-item-divider"),h.TgZ(8,"ion-label"),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA(),h.TgZ(11,"ion-item"),h.TgZ(12,"ion-label"),h.TgZ(13,"h3"),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"span",11),h._uU(17),h.ALo(18,"number"),h.qZA(),h.qZA(),h.TgZ(19,"ion-item"),h.TgZ(20,"ion-label"),h.TgZ(21,"h3"),h._uU(22),h.ALo(23,"translate"),h.qZA(),h.qZA(),h.TgZ(24,"p",11),h._uU(25),h.ALo(26,"number"),h.ALo(27,"translate"),h.qZA(),h.qZA(),h.TgZ(28,"ion-item"),h.TgZ(29,"ion-label"),h.TgZ(30,"h3"),h._uU(31),h.ALo(32,"translate"),h.qZA(),h.qZA(),h.TgZ(33,"p",11),h._uU(34),h.ALo(35,"number"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,11,"POND_MOD.HARVEST")),h.xp6(2),h.Q6J("ngForOf",n.itemData.harvest_list),h.xp6(1),h.Q6J("ngForOf",n.moveOut),h.xp6(3),h.hij(" ",h.lcZ(10,13,"POND_MOD.SUM")," "),h.xp6(5),h.Oqu(h.lcZ(15,15,"POND_MOD.SURVIVAL_PERCENTAGE")),h.xp6(3),h.hij(" ",h.xi3(18,17,100*n.harvestQuantity/n.seedQuantity,".0-1")," %"),h.xp6(5),h.Oqu(h.lcZ(23,20,"POND_MOD.QUANTITY")),h.xp6(3),h.AsE("",h.xi3(26,22,n.harvestQuantity,".0-2")," ",h.lcZ(27,25,"PCS")," "),h.xp6(6),h.Oqu(h.lcZ(32,27,"POND_MOD.BIOMASS")),h.xp6(3),h.hij("",h.xi3(35,29,n.harvestQuantity*(null==n.itemData.season?null:n.itemData.season.harvest_size)/1e3,".0-2")," kg")}}function mr(e,t){if(1&e&&(h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-list-header",9),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label"),h.TgZ(7,"h3"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.TgZ(10,"p",11),h._uU(11),h.ALo(12,"number"),h.qZA(),h.qZA(),h.TgZ(13,"ion-item"),h.TgZ(14,"ion-label"),h.TgZ(15,"h3"),h._uU(16,"FCR"),h.qZA(),h.qZA(),h.TgZ(17,"p",11),h._uU(18),h.ALo(19,"number"),h.qZA(),h.qZA(),h.TgZ(20,"ion-item"),h.TgZ(21,"ion-label"),h.TgZ(22,"h3"),h._uU(23),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.TgZ(25,"p",11),h._uU(26),h.ALo(27,"number"),h.ALo(28,"translate"),h.qZA(),h.qZA(),h.TgZ(29,"ion-item"),h.TgZ(30,"ion-label"),h.TgZ(31,"h3"),h._uU(32),h.ALo(33,"translate"),h.qZA(),h.qZA(),h.TgZ(34,"p",11),h._uU(35),h.ALo(36,"number"),h.ALo(37,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,10,"POND_MOD.FEED")),h.xp6(5),h.Oqu(h.lcZ(9,12,"POND_MOD.TOTAL_FEED")),h.xp6(3),h.hij("",h.xi3(12,14,null==n.itemData.season?null:n.itemData.season.total_feed,".0-2")," kg"),h.xp6(7),h.hij(" ",h.xi3(19,17,(null==n.itemData?null:n.itemData.season.total_feed)/(((null==n.itemData?null:n.itemData.season.seed_quantity)-(null==n.itemData?null:n.itemData.season.total_loss))*((null==n.itemData?null:n.itemData.season.current_weight)-(null==n.itemData?null:n.itemData.season.seed_weight))/1e3),".0-2")," "),h.xp6(5),h.Oqu(h.lcZ(24,20,"POND_MOD.AVERAGE_GROWTH")),h.xp6(3),h.AsE("",h.xi3(27,22,null==n.itemData.season?null:n.itemData.season.grow_rate,"1.0-2")," gr/",h.lcZ(28,25,"DAY"),""),h.xp6(6),h.Oqu(h.lcZ(33,27,"POND_MOD.LOSS")),h.xp6(3),h.AsE("",h.xi3(36,29,null==n.itemData.season?null:n.itemData.season.total_loss,"1.0-0")," ",h.lcZ(37,32,"PCS"),"")}}function hr(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-list-header",9),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.TgZ(5,"ion-item",13),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentCostOtherList()}),h.TgZ(6,"ion-label"),h.TgZ(7,"h3"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.TgZ(10,"p",11),h.TgZ(11,"ion-text",14),h._uU(12),h.ALo(13,"number"),h.qZA(),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,4,"POND_MOD.OTHER_INCOME")),h.xp6(5),h.Oqu(h.lcZ(9,6,"POND_MOD.SEASON")),h.xp6(4),h.Oqu(h.xi3(13,8,null==i.itemData.cost?null:i.itemData.cost.income,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(15,11,"CURRENCY_S")," ")}}function fr(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-list-header",9),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label"),h.TgZ(7,"h3"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.TgZ(10,"p",11),h.TgZ(11,"ion-text",12),h._uU(12),h.ALo(13,"number"),h.qZA(),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item",13),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentMaterialList("feed")}),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"p",11),h.TgZ(22,"ion-text",12),h._uU(23),h.ALo(24,"number"),h.qZA(),h._uU(25),h.ALo(26,"translate"),h.qZA(),h.qZA(),h.TgZ(27,"ion-item",13),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentMaterialList("blend")}),h.TgZ(28,"ion-label"),h.TgZ(29,"h3"),h._uU(30),h.ALo(31,"translate"),h.qZA(),h.qZA(),h.TgZ(32,"p",11),h.TgZ(33,"ion-text",12),h._uU(34),h.ALo(35,"number"),h.qZA(),h._uU(36),h.ALo(37,"translate"),h.qZA(),h.qZA(),h.TgZ(38,"ion-item",13),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentMaterialList("enviro")}),h.TgZ(39,"ion-label"),h.TgZ(40,"h3"),h._uU(41),h.ALo(42,"translate"),h.qZA(),h.qZA(),h.TgZ(43,"p",11),h.TgZ(44,"ion-text",12),h._uU(45),h.ALo(46,"number"),h.qZA(),h._uU(47),h.ALo(48,"translate"),h.qZA(),h.qZA(),h.TgZ(49,"ion-item",13),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentExchangeList()}),h.TgZ(50,"ion-label"),h.TgZ(51,"h3"),h._uU(52),h.ALo(53,"translate"),h.qZA(),h.qZA(),h.TgZ(54,"p",11),h.TgZ(55,"ion-text",12),h._uU(56),h.ALo(57,"number"),h.qZA(),h._uU(58),h.ALo(59,"translate"),h.qZA(),h.qZA(),h.TgZ(60,"ion-item"),h.TgZ(61,"ion-label"),h.TgZ(62,"h3"),h._uU(63),h.ALo(64,"translate"),h.qZA(),h.qZA(),h.TgZ(65,"p",11),h.TgZ(66,"ion-text",12),h._uU(67),h.ALo(68,"number"),h.qZA(),h._uU(69),h.ALo(70,"translate"),h.qZA(),h.qZA(),h.TgZ(71,"ion-item"),h.TgZ(72,"ion-label"),h.TgZ(73,"h3"),h._uU(74),h.ALo(75,"translate"),h.qZA(),h.qZA(),h.TgZ(76,"p",11),h.TgZ(77,"ion-text",12),h._uU(78),h.ALo(79,"number"),h.qZA(),h._uU(80),h.ALo(81,"translate"),h.qZA(),h.qZA(),h.TgZ(82,"ion-item"),h.TgZ(83,"ion-label"),h.TgZ(84,"h3"),h._uU(85),h.ALo(86,"translate"),h.qZA(),h.qZA(),h.TgZ(87,"p",11),h.TgZ(88,"ion-text",12),h._uU(89),h.ALo(90,"number"),h.qZA(),h._uU(91),h.ALo(92,"translate"),h.qZA(),h.qZA(),h.TgZ(93,"ion-item",13),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentCostOtherList()}),h.TgZ(94,"ion-label"),h.TgZ(95,"h3"),h._uU(96),h.ALo(97,"translate"),h.qZA(),h.qZA(),h.TgZ(98,"p",11),h.TgZ(99,"ion-text",12),h._uU(100),h.ALo(101,"number"),h.qZA(),h._uU(102),h.ALo(103,"translate"),h.qZA(),h.qZA(),h.TgZ(104,"ion-item"),h.TgZ(105,"ion-label"),h.TgZ(106,"h3"),h._uU(107),h.ALo(108,"translate"),h.qZA(),h.qZA(),h.TgZ(109,"p",11),h.TgZ(110,"ion-text",12),h._uU(111),h.ALo(112,"number"),h.qZA(),h._uU(113),h.ALo(114,"translate"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,31,"POND_MOD.COST")),h.xp6(5),h.Oqu(h.lcZ(9,33,"POND_MOD.COST_SEED")),h.xp6(4),h.Oqu(h.xi3(13,35,null==i.itemData.cost?null:i.itemData.cost.seed,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(15,38,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(20,40,"POND_MOD.COST_FEED")),h.xp6(4),h.Oqu(h.xi3(24,42,null==i.itemData.cost?null:i.itemData.cost.feed,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(26,45,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(31,47,"POND_MOD.COST_FEED_SUPPLEMENT")),h.xp6(4),h.Oqu(h.xi3(35,49,null==i.itemData.cost?null:i.itemData.cost.blend,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(37,52,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(42,54,"POND_MOD.COST_WATER_TREATMENT")),h.xp6(4),h.Oqu(h.xi3(46,56,null==i.itemData.cost?null:i.itemData.cost.enviro,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(48,59,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(53,61,"POND_MOD.WATER_TREAMENT")),h.xp6(4),h.Oqu(h.xi3(57,63,null==i.itemData.cost?null:i.itemData.cost.water,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(59,66,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(64,68,"POND_MOD.COST_DEPRECIATION")),h.xp6(4),h.Oqu(h.xi3(68,70,null==i.itemData.cost?null:i.itemData.cost.pond,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(70,73,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(75,75,"POND_MOD.COST_ACCOUTING")),h.xp6(4),h.Oqu(h.xi3(79,77,null==i.itemData.cost?null:i.itemData.cost.moneyout,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(81,80,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(86,82,"POND_MOD.COST_PREPARE")),h.xp6(4),h.Oqu(h.xi3(90,84,null==i.itemData.season?null:i.itemData.season.prepare_cost,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(92,87,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(97,89,"POND_MOD.COST_OTHER")),h.xp6(4),h.Oqu(h.xi3(101,91,null==i.itemData.cost?null:i.itemData.cost.other,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(103,94,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(108,96,"POND_MOD.PRICE_PRODUCTION")),h.xp6(4),h.Oqu(h.xi3(112,98,i.getProductionCost(),".0-0")),h.xp6(2),h.hij(" ",h.lcZ(114,101,"CURRENCY_S"),"/kg ")}}function Zr(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"h3"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.TgZ(5,"p",11),h.TgZ(6,"ion-text",9),h._uU(7),h.ALo(8,"number"),h.qZA(),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(3),h.Oqu(h.lcZ(4,3,"POND_MOD.MOVING")),h.xp6(4),h.Oqu(h.xi3(8,5,n.costMoveOut,".0-3")),h.xp6(2),h.hij(" ",h.lcZ(10,8,"CURRENCY_S")," ")}}function vr(e,t){if(1&e&&(h.TgZ(0,"ion-list",8),h.TgZ(1,"ion-list-header",9),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA(),h.TgZ(5,"ion-item"),h.TgZ(6,"ion-label"),h.TgZ(7,"h3"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h.TgZ(10,"p",11),h.TgZ(11,"ion-text",12),h._uU(12),h.ALo(13,"number"),h.qZA(),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"p",11),h.TgZ(22,"ion-text",9),h._uU(23),h.ALo(24,"number"),h.qZA(),h._uU(25),h.ALo(26,"translate"),h.qZA(),h.qZA(),h.YNc(27,Zr,11,10,"ion-item",15),h.TgZ(28,"ion-item"),h.TgZ(29,"ion-label"),h.TgZ(30,"h3"),h._uU(31),h.ALo(32,"translate"),h.qZA(),h.qZA(),h.TgZ(33,"p",11),h.TgZ(34,"ion-text"),h.TgZ(35,"strong"),h._uU(36),h.ALo(37,"number"),h.qZA(),h.qZA(),h._uU(38),h.ALo(39,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,11,"POND_MOD.SUMMARY")),h.xp6(5),h.Oqu(h.lcZ(9,13,"POND_MOD.TOTAL_COST")),h.xp6(4),h.Oqu(h.xi3(13,15,null==n.itemData.cost?null:n.itemData.cost.total,".0-2")),h.xp6(2),h.hij(" ",h.lcZ(15,18,"CURRENCY_S")," "),h.xp6(5),h.Oqu(h.lcZ(20,20,"POND_MOD.REVENUE")),h.xp6(4),h.Oqu(h.xi3(24,22,null==n.itemData.season?null:n.itemData.season.revenue,".0-3")),h.xp6(2),h.hij(" ",h.lcZ(26,25,"CURRENCY_S")," "),h.xp6(2),h.Q6J("ngIf",0!=n.costMoveOut),h.xp6(4),h.Oqu(h.lcZ(32,27,"POND_MOD.PROFIT")),h.xp6(5),h.Oqu(h.xi3(37,29,null==n.itemData.season?null:n.itemData.season.profit,".0-3")),h.xp6(2),h.hij(" ",h.lcZ(39,32,"CURRENCY_S")," ")}}var Ar=function(){var e=function(){function e(t,n,i,o,a){r(this,e),this.modalController=t,this.toastService=n,this.pondService=i,this.translate=o,this.route=a,this.code="",this.loadingFlag=new p.E,this.seedQuantity=0,this.seedWeight=0,this.harvestQuantity=0,this.costMoveOut=0,this.moveIn=[],this.moveOut=[]}return c(e,[{key:"ngOnInit",value:function(){this.code=this.route.snapshot.paramMap.get("code"),this.loadSeason()}},{key:"loadSeason",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.reqSeasonDetail(this.code).subscribe(function(t){1==t.status?(e.itemData=t.data,t.data.seed_list.forEach(function(t){e.seedQuantity+=parseInt(t.seed_quantity),e.seedWeight+=parseInt(t.seed_quantity)*parseInt(t.seed_weight)}),t.data.moved_list.forEach(function(t){t.to_season_code==e.code?(console.log(t),e.seedQuantity+=parseInt(t.quantity_individual),e.seedWeight+=parseInt(t.quantity_individual)*parseFloat(t.weight),e.moveIn.push(t)):(e.harvestQuantity+=parseInt(t.quantity_individual),e.costMoveOut+=parseInt(t.cost),e.moveOut.push(t))}),t.data.harvest_list.forEach(function(t){e.harvestQuantity+=1e3*t.harvest_quantity/t.harvest_size})):e.toastService.warning(t.message),e.loadingFlag.setResult(!0)},function(){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"presentMaterialList",value:function(e){var t;return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:ir.O,componentProps:{type:e,code:this.code,time:null===(t=this.itemData.season)||void 0===t?void 0:t.start_time}});case 2:return n.next=4,n.sent.present();case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}},n,this)}))}},{key:"presentCostOtherList",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:or.Z,componentProps:{code:this.code}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"getProductionCost",value:function(){var e=0,t=0;return this.itemData.harvest_list.forEach(function(n){e+=+n.cost,t+=+n.harvest_quantity}),e/t}},{key:"presentExchangeList",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:ar.V,componentProps:{code:this.code}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(x.k),h.Y36(g.p),h.Y36(f.sK),h.Y36(s.gz))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-season-detail"]],inputs:{item:"item"},decls:21,vars:13,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["class","spiner-loading",4,"ngIf"],[1,"ion-padding","ion-text-center"],[3,"src"],["lines","none",4,"ngIf"],[1,"spiner-loading"],["name","dots"],["lines","none"],["color","primary"],[4,"ngFor","ngForOf"],["slot","end"],["color","danger"],["detail","true",3,"click"],["color","success"],[4,"ngIf"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h._UZ(3,"ion-back-button",1),h.qZA(),h.TgZ(4,"ion-title"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"ion-content"),h.YNc(8,rr,2,0,"div",2),h.TgZ(9,"div",3),h.TgZ(10,"div"),h._UZ(11,"img",4),h.qZA(),h.TgZ(12,"span"),h._uU(13),h.qZA(),h.qZA(),h.YNc(14,sr,36,32,"ion-list",5),h.YNc(15,ur,39,35,"ion-list",5),h.YNc(16,pr,36,32,"ion-list",5),h.YNc(17,mr,38,34,"ion-list",5),h.YNc(18,hr,16,13,"ion-list",5),h.YNc(19,fr,115,103,"ion-list",5),h.YNc(20,vr,40,34,"ion-list",5),h.qZA()),2&e&&(h.xp6(5),h.Oqu(h.lcZ(6,11,"CROP")),h.xp6(3),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(3),h.Q6J("src","https://chart.googleapis.com/chart?chs=120x120&cht=qr&chl=crop:"+t.code+"&choe=UTF-8",h.LSH),h.xp6(2),h.hij("#",t.code,""),h.xp6(1),h.Q6J("ngIf",t.itemData),h.xp6(1),h.Q6J("ngIf",t.itemData),h.xp6(1),h.Q6J("ngIf",t.itemData),h.xp6(1),h.Q6J("ngIf",t.itemData),h.xp6(1),h.Q6J("ngIf",t.itemData&&t.itemData.cost&&t.itemData.cost.income),h.xp6(1),h.Q6J("ngIf",t.itemData&&t.itemData.cost),h.xp6(1),h.Q6J("ngIf",t.itemData&&0!=t.itemData.season.profit))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.W2,o.O5,l.PQ,l.q_,l.Ie,l.Q$,l.yh,o.sg,l.rH,l.Ub,l.yW],pipes:[f.X$,o.uU,o.JJ],styles:[""]}),e}();function _r(e,t){1&e&&(h.TgZ(0,"div",7),h._UZ(1,"ion-spinner",8),h.qZA())}function Tr(e,t){if(1&e&&(h.TgZ(0,"p",14),h._uU(1),h.ALo(2,"date"),h.ALo(3,"translate"),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(1),h.Oqu(h.xi3(2,1,1e3*n.end_time,h.lcZ(3,4,"FORMAT_DATE")))}}function xr(e,t){1&e&&(h.TgZ(0,"p",14),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"POND_MOD.NOT_YET")))}function qr(e,t){if(1&e&&(h.TgZ(0,"ion-col",9),h.TgZ(1,"ion-card",10),h.TgZ(2,"ion-item",11),h.TgZ(3,"ion-label"),h.TgZ(4,"h2"),h._uU(5),h.ALo(6,"date"),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"p"),h._uU(9),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-item",12),h.TgZ(11,"ion-label"),h.TgZ(12,"h3"),h._uU(13),h.ALo(14,"translate"),h.qZA(),h.qZA(),h.YNc(15,Tr,4,6,"p",13),h.YNc(16,xr,3,3,"p",13),h.qZA(),h.TgZ(17,"ion-item",12),h.TgZ(18,"ion-label"),h.TgZ(19,"h3"),h._uU(20),h.ALo(21,"translate"),h.qZA(),h.qZA(),h.TgZ(22,"p",14),h._uU(23),h.ALo(24,"number"),h.qZA(),h.qZA(),h.TgZ(25,"ion-item",12),h.TgZ(26,"ion-label"),h.TgZ(27,"h3"),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.qZA(),h.TgZ(30,"p",14),h._uU(31),h.ALo(32,"number"),h.ALo(33,"translate"),h.qZA(),h.qZA(),h.TgZ(34,"ion-item",12),h.TgZ(35,"ion-label"),h.TgZ(36,"h3"),h._uU(37),h.ALo(38,"translate"),h.qZA(),h.qZA(),h.TgZ(39,"p",14),h._uU(40),h.ALo(41,"number"),h.ALo(42,"number"),h.ALo(43,"translate"),h.qZA(),h.qZA(),h.TgZ(44,"ion-item",12),h.TgZ(45,"ion-label"),h.TgZ(46,"h3"),h._uU(47),h.ALo(48,"translate"),h.qZA(),h.qZA(),h.TgZ(49,"p",14),h._uU(50),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit;h.xp6(1),h.Q6J("routerLink",n.code),h.xp6(4),h.Oqu(h.xi3(6,17,1e3*n.start_time,h.lcZ(7,20,"FORMAT_DATE"))),h.xp6(4),h.Oqu(n.species_name),h.xp6(4),h.Oqu(h.lcZ(14,22,"POND_MOD.HARVEST")),h.xp6(2),h.Q6J("ngIf",n.end_time>0),h.xp6(1),h.Q6J("ngIf",0==n.end_time),h.xp6(4),h.Oqu(h.lcZ(21,24,"POND_MOD.QUANTITY")),h.xp6(3),h.hij("",h.xi3(24,26,n.harvest_quantity,"1.0-0")," kg"),h.xp6(5),h.Oqu(h.lcZ(29,29,"POND_MOD.PRICE")),h.xp6(3),h.AsE("",h.xi3(32,31,n.harvest_price,"1.0-0")," ",h.lcZ(33,34,"CURRENCY_S"),""),h.xp6(6),h.Oqu(h.lcZ(38,36,"POND_MOD.SIZE")),h.xp6(3),h.lnq("",h.xi3(41,38,n.harvest_size,"1.0-0"),"g (",h.xi3(42,41,1e3/n.harvest_size,"1.0-0"),"",h.lcZ(43,44,"PCS"),"/kg)"),h.xp6(7),h.Oqu(h.lcZ(48,46,"POND_MOD.SEASON_CODE")),h.xp6(3),h.hij("#",n.code,"")}}function Or(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-card",15),h.TgZ(2,"ion-card-content",16),h.TgZ(3,"p",17),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(4),h.Oqu(h.lcZ(5,1,"POND_MOD.EMPTY_HIS")))}function br(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,_r,2,0,"div",3),h.TgZ(2,"ion-grid"),h.TgZ(3,"ion-row"),h.TgZ(4,"ion-col",4),h.TgZ(5,"ion-card"),h.TgZ(6,"ion-card-header"),h.TgZ(7,"ion-card-title"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.qZA(),h._UZ(10,"div",5),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"ion-row"),h.YNc(12,qr,51,48,"ion-col",6),h.qZA(),h.qZA(),h.YNc(13,Or,6,3,"div",2),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.loadingFlag.pending),h.xp6(7),h.Oqu(h.lcZ(9,6,"ANALYTICS")),h.xp6(2),h.Q6J("loading",n.view)("options",n.options),h.xp6(2),h.Q6J("ngForOf",n.seasons),h.xp6(1),h.Q6J("ngIf",0==(null==n.seasons?null:n.seasons.length)&&n.loadingFlag.result)}}var Dr=function(){var e=function(){function e(t,n,i,o,a){r(this,e),this.modalController=t,this.pondService=n,this.toastService=i,this.translate=o,this.route=a,this.loadingFlag=new p.E,this.options={},this.view=!1}return c(e,[{key:"ngOnInit",value:function(){this.pondService.pcode||this.pondService.setCode(this.route.snapshot.paramMap.get("id")),this.getHistoryDate()}},{key:"ionViewDidEnter",value:function(){this.view=!0}},{key:"getHistoryDate",value:function(){var e=this;this.loadingFlag.setPending(!0),this.pondService.getHistory().subscribe(function(t){1==t.status?(e.seasons=t.data,console.log(e.seasons),e.seasons=t.data,e.initChart()):e.toastService.warning(t.message),e.loadingFlag.setResult(!0)},function(){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"initChart",value:function(){var e=this;this.options={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["S\u1ed1 l\u01b0\u1ee3ng","Gi\xe1","C\u1ee1"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:[]},series:[{name:this.translate.instant("COMPANY_MOD.QUANTITY")+"("+this.translate.instant("POND_MOD.TON")+")",type:"bar",data:[]},{name:this.translate.instant("POND_MOD.PRICE")+"("+this.translate.instant("POND_MOD.THOUSAND")+")",type:"bar",data:[]},{name:this.translate.instant("POND_MOD.SIZE")+"("+this.translate.instant("POND_MOD.UNIT_SEED")+")",type:"bar",data:[]}]},this.seasons.forEach(function(t){t.species_name&&(e.options.yAxis.data.push(e.shortString(t.species_name)+" ("+m(new Date(1e3*t.date)).format("DD/MM")+")"),e.options.series[2].data.push(t.harvest_size))}),console.log(this.options.dataset)}},{key:"shortString",value:function(e){for(var t="",n=e.split(" "),i=0;i<n.length;i++)t+=n[i][0].toUpperCase();return t}},{key:"presentSeason",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:Ar,componentProps:{item:e}});case 2:return t.next=4,t.sent.present();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(g.p),h.Y36(x.k),h.Y36(f.sK),h.Y36(s.gz))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-history"]],decls:9,vars:4,consts:[["slot","start"],["text","","defaultHref","tabs/management"],[4,"ngIf"],["class","spiner-loading",4,"ngIf"],["size","12"],["echarts","",3,"loading","options"],["size","12","size-sm","6",4,"ngFor","ngForOf"],[1,"spiner-loading"],["name","dots"],["size","12","size-sm","6"],[3,"routerLink"],["lines","full","detail","true"],["lines","none"],["slot","end",4,"ngIf"],["slot","end"],["mode","ios"],[1,"ion-text-center"],[1,"ion-padding"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h._UZ(3,"ion-back-button",1),h.qZA(),h.TgZ(4,"ion-title"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"ion-content"),h.YNc(8,br,14,8,"div",2),h.qZA()),2&e&&(h.xp6(5),h.Oqu(h.lcZ(6,2,"POND_MOD.HISTORY")),h.xp6(3),h.Q6J("ngIf",t.view))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.W2,o.O5,l.jY,l.Nd,l.wI,l.PM,l.Zi,l.gZ,u._w,o.sg,l.PQ,l.YI,s.rH,l.Ie,l.Q$,l.FN],pipes:[f.X$,o.uU,o.JJ],styles:[""]}),e}(),yr=i(54373),Sr=i(3571),Cr=function(){var e=function(){function e(t,n){r(this,e),this.modalController=t,this.translate=n}return c(e,[{key:"ngOnInit",value:function(){this.max=m(this.max).format("YYYY-MM-DD"),this.day=this.max}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"save",value:function(){this.modalController.dismiss(new Date(this.day).getTime())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-choose-delete"]],inputs:{max:"max"},decls:18,vars:11,consts:[["slot","end"],[3,"click"],["name","close"],["displayFormat","DD MM YYYY","placeholder","Select Date",3,"ngModel","max","ngModelChange"],[1,"ion-text-center"],["shape","round","expand","full",3,"click"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-item"),h.TgZ(10,"ion-label"),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.TgZ(13,"ion-datetime",3),h.NdJ("ngModelChange",function(e){return t.day=e}),h.qZA(),h.qZA(),h.TgZ(14,"div",4),h.TgZ(15,"ion-button",5),h.NdJ("click",function(){return t.save()}),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,5,"DEVICE_MOD.REMOVE_DATA")),h.xp6(8),h.Oqu(h.lcZ(12,7,"DEVICE_MOD.REMOVE_FROM_DATE")),h.xp6(2),h.Q6J("ngModel",t.day)("max",t.max),h.xp6(3),h.hij(" ",h.lcZ(17,9,"SAVE")," "))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,l.Ie,l.Q$,l.x4,l.QI,a.JJ,a.On],pipes:[f.X$],styles:[""]}),e}();function wr(e,t){1&e&&h._UZ(0,"ion-progress-bar",8)}function kr(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h._uU(2),h.qZA(),h.TgZ(3,"ion-buttons",0),h.TgZ(4,"ion-button",1),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw().presentChooseDelete(e)}),h._UZ(5,"ion-icon",9),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.Oqu(i.label)}}var Nr=function(){var e=function(){function e(t,n,i,o){r(this,e),this.modalController=t,this.afs=n,this.toastService=i,this.translate=o,this.loading=new p.E,this.arrItem=[],this.day=7}return c(e,[{key:"ngOnInit",value:function(){for(var e in this.justItem){var t=this.justItem[e];t.key=e,this.arrItem.push(t)}}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"presentChooseDelete",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:Cr,cssClass:"my-custom-class",componentProps:{max:new Date}});case 2:return(n=t.sent).onDidDismiss().then(function(t){void 0!==t.data&&i.deleteData(t.data,e)}),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"deleteData",value:function(e,t){var n=this;e=new Date(e);var i=this.afs.firestore.batch(),o=0;this.loading.setPending(!0),this.afs.collection("pub").doc(this.id).collection("factors").doc(t.key).collection("data",function(t){return t.orderBy("time","desc").where("time","<",e)}).get().forEach(function(e){0==e.docs.length&&(n.loading.setResult(!1),n.toastService.warning(n.translate.instant("DEVICE_MOD.DATA_NULL"))),e.forEach(function(t){i.delete(t.ref),o+=1,t.id==e.docs[e.docs.length-1].id&&i.commit().then(function(e){n.loading.setResult(!0),n.toastService.success(n.translate.instant("DEVICE_MOD.REMOVE_DATA_SUCCESS"))}).catch(function(e){n.loading.setResult(!1),n.toastService.danger(n.translate.instant("DEVICE_MOD.REMOVE_DATA_UNSUCCESS"))}),499==o&&(i.commit(),i=n.afs.firestore.batch(),o=0)})})}},{key:"save",value:function(){this.modalController.dismiss(this.day)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(Lt.ST),h.Y36(x.k),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-filter-delete"]],inputs:{justItem:"justItem",id:"id"},decls:19,vars:11,consts:[["slot","end"],[3,"click"],["name","close"],["type","indeterminate",4,"ngIf"],[2,"padding","15px"],[4,"ngFor","ngForOf"],[1,"ion-text-center"],["shape","round","expand","full",3,"click"],["type","indeterminate"],["name","trash"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(8,wr,1,0,"ion-progress-bar",3),h.TgZ(9,"ion-content"),h.TgZ(10,"p",4),h.TgZ(11,"b"),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.qZA(),h.YNc(14,kr,6,1,"ion-item",5),h.TgZ(15,"div",6),h.TgZ(16,"ion-button",7),h.NdJ("click",function(){return t.save()}),h._uU(17),h.ALo(18,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,5,"DEVICE_MOD.DATA")),h.xp6(5),h.Q6J("ngIf",t.loading.pending),h.xp6(4),h.Oqu(h.lcZ(13,7,"DEVICE_MOD.CHOOSE_INDEX")),h.xp6(2),h.Q6J("ngForOf",t.arrItem),h.xp6(3),h.hij(" ",h.lcZ(18,9,"SAVE")," "))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,o.O5,l.W2,o.sg,l.X7,l.Ie,l.Q$],pipes:[f.X$],styles:[""]}),e}(),Er=i(50384);function Mr(e,t){1&e&&h._UZ(0,"ion-progress-bar",15)}var Ir=function(){var e=function(){function e(t,n,i,o,s){r(this,e),this.modalController=t,this.toastService=n,this.alertController=i,this.iotService=o,this.translate=s,this.list=[],this.loading=new p.E,this.form=new a.cw({condition:new a.NI("",a.kI.required),value:new a.NI("",a.kI.required)})}return c(e,[{key:"ngOnInit",value:function(){this.form.setValue({condition:this.config[this.index].conditions[this.indexCondition].condition,value:this.config[this.index].conditions[this.indexCondition].value})}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"presentConfirmRemove",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",message:this.translate.instant("DEVICE_MOD.CONFIRM_REMOVE_CONDITION"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){t.remove()}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"remove",value:function(){var e=this;this.iotService.removeConditionPub(this.deviceId,this.config[this.index].id,this.config[this.index].conditions[this.indexCondition].id).subscribe(function(t){if(1==t.status){e.toastService.success(e.translate.instant("DEVICE_MOD.REMOVE_CONFITION_CUCCESS"));var n=e.form.value;n.type="remove",e.modalController.dismiss(n)}else e.toastService.warning(e.translate.instant("DEVICE_MOD.REMOVE_DATA_UNSUCCESS"))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"save",value:function(){var e=this;this.iotService.updateConditonPub(this.deviceId,this.config[this.index].id,this.config[this.index].conditions[this.indexCondition].id,this.form.value).subscribe(function(t){if(1==t.status){e.toastService.success(e.translate.instant("DEVICE_MOD.UPDATE_SUCCESS"));var n=e.form.value;n.type="update",e.modalController.dismiss(n)}else e.toastService.warning(e.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS"))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(x.k),h.Y36(l.Br),h.Y36(Me.d),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-config-value"]],inputs:{config:"config",deviceId:"deviceId",index:"index",indexCondition:"indexCondition"},decls:47,vars:41,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end","fill","clear",3,"click"],["type","indeterminate",4,"ngIf"],[3,"formGroup"],["formControlName","condition","okText","Okay","cancelText","Dismiss"],["value",">"],["value",">="],["value","<"],["value","<="],["value","="],["slot","end","formControlName","value","type","number"],[1,"ion-text-center"],["size","small","color","medium","shape","round",3,"click"],["type","indeterminate"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(8,"ion-button",3),h.NdJ("click",function(){return t.save()}),h._uU(9," L\u01b0u "),h.qZA(),h.qZA(),h.qZA(),h.YNc(10,Mr,1,0,"ion-progress-bar",4),h.TgZ(11,"ion-content"),h.TgZ(12,"ion-card",5),h.TgZ(13,"ion-list"),h.TgZ(14,"ion-item"),h.TgZ(15,"ion-label"),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.TgZ(18,"ion-select",6),h.TgZ(19,"ion-select-option",7),h._uU(20),h.ALo(21,"translate"),h.qZA(),h.TgZ(22,"ion-select-option",8),h._uU(23),h.ALo(24,"translate"),h.ALo(25,"translate"),h.ALo(26,"translate"),h.qZA(),h.TgZ(27,"ion-select-option",9),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.TgZ(30,"ion-select-option",10),h._uU(31),h.ALo(32,"translate"),h.ALo(33,"translate"),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-select-option",11),h._uU(36),h.ALo(37,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(38,"ion-item"),h.TgZ(39,"ion-label"),h._uU(40),h.ALo(41,"translate"),h.qZA(),h._UZ(42,"ion-input",12),h.qZA(),h.qZA(),h.qZA(),h.TgZ(43,"div",13),h.TgZ(44,"ion-button",14),h.NdJ("click",function(){return t.presentConfirmRemove()}),h._uU(45),h.ALo(46,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,15,"DEVICE_MOD.CONFIG_CONDITION")),h.xp6(7),h.Q6J("ngIf",t.loading.pending),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(4),h.Oqu(h.lcZ(17,17,"DEVICE_MOD.CHOOSE_CONDITION")),h.xp6(4),h.Oqu(h.lcZ(21,19,"DEVICE_MOD.GREATER_THAN")),h.xp6(3),h.lnq("",h.lcZ(24,21,"DEVICE_MOD.GREATER_THAN")," ",h.lcZ(25,23,"DEVICE_MOD.OR")," ",h.lcZ(26,25,"DEVICE_MOD.SAME"),""),h.xp6(5),h.Oqu(h.lcZ(29,27,"DEVICE_MOD.LESS_THAN")),h.xp6(3),h.lnq("",h.lcZ(32,29,"DEVICE_MOD.LESS_THAN")," ",h.lcZ(33,31,"DEVICE_MOD.OR")," ",h.lcZ(34,33,"DEVICE_MOD.SAME"),""),h.xp6(5),h.Oqu(h.lcZ(37,35,"DEVICE_MOD.SAME")),h.xp6(4),h.Oqu(h.lcZ(41,37,"DEVICE_MOD.VALUE_WARNING")),h.xp6(5),h.Oqu(h.lcZ(46,39,"DEVICE_MOD.REMOVE")))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,o.O5,l.W2,l.PM,a.JL,a.sg,l.q_,l.Ie,l.Q$,l.t9,l.QI,a.JJ,a.u,l.n0,l.pK,l.as,l.X7],pipes:[f.X$],styles:[""]}),e}(),Rr=i(3520),Ur=i(89858),Pr=i(42812),Yr=i(19486),Lr=i(49829);function Fr(e,t){1&e&&h._UZ(0,"ion-progress-bar",11)}function Jr(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",17),h.NdJ("click",function(){var e=h.CHM(n).index,t=h.oxw().index;return h.oxw().openConfigValue(t,e)}),h._uU(1),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw().$implicit;h.xp6(1),h.lnq("",o.label,"",i.condition,"",i.value,"")}}function Qr(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",12),h.TgZ(2,"ion-text",13),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.qZA(),h.TgZ(5,"ion-button",14),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().openAddConfigValue(e)}),h._UZ(6,"ion-icon",15),h.qZA(),h.YNc(7,Jr,2,3,"ion-button",16),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw();h.xp6(2),h.Q6J("ngStyle",o.calculateColor(i.color)),h.xp6(2),h.Oqu(i.label),h.xp6(3),h.Q6J("ngForOf",i.conditions)}}var Vr=function(){var e=function(){function e(t,n,i,o,a,s,c,l,u){r(this,e),this.modalController=t,this.alertController=n,this.afs=i,this.authService=o,this.fns=a,this.afAuth=s,this.toastService=c,this.iotService=l,this.translate=u,this.loading=new p.E}return c(e,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iotService.getInforDevice(this.id).catch(function(e){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))});case 2:(t=e.sent)&&1==t.status?(this.config=t.data.peripherals,this.device_infor.setting=t.data.setting,this.device_infor.third_app_setting=t.data.third_app_setting?t.data.third_app_setting:{},this.device_infor.setting||(this.device_infor.setting={phone_alert:0,send_data:1,alert_offline:1,alert_factor:1})):t&&0==t.status&&this.toastService.warning(t.error);case 4:case"end":return e.stop()}},e,this)}))}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"calculateColor",value:function(e){return{color:e}}},{key:"saveConfigPhone",value:function(e){e!=this.device_infor.setting.phone_alert&&this.actionSaveConfigPhone(e)}},{key:"actionSaveConfigPhone",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading.setPending(!0),console.log(this.device_infor),n={phone_alert:e,send_data:this.device_infor.setting.send_data,alert_offline:this.device_infor.setting.alert_offline,alert_factor:this.device_infor.setting.alert_factor},t.next=4,this.iotService.updateSetting(this.id,n).catch(function(){o.toastService.danger(o.translate.instant("ERROR_CONNECT"))});case 4:(i=t.sent)&&1==i.status?(this.device_infor.setting.phone_alert=n.phone_alert,this.loading.setResult(!0),this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS"))):i&&0==i.status&&(this.loading.setResult(!1),this.toastService.warning(this.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS")));case 6:case"end":return t.stop()}},t,this)}))}},{key:"changeConfigSendData",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.setPending(!0),e.next=3,this.authService.checkTkFb(this.iotService.pcode,this.afAuth);case 3:if(!e.sent){e.next=7;break}this.fns.httpsCallable("saveConfig")({deviceId:this.id,send_data:!this.infor.config.send_data,warn_phone:this.infor.config.warn_phone}).subscribe(function(e){t.toastService.success(t.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),t.loading.setResult(!0),t.infor.config.send_data=!t.infor.config.send_data},function(){t.loading.setResult(!1),t.toastService.warning(t.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS"))}),e.next=8;break;case 7:this.loading.setResult(!1),this.toastService.warning(this.translate.instant("DEVICE_MOD.AUTH_FAILED"));case 8:case"end":return e.stop()}},e,this)}))}},{key:"openConfigValue",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:Ir,cssClass:"my-custom-class",componentProps:{config:this.config,deviceId:this.id,index:e,indexCondition:t}});case 2:return(i=n.sent).onDidDismiss().then(function(n){void 0!==n.data&&("update"==n.data.type?o.config[e].conditions[t]={label:o.config[e].label,condition:n.data.condition,value:n.data.value}:o.config[e].conditions.splice(t,1))}),n.next=6,i.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"openAddConfigValue",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:Ur.F,cssClass:"my-custom-class",componentProps:{config:this.config,deviceId:this.id,index:e}});case 2:return(n=t.sent).onDidDismiss().then(function(t){void 0!==t.data&&i.config[e].conditions.push({label:i.config[e].label,condition:t.data.condition,value:t.data.value})}),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"openConfigWifi",value:function(){var e;return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:Rr.i,cssClass:"my-custom-class",componentProps:{id:this.device_infor.device_id_fb,type:"envisor",name:null===(e=this.device_infor)||void 0===e?void 0:e.name}});case 2:return t.next=4,t.sent.present();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"configPhone",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("DEVICE_MOD.SETTING"),inputs:[{name:"phone",type:"number",placeholder:this.translate.instant("AUTH.PHONE_NUMBER"),value:this.device_infor.setting.phone_alert}],buttons:[{text:"Cancel",role:"cancel",cssClass:"headerAlert",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.saveConfigPhone(e.phone)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"presentUpdateDevice",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("DEVICE_MOD.UPDATE_INFOR"),inputs:[{name:"name",type:"text",value:this.device_infor.name,placeholder:this.translate.instant("DEVICE_MOD.NAME")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.saveDevice(e)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"saveDevice",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.name==this.device_infor.name){t.next=5;break}return t.next=3,this.iotService.update(e.name,this.device_infor.id).catch(function(e){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 3:(n=t.sent)&&1==n.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),this.device_infor.name=e.name):n&&0==n.status&&this.toastService.warning(this.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS"));case 5:case"end":return t.stop()}},t,this)}))}},{key:"updateSetting",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={phone_alert:this.device_infor.setting.phone_alert,send_data:this.device_infor.setting.send_data,alert_offline:this.device_infor.setting.alert_offline,alert_factor:this.device_infor.setting.alert_factor},console.log(i),i[t]=1==i[t]?0:1,console.log(i),this.loading.setPending(!0),n.next=4,this.iotService.updateSetting(this.id,i).catch(function(){a.toastService.danger(a.translate.instant("ERROR_CONNECT")),a.loading.setResult(!1),e.target.checked=0==i[t]});case 4:(o=n.sent)&&1==o.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),this.device_infor.setting[t]=i[t],console.log(this.device_infor.setting),this.loading.setResult(!0)):o&&0==o.status&&(this.toastService.warning(this.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS")),this.loading.setResult(!0),e.target.checked=0==i[t]);case 6:case"end":return n.stop()}},n,this)}))}},{key:"configAutoRecord",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Pr.u,cssClass:"my-custom-class",componentProps:{config:this.device_infor.third_app_setting?this.device_infor.third_app_setting:{},deviceId:this.id}});case 2:return(t=e.sent).onDidDismiss().then(function(e){void 0!==e.data&&(n.device_infor.third_app_setting.mode_data=e.data.mode_data)}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(l.Br),h.Y36(Lt.ST),h.Y36(Er.e),h.Y36(Yr.l4),h.Y36(Lr.zQ),h.Y36(x.k),h.Y36(Me.d),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-setting"]],inputs:{id:"id",device_infor:"device_infor"},decls:83,vars:48,consts:[["slot","end"],[3,"click"],["slot","icon-only","name","close"],["type","indeterminate",4,"ngIf"],["lines","inset"],["name","calculator-outline","slot","start"],["slot","end","fill","clear",3,"click"],["name","create"],[4,"ngFor","ngForOf"],[3,"innerHTML"],["mode","ios",3,"checked","click"],["type","indeterminate"],[1,"ion-text-wrap"],[3,"ngStyle"],["shape","round","type","small","fill","outline","expand","block",1,"ion-float-right",3,"click"],["name","add","fill","clear"],["class","ion-float-left","shape","round","type","small","fill","outline","expand","block",3,"click",4,"ngFor","ngForOf"],["shape","round","type","small","fill","outline","expand","block",1,"ion-float-left",3,"click"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(8,Fr,1,0,"ion-progress-bar",3),h.TgZ(9,"ion-content"),h.TgZ(10,"ion-list",4),h.TgZ(11,"ion-item"),h._UZ(12,"ion-icon",5),h.TgZ(13,"ion-label"),h.TgZ(14,"h3"),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.TgZ(17,"p"),h._uU(18),h.qZA(),h.qZA(),h.TgZ(19,"ion-button",6),h.NdJ("click",function(){return t.presentUpdateDevice()}),h._UZ(20,"ion-icon",7),h.qZA(),h.qZA(),h.TgZ(21,"ion-list-header"),h.TgZ(22,"ion-label"),h._uU(23),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.YNc(25,Qr,8,3,"ion-item",8),h.qZA(),h.TgZ(26,"ion-list"),h.TgZ(27,"ion-list-header"),h.TgZ(28,"ion-label"),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.qZA(),h.TgZ(31,"ion-item"),h.TgZ(32,"ion-label"),h.TgZ(33,"ion-text"),h._uU(34),h.ALo(35,"translate"),h.qZA(),h._UZ(36,"p",9),h.qZA(),h.TgZ(37,"ion-button",6),h.NdJ("click",function(){return t.configAutoRecord()}),h._UZ(38,"ion-icon",7),h.qZA(),h.qZA(),h.TgZ(39,"ion-item"),h.TgZ(40,"ion-label"),h._uU(41),h.ALo(42,"translate"),h.qZA(),h.TgZ(43,"ion-button",6),h.NdJ("click",function(){return t.openConfigWifi()}),h._UZ(44,"ion-icon",7),h.qZA(),h.qZA(),h.TgZ(45,"ion-item"),h.TgZ(46,"ion-label"),h._uU(47),h.ALo(48,"translate"),h.qZA(),h.TgZ(49,"ion-toggle",10),h.NdJ("click",function(e){return t.updateSetting(e,"send_data")}),h.qZA(),h.qZA(),h.TgZ(50,"ion-item"),h.TgZ(51,"ion-label"),h._uU(52),h.ALo(53,"translate"),h.qZA(),h.TgZ(54,"ion-toggle",10),h.NdJ("click",function(e){return t.updateSetting(e,"alert_offline")}),h.qZA(),h.qZA(),h.TgZ(55,"ion-item"),h.TgZ(56,"ion-label"),h._uU(57),h.ALo(58,"translate"),h.qZA(),h.TgZ(59,"ion-toggle",10),h.NdJ("click",function(e){return t.updateSetting(e,"alert_factor")}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(60,"ion-list"),h.TgZ(61,"ion-list-header"),h.TgZ(62,"ion-label"),h._uU(63),h.ALo(64,"translate"),h.qZA(),h.qZA(),h.TgZ(65,"ion-item"),h.TgZ(66,"ion-label"),h._uU(67),h.ALo(68,"translate"),h.qZA(),h.TgZ(69,"ion-note",0),h._uU(70),h.qZA(),h.qZA(),h.TgZ(71,"ion-item"),h.TgZ(72,"ion-label"),h._uU(73,"Firmware"),h.qZA(),h.TgZ(74,"ion-note",0),h._uU(75,"1.1"),h.qZA(),h.qZA(),h.TgZ(76,"ion-item"),h.TgZ(77,"ion-label"),h._uU(78),h.ALo(79,"translate"),h.qZA(),h.TgZ(80,"ion-note",0),h._uU(81),h.ALo(82,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,21,"DEVICE_MOD.SETTING_DEVICE")),h.xp6(5),h.Q6J("ngIf",t.loading.pending),h.xp6(7),h.Oqu(h.lcZ(16,23,"DEVICE_MOD.NAME")),h.xp6(3),h.Oqu(null==t.device_infor?null:t.device_infor.name),h.xp6(5),h.Oqu(h.lcZ(24,25,"WARNING")),h.xp6(2),h.Q6J("ngForOf",t.config),h.xp6(4),h.Oqu(h.lcZ(30,27,"DEVICE_MOD.SETTING")),h.xp6(5),h.Oqu(h.lcZ(35,29,"DEVICE_MOD.AUTO_RECORD")),h.xp6(2),h.Q6J("innerHTML",t.device_infor.third_app_setting?t.device_infor.third_app_setting.mode_data:"no",h.oJD),h.xp6(5),h.Oqu(h.lcZ(42,31,"DEVICE_MOD.CONFIG_CONNECT")),h.xp6(6),h.Oqu(h.lcZ(48,33,"DEVICE_MOD.NO_SEND_DATA")),h.xp6(2),h.Q6J("checked",1==+(null==t.device_infor||null==t.device_infor.setting?null:t.device_infor.setting.send_data)),h.xp6(3),h.Oqu(h.lcZ(53,35,"DEVICE_MOD.OFFINE_WARNING")),h.xp6(2),h.Q6J("checked",1==+(null==t.device_infor||null==t.device_infor.setting?null:t.device_infor.setting.alert_offline)),h.xp6(3),h.Oqu(h.lcZ(58,37,"DEVICE_MOD.WARNING_OVER")),h.xp6(2),h.Q6J("checked",1==+(null==t.device_infor||null==t.device_infor.setting?null:t.device_infor.setting.alert_factor)),h.xp6(4),h.Oqu(h.lcZ(64,39,"DEVICE_MOD.INFOR")),h.xp6(4),h.Oqu(h.lcZ(68,41,"DEVICE_MOD.VER")),h.xp6(3),h.Oqu(null==t.device_infor?null:t.device_infor.version),h.xp6(8),h.Oqu(h.lcZ(79,43,"DEVICE_MOD.ACTIVE")),h.xp6(3),h.Oqu(h.xi3(82,45,1e3*(null==t.device_infor?null:t.device_infor.add_time),"MM.dd.yyyy")))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,o.O5,l.W2,l.q_,l.Ie,l.Q$,l.yh,o.sg,l.yW,l.ho,l.w,l.uN,l.X7,o.PC],pipes:[f.X$,o.uU],styles:[""]}),e}(),jr=["lineCanvas"];function Hr(e,t){1&e&&h._UZ(0,"ion-progress-bar",13)}function Gr(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"div",16),h._uU(2),h.qZA(),h.TgZ(3,"div",17),h._uU(4),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit,i=h.oxw();h.xp6(1),h.Q6J("ngStyle",i.calculateColor(null==i.justItem[n]?null:i.justItem[n].color)),h.xp6(1),h.hij(" ",i.justItem[n].label," "),h.xp6(1),h.Q6J("ngStyle",i.calculateColor(null==i.justItem[n]?null:i.justItem[n].color)),h.xp6(1),h.hij(" ",null==i.justItem[n]?null:i.justItem[n].value," ")}}function Br(e,t){if(1&e&&(h.TgZ(0,"ion-col",14),h.YNc(1,Gr,5,4,"div",15),h.qZA()),2&e){var n=t.$implicit,i=h.oxw();h.xp6(1),h.Q6J("ngIf",i.justItem[n].value&&i.justItem[n].label)}}function zr(e,t){if(1&e&&h._UZ(0,"div",18),2&e){var n=h.oxw();h.Q6J("options",n.optionChartsAll)("merge",n.mergesAll)}}var $r=function(){var e=function(){function e(t,n,i,o,a,s,c,l,u){r(this,e),this.modalController=t,this.route=n,this.afs=i,this.pondService=o,this.toastService=a,this.alertController=s,this.cd=c,this.iotService=l,this.translate=u,this.optionCharts={},this.optionChartsAll={},this.merges={},this.mergesAll={},this.datasets=[],this.justItem={},this.seleted=3,this.loading=new p.E,this.loadStatis=new kt.X(1),this.show=!1,this.dataOption={},this.startRange=7,this.limitLoadDate=new Date}return c(e,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.id=this.route.snapshot.paramMap.get("device_id"),e.next=3,this.loadRangeBar();case 3:case"end":return e.stop()}},e,this)}))}},{key:"ionViewWillEnter",value:function(){this.getInfor()}},{key:"setMergeAll",value:function(e,t){this.mergesAll=this.optionChartsAll,this.mergesAll.series[e].data.push(t)}},{key:"setOptionChartAll",value:function(e){var t=[],n=[];for(var i in e)t.length<3&&t.push({type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1},show:0==t.length,position:t.length%2==0?"left":"right",offset:0}),n.push({name:i,type:"line",smooth:!0,symbol:"none",yAxisIndex:"orp"==i?2:"rtd"==i?1:0,data:e[i].data,itemStyle:{color:1==this.isColor(e[i].color.substring(1))?e[i].color:"#244988"}});return this.mergesAll={series:n},this.optionChartsAll={tooltip:{trigger:"axis",formatter:function(e){var t={};e.forEach(function(e){e.seriesName in t||(t[e.seriesName]='<p><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e.color+'"></span>'+e.seriesName+" : "+e.data.value[1]+"<br/></p>")});var n="<p>"+m(e[0].value[0]).format("HH:mm YYYY-MM-DD")+"</p>";for(var i in t)n+=t[i];return n},position:["50%","50%"]},color:["#000000"],title:{left:"center",text:"Bi\u1ec3u \u0111\u1ed3"},grid:{left:"0%",right:"12px",bottom:"12%",containLabel:!0},xAxis:{type:"time"},yAxis:t,dataZoom:[{type:"inside",start:0,end:100},{start:0,end:10,type:"inside",handleIcon:"M512 512m-208 0a6.5 6.5 0 1 0 416 0 6.5 6.5 0 1 0-416 0Z M512 192C335.264 192 192 335.264 192 512c0 176.736 143.264 320 320 320s320-143.264 320-320C832 335.264 688.736 192 512 192zM512 800c-159.072 0-288-128.928-288-288 0-159.072 128.928-288 288-288s288 128.928 288 288C800 671.072 671.072 800 512 800z",handleSize:"100%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:n},this.optionChartsAll}},{key:"setOptionChart",value:function(e,t,n,i){return{tooltip:{trigger:"axis",position:["50%","50%"]},color:["#000000"],title:{left:"center",text:e,textStyle:{color:1==this.isColor(t.substring(1))?t:"#244988"}},grid:{left:"2%",right:"5%",bottom:"12%",containLabel:!0},xAxis:[{type:"category",data:n,boundaryGap:!1}],yAxis:[{type:"value",boundaryGap:[0,"100%"]}],dataZoom:[{type:"inside",start:0,end:100},{start:0,end:10,type:"inside",handleIcon:"M512 512m-208 0a6.5 6.5 0 1 0 416 0 6.5 6.5 0 1 0-416 0Z M512 192C335.264 192 192 335.264 192 512c0 176.736 143.264 320 320 320s320-143.264 320-320C832 335.264 688.736 192 512 192zM512 800c-159.072 0-288-128.928-288-288 0-159.072 128.928-288 288-288s288 128.928 288 288C800 671.072 671.072 800 512 800z",handleSize:"100%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{name:e,type:"line",smooth:!0,symbol:"none",sampling:"average",data:i,itemStyle:{color:1==this.isColor(t.substring(1))?t:"#244988"},areaStyle:{color:new Sr.graphic.LinearGradient(0,0,0,1,[{offset:0,color:1==this.isColor(t.substring(1))?t:"#3c7ae4"},{offset:1,color:1==this.isColor(t.substring(1))?t:"#3c7ae4"}])}}]}}},{key:"isColor",value:function(e){return"string"==typeof e&&6===e.length&&!isNaN(Number("0x"+e))}},{key:"loadRangeBar",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,o,a,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,n=m(),e.next=3,this.afs.collection("pub").doc(this.id).collection("factors").get().toPromise();case 3:return i=e.sent,o=0,a=7,e.next=7,i.forEach(function(e){return(0,d.mG)(r,void 0,void 0,regeneratorRuntime.mark(function i(){var r,s=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o+=1,r=e.id,e.data(),i.next=5,this.afs.collection("pub").doc(this.id).collection("factors").doc(r).collection("data",function(e){return e.orderBy("time","asc").limit(1)}).get().toPromise();case 5:return i.next=7,i.sent.forEach(function(e){return(0,d.mG)(s,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:o-=1,e.data().time.toMillis()>t&&(t=e.data().time.toMillis(),this.startRange=n.diff(m(t),"days"),a=this.startRange-this.startRange%7==this.startRange?this.startRange-7:this.startRange-this.startRange%7),0==o&&(this.seleted=a);case 1:case"end":return i.stop()}},i,this)}))});case 7:case"end":return i.stop()}},i,this)}))});case 7:case"end":return e.stop()}},e,this)}))}},{key:"getInfor",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iotService.get(this.id).catch(function(){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))});case 2:(t=e.sent)&&1==t.status?this.deviceInfor=t.data:t&&0==t.status&&this.toastService.warning(t.error);case 4:case"end":return e.stop()}},e,this)}))}},{key:"getData",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loading.setPending(!0),this.dataOption={},this.optionChartsAll={},n=new Date(m(this.limitLoadDate).subtract(e,"days").toDate()),(i=new Date(m(n).add(7,"days").toDate())).getTime()>this.limitLoadDate.getTime()&&(i=this.limitLoadDate),this.afs.collection("pub").doc(this.id).collection("factors").get().forEach(function(e){return(0,d.mG)(o,void 0,void 0,regeneratorRuntime.mark(function t(){var o,a,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.docs.length,a=0,t.next=3,e.forEach(function(e){return(0,d.mG)(r,void 0,void 0,regeneratorRuntime.mark(function t(){var r,s,c=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.id,s=e.data(),this.dataOption[s.name]={},this.dataOption[s.name].x=[],this.dataOption[s.name].title=s.ui.label,this.dataOption[s.name].color=s.ui?s.ui.color:"#244988",this.dataOption[s.name].data=[],t.next=8,this.afs.collection("pub").doc(this.id).collection("factors").doc(r).collection("data",function(e){return e.where("time",">=",n).where("time","<",i).orderBy("time","asc")}).get().subscribe(function(e){return(0,d.mG)(c,void 0,void 0,regeneratorRuntime.mark(function t(){var i,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.datasets.includes(s.name)||this.datasets.push(s.name),this.justItem[s.name]={},this.justItem[s.name].label=s.ui.label,this.justItem[s.name].color=s.ui?s.ui.color:"#244988",i=n.getTime(),t.next=4,e.forEach(function(e){var t=m(e.data().time.toMillis()).format("HH:00:00 YYYY-MM-DD"),n=new Date(t).getTime();i!=n&&(r.dataOption[s.name].x.push(t),r.dataOption[s.name].data.push({value:[new Date(t),e.data().value]}),r.justItem[s.name].value=e.data().value,r.justItem[s.name].lastTime=e.data().time.toMillis(),i=n)});case 4:(a+=1)==o&&(this.loadStatis.next(0),this.loading.setResult(!0),this.datasets.sort(),this.setOptionChartAll(this.dataOption));case 6:case"end":return t.stop()}},t,this)}))});case 8:case"end":return t.stop()}},t,this)}))});case 3:case"end":return t.stop()}},t)}))}),this.loadStatis.subscribe(function(e){0==e&&(o.limitLoadDate=new Date(m(o.limitLoadDate).subtract(o.startRange-o.seleted).toDate()),o.afs.collection("pub").doc(o.id).collection("factors").get().forEach(function(e){e.forEach(function(e){var t=e.id,n=e.data();o.afs.collection("pub").doc(o.id).collection("factors").doc(t).collection("data",function(e){return e.orderBy("time","desc").limit(1)}).stateChanges(["added"]).subscribe(function(e){e.reverse().map(function(e){n.name in o.justItem||(o.justItem[n.name]={}),o.justItem[n.name].color=void 0!==n.ui.color?n.ui.color:"#244988",o.justItem[n.name].value=e.payload.doc.data().value,o.justItem[n.name].lastTime=e.payload.doc.data().time.toMillis();var t=o.optionChartsAll.series.findIndex(function(e){return e.name===n.name});-1!=t&&o.optionChartsAll.series[t].data.push({value:[new Date(m(e.payload.doc.data().time.toMillis()).format("HH:mm YYYY-MM-DD")),e.payload.doc.data().value]}),o.mergesAll={series:o.optionChartsAll.series}})})})}))});case 3:case"end":return t.stop()}},t,this)}))}},{key:"add",value:function(){this.optionCharts.do.xAxis[0].data.push(m().format("MMMM Do YYYY, h:mm:ss a")),this.optionCharts.do.series[0].data.push(5)}},{key:"filterData",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}},{key:"presentSetting",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Vr,componentProps:{id:this.id,device_infor:this.deviceInfor}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentChooseDelete",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:Cr,cssClass:"my-custom-class",componentProps:{max:this.justItem[e].lastTime}});case 2:return(n=t.sent).onDidDismiss().then(function(t){void 0!==t.data&&i.deleteData(t.data,e)}),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"presentFilterDelete",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Nr,cssClass:"my-custom-class",componentProps:{justItem:this.justItem,id:this.id}});case 2:return(t=e.sent).onDidDismiss().then(function(e){void 0!==e.data&&(n.seleted=e.data,n.getData(n.startRange-n.seleted))}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"deleteData",value:function(e,t){var n=this;e=new Date(e),console.log(e);var i=this.afs.firestore.batch(),o=0;this.afs.collection("pub").doc(this.id).collection("factors").doc(t).collection("data",function(t){return t.orderBy("time","desc").where("time","<",e)}).get().forEach(function(e){0==e.docs.length&&n.toastService.warning(n.translate.instant("DEVICE_MOD.DATA_NULL")),e.forEach(function(t){console.log(t.ref),i.delete(t.ref),o+=1,t.id==e.docs[e.docs.length-1].id&&i.commit().then(function(e){n.getData(n.startRange-n.seleted),n.toastService.success(n.translate.instant("DEVICE_MOD.REMOVE_DATA_SUCCESS"))}).catch(function(e){n.toastService.warning(n.translate.instant("DEVICE_MOD.REMOVE_DATA_UNSUCCESS"))}),499==o&&(i.commit(),i=n.afs.firestore.batch(),o=0)})})}},{key:"calculateColor",value:function(e){return{color:e}}},{key:"numberEffect",value:function(e){}},{key:"ionViewDidEnter",value:function(){this.show=!0}},{key:"setRangeDay",value:function(){this.getData(this.startRange-this.seleted)}},{key:"getLabelDayRange",value:function(){var e=new Date(m(this.limitLoadDate).subtract(this.startRange-this.seleted,"days").toDate()),t=new Date(m(e).add(7,"days").toDate());return t.getTime()>this.limitLoadDate.getTime()&&(t=this.limitLoadDate),"T\u1eeb "+m(e).format("DD-MM-YYYY")+" \u0111\u1ebfn "+m(t).format("DD-MM-YYYY")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(s.gz),h.Y36(Lt.ST),h.Y36(g.p),h.Y36(x.k),h.Y36(l.Br),h.Y36(h.sBO),h.Y36(Me.d),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pub-device"]],viewQuery:function(e,t){var n;(1&e&&h.Gf(jr,7),2&e)&&(h.iGM(n=h.CRH())&&(t.chartRef=n.first))},decls:24,vars:14,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["color","tb"],["slot","end"],["color","danger","slot","end",3,"click"],[3,"disabled","click"],["slot","icon-only","name","cog-outline"],["type","indeterminate",4,"ngIf"],["size","6","size-md","3","class","ion-text-center ion-margin-top",4,"ngFor","ngForOf"],["style","margin-top: 12px;","echarts","",3,"options","merge",4,"ngIf"],["lines","none"],["min","0","step","7","snaps","true","color","primary",3,"max","ngClass","ngModel","ngModelChange","ionChange"],[1,"ion-text-center"],["type","indeterminate"],["size","6","size-md","3",1,"ion-text-center","ion-margin-top"],[4,"ngIf"],[1,"title","ion-text-uppercase",3,"ngStyle"],[1,"f-value",3,"ngStyle"],["echarts","",2,"margin-top","12px",3,"options","merge"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h._UZ(3,"ion-back-button",1),h.qZA(),h.TgZ(4,"ion-title",2),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"ion-buttons",3),h.TgZ(8,"ion-button",4),h.NdJ("click",function(){return t.presentFilterDelete()}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"ion-button",5),h.NdJ("click",function(){return t.presentSetting()}),h._UZ(12,"ion-icon",6),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(13,"ion-content"),h.YNc(14,Hr,1,0,"ion-progress-bar",7),h.TgZ(15,"ion-grid"),h.TgZ(16,"ion-row"),h.YNc(17,Br,2,1,"ion-col",8),h.qZA(),h.qZA(),h.YNc(18,zr,1,2,"div",9),h.TgZ(19,"ion-list",10),h.TgZ(20,"ion-item"),h.TgZ(21,"ion-range",11),h.NdJ("ngModelChange",function(e){return t.seleted=e})("ionChange",function(){return t.setRangeDay()}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(22,"p",12),h._uU(23),h.qZA(),h.qZA()),2&e&&(h.xp6(5),h.Oqu(h.lcZ(6,10,"DEVICE_MOD.ENVISOR")),h.xp6(4),h.Oqu(h.lcZ(10,12,"DEVICE_MOD.REMOVE")),h.xp6(2),h.Q6J("disabled",!t.iotService.checkPermission(t.pondService.permission)),h.xp6(3),h.Q6J("ngIf",t.loading.pending),h.xp6(3),h.Q6J("ngForOf",t.datasets),h.xp6(1),h.Q6J("ngIf",t.show),h.xp6(3),h.Q6J("max",t.startRange-7)("ngClass",t.loading.pending?"disableSelect":"")("ngModel",t.seleted),h.xp6(2),h.Oqu(t.getLabelDayRange()))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.YG,l.gu,l.W2,o.O5,l.jY,l.Nd,o.sg,l.q_,l.Ie,l.I_,l.QI,o.mk,a.JJ,a.On,l.X7,l.wI,o.PC,u._w],pipes:[f.X$],styles:['.f-value[_ngcontent-%COMP%]{font-size:2em;font-family:Atomic}.icon-title[_ngcontent-%COMP%]:before{content:"";height:2px;background:#244988;width:10%;margin-right:12px;display:inline-block;vertical-align:middle}.icon-title[_ngcontent-%COMP%]:after{content:"";height:2px;background:#244988;width:10%;margin-left:12px;display:inline-block;vertical-align:middle}.title[_ngcontent-%COMP%]{font-size:.8em}.disableSelect[_ngcontent-%COMP%]{pointer-events:none}']}),e}(),Wr=function(){var e=function(){function e(t,n,i,o,a,s){r(this,e),this.modalController=t,this.iotService=n,this.alertController=i,this.toastService=o,this.pondService=a,this.translate=s,this.loading=new p.E}return c(e,[{key:"ngOnInit",value:function(){console.log(this.device),this.device.setting||(this.device.setting={phone_alert:0,alert_control:1,alert_offline:1,automatic:1})}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"presentUpdateDevice",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("DEVICE_MOD.UPDATE_INFOR"),inputs:[{name:"name",type:"text",value:this.device.name,placeholder:this.translate.instant("DEVICE_MOD.NAME")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.saveDevice(e)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"saveDevice",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.iotService.update(e.name,this.device.id).catch(function(){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 2:(n=t.sent)&&1==n.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),this.device.name=e.name):n&&0==n.status&&this.toastService.warning(n.messages);case 4:case"end":return t.stop()}},t,this)}))}},{key:"presentConfigWifi",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Rr.i,cssClass:"my-custom-class",componentProps:{ssid:this.id+"_"+this.version}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"updateSetting",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(i={phone_alert:this.device.setting.phone_alert,alert_control:this.device.setting.alert_control,alert_offline:this.device.setting.alert_offline,automatic:this.device.setting.automatic})[t]=1==i[t]?0:1,n.next=4,this.iotService.updateSetting(this.device.id,i).catch(function(){a.toastService.danger(a.translate.instant("ERROR_CONNECT")),e.target.checked=0==i[t]});case 4:(o=n.sent)&&1==o.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),this.device.setting[t]=i[t]):o&&0==o.status&&(this.toastService.warning(o.errors),e.target.checked=0==i[t]);case 6:case"end":return n.stop()}},n,this)}))}},{key:"updatePhoneSetting",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this.device.setting).phone_alert=e,t.next=4,this.iotService.updateSetting(this.device.id,n).catch(function(){o.toastService.danger(o.translate.instant("ERROR_CONNECT"))});case 4:(i=t.sent)&&1==i.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),this.device.setting.phone_alert=n.phone_alert):i&&0==i.status&&this.toastService.warning(i.errors);case 6:case"end":return t.stop()}},t,this)}))}},{key:"presentUpdatePhone",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("DEVICE_MOD.UPDATE_INFOR"),inputs:[{name:"phone",type:"text",value:this.device.setting.phone_alert,placeholder:this.translate.instant("DEVICE_MOD.NAME")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.updatePhoneSetting(e.phone)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(Me.d),h.Y36(l.Br),h.Y36(x.k),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-settings"]],inputs:{device:"device",id:"id",version:"version"},decls:83,vars:37,consts:[["slot","end"],[3,"click"],["slot","icon-only","name","close"],["name","calculator-outline","slot","start"],[2,"color","#244988"],["slot","end","mode","ios","fill","clear",3,"disabled","click"],["name","create"],["name","wifi-outline","slot","start"],["name","call-outline","slot","start"],["name","aperture-outline","slot","start"],["mode","ios","slot","end",3,"checked","click"],["name","alert-circle-outline","slot","start"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-list"),h.TgZ(10,"ion-list-header"),h.TgZ(11,"ion-label"),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.qZA(),h.TgZ(14,"ion-item"),h._UZ(15,"ion-icon",3),h.TgZ(16,"ion-label"),h.TgZ(17,"h3",4),h._uU(18),h.ALo(19,"translate"),h.qZA(),h.TgZ(20,"p"),h._uU(21),h.qZA(),h.qZA(),h.TgZ(22,"ion-button",5),h.NdJ("click",function(){return t.presentUpdateDevice()}),h._UZ(23,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(24,"ion-item"),h._UZ(25,"ion-icon",7),h.TgZ(26,"ion-label"),h.TgZ(27,"h3",4),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.qZA(),h.TgZ(30,"ion-button",5),h.NdJ("click",function(){return t.presentConfigWifi()}),h._UZ(31,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(32,"ion-item"),h._UZ(33,"ion-icon",8),h.TgZ(34,"ion-label"),h.TgZ(35,"h3",4),h._uU(36),h.ALo(37,"translate"),h.qZA(),h.TgZ(38,"p"),h._uU(39),h.qZA(),h.qZA(),h.TgZ(40,"ion-button",5),h.NdJ("click",function(){return t.presentUpdatePhone()}),h._UZ(41,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(42,"ion-item"),h._UZ(43,"ion-icon",9),h.TgZ(44,"ion-label"),h.TgZ(45,"h3",4),h._uU(46,"T\u1ef1 \u0111\u1ed9ng"),h.qZA(),h.qZA(),h.TgZ(47,"ion-toggle",10),h.NdJ("click",function(e){return t.updateSetting(e,"automatic")}),h.qZA(),h.qZA(),h.TgZ(48,"ion-item"),h._UZ(49,"ion-icon",11),h.TgZ(50,"ion-label"),h.TgZ(51,"h3",4),h._uU(52,"C\u1ea3nh b\xe1o \u0111i\u1ec1u khi\u1ec3n"),h.qZA(),h.qZA(),h.TgZ(53,"ion-toggle",10),h.NdJ("click",function(e){return t.updateSetting(e,"alert_control")}),h.qZA(),h.qZA(),h.TgZ(54,"ion-item"),h._UZ(55,"ion-icon",11),h.TgZ(56,"ion-label"),h.TgZ(57,"h3",4),h._uU(58,"C\u1ea3nh b\xe1o offline"),h.qZA(),h.qZA(),h.TgZ(59,"ion-toggle",10),h.NdJ("click",function(e){return t.updateSetting(e,"alert_offline")}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(60,"ion-list"),h.TgZ(61,"ion-list-header"),h.TgZ(62,"ion-label"),h._uU(63),h.ALo(64,"translate"),h.qZA(),h.qZA(),h.TgZ(65,"ion-item"),h.TgZ(66,"ion-label"),h._uU(67),h.ALo(68,"translate"),h.qZA(),h.TgZ(69,"ion-text",0),h._uU(70),h.qZA(),h.qZA(),h.TgZ(71,"ion-item"),h.TgZ(72,"ion-label"),h._uU(73,"Firmware"),h.qZA(),h.TgZ(74,"ion-text",0),h._uU(75,"1.1"),h.qZA(),h.qZA(),h.TgZ(76,"ion-item"),h.TgZ(77,"ion-label"),h._uU(78),h.ALo(79,"translate"),h.qZA(),h.TgZ(80,"ion-text",0),h._uU(81),h.ALo(82,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,18,"DEVICE_MOD.CONFIG_CABINET")),h.xp6(9),h.Oqu(h.lcZ(13,20,"DEVICE_MOD.SETTING")),h.xp6(6),h.Oqu(h.lcZ(19,22,"DEVICE_MOD.NAME")),h.xp6(3),h.Oqu(null==t.device?null:t.device.name),h.xp6(1),h.Q6J("disabled",!t.iotService.checkPermission(t.pondService.permission)),h.xp6(6),h.Oqu(h.lcZ(29,24,"DEVICE_MOD.CONFIG_CONNECT")),h.xp6(2),h.Q6J("disabled",!t.iotService.checkPermission(t.pondService.permission)),h.xp6(6),h.Oqu(h.lcZ(37,26,"DEVICE_MOD.PHONE")),h.xp6(3),h.Oqu(null==t.device?null:t.device.setting.phone_alert),h.xp6(1),h.Q6J("disabled",!t.iotService.checkPermission(t.pondService.permission)),h.xp6(7),h.Q6J("checked",t.device.setting.automatic),h.xp6(6),h.Q6J("checked",t.device.setting.alert_control),h.xp6(6),h.Q6J("checked",t.device.setting.alert_offline),h.xp6(4),h.Oqu(h.lcZ(64,28,"DEVICE_MOD.INFOR")),h.xp6(4),h.Oqu(h.lcZ(68,30,"DEVICE_MOD.VER")),h.xp6(3),h.Oqu(t.version),h.xp6(8),h.Oqu(h.lcZ(79,32,"DEVICE_MOD.ACTIVE")),h.xp6(3),h.Oqu(h.xi3(82,34,1e3*t.device.add_time,"MM.dd.yyyy")))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,l.q_,l.yh,l.Q$,l.Ie,l.ho,l.w,l.yW],pipes:[f.X$,o.uU],styles:[""]}),e}();function Xr(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",16),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.device_id_fb),h.xp6(1),h.Oqu(n.name)}}function Kr(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",16),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.id),h.xp6(1),h.Oqu(n.label)}}function es(e,t){if(1&e&&(h.TgZ(0,"ion-select",17),h.YNc(1,Kr,2,2,"ion-select-option",5),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngForOf",n.deviceSeleted.peripherals)}}var ts=function(){var e=function(){function e(t,n,i,o,s){r(this,e),this.modalController=t,this.afs=n,this.iotService=i,this.translate=o,this.toastService=s,this.form=new a.cw({condition:new a.NI("",a.kI.required),value:new a.NI("",a.kI.required),peripheral_source_id:new a.NI("",a.kI.required),peripheral_target_id:new a.NI("",a.kI.required),envisorId:new a.NI("")})}return c(e,[{key:"ngOnInit",value:function(){this.form.patchValue({peripheral_target_id:this.peripheral_target_id})}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"getListIndex",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.iotService.getInforDevice(e).catch(function(){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 2:(n=t.sent)&&n.status?this.deviceSeleted=n.data:n&&!n.status&&this.toastService.warning("Thi\u1ebft b\u1ecb kh\xf4ng t\u1ed3n t\u1ea1i");case 4:case"end":return t.stop()}},t,this)}))}},{key:"save",value:function(){var e=this,t=this.form.value,n=this.deviceSeleted.peripherals.findIndex(function(t){return t.id===e.form.value.peripheral_source_id});console.log(n),t.device_name=this.deviceSeleted.name,t.color=this.deviceSeleted.peripherals[n].color,t.label=this.deviceSeleted.peripherals[n].label,this.modalController.dismiss(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(Lt.ST),h.Y36(Me.d),h.Y36(f.sK),h.Y36(x.k))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-add-condition"]],inputs:{listDevices:"listDevices",peripheral_target_id:"peripheral_target_id"},decls:55,vars:49,consts:[["slot","end"],[3,"click"],["name","close"],[3,"formGroup"],["formControlName","envisorId",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","peripheral_source_id",4,"ngIf"],["formControlName","condition"],["value",">"],["value",">="],["value","<"],["value","<="],["value","="],["type","number","formControlName","value","slot","end"],[2,"text-align","center"],["expand","small",3,"disabled","click"],[3,"value"],["formControlName","peripheral_source_id"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-list"),h.TgZ(10,"form",3),h.TgZ(11,"ion-item"),h.TgZ(12,"ion-label"),h._uU(13),h.ALo(14,"translate"),h.qZA(),h.TgZ(15,"ion-select",4),h.NdJ("ionChange",function(e){return t.getListIndex(e.detail.value)}),h.YNc(16,Xr,2,2,"ion-select-option",5),h.qZA(),h.qZA(),h.TgZ(17,"ion-item"),h.TgZ(18,"ion-label"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.YNc(21,es,2,1,"ion-select",6),h.qZA(),h.TgZ(22,"ion-item"),h.TgZ(23,"ion-label"),h._uU(24),h.ALo(25,"translate"),h.qZA(),h.TgZ(26,"ion-select",7),h.TgZ(27,"ion-select-option",8),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.TgZ(30,"ion-select-option",9),h._uU(31),h.ALo(32,"translate"),h.ALo(33,"translate"),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-select-option",10),h._uU(36),h.ALo(37,"translate"),h.qZA(),h.TgZ(38,"ion-select-option",11),h._uU(39),h.ALo(40,"translate"),h.ALo(41,"translate"),h.ALo(42,"translate"),h.qZA(),h.TgZ(43,"ion-select-option",12),h._uU(44),h.ALo(45,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(46,"ion-item"),h.TgZ(47,"ion-label"),h._uU(48),h.ALo(49,"translate"),h.qZA(),h._UZ(50,"ion-input",13),h.qZA(),h.qZA(),h.qZA(),h.TgZ(51,"div",14),h.TgZ(52,"ion-button",15),h.NdJ("click",function(){return t.save()}),h._uU(53),h.ALo(54,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,19,"DEVICE_MOD.CONFIG_CONDITION")),h.xp6(7),h.Q6J("formGroup",t.form),h.xp6(3),h.Oqu(h.lcZ(14,21,"DEVICE_MOD.CHOOSE_DEVICE")),h.xp6(3),h.Q6J("ngForOf",t.listDevices),h.xp6(3),h.Oqu(h.lcZ(20,23,"DEVICE_MOD.CHOOSE_INDEX")),h.xp6(2),h.Q6J("ngIf",t.deviceSeleted),h.xp6(3),h.Oqu(h.lcZ(25,25,"DEVICE_MOD.CONFIG_CONDITION")),h.xp6(4),h.Oqu(h.lcZ(29,27,"DEVICE_MOD.GREATER_THAN")),h.xp6(3),h.lnq("",h.lcZ(32,29,"DEVICE_MOD.GREATER_THAN")," ",h.lcZ(33,31,"DEVICE_MOD.OR")," ",h.lcZ(34,33,"DEVICE_MOD.SAME"),""),h.xp6(5),h.Oqu(h.lcZ(37,35,"DEVICE_MOD.LESS_THAN")),h.xp6(3),h.lnq("",h.lcZ(40,37,"DEVICE_MOD.LESS_THAN")," ",h.lcZ(41,39,"DEVICE_MOD.OR")," ",h.lcZ(42,41,"DEVICE_MOD.SAME"),""),h.xp6(5),h.Oqu(h.lcZ(45,43,"DEVICE_MOD.SAME")),h.xp6(4),h.Oqu(h.lcZ(49,45,"DEVICE_MOD.VALUE")),h.xp6(4),h.Q6J("disabled",t.form.invalid),h.xp6(1),h.Oqu(h.lcZ(54,47,"DEVICE_MOD.ADD")))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,l.q_,a._Y,a.JL,a.sg,l.Ie,l.Q$,l.t9,l.QI,a.JJ,a.u,o.sg,o.O5,l.n0,l.pK,l.as],pipes:[f.X$],styles:[""]}),e}(),ns=i(38800);function is(e,t){1&e&&h._UZ(0,"ion-progress-bar",11)}function os(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",12),h.TgZ(2,"p"),h.TgZ(3,"ion-text"),h.TgZ(4,"span"),h.TgZ(5,"b"),h._uU(6),h.qZA(),h.qZA(),h._uU(7," | "),h.TgZ(8,"span",13),h._uU(9),h.qZA(),h._uU(10),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"ion-button",5),h.NdJ("click",function(){var e=h.CHM(n),t=e.$implicit,i=e.index;return h.oxw().removeCondition(t,i)}),h._UZ(12,"ion-icon",14),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw();h.xp6(6),h.Oqu(i.peripheral_source.device_name),h.xp6(2),h.Q6J("ngStyle",o.calculateColor(i.peripheral_source.color)),h.xp6(1),h.Oqu(i.peripheral_source.label),h.xp6(1),h.AsE(" ",i.condition," ",i.value,"")}}function as(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",12),h.TgZ(2,"ion-text",15),h._uU(3),h.ALo(4,"translate"),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.TgZ(6,"ion-button",5),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().changeStatusTimer(e)}),h._UZ(7,"ion-icon",16),h.qZA(),h.TgZ(8,"ion-button",5),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().editTimer(e)}),h._UZ(9,"ion-icon",6),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit;h.xp6(2),h.Q6J("color",0==i.enable?"dark":"success"),h.xp6(1),h.HOy("",h.lcZ(4,6,"DEVICE_MOD.FROM")," ",i.start," ",h.lcZ(5,8,"DEVICE_MOD.TO")," ",i.end,""),h.xp6(4),h.Q6J("color",0==i.enable?"dark":"success")}}var rs=function(){var e=function(){function e(t,n,i,o,s,c,l,u,d,g,m,h){r(this,e),this.modalController=t,this.alertController=n,this.afs=i,this.authService=o,this.fns=s,this.afAuth=c,this.toastService=l,this.iotService=u,this.router=d,this.pickerController=g,this.cd=m,this.translate=h,this.loading=new p.E,this.listConditions=[],this.listDevices=[],this.listPond=[],this.isAddDevice=!1,this.isAddCondition=!1,this.isAddTimer=!1,this.listDeviceInPond={},this.form=new a.cw({device_id:new a.NI("",a.kI.required),condition:new a.NI("",a.kI.required),value:new a.NI("",a.kI.required),label:new a.NI("",a.kI.required)}),this.minStart=40,this.minEnd=50,this.hourStart=23,this.hourEnd=23,this.listLabel=[],this.listTimer=[]}return c(e,[{key:"ngOnInit",value:function(){this.listTimer=this.infor.timers,console.log(this.listTimer),this.getListDeviceInPond()}},{key:"getListDeviceInPond",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iotService.list().catch(function(){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))});case 2:(t=e.sent)&&1==t.status?(t.data.forEach(function(e){"envisor"==e.type&&n.listDevices.push(e)}),this.getListCondition()):t&&0==t.status&&this.toastService.warning(t.error);case 4:case"end":return e.stop()}},e,this)}))}},{key:"getListCondition",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.iotService.getListCondition(this.infor.id,this.sub_id).subscribe(function(e){e.status?(t.listConditions=e.data,console.log(t.listConditions)):t.toastService.warning(e.errors)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"convertTimer",value:function(e){var t=parseInt((e/100).toString()),n=e-100*t;return t.toString()+":"+n.toString()}},{key:"changeStatus",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.setPending(!0),e.next=3,this.authService.checkTkFb(this.iotService.pcode,this.afAuth);case 3:if(!e.sent){e.next=7;break}this.fns.httpsCallable("saveContactorConfig")({deviceId:this.sub_id,contactorId:this.infor.id,automatic:this.item.config.contactors&&this.infor.id in this.item.config.contactors&&"automatic"in this.item.config.contactors[this.infor.id]?!this.item.config.contactors[this.infor.id].automatic:0}).subscribe(function(e){t.toastService.success(t.translate.instant("DEVICE_MOD.UPDATE_SETTING")),t.item.config.contactors[t.infor.id].automatic=!t.item.config.contactors[t.infor.id].automatic,t.loading.setResult(!0)}),e.next=8;break;case 7:this.toastService.warning(this.translate.instant("DEVICE_MOD.AUTH_FAILED")),this.loading.setResult(!1);case 8:case"end":return e.stop()}},e,this)}))}},{key:"actionAddDevice",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=[],this.listDeviceInPond)t.push({name:this.listDeviceInPond[n].name,type:"radio",label:this.listDeviceInPond[n].name,value:this.listDeviceInPond[n]});return t[0].checked=!0,e.next=5,this.alertController.create({cssClass:"my-custom-class",header:"Radio",inputs:t,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){i.addDevice(e)}}]});case 5:return e.next=7,e.sent.present();case 7:case"end":return e.stop()}},e,this)}))}},{key:"addDevice",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.listDevices.filter(function(t){return t.device_id==e.device_id_fb}).length>0)){t.next=4;break}this.toastService.warning(this.translate.instant("DEVICE_MOD.DEVICE_EXIST")),this.isAddDevice=!1,t.next=12;break;case 4:return this.loading.setPending(!0),t.next=7,this.authService.checkTkFb(this.iotService.pcode,this.afAuth);case 7:if(!t.sent){t.next=11;break}this.fns.httpsCallable("addContactorCondition")({deviceId:this.sub_id,contactorId:this.infor.id,pubId:e.device_id_fb,conditions:{}}).subscribe(function(e){n.toastService.success(n.translate.instant("DEVICE_MOD.ADDED_DEVICE")),n.isAddDevice=!1,n.loading.setResult(!0)}),t.next=12;break;case 11:this.toastService.warning(this.translate.instant("DEVICE_MOD.AUTH_FAILED"));case 12:case"end":return t.stop()}},t,this)}))}},{key:"removeDevice",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({cssClass:"my-custom-class",header:"X\xe1c nh\u1eadn x\xf3a",message:this.translate.instant("DEVICE_MOD.CONFIRM_REMOVE_DEVICE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){i.loading.setPending(!0),i.handleRemove(e,t)}}]});case 2:return n.next=4,n.sent.present();case 4:case"end":return n.stop()}},n,this)}))}},{key:"handleRemove",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.authService.checkTkFb(this.iotService.pcode,this.afAuth);case 2:if(!n.sent){n.next=6;break}this.fns.httpsCallable("deleteContactorCondition")({deviceId:this.sub_id,contactorId:this.infor.id,conditionId:e.condition_id}).subscribe(function(n){if(i.loading.setResult(!0),i.toastService.success(i.translate.instant("DEVICE_MOD.REMOVE_SUCCESS")),i.listDevices.splice(t,1),i.listDevices.length>0){for(var o=[],a=0;a<i.listConditions.length;a++)i.listConditions[a].pub_id!=e.device_id&&o.push(i.listConditions[a]);i.listConditions=o}else i.listConditions=[]}),n.next=7;break;case 6:this.toastService.warning(this.translate.instant("DEVICE_MOD.AUTH_FAILED"));case 7:case"end":return n.stop()}},n,this)}))}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"actionAddCondition",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:ts,cssClass:"my-custom-class",componentProps:{listDevices:this.listDevices,peripheral_target_id:this.infor.id}});case 2:return(t=e.sent).onDidDismiss().then(function(e){void 0!==e.data&&n.addCondition(e.data)}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"actionAddTimer",value:function(){this.isAddTimer=!this.isAddTimer}},{key:"removeCondition",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("DEVICE_MOD.NOTI_REMOVE"),message:this.translate.instant("DEVICE_MOD.CONFIRM_REMOVE_CONDITION"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){i.handleRemoveCondition(e,t)}}]});case 2:return n.next=4,n.sent.present();case 4:case"end":return n.stop()}},n,this)}))}},{key:"handleRemoveCondition",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.iotService.removeCondition(e.peripheral_target.id,e.peripheral_target.device_id,e.id).subscribe(function(e){e.status?(i.listConditions.splice(t,1),i.toastService.success(i.translate.instant("DEVICE_MOD.REMOVE_CONFITION_CUCCESS"))):i.toastService.warning(i.translate.instant("DEVICE_MOD.AUTH_FAILED"))},function(){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 1:case"end":return n.stop()}},n,this)}))}},{key:"addCondition",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loading.setPending(!0),this.iotService.addCondition(this.infor.id,this.sub_id,e).subscribe(function(t){t.status?(n.listConditions.push({peripheral_source:{device_name:e.device_name,color:e.color,label:e.label},condition:e.condition,value:e.value}),n.loading.setResult(!0),n.toastService.success(n.translate.instant("DEVICE_MOD.ADDED_DEVICE"))):(n.loading.setResult(!0),n.toastService.warning(n.translate.instant("DEVICE_MOD.AUTH_FAILED")))},function(){n.loading.setResult(!1),n.toastService.success(n.translate.instant("ERROR_CONNECT"))});case 1:case"end":return t.stop()}},t,this)}))}},{key:"getListIndex",value:function(e){var t=this;this.listLabel=[],this.afs.collection("pub").doc(this.listDevices[e].device_id).collection("factors").snapshotChanges().forEach(function(n){n.map(function(n){t.listLabel.push({id:n.payload.doc.id,pub_id:t.listDevices[e].device_id,name:n.payload.doc.data().ui.label})})})}},{key:"presentUpdateName",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("DEVICE_MOD.UPDATE_INFOR"),inputs:[{name:"name",type:"text",value:this.infor.name,placeholder:this.translate.instant("DEVICE_MOD.NAME")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.handleUpdateName(e)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"handleUpdateName",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.loading.setPending(!0),this.iotService.updateNameContactor(this.infor.id,this.sub_id,e).subscribe(function(t){t.status?(n.infor.name=e.name,n.loading.setResult(!0),n.toastService.success(n.translate.instant("DEVICE_MOD.UPDATE_SUCCESS"))):(n.loading.setResult(!0),n.toastService.warning(n.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS")))},function(){n.loading.setResult(!1),n.toastService.danger(n.translate.instant("ERROR_CONNECT"))});case 1:case"end":return t.stop()}},t,this)}))}},{key:"openPicker",value:function(e,t){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.pickerController.create({columns:this.getColumns(e),buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",handler:function(e){console.log(e),1==t?i.hourStart=e.col.value:2==t?i.minStart=e.col.value:3==t?i.hourEnd=e.col.value:i.minEnd=e.col.value}}]});case 2:return n.next=4,n.sent.present();case 4:case"end":return n.stop()}},n,this)}))}},{key:"getColumns",value:function(e){return[{name:"col",options:this.getColumnOptions(e)}]}},{key:"getColumnOptions",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n<10?{text:"0"+n,value:n}:{text:n,value:n});return t}},{key:"addTimer",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hourEnd!=this.hourStart||this.minEnd!=this.minStart){e.next=4;break}this.toastService.warning(this.translate.instant("DEVICE_MOD.DUPLICATE_TIMER")),e.next=20;break;case 4:if(1!=this.checkTimer()){e.next=19;break}return t=[],this.listTimer.forEach(function(e){t.push({start:{h:parseInt((parseInt(e.start)/100).toString()),m:e.start%100},end:{h:parseInt((parseInt(e.end)/100).toString()),m:e.end%100}})}),t.push({start:{h:this.hourStart,m:this.minStart},end:{h:this.hourEnd,m:this.minEnd}}),this.isAddTimer=!1,this.loading.setPending(!0),e.next=12,this.authService.checkTkFb(this.iotService.pcode,this.afAuth);case 12:if(!e.sent){e.next=16;break}this.fns.httpsCallable("updateContactorTimer")({deviceId:this.sub_id,contactorId:this.infor.id,timer:t}).subscribe(function(e){n.toastService.success(n.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),n.loading.setResult(!0),n.loading.setResult(!0),n.cd.detectChanges()}),e.next=17;break;case 16:this.loading.setResult(!1),this.toastService.danger(this.translate.instant("DEVICE_MOD.AUTH_FAILED"));case 17:e.next=20;break;case 19:this.toastService.warning(this.translate.instant("DEVICE_MOD.EXIST_TIMER"));case 20:case"end":return e.stop()}},e,this)}))}},{key:"checkTimer",value:function(){var e=100*this.hourStart+this.minStart,t=100*this.hourEnd+this.minEnd,n=!0;return this.listTimer.forEach(function(i){e>=i.start&&t<=i.end&&1==i.enable&&(n=!1)}),console.log(n),n}},{key:"changeStatusTimer",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n={start:this.listTimer[e].start,end:this.listTimer[e].end,index:e+1,enable:0==this.listTimer[e].enable?1:0},this.loading.setPending(!0),this.iotService.updateTimer(this.infor.id,this.sub_id,n).subscribe(function(t){t.status?(i.loading.setResult(!0),i.listTimer[e].enable=n.enable,i.toastService.success(i.translate.instant("DEVICE_MOD.UPDATE_SUCCESS"))):(i.loading.setResult(!0),i.toastService.warning(i.translate.instant("DEVICE_MOD.UPDATE_UNSUCCESS")))},function(){i.loading.setResult(!1),i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 2:case"end":return t.stop()}},t,this)}))}},{key:"actionRemoveTimer",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],this.listTimer.forEach(function(e){n.push({start:{h:parseInt(e.time_start.split(":")[0]),m:parseInt(e.time_start.split(":")[1])},end:{h:parseInt(e.time_end.split(":")[0]),m:parseInt(e.time_end.split(":")[1])}})}),n.splice(e,1),this.isAddTimer=!1,this.loading.setPending(!0),t.next=7,this.authService.checkTkFb(this.iotService.pcode,this.afAuth);case 7:if(!t.sent){t.next=11;break}this.fns.httpsCallable("updateContactorTimer")({deviceId:this.sub_id,contactorId:this.infor.id,timer:n}).subscribe(function(t){i.toastService.success(i.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),i.loading.setResult(!0),i.cd.detectChanges(),i.listTimer.splice(e,1)}),t.next=12;break;case 11:this.loading.setResult(!1),this.toastService.warning(this.translate.instant("DEVICE_MOD.AUTH_FAILED"));case 12:case"end":return t.stop()}},t,this)}))}},{key:"calculateColor",value:function(e){return{color:e}}},{key:"editTimer",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:ns.K,cssClass:"my-custom-class",componentProps:{listTimer:this.listTimer,index:e,deviceId:this.sub_id,contactorId:this.infor.id}});case 2:return(n=t.sent).onDidDismiss().then(function(t){void 0!==t.data&&(t.data.start_int=t.data.start,t.data.start=i.convertTime(t.data.start),t.data.end_int=t.data.end,t.data.end=i.convertTime(t.data.end),i.listTimer[e]=t.data)}),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"convertTime",value:function(e){var t=(e/100).toFixed(0),n=e-100*parseInt(t);return(parseInt(t)<10?"0":"")+t+":"+(n<10?"0":"")+n+":00"}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(l.Br),h.Y36(Lt.ST),h.Y36(Er.e),h.Y36(Yr.l4),h.Y36(Lr.zQ),h.Y36(x.k),h.Y36(Me.d),h.Y36(s.F0),h.Y36(l.up),h.Y36(h.sBO),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-item"]],inputs:{infor:"infor",sub_id:"sub_id"},decls:36,vars:16,consts:[["slot","end"],[3,"click"],["name","close"],["type","indeterminate",4,"ngIf"],["lines","inset"],["slot","end","fill","clear",3,"click"],["name","create"],[4,"ngFor","ngForOf"],["lines","none"],["slot","icon-only","name","add"],["color","tb"],["type","indeterminate"],[1,"ion-text-wrap"],[3,"ngStyle"],["name","remove-circle"],["slot","start",3,"color"],["name","power-outline",3,"color"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"ion-buttons",0),h.TgZ(6,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(7,"ion-icon",2),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(8,is,1,0,"ion-progress-bar",3),h.TgZ(9,"ion-content"),h.TgZ(10,"ion-list",4),h.TgZ(11,"ion-item-group"),h.TgZ(12,"ion-list-header"),h.TgZ(13,"ion-label"),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"ion-item"),h.TgZ(17,"ion-label"),h._uU(18),h.qZA(),h.TgZ(19,"ion-button",5),h.NdJ("click",function(){return t.presentUpdateName()}),h._UZ(20,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(21,"ion-list-header"),h.TgZ(22,"ion-label"),h._uU(23),h.ALo(24,"translate"),h.qZA(),h.qZA(),h.YNc(25,os,13,5,"ion-item",7),h.TgZ(26,"ion-item",8),h.TgZ(27,"ion-button",5),h.NdJ("click",function(){return t.actionAddCondition()}),h._UZ(28,"ion-icon",9),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(29,"ion-list",4),h.TgZ(30,"ion-list-header"),h.TgZ(31,"ion-label",10),h._uU(32),h.ALo(33,"translate"),h.qZA(),h.qZA(),h.TgZ(34,"ion-item-group"),h.YNc(35,as,10,10,"ion-item",7),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(3),h.Oqu(h.lcZ(4,8,"DEVICE_MOD.SETTING_DEVICE")),h.xp6(5),h.Q6J("ngIf",t.loading.pending),h.xp6(6),h.Oqu(h.lcZ(15,10,"DEVICE_MOD.NAME")),h.xp6(4),h.Oqu(null==t.infor?null:t.infor.name),h.xp6(5),h.Oqu(h.lcZ(24,12,"DEVICE_MOD.CONDITION_ON")),h.xp6(2),h.Q6J("ngForOf",t.listConditions),h.xp6(7),h.Oqu(h.lcZ(33,14,"DEVICE_MOD.TIMER")),h.xp6(3),h.Q6J("ngForOf",t.listTimer))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,o.O5,l.W2,l.q_,l.Ub,l.yh,l.Q$,l.Ie,o.sg,l.X7,l.yW,o.PC],pipes:[f.X$],styles:[""]}),e}();function ss(e,t){1&e&&h._UZ(0,"ion-progress-bar",8)}function cs(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div"),h.TgZ(1,"ion-item"),h.TgZ(2,"ion-text",19),h._UZ(3,"b",20),h.qZA(),h.qZA(),h.TgZ(4,"ion-item"),h.TgZ(5,"ion-button",21),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw(2).itemSetting(e.value)}),h._UZ(6,"ion-icon",22),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"ion-toggle",23),h.NdJ("click",function(e){var t=h.CHM(n).$implicit;return h.oxw(2).deviceStatusChange(e,t.key)}),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,o=h.oxw(2);h.xp6(3),h.Q6J("innerHTML",""==i.value.name?"Ch\u01b0a \u0111\u1eb7t t\xean":i.value.name,h.oJD),h.xp6(2),h.Q6J("disabled",!o.iotService.checkPermission(o.pondService.permission)||!o.status$),h.xp6(2),h.hij(" ",h.lcZ(8,6,"DEVICE_MOD.SETTING")," "),h.xp6(2),h.s9C("id",i.id),h.Q6J("disabled",!o.iotService.checkPermission(o.pondService.permission)||!o.status$||o.processToggle.pending)("checked",o.childDevices[i.key].value)}}function ls(e,t){if(1&e&&(h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",24),h.TgZ(2,"ion-label",25),h.TgZ(3,"p"),h.TgZ(4,"span"),h.TgZ(5,"ion-text",26),h._uU(6),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"ion-text",27),h.TgZ(8,"small"),h._uU(9),h.ALo(10,"translate"),h.ALo(11,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var n=t.$implicit,i=h.oxw(2);h.xp6(1),h.Q6J("color",i.checkStatusLog(n.logs)?"success":"dark"),h.xp6(5),h.Oqu(n.log),h.xp6(3),h.AsE("",h.lcZ(10,4,"DEVICE_MOD.AT")," ",h.xi3(11,6,n.time.toMillis(),"yyyy/MM/dd h:mm:ss a"),"")}}function us(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div"),h.TgZ(1,"ion-card",9),h.TgZ(2,"ion-list",10),h.TgZ(3,"ion-item"),h.TgZ(4,"ion-buttons",11),h.TgZ(5,"ion-button"),h._UZ(6,"ion-icon",12),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"ion-item"),h.TgZ(8,"h3",11),h._uU(9),h.qZA(),h.qZA(),h.TgZ(10,"div"),h.TgZ(11,"div",13),h._UZ(12,"ion-spinner",14),h.qZA(),h.YNc(13,cs,10,8,"div",15),h.ALo(14,"keyvalue"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(15,"ion-list",16),h.TgZ(16,"ion-list-header"),h.TgZ(17,"ion-label"),h._uU(18),h.ALo(19,"translate"),h.qZA(),h.qZA(),h.YNc(20,ls,12,9,"ion-item",15),h.TgZ(21,"ion-infinite-scroll",17),h.NdJ("ionInfinite",function(e){return h.CHM(n),h.oxw().loadMoreLogs(e)}),h._UZ(22,"ion-infinite-scroll-content",18),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(6),h.Q6J("color",i.status$?"success":"medium"),h.xp6(3),h.Oqu(null==i.device?null:i.device.name),h.xp6(2),h.Q6J("ngClass",!i.processToggle.pending&&i.status$?"hiddenProcessToggle":""),h.xp6(2),h.Q6J("ngForOf",h.lcZ(14,6,i.childDevices)),h.xp6(5),h.Oqu(h.lcZ(19,8,"DEVICE_MOD.LOG")),h.xp6(2),h.Q6J("ngForOf",i.logs)}}var ds=function(){var e=function(){function e(t,n,i,o,a,s,c,l,u,d,g,m){r(this,e),this.modalController=t,this.route=n,this.afs=i,this.toastService=o,this.authService=a,this.fns=s,this.afAuth=c,this.iotService=l,this.alertController=u,this.router=d,this.pondService=g,this.translate=m,this.version="",this.lastTimeLogs=new Date,this.numLoadRecord=10,this.logs=[],this.loading=new p.E,this.processToggle=new p.E,this.loadingLogs=new p.E}return c(e,[{key:"ngOnInit",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.id=this.route.snapshot.paramMap.get("device_id"),e.next=3,this.getDevice();case 3:this.getLogs(),this.subcriceInit();case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentSetting",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Wr,componentProps:{device:this.device,id:this.id,version:this.version}});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"itemSetting",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:rs,componentProps:{infor:e,sub_id:this.id}});case 2:return t.next=4,t.sent.present();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"subcriceInit",value:function(){var e=this;this.afs.collection("sub").doc(this.id).collection("logs",function(e){return e.orderBy("time","desc").limit(1)}).stateChanges(["added"]).subscribe(function(t){t.map(function(t){var n=t.payload.doc.data();e.logs.length>0&&!m(n.time.toMillis()).isSame(e.logs[0].time.toMillis())&&e.logs.unshift(n)})}),this.afs.collection("sub").doc(this.id).valueChanges().subscribe(function(t){e.status$=t.online}),this.afs.collection("sub").doc(this.id).get().forEach(function(t){e.version=t.data().info.firmware_version});var t=function(t){e.afs.collection("sub").doc(e.id).collection("contactors").doc(t).valueChanges().subscribe(function(n){e.childDevices[t].value!=n.value&&(e.childDevices[t].value=n.value)})};for(var n in this.childDevices)t(n)}},{key:"update",value:function(e,t){return this.afs.collection("sub").doc(this.id).collection("contactors").doc(t).update({value:e})}},{key:"getDevice",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.setPending(!0),e.next=3,this.iotService.getInforDevice(this.id).catch(function(){i.loading.setResult(!1),i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 3:return(t=e.sent)&&t.status?(this.device=t.data,this.childDevices={},this.device.peripherals.forEach(function(e){i.childDevices[e.firestore_id]=e,i.childDevices[e.firestore_id].value=0,e.timers&&Array.isArray(e.timers)&&8==e.timers.length&&(i.childDevices[e.firestore_id].timers=e.timers)})):t&&!t.status&&this.toastService.warning(t.errors.description),e.next=7,this.iotService.get(this.id).catch(function(e){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 7:(n=e.sent)&&n.status?(this.device.name=n.data.name,this.device.add_time=n.data.add_time):t&&!t.status&&this.toastService.warning(t.error.message),this.loading.setResult(!1);case 9:case"end":return e.stop()}},e,this)}))}},{key:"presentUpdateDevice",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:this.translate.instant("DEVICE_MOD.UPDATE_INFOR"),inputs:[{name:"device_name",type:"text",value:this.device.device_name,placeholder:this.translate.instant("DEVICE_MOD.NAME")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){t.saveDevice(e)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"saveDevice",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.iotService.update(this.device.name,this.device.id).catch(function(){i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 2:(n=t.sent)&&1==n.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.UPDATE_SUCCESS")),this.device.device_name=e.device_name):n&&0==n.status&&this.toastService.warning(n.error);case 4:case"end":return t.stop()}},t,this)}))}},{key:"presentConfigWifi",value:function(){var e;return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:Rr.i,cssClass:"my-custom-class",componentProps:{id:this.id,type:"cabinet",name:null===(e=this.device)||void 0===e?void 0:e.name}});case 2:return t.next=4,t.sent.present();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"checkStatusLog",value:function(e){return!!e&&"b\u1eadt"==e.split(" ")[0].toLowerCase()}},{key:"deviceStatusChange",value:function(e,t){var n=this,i={contactorId:t,value:this.childDevices[t].value?0:1,name:this.childDevices[t].name};this.processToggle.setPending(!0),this.iotService.changeStatusContactor(i,this.childDevices[t].id,this.id).subscribe(function(o){1==o.status?(n.processToggle.setResult(!0),n.childDevices[t].value=i.value,n.toastService.success("\u0110\xe3 "+(n.childDevices[t].value?"M\u1edf":"T\u1eaft")+" thi\u1ebft b\u1ecb")):(n.processToggle.setResult(!0),e.target.checked=!!n.childDevices[t].value,n.toastService.warning("Kh\xf4ng th\u1ec3 th\u1ef1c hi\u1ec7n"))},function(){n.processToggle.setResult(!1),e.target.checked=!!n.childDevices[t].value,n.toastService.warning("Kh\xf4ng th\u1ec3 th\u1ef1c hi\u1ec7n [2]")})}},{key:"loadMoreLogs",value:function(e){this.getLogs(),setTimeout(function(){console.log("Done"),e.target.complete()},500)}},{key:"getLogs",value:function(){var e=this;this.afs.collection("sub").doc(this.id).collection("logs",function(t){return t.orderBy("time","desc").where("time","<=",e.lastTimeLogs).limit(e.numLoadRecord)}).get().subscribe(function(t){t.forEach(function(t){e.lastTimeLogs=new Date(t.data().time.toMillis()),e.logs.push(t.data())})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.IN),h.Y36(s.gz),h.Y36(Lt.ST),h.Y36(x.k),h.Y36(Er.e),h.Y36(Yr.l4),h.Y36(Lr.zQ),h.Y36(Me.d),h.Y36(l.Br),h.Y36(s.F0),h.Y36(g.p),h.Y36(f.sK))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-sub-device"]],decls:13,vars:6,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["slot","end"],["color","primary",3,"disabled","click"],["slot","icon-only","name","cog-outline"],[1,"ion-padding"],["type","indeterminate",4,"ngIf"],[4,"ngIf"],["type","indeterminate"],[2,"padding-bottom","12px","padding-top","12px"],["lines","none",1,"box-cabinet"],[2,"margin","0 auto"],["name","ellipse",3,"color"],[1,"ion-text-center",3,"ngClass"],["name","lines-small","mode","ios"],[4,"ngFor","ngForOf"],["lines","none"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","dots"],["color","tb"],[3,"innerHTML"],["slot","start","color","primary","fill","clear",3,"disabled","click"],["name","cog","slot","start"],["mode","ios","slot","end",3,"disabled","id","checked","click"],["name","power-outline",1,"ion-margin-end",3,"color"],[1,"ion-text-wrap"],["color","primary"],["color","medium"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h._UZ(3,"ion-back-button",1),h.qZA(),h.TgZ(4,"ion-title"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"ion-buttons",2),h.TgZ(8,"ion-button",3),h.NdJ("click",function(){return t.presentSetting()}),h._UZ(9,"ion-icon",4),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-content",5),h.YNc(11,ss,1,0,"ion-progress-bar",6),h.YNc(12,us,23,10,"div",7),h.qZA()),2&e&&(h.xp6(5),h.Oqu(h.lcZ(6,4,"DEVICE_MOD.CABINET")),h.xp6(3),h.Q6J("disabled",!t.iotService.checkPermission(t.pondService.permission)),h.xp6(3),h.Q6J("ngIf",t.loading.pending),h.xp6(1),h.Q6J("ngIf",!t.loading.pending))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.YG,l.gu,l.W2,o.O5,l.X7,l.PM,l.q_,l.Ie,o.mk,l.PQ,o.sg,l.yh,l.Q$,l.ju,l.MB,l.yW,l.ho,l.w],pipes:[f.X$,o.Nd,o.uU],styles:[".hiddenProcessToggle[_ngcontent-%COMP%]{opacity:0}"]}),e}(),gs=i(24023),ps=i(84267),ms=i(97905),hs=i(59865),fs=i(38739),Zs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,d.ZT)(t,e),Object.defineProperty(t.prototype,"convertFileSrc",{get:function(){return(0,fs.J2)(this,"convertFileSrc")},set:function(e){(0,fs.Iq)(this,"convertFileSrc",e)},enumerable:!1,configurable:!0}),t.pluginName="WebView",t.plugin="cordova-plugin-ionic-webview",t.pluginRef="window.Ionic.WebView",t.repo="https://github.com/ionic-team/cordova-plugin-ionic-webview",t.platforms=["Android","iOS"],t.install="ionic cordova plugin add cordova-plugin-ionic-webview",t.\u0275fac=function(e){return(n||(n=h.n5z(t)))(e||t)},t.\u0275prov=h.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),t;var n}(fs.KY),vs=i(10740),As=i(49246),_s=[{path:"",children:[{path:"season-create",component:tr},{path:"season-seed",component:Mn},{path:"history",component:Dr},{path:"history/:code",component:Ar},{path:"",component:Qa},{path:"pub/:device_id",component:$r},{path:"sub/:device_id",component:ds},{path:"feed/:device_id",component:As.C}]}],Ts=function(){var e=function e(){r(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({providers:[R.o,he.n,Qt.d,ht.$,vs.B,ms.K,hs.y,ps.V1,Zs],imports:[[o.ez,a.u5,l.Pc,u.Ns,a.UX,s.Bz.forChild(_s),f.aw.forChild(),nr.Ud,yr.i,gs.E,Jt.bQ,lt.tP]]}),e}()},66341:function(e,t,n){n.d(t,{n:function(){return l}});var i,o=n(88002),a=n(15189),s=n(37716),l=((i=function(){function e(t){r(this,e),this.reqAPIService=t,this.urlApi="/manager/farm-api"}return c(e,[{key:"searchMember",value:function(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-user&key="+e).pipe((0,o.U)(function(e){return e.data}))}},{key:"searchExpert",value:function(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-expert&key="+e).pipe((0,o.U)(function(e){return e.data}))}},{key:"getSitePath",value:function(){return this.reqAPIService.FILE_PATH}}]),e}()).\u0275fac=function(e){return new(e||i)(s.LFG(a.$))},i.\u0275prov=s.Yz7({token:i,factory:i.\u0275fac}),i)},22923:function(e,t,n){n.d(t,{d:function(){return u}});var i,o=n(88002),a=n(26215),s=n(15189),l=n(37716),u=((i=function(){function e(t){r(this,e),this.reqAPIService=t,this.urlApi="/manager/store-api-mobie",this.NEW_URL_API="/manager/warehouse-api",this.changeDataStore=!1,this.onLoaded$=new a.X(0)}return c(e,[{key:"destroy",value:function(){this.fcode=null,this.store=null}},{key:"setFarmCode",value:function(e){this.fcode=e}},{key:"getFarmCode",value:function(){return this.fcode}},{key:"setStoreCode",value:function(e){this.wcode=e}},{key:"getStoreCode",value:function(){return this.wcode}},{key:"setStore",value:function(e){this.store=e}},{key:"getStore",value:function(){return this.store}},{key:"itemChanged",value:function(e,t){void 0!==this.store[e]&&Object.assign(this.store[e],t)}},{key:"getApiStore",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e=""===i?this.NEW_URL_API+"?action="+t+"&wcode="+this.wcode+n:"/".concat(i,"?action=")+t+n,this.reqAPIService.get(e).pipe((0,o.U)(function(e){return e}))}},{key:"sendPost",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return e=""===a?this.NEW_URL_API+"?action="+t+"&wcode="+this.wcode+i:"/".concat(a,"?action=")+t+i,this.reqAPIService.post(e,n).pipe((0,o.U)(function(e){return e}))}},{key:"sendPostWithFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this.reqAPIService.postApiWithFile(e,t,"&wcode="+this.wcode+n,this.NEW_URL_API)}},{key:"postEdit",value:function(e,t){return this.reqAPIService.post(this.urlApi+"?action=edit-product-private&fcode="+this.fcode+"&id="+e,t)}}]),e}()).\u0275fac=function(e){return new(e||i)(l.LFG(s.$))},i.\u0275prov=l.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},69814:function(e,t,n){n.d(t,{F:function(){return d}});var i,o=n(15189),a=n(92340),s=n(88002),l=n(37716),u=n(81780),d=((i=function(){function e(t,n){r(this,e),this.reqAPIService=t,this.translate=n,this.farmextApi="/manager/disease-neighboor-api",this.farmextWall="/manager/wall-api",this.tepbacApi="/farmext/update-api",this.weatherPath="http://api.openweathermap.org/data/2.5/onecall"}return c(e,[{key:"listDisease",value:function(){return this.reqAPIService.get(this.farmextApi)}},{key:"listUpdate",value:function(e,t){return this.reqAPIService.postOutSiteNoneToken(a.h_.SITE_PATH+this.tepbacApi+"&action=list&page="+e,t)}},{key:"getPriceHistory",value:function(e){return this.reqAPIService.getOutSite(a.h_.SITE_PATH+this.tepbacApi+"&action=get-price&sid="+e)}},{key:"searchSpecies",value:function(e){return this.reqAPIService.getOutSite(a.h_.SITE_PATH+this.tepbacApi+"&action=search-species&keyword="+e).pipe((0,s.U)(function(e){return e.data}))}},{key:"loadAnalyze",value:function(e){return this.reqAPIService.post(this.farmextWall+"?action=analyze",e)}},{key:"loadReport",value:function(e){return this.reqAPIService.post(this.farmextWall+"?action=report",e)}},{key:"getWeatherToday",value:function(e,t){return this.reqAPIService.getOutSiteNoneToken(this.weatherPath+"?lat="+e+"&lon="+t+"&appid=9d7acdb5a0b7977b5dbd5dddf54c1fb4&lang="+this.translate.currentLang)}},{key:"getWeather",value:function(e,t){return this.reqAPIService.getOutSiteNoneToken(this.weatherPath+"?lat="+e+"&lon="+t+"&appid=9d7acdb5a0b7977b5dbd5dddf54c1fb4&lang="+this.translate.currentLang).toPromise()}},{key:"getWeatherYesterday",value:function(e,t,n){return this.reqAPIService.getOutSiteNoneToken(this.weatherPath+"?/timemachine?dt="+e+"&lat="+t+"&lon="+n+"&appid=9d7acdb5a0b7977b5dbd5dddf54c1fb4&lang="+this.translate.currentLang).toPromise()}}]),e}()).\u0275fac=function(e){return new(e||i)(l.LFG(o.$),l.LFG(u.sK))},i.\u0275prov=l.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)}}])}();