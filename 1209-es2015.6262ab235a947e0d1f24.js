"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[1209],{54395:function(t,e,i){i.d(e,{b:function(){return o}});var n=i(77393),s=i(33637);function o(t,e=s.P){return i=>i.lift(new r(t,e))}class r{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new a(t,this.dueTime,this.scheduler))}}class a extends n.L{constructor(t,e,i){super(t),this.dueTime=e,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(l,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function l(t){t.debouncedNext()}},51937:function(t,e,i){i.d(e,{D:function(){return a}});var n=i(76329),s=i(15189),o=i(88002),r=i(37716);let a=(()=>{class t{constructor(t){this.reqAPIService=t,this.urlApi="/manager/farm-api",this.urlApiAdress="/manager/address-api",this.reload$=new n.BehaviorSubject(0),this.numberOfPonds=0}setCode(t){this.fcode=t}setFarm(t){this.farm=t,this.permission=t.permission}loadPonds(){return this.reqAPIService.get("/manager/farm-api-mobie?fcode="+this.fcode+"&action=get-item-pond").pipe((0,o.U)(t=>t))}listAddress(t){return this.reqAPIService.get(this.urlApiAdress+"?action=listUnit&id="+t)}loadFarm(){return this.reqAPIService.get("/manager/farm-api-info?fcode="+this.fcode).pipe((0,o.U)(t=>(this.setFarm(t.data),t)))}getSeting(){return this.reqAPIService.get("/manager/farm-api-mobie?action=get-farm-setting&fcode="+this.fcode).pipe((0,o.U)(t=>t))}updatePrivate(t){return this.reqAPIService.post("/manager/farm-api-mobie?action=add-farm-setting&fcode="+this.fcode,t).pipe((0,o.U)(t=>t))}removePermission(t,e){return this.reqAPIService.get("/manager/farm-api-mobie?action=remove-manager&fcode="+this.fcode+"&user_id="+t+"&position="+e).pipe((0,o.U)(t=>t))}updateFarm(t){return this.reqAPIService.post("/manager/farm-edit-api-mobie?action=edit&fcode="+this.fcode,t).pipe((0,o.U)(t=>t))}destroyValue(){this.farm=null,this.fcode=null,this.permission=null,this.numberOfPonds=null}getSpecies(){return this.reqAPIService.get("/manager/farm-create-api?action=get-species").pipe((0,o.U)(t=>t))}insertPond(t){return this.reqAPIService.post("/manager/farm-api-mobie?action=add-pond&fcode="+this.fcode,t).pipe((0,o.U)(t=>t))}insertOnePond(t){return this.reqAPIService.post("/manager/farm-api-mobie?action=add-a-pond&fcode="+this.fcode,t).pipe((0,o.U)(t=>t))}loadReport(){return this.reqAPIService.get("/manager/farm-api-report?fcode="+this.fcode)}listStore(){return this.reqAPIService.get("/manager/farm-api-mobie?fcode="+this.fcode+"&action=list-store")}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(s.$))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},31781:function(t,e,i){i.d(e,{S:function(){return b}});var n=i(64762),s=i(90665),o=i(87152),r=i(51937),a=i(27887),l=i(40044),c=i(37716),d=i(47063),u=i(84465),g=i(81780),h=i(38583);function p(t,e){1&t&&c._UZ(0,"ion-progress-bar",18)}function m(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",21),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function A(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",8),c.TgZ(1,"ion-label",9),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",19),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).changeProvince(e)}),c.YNc(5,m,2,2,"ion-select-option",20),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"PROVINCE")),c.xp6(3),c.Q6J("ngForOf",t.listProvince)}}function f(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",21),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function Z(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",8),c.TgZ(1,"ion-label",9),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",22),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).changeDistrict(e)}),c.YNc(5,f,2,2,"ion-select-option",20),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"DISTRICT")),c.xp6(3),c.Q6J("ngForOf",t.listDistrict)}}function q(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",21),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function T(t,e){if(1&t&&(c.TgZ(0,"ion-item",8),c.TgZ(1,"ion-label",9),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",23),c.YNc(5,q,2,2,"ion-select-option",20),c.qZA(),c.qZA()),2&t){const t=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"WARDS")),c.xp6(3),c.Q6J("ngForOf",t.listWards)}}function v(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-content",6),c.YNc(1,p,1,0,"ion-progress-bar",7),c.TgZ(2,"ion-list"),c.TgZ(3,"ion-item",8),c.TgZ(4,"ion-label",9),c._uU(5),c.ALo(6,"translate"),c.qZA(),c._UZ(7,"ion-input",10),c.qZA(),c.TgZ(8,"ion-item",8),c.TgZ(9,"ion-label",9),c._uU(10),c.ALo(11,"translate"),c.qZA(),c._UZ(12,"ion-input",11),c.qZA(),c.YNc(13,A,6,4,"ion-item",12),c.YNc(14,Z,6,4,"ion-item",12),c.YNc(15,T,6,4,"ion-item",12),c.TgZ(16,"ion-item",8),c.TgZ(17,"ion-label",9),c._uU(18),c.ALo(19,"translate"),c.qZA(),c._UZ(20,"ion-textarea",13),c.qZA(),c.TgZ(21,"ion-item",8),c.TgZ(22,"ion-label",9),c._uU(23),c.ALo(24,"translate"),c.qZA(),c._UZ(25,"ion-input",14),c.qZA(),c.TgZ(26,"ion-item",8),c.TgZ(27,"ion-label",9),c._uU(28),c.ALo(29,"translate"),c.qZA(),c._UZ(30,"ion-input",15),c.qZA(),c.TgZ(31,"ion-item",16),c.TgZ(32,"ion-button",17),c.NdJ("click",function(){return c.CHM(t),c.oxw().getLocation()}),c._uU(33),c.ALo(34,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.Q6J("formGroup",t.form),c.xp6(1),c.Q6J("ngIf",t.savingFlag.pending),c.xp6(4),c.Oqu(c.lcZ(6,11,"LAB_MOD.NAME")),c.xp6(5),c.Oqu(c.lcZ(11,13,"FARM_MOD.ADDRESS")),c.xp6(3),c.Q6J("ngIf",t.listProvince),c.xp6(1),c.Q6J("ngIf",t.listDistrict),c.xp6(1),c.Q6J("ngIf",t.listWards),c.xp6(3),c.Oqu(c.lcZ(19,15,"PHOTO_MOD.DESCRIPTION")),c.xp6(5),c.Oqu(c.lcZ(24,17,"FARM_MOD.LONG")),c.xp6(5),c.Oqu(c.lcZ(29,19,"FARM_MOD.LAT")),c.xp6(5),c.Oqu(c.lcZ(34,21,"COMPANY_MOD.CURRENT_LOCATE"))}}let b=(()=>{class t{constructor(t,e,i,n,o,r){this.modalController=t,this.farmService=e,this.toastService=i,this.translate=n,this.geolocation=o,this.labService=r,this.savingFlag=new a.E,this.listProvince=[],this.listDistrict=[],this.listWards=[],this.show=!1,this.form=new s.cw({name:new s.NI("",s.kI.required),address:new s.NI("",s.kI.required),wards_id:new s.NI("",s.kI.required),district_id:new s.NI("",s.kI.required),province_id:new s.NI("",s.kI.required),description:new s.NI("",s.kI.required),longitude:new s.NI(""),latitude:new s.NI("")})}ngOnInit(){return(0,n.mG)(this,void 0,void 0,function*(){this.getLocation(),console.log(this.typeAdd)})}save(){this.labService[this.typeAdd](this.form.value).subscribe(t=>{1==t.status?(this.toastService.success(this.translate.instant("LAB_MOD.CREATE_SUCCESSFUL")),this.modalController.dismiss(this.form.value)):this.toastService.warning(t.message)},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}getListAddress(t,e){return(0,n.mG)(this,void 0,void 0,function*(){const i=yield this.farmService.listAddress(t).toPromise().catch(()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))});1==i.status?this[e]=i.data:this.toastService.warning(i.message)})}changeProvince(t){let e=t.detail.value;this.listDistrict=[],this.form.patchValue({district_id:""}),this.getListAddress(e,"listDistrict")}changeDistrict(t){let e=t.detail.value;this.listWards=[],this.form.patchValue({wards_id:""}),this.getListAddress(e,"listWards")}getLocation(){this.geolocation.getCurrentPosition().then(t=>{console.log(t),t.coords.latitude&&t.coords.longitude&&(this.form.controls.latitude.setValue(t.coords.latitude),this.form.controls.longitude.setValue(t.coords.longitude))}).catch(()=>{this.toastService.danger(this.translate.instant("COMPANY_MOD.ERROR_LOCATE"))})}ionViewWillEnter(){return(0,n.mG)(this,void 0,void 0,function*(){yield this.getListAddress(0,"listProvince"),this.show=!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.IN),c.Y36(r.D),c.Y36(u.k),c.Y36(g.sK),c.Y36(o.b),c.Y36(l.y))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-lab-create"]],inputs:{typeAdd:"typeAdd"},decls:13,vars:8,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["type","indeterminate",4,"ngIf"],["lines","inset"],["position","floating"],["formControlName","name"],["formControlName","address","type","text","inputmode","text"],["lines","inset",4,"ngIf"],["formControlName","description"],["formControlName","longitude","type","tel","inputmode","decimal"],["formControlName","latitude","type","tel","inputmode","decimal"],["lines","none"],["slot","end","fill","outline",3,"click"],["type","indeterminate"],["formControlName","province_id",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","district_id",3,"ionChange"],["formControlName","wards_id"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.modalController.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.TgZ(8,"ion-buttons",3),c.TgZ(9,"ion-button",4),c.NdJ("click",function(){return e.save()}),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(12,v,35,23,"ion-content",5)),2&t&&(c.xp6(6),c.Oqu(c.lcZ(7,4,"LAB_MOD.CREATE_LAB")),c.xp6(3),c.Q6J("disabled",e.form.invalid||e.savingFlag.pending),c.xp6(1),c.Oqu(c.lcZ(11,6,"FARM_MOD.SAVE")),c.xp6(2),c.Q6J("ngIf",e.show))},directives:[d.Gu,d.sr,d.Sm,d.YG,d.gu,d.wd,h.O5,d.W2,s.JL,s.sg,d.q_,d.Ie,d.Q$,d.pK,d.j9,s.JJ,s.u,d.g2,d.X7,d.t9,d.QI,h.sg,d.n0],pipes:[g.X$],styles:[""]}),t})()},53772:function(t,e,i){i.d(e,{_:function(){return b}});var n=i(64762),s=i(90665),o=i(87152),r=i(51937),a=i(27887),l=i(40044),c=i(37716),d=i(47063),u=i(84465),g=i(81780),h=i(38583);function p(t,e){1&t&&c._UZ(0,"ion-progress-bar",18)}function m(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",21),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function A(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",8),c.TgZ(1,"ion-label",9),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",19),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).changeProvince(e)}),c.YNc(5,m,2,2,"ion-select-option",20),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"PROVINCE")),c.xp6(3),c.Q6J("ngForOf",t.listProvince)}}function f(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",21),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function Z(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",8),c.TgZ(1,"ion-label",9),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",22),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).changeDistrict(e)}),c.YNc(5,f,2,2,"ion-select-option",20),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"DISTRICT")),c.xp6(3),c.Q6J("ngForOf",t.listDistrict)}}function q(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",21),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function T(t,e){if(1&t&&(c.TgZ(0,"ion-item",8),c.TgZ(1,"ion-label",9),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",23),c.YNc(5,q,2,2,"ion-select-option",20),c.qZA(),c.qZA()),2&t){const t=c.oxw(2);c.xp6(2),c.Oqu(c.lcZ(3,2,"WARDS")),c.xp6(3),c.Q6J("ngForOf",t.listWards)}}function v(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-content",6),c.YNc(1,p,1,0,"ion-progress-bar",7),c.TgZ(2,"ion-list"),c.TgZ(3,"ion-item",8),c.TgZ(4,"ion-label",9),c._uU(5),c.ALo(6,"translate"),c.qZA(),c._UZ(7,"ion-input",10),c.qZA(),c.TgZ(8,"ion-item",8),c.TgZ(9,"ion-label",9),c._uU(10),c.ALo(11,"translate"),c.qZA(),c._UZ(12,"ion-input",11),c.qZA(),c.YNc(13,A,6,4,"ion-item",12),c.YNc(14,Z,6,4,"ion-item",12),c.YNc(15,T,6,4,"ion-item",12),c.TgZ(16,"ion-item",8),c.TgZ(17,"ion-label",9),c._uU(18),c.ALo(19,"translate"),c.qZA(),c._UZ(20,"ion-textarea",13),c.qZA(),c.TgZ(21,"ion-item",8),c.TgZ(22,"ion-label",9),c._uU(23),c.ALo(24,"translate"),c.qZA(),c._UZ(25,"ion-input",14),c.qZA(),c.TgZ(26,"ion-item",8),c.TgZ(27,"ion-label",9),c._uU(28),c.ALo(29,"translate"),c.qZA(),c._UZ(30,"ion-input",15),c.qZA(),c.TgZ(31,"ion-item",16),c.TgZ(32,"ion-button",17),c.NdJ("click",function(){return c.CHM(t),c.oxw().getLocation()}),c._uU(33),c.ALo(34,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.Q6J("formGroup",t.form),c.xp6(1),c.Q6J("ngIf",t.savingFlag.pending),c.xp6(4),c.Oqu(c.lcZ(6,11,"LAB_MOD.NAME")),c.xp6(5),c.Oqu(c.lcZ(11,13,"FARM_MOD.ADDRESS")),c.xp6(3),c.Q6J("ngIf",t.listProvince),c.xp6(1),c.Q6J("ngIf",t.listDistrict),c.xp6(1),c.Q6J("ngIf",t.listWards),c.xp6(3),c.Oqu(c.lcZ(19,15,"PHOTO_MOD.DESCRIPTION")),c.xp6(5),c.Oqu(c.lcZ(24,17,"FARM_MOD.LONG")),c.xp6(5),c.Oqu(c.lcZ(29,19,"FARM_MOD.LAT")),c.xp6(5),c.Oqu(c.lcZ(34,21,"COMPANY_MOD.CURRENT_LOCATE"))}}let b=(()=>{class t{constructor(t,e,i,n,o,r){this.modalController=t,this.farmService=e,this.toastService=i,this.translate=n,this.geolocation=o,this.labService=r,this.savingFlag=new a.E,this.listProvince=[],this.listDistrict=[],this.listWards=[],this.show=!1,this.form=new s.cw({name:new s.NI("",s.kI.required),address:new s.NI("",s.kI.required),wards_id:new s.NI("",s.kI.required),district_id:new s.NI("",s.kI.required),province_id:new s.NI("",s.kI.required),description:new s.NI("",s.kI.required),longitude:new s.NI("",s.kI.required),latitude:new s.NI("",s.kI.required)}),this.typeEdit="updateLab"}ngOnInit(){return(0,n.mG)(this,void 0,void 0,function*(){console.log(this.typeEdit)})}save(){this.labService[this.typeEdit](this.form.value).subscribe(t=>{1==t.status?(this.toastService.success(this.translate.instant("SHOP.CART.ADDRESS.UPDATE_SUCCESS")),this.modalController.dismiss(this.form.value)):this.toastService.warning(t.message)},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}getListAddress(t,e){return(0,n.mG)(this,void 0,void 0,function*(){const i=yield this.farmService.listAddress(t).toPromise().catch(()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))});1==i.status?this[e]=i.data:this.toastService.warning(i.message)})}changeProvince(t){let e=t.detail.value;this.listDistrict=[],this.form.patchValue({district_id:""}),this.getListAddress(e,"listDistrict")}changeDistrict(t){let e=t.detail.value;this.listWards=[],this.form.patchValue({wards_id:""}),this.getListAddress(e,"listWards")}getLocation(){this.geolocation.getCurrentPosition().then(t=>{console.log(t),t.coords.latitude&&t.coords.longitude&&(this.form.controls.latitude.setValue(t.coords.latitude),this.form.controls.longitude.setValue(t.coords.longitude))}).catch(()=>{this.toastService.danger(this.translate.instant("COMPANY_MOD.ERROR_LOCATE"))})}ionViewWillEnter(){return(0,n.mG)(this,void 0,void 0,function*(){yield this.getListAddress(0,"listProvince"),yield this.getListAddress(this.data.province_id,"listDistrict"),yield this.getListAddress(this.data.district_id,"listWards"),Object.keys(this.form.controls).forEach(t=>{let e={};e[t]=this.data[t],this.form.patchValue(e)}),this.show=!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.IN),c.Y36(r.D),c.Y36(u.k),c.Y36(g.sK),c.Y36(o.b),c.Y36(l.y))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-lab-edit"]],inputs:{data:"data",typeEdit:"typeEdit"},decls:13,vars:8,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["type","indeterminate",4,"ngIf"],["lines","inset"],["position","floating"],["formControlName","name"],["formControlName","address","type","text","inputmode","text"],["lines","inset",4,"ngIf"],["formControlName","description"],["formControlName","longitude","type","tel","inputmode","decimal"],["formControlName","latitude","type","tel","inputmode","decimal"],["lines","none"],["slot","end","fill","outline",3,"click"],["type","indeterminate"],["formControlName","province_id",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","district_id",3,"ionChange"],["formControlName","wards_id"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.modalController.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.TgZ(8,"ion-buttons",3),c.TgZ(9,"ion-button",4),c.NdJ("click",function(){return e.save()}),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(12,v,35,23,"ion-content",5)),2&t&&(c.xp6(6),c.Oqu(c.lcZ(7,4,"DEVICE_MOD.UPDATE_INFOR")),c.xp6(3),c.Q6J("disabled",e.form.invalid||e.savingFlag.pending),c.xp6(1),c.Oqu(c.lcZ(11,6,"FARM_MOD.SAVE")),c.xp6(2),c.Q6J("ngIf",e.show))},directives:[d.Gu,d.sr,d.Sm,d.YG,d.gu,d.wd,h.O5,d.W2,s.JL,s.sg,d.q_,d.Ie,d.Q$,d.pK,d.j9,s.JJ,s.u,d.g2,d.X7,d.t9,d.QI,h.sg,d.n0],pipes:[g.X$],styles:[""]}),t})()},69130:function(t,e,i){i.d(e,{J:function(){return b}});var n=i(64762),s=i(79765),o=i(25917),r=i(54395),a=i(87519),l=i(43190),c=i(51937),d=i(27887),u=i(66341),g=i(40044),h=i(37716),p=i(47063),m=i(81780),A=i(84465),f=i(38583);function Z(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",8),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h3"),h._uU(5),h.qZA(),h.qZA(),h.TgZ(6,"ion-button",9),h.NdJ("click",function(){const e=h.CHM(t).index;return h.oxw().presentRemoveUser(e)}),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit;h.xp6(5),h.Oqu(t.username),h.xp6(2),h.hij(" ",h.lcZ(8,2,"FARM_MOD.DELETE")," ")}}function q(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",10),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h3"),h._uU(5),h.qZA(),h.TgZ(6,"p"),h._uU(7),h.qZA(),h.qZA(),h.TgZ(8,"ion-button",11),h.NdJ("click",function(){const e=h.CHM(t).$implicit;return h.oxw().presentAddUser(e)}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit,i=h.oxw();h.xp6(2),h.Q6J("src",i.memberService.getSitePath()+"/upload/users/avatars/medium/"+t.photo,h.LSH),h.xp6(3),h.Oqu(t.username),h.xp6(2),h.Oqu(t.email),h.xp6(1),h.Q6J("disabled",i.checkExistUser(t)),h.xp6(1),h.hij(" ",h.lcZ(10,5,"FARM_MOD.SELECT")," ")}}function T(t,e){if(1&t&&(h.TgZ(0,"ion-item",12),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.message)}}function v(t,e){1&t&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",13),h.qZA())}let b=(()=>{class t{constructor(t,e,i,n,o,r,a){this.modalController=t,this.translate=e,this.memberService=i,this.farmService=n,this.toastService=o,this.labService=r,this.alertController=a,this.savingFlag=new d.E,this.loadingFlag=new d.E,this.searchTerms=new s.xQ}ngOnInit(){let t=this.searchTerms.pipe((0,r.b)(300),(0,a.x)(),(0,l.w)(t=>this.getListMember(t)));this.members$=t,this.members$.subscribe(t=>{t?(this.loadingFlag.setResult(!0),this.message=""):(this.loadingFlag.setResult(!1),this.message=this.translate.instant("FARM_MOD.NOT_FOUND"))})}search(t){this.searchTerms.next(t.detail.value)}getListMember(t){return this.loadingFlag.setPending(!0),t.trim()?this.memberService.searchMember(t).pipe():(this.loadingFlag.setResult(!0),(0,o.of)([]))}onSelect(t){this.memberSelected=t}addPermission(t){this.labService.addMember(t.user_id).pipe().subscribe(e=>{0==e.status?this.toastService.warning(e.error):(this.manager.push({username:t.username,user_id:t.user_id}),this.toastService.success(this.translate.instant("FARM_MOD.ADDED_STAFF"))),this.savingFlag.setResult(!0)},t=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}removePermission(t){this.labService.removeMember(this.manager[t].user_id).pipe().subscribe(e=>{0==e.status?this.toastService.warning(e.error):(this.manager.splice(t,1),this.toastService.success(this.translate.instant("FARM_MOD.REMOVED_STAFF"))),this.savingFlag.setResult(!0)},t=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentRemoveUser(t){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_REMOVE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{this.removePermission(t)}}]})).present()})}presentAddUser(t){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_ADD"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:e=>{this.addPermission(t)}}]})).present()})}close(){this.modalController.dismiss(this.manager)}checkExistUser(t){for(let e=0;e<this.manager.length;e++)if(this.manager[e].user_name==t.username)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(p.IN),h.Y36(m.sK),h.Y36(u.n),h.Y36(c.D),h.Y36(A.k),h.Y36(g.y),h.Y36(p.Br))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-lab-manager"]],inputs:{manager:"manager"},decls:22,vars:13,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"placeholder","ionChange"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],[4,"ngIf"],["src","assets/img/default-profile.jpg"],["slot","end","color","danger",3,"click"],["onError","this.src='assets/img/default-profile.jpg'",3,"src"],["slot","end",3,"disabled","click"],["lines","none"],["name","dots"]],template:function(t,e){1&t&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return e.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-searchbar",3),h.NdJ("ionChange",function(t){return e.search(t)}),h.qZA(),h.TgZ(10,"ion-list"),h.YNc(11,Z,9,4,"ion-item",4),h.qZA(),h.TgZ(12,"ion-list"),h.TgZ(13,"ion-list-header"),h.TgZ(14,"ion-label"),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.qZA(),h.YNc(17,q,11,7,"ion-item",4),h.ALo(18,"async"),h.YNc(19,T,4,1,"ion-item",5),h.qZA(),h.TgZ(20,"div",6),h.YNc(21,v,2,0,"div",7),h.qZA(),h.qZA()),2&t&&(h.xp6(6),h.Oqu(h.lcZ(7,7,"LAB_MOD.MEMBER")),h.xp6(3),h.Q6J("placeholder",e.translate.instant("FARM_MOD.MANAGER_EMAIL")),h.xp6(2),h.Q6J("ngForOf",e.manager),h.xp6(4),h.Oqu(h.lcZ(16,9,"FARM_MOD.RESULT")),h.xp6(2),h.Q6J("ngForOf",h.lcZ(18,11,e.members$)),h.xp6(2),h.Q6J("ngIf",e.message),h.xp6(2),h.Q6J("ngIf",e.loadingFlag.pending))},directives:[p.Gu,p.sr,p.Sm,p.YG,p.gu,p.wd,p.W2,p.VI,p.j9,p.q_,f.sg,p.yh,p.Q$,f.O5,p.Ie,p.BJ,p.PQ],pipes:[m.X$,f.Ov],styles:[""]}),t})()},1209:function(t,e,i){i.d(e,{V:function(){return q}});var n=i(64762),s=i(27887),o=i(31781),r=i(53772),a=i(69130),l=i(40044),c=i(37716),d=i(47063),u=i(84465),g=i(81780),h=i(13619),p=i(38583);function m(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",14),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).presentManager()}),c._UZ(1,"ion-icon",15),c.TgZ(2,"ion-label"),c.TgZ(3,"h3"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"p"),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(4),c.Oqu(c.lcZ(5,3,"FARM_MOD.MANAGER")),c.xp6(3),c.AsE("",t.infor.members.length," ",c.lcZ(8,5,"FARM_MOD.MEMBER"),"")}}function A(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",10),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).presentAddLab()}),c._UZ(1,"ion-icon",16),c._uU(2),c.ALo(3,"translate"),c.qZA()}2&t&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"LAB_MOD.CREATE_LAB")," "))}function f(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",17),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).removeLab()}),c._UZ(1,"ion-icon",18),c._uU(2),c.ALo(3,"translate"),c.qZA()}2&t&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"DEVICE_MOD.REMOVE")," "))}function Z(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-content"),c.TgZ(1,"div",4),c.TgZ(2,"h1",5),c._uU(3),c.qZA(),c.TgZ(4,"span"),c._uU(5),c.qZA(),c.TgZ(6,"p"),c._uU(7),c.qZA(),c.qZA(),c.TgZ(8,"ion-list"),c.TgZ(9,"ion-item"),c._UZ(10,"ion-icon",6),c.TgZ(11,"ion-label"),c.TgZ(12,"h3"),c._uU(13),c.ALo(14,"translate"),c.qZA(),c.TgZ(15,"p"),c._uU(16),c.qZA(),c.qZA(),c.qZA(),c.TgZ(17,"ion-item"),c._UZ(18,"ion-icon",7),c.TgZ(19,"ion-label"),c.TgZ(20,"h3"),c._uU(21),c.ALo(22,"translate"),c.qZA(),c.TgZ(23,"p"),c._uU(24),c.qZA(),c.qZA(),c.qZA(),c.YNc(25,m,9,7,"ion-item",8),c.qZA(),c.TgZ(26,"div"),c.TgZ(27,"ion-card",9),c.TgZ(28,"ion-card-content"),c.TgZ(29,"ion-button",10),c.NdJ("click",function(){return c.CHM(t),c.oxw().presentEdit()}),c._UZ(30,"ion-icon",11),c._uU(31),c.ALo(32,"translate"),c.qZA(),c.YNc(33,A,4,3,"ion-button",12),c.qZA(),c.qZA(),c.YNc(34,f,4,3,"ion-button",13),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(3),c.Oqu(t.infor.name),c.xp6(2),c.hij("#",t.infor.code,""),c.xp6(2),c.Oqu(t.infor.description),c.xp6(6),c.Oqu(c.lcZ(14,12,"FARM_MOD.ADDRESS")),c.xp6(3),c.Oqu(t.infor.address),c.xp6(5),c.Oqu(c.lcZ(22,14,"FARM_MOD.LOCATE")),c.xp6(3),c.AsE("",t.infor.longitude," : ",t.infor.latitude,""),c.xp6(1),c.Q6J("ngIf","lab_owner"==t.infor.permission&&!t.labRoot),c.xp6(6),c.hij(" ",c.lcZ(32,16,"FARM_MOD.EDIT")," "),c.xp6(2),c.Q6J("ngIf",t.labRoot),c.xp6(1),c.Q6J("ngIf","lab_owner"==t.infor.permission&&!t.labRoot)}}let q=(()=>{class t{constructor(t,e,i,n,o,r,a){this.modalController=t,this.labService=e,this.toastService=i,this.translate=n,this.alertController=o,this.loadingController=r,this.router=a,this.loadingFlag=new s.E,this.labRoot=!1}ngOnInit(){this.labRoot?this.infor=this.data.infor:this.getLab()}getLab(){this.loadingFlag.setPending(!0),this.labService.getLab().subscribe(t=>{1==t.status?this.infor=t.data:this.toastService.warning(t.message),this.loadingFlag.setResult(!0)},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT")),this.loadingFlag.setResult(!1)})}removeLab(){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:this.translate.instant("POND_MOD.CAREFUL"),message:this.translate.instant("POND_MOD.CONFIRM_DELETE")+" <strong>"+this.infor.name+"</strong>?",inputs:[{name:"confirmInput",type:"text",placeholder:this.translate.instant("POND_MOD.ENTER")+' "OK"'}],buttons:[{text:this.translate.instant("NO"),role:"cancel",cssClass:"secondary"},{text:this.translate.instant("POND_MOD.DELETE"),cssClass:"secondary",handler:t=>{"OK"===t.confirmInput&&(this.loadingController.create({message:this.translate.instant("POND_MOD.DELETING")}).then(t=>{t.present()}),this.labService.removeLab(this.infor.id).subscribe(t=>{1==t.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.REMOVE_DATA_SUCCESS")),this.modalController.dismiss(),this.router.navigateByUrl("tabs/management")):this.toastService.warning(t.message),this.loadingController.dismiss()},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT")),this.loadingController.dismiss()}))}}]})).present()})}presentManager(){return(0,n.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:a.J,componentProps:{manager:this.infor.members}});return t.onDidDismiss().then(t=>{t.data&&(this.infor.member=t.data)}),yield t.present()})}presentEdit(){return(0,n.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:r._,componentProps:{data:this.infor,typeEdit:this.labRoot?"updateLabOwner":"updateLab"}});return t.onDidDismiss().then(t=>{if(t.data)for(let e in t.data)this.infor[e]=t.data[e]}),yield t.present()})}presentAddLab(){return(0,n.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:o.S,componentProps:{typeAdd:"addLab"}});return t.onDidDismiss().then(t=>{}),yield t.present()})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.IN),c.Y36(l.y),c.Y36(u.k),c.Y36(g.sK),c.Y36(d.Br),c.Y36(d.HT),c.Y36(h.F0))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-lab-setting"]],inputs:{data:"data",labRoot:"labRoot"},decls:9,vars:4,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[4,"ngIf"],[1,"ion-padding","ion-text-center"],[1,""],["src","assets/icon/adress.svg","slot","start"],["src","assets/icon/location_on-24px.svg","slot","start"],["detail","",3,"click",4,"ngIf"],["mode","ios"],["size","large","expand","block","shape","round","fill","outline",3,"click"],["name","create-outline","slot","start"],["size","large","expand","block","shape","round","fill","outline",3,"click",4,"ngIf"],["size","small","color","medium","expand","block","fill","clear",3,"click",4,"ngIf"],["detail","",3,"click"],["src","assets/icon/supervised_user_circle-24px.svg","slot","start"],["name","add-outline","slot","start"],["size","small","color","medium","expand","block","fill","clear",3,"click"],["name","remove-circle-outline","slot","start"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.modalController.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.qZA(),c.YNc(8,Z,35,18,"ion-content",3)),2&t&&(c.xp6(6),c.Oqu(c.lcZ(7,2,"LAB_MOD.INFOR_LAB")),c.xp6(2),c.Q6J("ngIf",e.infor))},directives:[d.Gu,d.sr,d.Sm,d.YG,d.gu,d.wd,p.O5,d.W2,d.q_,d.Ie,d.Q$,d.PM,d.FN],pipes:[g.X$],styles:[""]}),t})()},40044:function(t,e,i){i.d(e,{y:function(){return r}});var n=i(88002),s=i(15189),o=i(37716);let r=(()=>{class t{constructor(t){this.reqAPIService=t,this.PATH={MEMBER:"/manager/lab-member-api",MANAGER:"/manager/lab-manager-api",ROOT:"/user/user-lab-api"}}setCode(t){this.code=t,console.log("set lab code")}getApiStore(t="",e="",i=""){return this.reqAPIService.get(i+="?action="+t+"&lcode="+this.code+e).pipe((0,n.U)(t=>t))}postApiStore(t="",e={},i="",s=""){return this.reqAPIService.post(s+="?action="+t+"&lcode="+this.code+i,e).pipe((0,n.U)(t=>t))}loadLab(){return this.getApiStore("home","",this.PATH.MEMBER)}loadLabRoot(){return this.getApiStore("get","",this.PATH.ROOT)}loadFarm(t){return this.getApiStore("searchFarm","&keyword="+t,this.PATH.MANAGER)}addFarm(t){return this.getApiStore("addFarm","&fcode="+t,this.PATH.MANAGER)}removeFarm(t){return this.getApiStore("removeFarm","&fcode="+t,this.PATH.MANAGER)}getLab(){return this.getApiStore("getLab","",this.PATH.MANAGER)}addLab(t){return this.postApiStore("addLab",t,"",this.PATH.ROOT)}register(t){return this.postApiStore("register",t,"",this.PATH.ROOT)}updateLabOwner(t){return this.postApiStore("updateInfor",t,"",this.PATH.ROOT)}updateLab(t){return this.postApiStore("updateLab",t,"",this.PATH.MANAGER)}addMember(t){return this.getApiStore("addManager","&user_id="+t,this.PATH.ROOT)}removeMember(t){return this.getApiStore("removeManager","&user_id="+t,this.PATH.ROOT)}removeLab(t){return this.getApiStore("removeLab","&id="+t,this.PATH.ROOT)}loadSpecies(){return this.getApiStore("listSpecies","",this.PATH.MANAGER)}loadReport(t){return this.postApiStore("reportLab",t,"",this.PATH.MANAGER)}loadAnalyze(t){return this.postApiStore("analyzeLab",t,"",this.PATH.MANAGER)}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(s.$))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t})()},66341:function(t,e,i){i.d(e,{n:function(){return r}});var n=i(88002),s=i(15189),o=i(37716);let r=(()=>{class t{constructor(t){this.reqAPIService=t,this.urlApi="/manager/farm-api"}searchMember(t){return this.reqAPIService.get("/user/list-api-mobie?action=get-user&key="+t).pipe((0,n.U)(t=>t.data))}searchExpert(t){return this.reqAPIService.get("/user/list-api-mobie?action=get-expert&key="+t).pipe((0,n.U)(t=>t.data))}getSitePath(){return this.reqAPIService.FILE_PATH}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(s.$))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t})()}}]);