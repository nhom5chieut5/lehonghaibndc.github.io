!function(){"use strict";function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function t(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[3469],{73469:function(e,i,o){o.r(i),o.d(i,{ShopFlashsalesPageModule:function(){return N}});var r=o(38583),a=o(90665),s=o(47063),l=o(13619),c=o(16738),g=o(27887),d=o(15085),u=o(37716),m=o(84465),p=o(81780),h=o(71239),f=o(4015);function x(n,t){if(1&n){var e=u.EpF();u.TgZ(0,"ion-slide",17),u.NdJ("click",function(){var n=u.CHM(e).$implicit;return u.oxw().loadProduct(n.url)}),u.TgZ(1,"div"),u._UZ(2,"img",18),u.qZA(),u.qZA()}if(2&n){var i=t.$implicit,o=u.oxw();u.xp6(2),u.Q6J("src",o.shopService.SITE_PATH+"/upload/advertiment/ge_image/"+i.image,u.LSH)}}function _(n,t){1&n&&(u.TgZ(0,"span"),u._uU(1,"0"),u.qZA())}function P(n,t){1&n&&(u.TgZ(0,"span"),u._uU(1,"0"),u.qZA())}function b(n,t){1&n&&(u.TgZ(0,"span"),u._uU(1,"0"),u.qZA())}function O(n,t){if(1&n&&(u.TgZ(0,"ion-list-header",19),u.TgZ(1,"ion-label",20),u._uU(2,"Flash"),u._UZ(3,"ion-icon",21),u._uU(4,"sale"),u.qZA(),u.TgZ(5,"div",22),u.TgZ(6,"div",23),u.YNc(7,_,2,0,"span",13),u._uU(8),u.qZA(),u.TgZ(9,"div",23),u.YNc(10,P,2,0,"span",13),u._uU(11),u.qZA(),u.TgZ(12,"div",23),u.YNc(13,b,2,0,"span",13),u._uU(14),u.qZA(),u.qZA(),u.qZA()),2&n){var e=u.oxw();u.xp6(7),u.Q6J("ngIf",e.remainingTime.hour<10),u.xp6(1),u.Oqu(e.remainingTime.hour),u.xp6(2),u.Q6J("ngIf",e.remainingTime.min<10),u.xp6(1),u.Oqu(e.remainingTime.min),u.xp6(2),u.Q6J("ngIf",e.remainingTime.seconds<10),u.xp6(1),u.Oqu(e.remainingTime.seconds)}}function C(n,t){if(1&n){var e=u.EpF();u.TgZ(0,"ion-segment-button",24),u.NdJ("click",function(){var n=u.CHM(e).index;return u.oxw().segmentFrameChanged(n)}),u._uU(1),u.qZA()}if(2&n){var i=t.$implicit;u.Q6J("value",t.index),u.xp6(1),u.hij(" ",i[0],"H ")}}function M(n,t){if(1&n){var e=u.EpF();u.TgZ(0,"ion-segment-button",24),u.NdJ("click",function(){var n=u.CHM(e).$implicit;return u.oxw().segmentTermChanged(n.id)}),u._uU(1),u.qZA()}if(2&n){var i=t.$implicit;u.Q6J("value",i.id),u.xp6(1),u.hij(" ",i.name," ")}}function T(n,t){1&n&&(u.TgZ(0,"div"),u.TgZ(1,"p",25),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.qZA()),2&n&&(u.xp6(2),u.Oqu(u.lcZ(3,1,"SHOP.HOME.NO_PRODUCTS")))}function v(n,t){1&n&&u._UZ(0,"ion-progress-bar",26)}function Z(n,t){if(1&n&&(u.TgZ(0,"div",38),u.TgZ(1,"span"),u._uU(2),u.ALo(3,"number"),u.qZA(),u.qZA()),2&n){var e=u.oxw().$implicit;u.xp6(2),u.hij("-",u.xi3(3,1,100*e.ratio,"0.0-0"),"%")}}function w(n,t){if(1&n&&u._UZ(0,"img",39),2&n){var e=u.oxw().$implicit,i=u.oxw(2);u.Q6J("src",i.shopService.SITE_PATH+"/upload/eventeshop/"+e.banner,u.LSH)}}function A(n,t){if(1&n&&(u.TgZ(0,"div",40),u._uU(1),u.ALo(2,"number"),u.qZA()),2&n){var e=u.oxw().$implicit;u.xp6(1),u.hij(" ",u.xi3(2,1,e.maxPrice,"1.0-0"),"\u20ab ")}}function F(n,t){if(1&n&&(u.TgZ(0,"div",40),u._uU(1),u.ALo(2,"number"),u.ALo(3,"number"),u.qZA()),2&n){var e=u.oxw().$implicit;u.xp6(1),u.AsE(" ",u.xi3(2,2,e.minPrice,"1.0-0")," ~ ",u.xi3(3,5,e.maxPrice,"1.0-0"),"\u20ab ")}}function S(n,t){if(1&n&&(u.TgZ(0,"ion-col",29),u.YNc(1,Z,4,4,"div",30),u.TgZ(2,"div",31),u._UZ(3,"img",32),u.YNc(4,w,1,1,"img",33),u.qZA(),u.TgZ(5,"div",34),u._uU(6),u.qZA(),u.TgZ(7,"div",35),u.TgZ(8,"small",36),u._uU(9),u.ALo(10,"number"),u.qZA(),u.qZA(),u.YNc(11,A,3,4,"div",37),u.YNc(12,F,4,8,"div",37),u.qZA()),2&n){var e=t.$implicit,i=u.oxw(2);u.MGl("routerLink","../product/",e.id,""),u.xp6(1),u.Q6J("ngIf",0!=e.ratio),u.xp6(2),u.Q6J("src",i.shopService.SITE_PATH+e.img_default,u.LSH),u.xp6(1),u.Q6J("ngIf",e.banner),u.xp6(2),u.Oqu(e.alias),u.xp6(3),u.hij("",u.xi3(10,8,e.maxFullPrice,"0.0-0"),"\u20ab"),u.xp6(2),u.Q6J("ngIf",e.minPrice==e.maxPrice),u.xp6(1),u.Q6J("ngIf",e.minPrice!=e.maxPrice)}}function q(n,t){if(1&n&&(u.TgZ(0,"ion-grid",27),u.TgZ(1,"ion-row"),u.YNc(2,S,13,11,"ion-col",28),u.qZA(),u.qZA()),2&n){var e=u.oxw();u.xp6(2),u.Q6J("ngForOf",e.flashSales.list)}}var k,I=[{path:"",component:(k=function(){function e(t,i,o,r,a,s){n(this,e),this.modalController=t,this.shopService=i,this.toastService=o,this.translate=r,this.localDb=a,this.route=s,this.loadingFlag=new g.E,this.listADS=[],this.flashSales={list:[],numRows:0},this.page=0,this.remainingTime={hour:0,min:0,seconds:0},this.bannerOpts={speed:400,pagination:{el:".swiper-pagination",dynamicBullets:!0}}}var i,o,r;return i=e,(o=[{key:"ngOnInit",value:function(){this.loadFlashsale(),this.loadAds()}},{key:"loadFlashsale",value:function(){var n=this;this.loadingFlag.setPending(!0),this.shopService.loadFlashsaleFull(this.page,this.currentTerm,this.currentIndex).pipe().subscribe(function(t){"error"==t.status?(console.log(t.error.message),n.loadingFlag.setResult(!1)):(n.flashSales.numRows=t.data.numRows,n.flashSales.list=n.flashSales.list.concat(n.prepareProductPrice(t.data.list)),n.listTerms=t.data.listTerms,n.timeFrame=t.data.timeFrame,void 0===n.currentIndex&&(n.currentIndex=t.data.currentFrameIndex,n.prepareFlashsale()),n.currentTerm||(n.currentTerm=t.data.currentTerm),n.loadingFlag.setResult(!0))},function(t){console.log(n.translate.instant("ERROR_CONNECT")),n.loadingFlag.setResult(!1)})}},{key:"prepareProductPrice",value:function(n){var t=[];return n.forEach(function(n){var e=n.label_price.split("~");n.minPrice=e[0],n.maxPrice=e[1],n.maxFullPrice=n.maxPrice/(1-n.ratio),t.push(n)}),t}},{key:"loadAds",value:function(){var n=this;this.shopService.getAds().subscribe(function(t){"success"==t.status?(n.listADS="EFW"in t.data?t.data.EFW:[],console.log(n.listADS)):n.toastService.danger(n.translate.instant("ERROR_CONNECT"))},function(){n.toastService.danger(n.translate.instant("ERROR_CONNECT"))})}},{key:"loadProduct",value:function(n){var t=n.trim().split("//"),e=t[t.length-1].split("/");if(console.log(e),4==e.length){var i=e[3].split("-");this.route.navigateByUrl({company:"shop/companys/company/",detail:"shop/product/",shop:"shop/store/",term:"shop/products/"}[e[2]]+parseInt(i[i.length-1]))}}},{key:"prepareFlashsale",value:function(){var n=this,t=this.timeFrame[this.currentIndex],e=new Date,i=(new Date(e.getFullYear(),e.getMonth()+1,e.getDate(),t[0],0,0,0),new Date(e.getFullYear(),e.getMonth(),e.getDate(),t[1],0,0,0)),o=c.utc(c(i.getTime()).diff(e.getTime())).format("HH:mm:ss").split(":");this.remainingTime.hour=parseInt(o[0]),this.remainingTime.min=parseInt(o[1]),this.remainingTime.seconds=parseInt(o[2]);var r=this;this.timeCountDown=setInterval(function(){r.remainingTime.seconds=0==r.remainingTime.seconds?0:r.remainingTime.seconds-=1,0==r.remainingTime.seconds&&(r.remainingTime.min>0&&(r.remainingTime.seconds=59),r.remainingTime.min=0==r.remainingTime.min?0:r.remainingTime.min-=1),0==r.remainingTime.min&&(r.remainingTime.hour>0?(r.remainingTime.hour=r.remainingTime.hour>0?r.remainingTime.hour-=1:0,r.remainingTime.min=59,r.remainingTime.seconds=59):r.remainingTime.hour=0),0==r.remainingTime.hour&&0==r.remainingTime.min&&0==r.remainingTime.seconds&&(n.page=0,n.flashSales.list=[],n.flashSales.numRows=0,clearInterval(n.timeCountDown))},1e3)}},{key:"doRefresh",value:function(n){this.timeCountDown&&clearInterval(this.timeCountDown),this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,this.loadFlashsale(),n.target.complete()}},{key:"loadMoreProducts",value:function(n){this.page+=1,this.loadFlashsale(),setTimeout(function(){n.target.complete()},500)}},{key:"segmentTermChanged",value:function(n){this.currentTerm=n,this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,this.loadFlashsale()}},{key:"segmentFrameChanged",value:function(n){this.currentIndex=n,this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,this.loadFlashsale()}}])&&t(i.prototype,o),r&&t(i,r),e}(),k.\u0275fac=function(n){return new(n||k)(u.Y36(s.IN),u.Y36(d.d),u.Y36(m.k),u.Y36(p.sK),u.Y36(h.T),u.Y36(l.F0))},k.\u0275cmp=u.Xpm({type:k,selectors:[["app-shop-flashsales"]],decls:27,vars:11,consts:[["slot","start"],["text","","defaultHref","tabs/shop"],["slot","end"],["slot","fixed",3,"ionRefresh"],["mode","ios"],[1,"banner"],[3,"options"],[3,"click",4,"ngFor","ngForOf"],[1,"swiper-pagination"],["mode","ios","routerLink","product-flashsale",4,"ngIf"],["scrollable","","mode","ios",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],["scrollable","true","mode","ios",3,"ngModel","ngModelChange"],[4,"ngIf"],["type","indeterminate",4,"ngIf"],["class","grid-product",4,"ngIf"],["threshold","100px",3,"disabled","ionInfinite"],[3,"click"],[3,"src"],["mode","ios","routerLink","product-flashsale"],["color","danger"],["name","flash-outline"],[1,"boxTimeFlashsale"],[1,"boxTime"],[3,"value","click"],[1,"ion-text-center"],["type","indeterminate"],[1,"grid-product"],["size","6","size-sm","3",3,"routerLink",4,"ngFor","ngForOf"],["size","6","size-sm","3",3,"routerLink"],["class","discount-label",4,"ngIf"],[1,"img-box"],["onError","this.src='assets/img/1235.jpg'",1,"m-auto",3,"src"],["class","bannerProduct",3,"src",4,"ngIf"],[1,"product-alias"],[1,"promotion-box"],[1,"strike","ion-align-self-center"],["class","price-box",4,"ngIf"],[1,"discount-label"],[1,"bannerProduct",3,"src"],[1,"price-box"]],template:function(n,t){1&n&&(u.TgZ(0,"ion-header"),u.TgZ(1,"ion-toolbar"),u.TgZ(2,"ion-buttons",0),u._UZ(3,"ion-back-button",1),u.qZA(),u.TgZ(4,"ion-title"),u._uU(5,"Flashsale"),u.qZA(),u.TgZ(6,"ion-buttons",2),u._UZ(7,"app-shop-toolbar"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(8,"ion-content"),u.TgZ(9,"ion-refresher",3),u.NdJ("ionRefresh",function(n){return t.doRefresh(n)}),u._UZ(10,"ion-refresher-content",4),u.qZA(),u.TgZ(11,"div",5),u.TgZ(12,"ion-slides",6),u.YNc(13,x,3,1,"ion-slide",7),u.qZA(),u._UZ(14,"div",8),u.qZA(),u.YNc(15,O,15,6,"ion-list-header",9),u.TgZ(16,"ion-toolbar"),u.TgZ(17,"ion-segment",10),u.NdJ("ngModelChange",function(n){return t.currentIndex=n}),u.YNc(18,C,2,2,"ion-segment-button",11),u.qZA(),u.qZA(),u.TgZ(19,"ion-toolbar"),u.TgZ(20,"ion-segment",12),u.NdJ("ngModelChange",function(n){return t.currentTerm=n}),u.YNc(21,M,2,2,"ion-segment-button",11),u.qZA(),u.qZA(),u.YNc(22,T,4,3,"div",13),u.YNc(23,v,1,0,"ion-progress-bar",14),u.YNc(24,q,3,1,"ion-grid",15),u.TgZ(25,"ion-infinite-scroll",16),u.NdJ("ionInfinite",function(n){return t.loadMoreProducts(n)}),u._UZ(26,"ion-infinite-scroll-content"),u.qZA(),u.qZA()),2&n&&(u.xp6(12),u.Q6J("options",t.bannerOpts),u.xp6(1),u.Q6J("ngForOf",t.listADS),u.xp6(2),u.Q6J("ngIf",t.flashSales),u.xp6(2),u.Q6J("ngModel",t.currentIndex),u.xp6(1),u.Q6J("ngForOf",t.timeFrame),u.xp6(2),u.Q6J("ngModel",t.currentTerm),u.xp6(1),u.Q6J("ngForOf",t.listTerms),u.xp6(1),u.Q6J("ngIf",!t.flashSales),u.xp6(1),u.Q6J("ngIf",t.loadingFlag.pending),u.xp6(1),u.Q6J("ngIf",t.flashSales),u.xp6(1),u.Q6J("disabled",(null==t.flashSales?null:t.flashSales.numRows)==(null==t.flashSales?null:t.flashSales.list.length)))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,f.g,s.W2,s.nJ,s.Wo,s.Hr,r.sg,r.O5,s.cJ,s.QI,a.JJ,a.On,s.ju,s.MB,s.A$,s.yh,s.YI,l.rH,s.Q$,s.gu,s.GO,s.X7,s.jY,s.Nd,s.wI],pipes:[p.X$,r.JJ],styles:["[_nghost-%COMP%]{--bullet-background-active: var(--ion-color-light);--bullet-background: var(--ion-color-dark)}[_nghost-%COMP%]   .banner[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .banner[_ngcontent-%COMP%]   .swiper-pagination[_ngcontent-%COMP%]{z-index:1000;position:absolute;bottom:10px;left:5px}[_nghost-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{min-width:auto!important}",'[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--padding-bottom: 3em}[_nghost-%COMP%]   ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:"Averta";font-size:.8em}[_nghost-%COMP%]   .boxTimeFlashsale[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px;margin-top:29px;margin-bottom:6px;font-family:"Averta";font-size:.8em;display:flex;margin-right:16px}[_nghost-%COMP%]   .boxTimeFlashsale[_ngcontent-%COMP%]   .boxTime[_ngcontent-%COMP%]{color:#fff;background-color:#000;padding-left:2px;padding-right:2px;margin-right:2px;margin-left:2px;border-radius:2px;max-width:27px;width:27px;text-align:center}[_nghost-%COMP%]   .boxSpecial[_ngcontent-%COMP%]{min-height:150px}[_nghost-%COMP%]   .boxSpecial[_ngcontent-%COMP%]   .bannerSpecial[_ngcontent-%COMP%]{max-height:50px}[_nghost-%COMP%]   .boxSpecial[_ngcontent-%COMP%]   .imgProductSpecial[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .arrowButton[_ngcontent-%COMP%]{vertical-align:middle;margin-right:16px}[_nghost-%COMP%]   .bag-cart[_ngcontent-%COMP%]{color:#de2525;font-weight:bold;position:absolute;top:1em;font-size:.8em}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:240px;width:100%}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{border-top:1px solid rgba(192,192,192,.2);border-left:1px solid rgba(192,192,192,.2)}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{border-right:1px solid rgba(192,192,192,.2);border-bottom:1px solid rgba(192,192,192,.2)}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]{flex:auto;text-align:center;margin:0 auto;overflow:hidden;position:relative}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:80x!important;margin-bottom:5px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   .bannerProduct[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;max-height:60px;max-width:80%;width:auto}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .product-alias[_ngcontent-%COMP%]{line-height:1.2em;font-size:.9em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;height:2.4em;-webkit-box-orient:vertical}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .promotion-box[_ngcontent-%COMP%]{margin:3px 0}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .promotion-box[_ngcontent-%COMP%]   .mr[_ngcontent-%COMP%]{margin-left:3px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .promotion-box[_ngcontent-%COMP%]   .strike[_ngcontent-%COMP%]{text-decoration:line-through}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]{margin:3px 0;font-size:.9em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;height:1.3em;-webkit-box-orient:vertical;color:var(--ion-color-danger)}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]{padding:5px;position:absolute;right:5px;top:10px;float:left;width:43px;background-color:#de2525;z-index:9999;transform:rotate(20deg);border-radius:4px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]:after{right:42px;border:solid transparent;content:" ";height:0;width:0;position:absolute;border-color:#88b7d500;border-right-color:#de2525;border-width:13.5px;top:50%;margin-top:-13.6px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]:before{content:"";z-index:2;position:absolute;top:44%;right:100%;width:5px;height:5px;opacity:.95;background:#fff;border-radius:5px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:12px;text-align:center;font-family:"Averta"}']}),k)}],J=function(){var t=function t(){n(this,t)};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[l.Bz.forChild(I)],l.Bz]}),t}(),y=o(26177),N=function(){var t=function t(){n(this,t)};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[r.ez,a.u5,s.Pc,J,p.aw.forChild(),y.t]]}),t}()}}])}();