!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[5396],{97905:function(e,t,a){a.d(t,{K:function(){return r}});var n=a(64762),i=a(38739),o=a(37716),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FileTransferErrorCode={FILE_NOT_FOUND_ERR:1,INVALID_URL_ERR:2,CONNECTION_ERR:3,ABORT_ERR:4,NOT_MODIFIED_ERR:5},t}return(0,n.ZT)(t,e),t.prototype.create=function(){return new s},t.pluginName="FileTransfer",t.plugin="cordova-plugin-file-transfer",t.pluginRef="FileTransfer",t.repo="https://github.com/apache/cordova-plugin-file-transfer",t.platforms=["Amazon Fire OS","Android","Browser","iOS","Ubuntu","Windows","Windows Phone"],t.\u0275fac=function(e){return(a||(a=o.n5z(t)))(e||t)},t.\u0275prov=o.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),t;var a}(i.KY),s=function(){function e(){!0===(0,i.gR)(r.getPluginRef(),null,r.getPluginName())&&(this._objectInstance=new(r.getPlugin()))}return e.prototype.upload=function(e,t,a,n){return(0,i.e4)(this,"upload",{successIndex:2,errorIndex:3},arguments)},e.prototype.download=function(e,t,a,n){return(0,i.e4)(this,"download",{successIndex:2,errorIndex:3},arguments)},e.prototype.onProgress=function(e){!0===(0,i.G5)(this)&&(this._objectInstance.onprogress=e)},e.prototype.abort=function(){return(0,i.e4)(this,"abort",{sync:!0},arguments)},e.plugin="cordova-plugin-file-transfer",e.pluginName="FileTransfer",e}()},10740:function(t,n,i){i.d(n,{B:function(){return l}});var o,r=i(76329),s=i(15189),c=i(50384),u=i(37716),l=((o=function(){function t(a,n){e(this,t),this.reqAPIService=a,this.auth=n,this.API_URL="",this.reload$=new r.BehaviorSubject(0),this.user=this.auth.user}return a(t,[{key:"getUserInformation",value:function(){return this.API_URL="/user/api-account-mobie?action=get",this.reqAPIService.get(this.API_URL)}},{key:"getFilePath",value:function(){return this.reqAPIService.FILE_PATH}},{key:"getSitePath",value:function(){return this.reqAPIService.SITE_PATH}},{key:"getToken",value:function(){return this.reqAPIService.getToken()}},{key:"updateAccount",value:function(e){return this.API_URL="/user/api-account-mobie?action=edit",this.reqAPIService.post(this.API_URL,e)}},{key:"resetPassword",value:function(e){return this.API_URL="/user/api-account-mobie?action=changepass",this.reqAPIService.post(this.API_URL,e)}},{key:"actionExpert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"register",t=arguments.length>1?arguments[1]:void 0;return this.API_URL="/user/expert-account-api?action="+e,this.reqAPIService.post(this.API_URL,t)}}]),t}()).\u0275fac=function(e){return new(e||o)(u.LFG(s.$),u.LFG(c.e))},o.\u0275prov=u.Yz7({token:o,factory:o.\u0275fac}),o)},55396:function(t,n,i){i.d(n,{a:function(){return y}});var o=i(64762),r=i(27887),s=i(80272),c=i(92340),u=i(16738),l=i(90665),d=i(59865),h=i(97905),g=i(84267),p=i(10740),f=i(37716),m=i(47063),v=i(84465),R=i(81780),A=i(39075),T=i(38583);function P(e,t){1&e&&f._UZ(0,"ion-progress-bar",18)}function D(e,t){if(1&e&&f._UZ(0,"img",19),2&e){var a=f.oxw();f.Q6J("src",a.baseImage+a.pathPhoto,f.LSH)}}var I,y=((I=function(){function t(a,n,i,o,s,d,h,g,p,f){e(this,t),this.modalCtrl=a,this.pondService=n,this.toastService=i,this.translate=o,this.accountService=s,this.actionSheetController=d,this.camera=h,this.platform=g,this.filePath=p,this.DomSanitizer=f,this.URL_SAVE=c.bl.SITE_PATH+"/manager/upload-image-daily-api",this.form=new l.cw({date:new l.NI(""),description:new l.NI("",[l.kI.maxLength(255)])}),this.loadingFlag=new r.E,this.saveLoadingFlag=new r.E,this.baseImage="",this.isUpload=!1,this.dataRaw=[],this.dateRangeSelected=u().format("YYYY-MM-DD"),this.maxDate=u(),this.minDate=u().subtract(180,"days")}return a(t,[{key:"ngOnInit",value:function(){this.URL_SAVE+="?pcode="+this.pondService.pcode,this.minDate<this.pondService.seasonStartTime&&(this.minDate=this.pondService.seasonStartTime),this.getData()}},{key:"setData",value:function(e){void 0!==e&&(this.pathPhoto=e.image?c.bl.FILE_PATH+"/upload/season/"+this.scode+"/thumb_image/"+e.image:"",this.form.patchValue({description:e.description}))}},{key:"getData",value:function(){var e=this;this.loadingFlag.setStart(!0),this.pondService.loadDailyPaging({pageIndex:0,pageSize:30},u(this.dateRangeSelected).format("YYYY-MM-DD")).subscribe(function(t){t.data?(e.dataRaw=t.data,console.log(e.dateRangeSelected),e.dataRaw[0].date==u(e.dateRangeSelected).format("YYYY-MM-DD")&&(e.itemSelected=e.dataRaw[0]),e.setData(e.itemSelected),e.loadingFlag.setResult(!0)):e.loadingFlag.setResult(!1)},function(t){e.loadingFlag.setResult(!1),console.log(t)})}},{key:"onChangeDate",value:function(e){this.dateRangeSelected=e.detail.value;var t=u(this.dateRangeSelected);this.itemSelected=this.dataRaw[this.dataRaw.findIndex(function(e){return e.date==t.format("YYYY-MM-DD")})],this.isUpload=!1,this.pathPhoto="",this.baseImage="",this.form.patchValue({date:t.format("YYYY-MM-DD")}),!this.itemSelected||t<u(this.dataRaw[this.dataRaw.length-1].date)||t>u(this.dataRaw[0].date)?this.getData():this.setData(this.itemSelected)}},{key:"changeDate",value:function(e){var t=u(this.dateRangeSelected).add(e,"days");if(t<this.minDate||t>this.maxDate)return!1;this.dateRangeSelected=t.format("YYYY-MM-DD")}},{key:"processData",value:function(){var e=this;this.itemSelected=this.dataRaw.filter(function(t){return t.date==u(e.dateRangeSelected).format("YYYY-MM-DD")})}},{key:"uploadPhoto",value:function(){return(0,o.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:this.translate.instant("ACCOUNT_MOD.CHANGE_AVATAR"),buttons:[{text:this.translate.instant("ACCOUNT_MOD.NEW_PHOTO"),icon:"camera-outline",handler:function(){t.takePicture(t.camera.PictureSourceType.CAMERA)}},{text:this.translate.instant("ACCOUNT_MOD.LIBRARY"),icon:"albums-outline",handler:function(){t.pickerImage(t.camera.PictureSourceType.PHOTOLIBRARY)}},{text:this.translate.instant("OPTION.CANCEL"),icon:"close-outline",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"takePicture",value:function(e){var t=this;this.camera.getPicture({quality:100,sourceType:e,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,saveToPhotoAlbum:!1,correctOrientation:!0,targetHeight:500,targetWidth:500}).then(function(e){t.namePhoto=e.substr(e.lastIndexOf("/")+1),t.baseImage="data:image/jpeg;base64,",t.pathPhoto=e,t.isUpload=!0},function(e){t.toastService.warning(t.translate.instant("ACCOUNT_MOD.ERROR_LIBRARY"))})}},{key:"pickerImage",value:function(e){var t=this;this.camera.getPicture({quality:100,sourceType:e,saveToPhotoAlbum:!1,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,targetHeight:500,targetWidth:500}).then(function(a){t.platform.is("android")&&e===t.camera.PictureSourceType.PHOTOLIBRARY?t.filePath.resolveNativePath(a="file://"+a).then(function(e){t.namePhoto=a.substring(a.lastIndexOf("/")+1,a.lastIndexOf("?")),t.baseImage="data:image/jpeg;base64,",t.pathPhoto=e.replace("file://",""),t.isUpload=!0}).catch(function(e){t.toastService.warning(t.translate.instant("ACCOUNT_MOD.ERROR")+" "+e)}):(t.baseImage="data:image/jpeg;base64,",t.pathPhoto=a,t.namePhoto=a.substring(a.lastIndexOf("/")+1,a.lastIndexOf("?")))},function(e){t.toastService.warning(t.translate.instant("ACCOUNT_MOD.ERROR_LIBRARY"))})}},{key:"onSaveNonePhoto",value:function(){var e=this;this.saveLoadingFlag.setPending(!0),this.pondService.savePhotoDaily(this.form.value).subscribe(function(t){1==t.status?e.modalCtrl.dismiss(e.form.value):e.toastService.warning(t.error),e.saveLoadingFlag.setResult(!0)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT")),e.saveLoadingFlag.setResult(!1)})}},{key:"onSaveWithPhoto",value:function(){return(0,o.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,a,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(new Date).valueOf()+".jpeg",a=this.dataURItoBlob(this.pathPhoto),console.log(a),(n=new FormData).append("image",a),n.append("date",this.form.value.date),n.append("description",this.form.value.description),this.loadingFlag.setPending(!0),this.pondService.uploadPhoto(n,t).pipe().subscribe(function(e){1==e.status?(i.toastService.success(i.translate.instant("POND_MOD.NOTI_UPDATE")),i.modalCtrl.dismiss({image:e.data,description:i.form.value.description,date:u(i.form.value.date).format("YYYY-MM-DD")})):i.toastService.warning(e.error),i.saveLoadingFlag.setResult(!0)},function(e){i.saveLoadingFlag.setResult(!1),i.toastService.danger(i.translate.instant("ERROR_CONNECT"))});case 4:case"end":return e.stop()}},e,this)}))}},{key:"onSave",value:function(){this.isUpload?this.onSaveWithPhoto():this.onSaveNonePhoto()}},{key:"dataURItoBlob",value:function(e){for(var t=window.atob(e),a=new ArrayBuffer(t.length),n=new Uint8Array(a),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return new Blob([n],{type:"image/jpeg"})}}]),t}()).\u0275fac=function(e){return new(e||I)(f.Y36(m.IN),f.Y36(s.p),f.Y36(v.k),f.Y36(R.sK),f.Y36(p.B),f.Y36(m.BX),f.Y36(g.V1),f.Y36(m.t4),f.Y36(d.y),f.Y36(A.H7))},I.\u0275cmp=f.Xpm({type:I,selectors:[["app-daily-photo-update"]],inputs:{inforDaily:"inforDaily",scode:"scode"},features:[f._Bn([h.K])],decls:40,vars:24,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],["type","indeterminate",4,"ngIf"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back-outline"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward-outline"],["width","240px",3,"src",4,"ngIf"],[2,"max-width","240px","margin","0 auto",3,"formGroup"],["size","small",3,"click"],["position","floating"],["rows","6","cols","20","formControlName","description"],["type","indeterminate"],["width","240px",3,"src"]],template:function(e,t){1&e&&(f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar"),f.TgZ(2,"ion-buttons",0),f.TgZ(3,"ion-button",1),f.NdJ("click",function(){return t.modalCtrl.dismiss()}),f._UZ(4,"ion-icon",2),f.qZA(),f.qZA(),f.TgZ(5,"ion-title"),f._uU(6),f.ALo(7,"translate"),f.qZA(),f.TgZ(8,"ion-buttons",3),f.TgZ(9,"ion-button",4),f.NdJ("click",function(){return t.onSave()}),f._uU(10),f.ALo(11,"translate"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"ion-content"),f.YNc(13,P,1,0,"ion-progress-bar",5),f.TgZ(14,"div",6),f.TgZ(15,"ion-grid"),f.TgZ(16,"ion-row"),f.TgZ(17,"ion-col",7),f.TgZ(18,"ion-button",8),f.NdJ("click",function(){return t.changeDate(-1)}),f._UZ(19,"ion-icon",9),f.qZA(),f.qZA(),f.TgZ(20,"ion-col",10),f.TgZ(21,"ion-item"),f.TgZ(22,"ion-datetime",11),f.NdJ("ionChange",function(e){return t.onChangeDate(e)}),f.ALo(23,"translate"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(24,"ion-col",7),f.TgZ(25,"ion-button",8),f.NdJ("click",function(){return t.changeDate(1)}),f._UZ(26,"ion-icon",12),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(27,"div",6),f.YNc(28,D,1,1,"img",13),f.qZA(),f.TgZ(29,"div"),f.TgZ(30,"ion-list",14),f.TgZ(31,"ion-item"),f.TgZ(32,"ion-button",15),f.NdJ("click",function(){return t.uploadPhoto()}),f._uU(33),f.ALo(34,"translate"),f.qZA(),f.qZA(),f.TgZ(35,"ion-item"),f.TgZ(36,"ion-label",16),f._uU(37),f.ALo(38,"translate"),f.qZA(),f._UZ(39,"ion-textarea",17),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(6),f.Oqu(f.lcZ(7,14,"PHOTO_MOD.DAILY_PHOTO_UPDATE")),f.xp6(3),f.Q6J("disabled",t.form.invalid),f.xp6(1),f.hij(" ",f.lcZ(11,16,"POND_MOD.SAVE")," "),f.xp6(3),f.Q6J("ngIf",t.saveLoadingFlag.pending),f.xp6(5),f.Q6J("disabled",t.dateRangeSelected<=t.minDate.format("YYYY-MM-DD")),f.xp6(4),f.Q6J("displayFormat",f.lcZ(23,18,"FORMAT_DATE_MOMENT"))("min",t.minDate.format("YYYY-MM-DD"))("max",t.maxDate.format("YYYY-MM-DD"))("value",t.dateRangeSelected),f.xp6(3),f.Q6J("disabled",t.dateRangeSelected>=t.maxDate.format("YYYY-MM-DD")),f.xp6(3),f.Q6J("ngIf",t.pathPhoto),f.xp6(2),f.Q6J("formGroup",t.form),f.xp6(3),f.Oqu(f.lcZ(34,20,"PHOTO_MOD.CHOOSE_IMAGE")),f.xp6(4),f.Oqu(f.lcZ(38,22,"PHOTO_MOD.DESCRIPTION")))},directives:[m.Gu,m.sr,m.Sm,m.YG,m.gu,m.wd,m.W2,T.O5,m.jY,m.Nd,m.wI,m.Ie,m.x4,m.QI,m.q_,l.JL,l.sg,m.Q$,m.g2,m.j9,l.JJ,l.u,m.X7],pipes:[R.X$],styles:[""]}),I)}}])}();