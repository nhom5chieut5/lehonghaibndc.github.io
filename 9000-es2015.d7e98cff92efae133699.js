"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[9e3],{76329:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a=n(13409),s=n(25639),r=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new s.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(a.Subject);e.BehaviorSubject=r},13409:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a=n(93576),s=n(67241),r=n(43984),l=n(25639),c=n(45298),d=n(81476),u=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return o(e,t),e}(s.Subscriber);e.SubjectSubscriber=u;var p=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[d.rxSubscriber]=function(){return new u(this)},e.prototype.lift=function(t){var e=new h(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new l.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new l.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new l.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),i=0;i<e;i++)n[i].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new l.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new l.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),r.Subscription.EMPTY):this.isStopped?(t.complete(),r.Subscription.EMPTY):(this.observers.push(t),new c.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new a.Observable;return t.source=this,t},e.create=function(t,e){return new h(t,e)},e}(a.Observable);e.Subject=p;var h=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):r.Subscription.EMPTY},e}(p);e.AnonymousSubject=h},45298:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n){var i=t.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=!1,i}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(n(43984).Subscription);e.SubjectSubscription=a},25639:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}();e.ObjectUnsubscribedError=n},87498:function(t,e,n){n.d(e,{R:function(){return a}});var i=n(15189),o=n(37716);let a=(()=>{class t{constructor(t){this.reqAPIService=t}getFollowingList(){return this.reqAPIService.get("/follow/follow-api?action=list")}searchFarm(t){return this.reqAPIService.post("/follow/follow-api?action=search",t)}getPondsByFarmCode(t){return this.reqAPIService.get("/follow/follow-api?action=pondlist&fcode="+t)}submitFollowerRequest(t){return this.reqAPIService.get("/manager/follow-api?action=request&pcode="+t)}unFollow(t){return this.reqAPIService.post("/follow/follow-api?action=unfollow",{item_code:t})}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(i.$))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t})()},75446:function(t,e,n){n.d(e,{e:function(){return b}});var i=n(64762),o=n(25917),a=n(88002),s=n(87498),r=n(27887),l=n(40044),c=n(37716),d=n(47063),u=n(84465),p=n(81780),h=n(90665),g=n(38583);function f(t,e){1&t&&c._UZ(0,"ion-progress-bar",7)}function m(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item"),c._UZ(1,"ion-icon",8),c.TgZ(2,"ion-label"),c.TgZ(3,"h3"),c._uU(4),c.qZA(),c.TgZ(5,"p"),c._uU(6),c.qZA(),c.TgZ(7,"p"),c._uU(8),c.qZA(),c.qZA(),c.TgZ(9,"ion-button",9),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw().selectFarm(e)}),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw();c.xp6(4),c.Oqu(t.name),c.xp6(2),c.Oqu(t.company_name),c.xp6(2),c.Oqu(t.address),c.xp6(1),c.Q6J("disabled",n.checkExist(t)),c.xp6(1),c.hij(" ",c.lcZ(11,5,"ADD")," ")}}function Z(t,e){if(1&t&&(c.TgZ(0,"ion-item",10),c.TgZ(1,"ion-label"),c.TgZ(2,"p"),c._uU(3),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(3),c.Oqu(t.searchMessage)}}let b=(()=>{class t{constructor(t,e,n,i,o,a){this.modalController=t,this.labService=e,this.toastService=n,this.translate=i,this.followService=o,this.alertController=a,this.loadingFlag=new r.E,this.keyword="",this.listAdded=[]}ngOnInit(){}inputSearch(){this.loadingFlag.setPending(!0),this.farms=this.getFarmList(this.keyword),this.farms.subscribe(t=>{t?(0==t.length&&(this.searchMessage=this.translate.instant("FOLLOW_MOD.NOT_FIND")),this.loadingFlag.setResult(!0)):(this.loadingFlag.setResult(!1),this.searchMessage=this.translate.instant("FOLLOW_MOD.NOT_FIND_FARM"))})}getFarmList(t){return""!=t.trim()?this.followService.searchFarm({keyword:t}).pipe((0,a.U)(t=>t.data)):(0,o.of)([])}selectFarm(t){return(0,i.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM"),message:this.translate.instant("ADD")+" "+t.name,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{this.addFarm(t)}}]})).present()})}addFarm(t){this.labService.addFarm(t.code).subscribe(e=>{1==e.status?(this.listAdded.push(t),this.toastService.success(this.translate.instant("SHOP.CART.ADDRESS.UPDATE_SUCCESS"))):this.toastService.warning(e.message)},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}checkExist(t){return this.listAdded.filter(e=>e.id===t.id).length>0}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.IN),c.Y36(l.y),c.Y36(u.k),c.Y36(p.sK),c.Y36(s.R),c.Y36(d.Br))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-add-farm"]],decls:17,vars:15,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["mode","ios","debounce","300",3,"placeholder","ngModel","ngModelChange","ionChange"],["type","indeterminate",4,"ngIf"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],["type","indeterminate"],["slot","start","src","/assets/icon/001-flooded-house.svg"],["slot","end","shape","round","fill","outline",3,"disabled","click"],["lines","none"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.modalController.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.ALo(8,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"ion-content"),c.TgZ(10,"ion-searchbar",3),c.NdJ("ngModelChange",function(t){return e.keyword=t})("ionChange",function(){return e.inputSearch()}),c.ALo(11,"translate"),c.qZA(),c.YNc(12,f,1,0,"ion-progress-bar",4),c.TgZ(13,"ion-list"),c.YNc(14,m,12,7,"ion-item",5),c.ALo(15,"async"),c.YNc(16,Z,4,1,"ion-item",6),c.qZA(),c.qZA()),2&t&&(c.xp6(6),c.AsE("",c.lcZ(7,7,"ADD")," ",c.lcZ(8,9,"FARM"),""),c.xp6(4),c.s9C("placeholder",c.lcZ(11,11,"LAB_MOD.SEARCH_FARM")),c.Q6J("ngModel",e.keyword),c.xp6(2),c.Q6J("ngIf",e.loadingFlag.pending),c.xp6(2),c.Q6J("ngForOf",c.lcZ(15,13,e.farms)),c.xp6(2),c.Q6J("ngIf",e.searchMessage))},directives:[d.Gu,d.sr,d.Sm,d.YG,d.gu,d.wd,d.W2,d.VI,d.j9,h.JJ,h.On,g.O5,d.q_,g.sg,d.X7,d.Ie,d.Q$],pipes:[p.X$,g.Ov],styles:[""]}),t})()},29111:function(t,e,n){n.d(e,{k:function(){return A}});var i=n(64762),o=n(16738),a=n(27887),s=n(90559),r=n(40044),l=n(37716),c=n(47063),d=n(81780),u=n(84465),p=n(38583),h=n(56209);function g(t,e){1&t&&(l.TgZ(0,"div",7),l._UZ(1,"ion-spinner",8),l.qZA())}function f(t,e){if(1&t&&(l.TgZ(0,"div"),l._UZ(1,"div",12),l.qZA()),2&t){const t=e.index,n=l.oxw(3);l.xp6(1),l.Q6J("options",n.getOptionBac(t))}}function m(t,e){if(1&t&&(l.TgZ(0,"div"),l.TgZ(1,"p",10),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.YNc(4,f,2,1,"div",11),l.qZA()),2&t){const t=l.oxw(2);l.xp6(2),l.hij(" ",l.lcZ(3,2,"LAB_MOD.BACTERIA")," "),l.xp6(2),l.Q6J("ngForOf",t.dataBacte.arr)}}function Z(t,e){if(1&t&&l._UZ(0,"div",12),2&t){const t=l.oxw(2);l.Q6J("options",t.getOptionBar(t.result.antibiotic.data,t.result.antibiotic.group))}}function b(t,e){if(1&t&&(l.TgZ(0,"div"),l.YNc(1,m,5,4,"div",6),l.YNc(2,Z,1,1,"div",9),l.qZA()),2&t){const t=l.oxw();l.xp6(1),l.Q6J("ngIf",t.dataBacte.arr.length>0),l.xp6(1),l.Q6J("ngIf",t.result.antibiotic)}}let A=(()=>{class t{constructor(t,e,n,i){this.modalController=t,this.translate=e,this.toastService=n,this.labService=i,this.dataFilter={species_id:"",startDate:o().subtract(180,"days"),endDate:o()},this.dataBacte={label:[],data:[]},this.loadingFlag=new a.E}ngOnInit(){this.loadData()}loadData(){const t={species_id:this.dataFilter.species_id,startDate:this.dataFilter.startDate.valueOf()/1e3,endDate:this.dataFilter.endDate.valueOf()/1e3};this.loadingFlag.setPending(!0),this.labService.loadAnalyze(t).subscribe(t=>{1==+t.status?(this.result=t.data.analyze,this.dataFilter.startDate=o(t.data.rangeTime.start),this.dataFilter.endDate=o(t.data.rangeTime.end),this.processData(t.data.analyze)):this.toastService.warning(t.message),this.loadingFlag.setResult(!0)},()=>{this.loadingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentSearch(){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:s.O,componentProps:{data:{species_id:this.dataFilter.species_id,startDate:this.dataFilter.startDate.format("YYYY-MM-DD"),endDate:this.dataFilter.endDate.format("YYYY-MM-DD")}}});return t.onDidDismiss().then(t=>{t.data&&(this.dataFilter={species_id:t.data.species_id,startDate:o(t.data.startDate),endDate:o(t.data.endDate)},this.loadData())}),yield t.present()})}getJson(t){var e;try{e=JSON.parse(t)}catch(n){e={min:1e3,max:3e3}}return e}getPondByString(t){let e=[];return t.split(",,,").forEach(t=>{let n=t.split(":::");0==e.filter(t=>t.pcode===n[2]).length&&e.push({key:n[0],name:n[1],pcode:n[2],pname:n[3],fcode:n[4],fname:n[5],value:n[6],calculator:n[7]?this.getJson(n[7]):""})}),e}getDailyByString(t){let e=[];return t.split(",,,").forEach(t=>{let n=t.split(":::");e.push({key:n[0],name:n[1],pcode:n[2],pname:n[3],fcode:n[4],fname:n[5],value:n[6],calculator:n[7]?this.getJson(n[7]):""})}),e}getStatusBacte(t){return console.log(t),+t.value<+t.calculator.min?0:+t.value>+t.calculator.max?2:1}getOptionBac(t){return{legend:{top:"bottom"},toolbox:{show:!0},tooltip:{trigger:"item"},series:[{name:this.dataBacte.arr[t].name,type:"pie",radius:[50,80],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:8},data:[{value:this.dataBacte.data[t][0],name:this.translate.instant("LAB_MOD.GOOD")},{value:this.dataBacte.data[t][1],name:this.translate.instant("WARNING")},{value:this.dataBacte.data[t][2],name:this.translate.instant("LAB_MOD.DANGER")}]}]}}getOptionBar(t,e){let n=this.getDailyByString(t),i=[];n.forEach(t=>{i.findIndex(e=>e.code===t.fcode)<0&&i.push({code:t.fcode,name:t.fname})});let o=[];n.forEach(t=>{o.findIndex(e=>e.id===t.key)<0&&o.push({id:t.key,name:t.name})});var a=[];n.forEach(t=>{a.findIndex(e=>e.key==t.key&&e.pcode==t.pcode)<0&&a.push(t)});var s=[];return o.forEach(t=>{let e={name:t.name,type:"bar",data:[]};i.forEach(n=>{let i=a.filter(e=>e.key==t.id&&e.fcode==n.code).length;e.data.push(0==i?"":i)}),s.push(e)}),{tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value",boundaryGap:[0,.01]},xAxis:{type:"category",data:i.map(t=>t.name)},series:s}}processData(t){let e=[],n=[];if(t.bacteria){let i=this.getPondByString(t.bacteria.data);console.log(i),i.forEach(t=>{let i=e.findIndex(e=>e.key===t.key);i>=0?n[i][this.getStatusBacte(t)]=+n[i][this.getStatusBacte(t)]+1:(e.push(t),n.push([0,0,0]),n[n.length-1][this.getStatusBacte(t)]=+n[n.length-1][this.getStatusBacte(t)]+1)})}this.dataBacte.arr=e,this.dataBacte.data=n}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(c.IN),l.Y36(d.sK),l.Y36(u.k),l.Y36(r.y))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-lab-analyze"]],decls:14,vars:5,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["slot","icon-only","name","search-outline"],["class","spiner-loading",4,"ngIf"],[4,"ngIf"],[1,"spiner-loading"],["name","dots"],["echarts","","class","ion-margin-top",3,"options",4,"ngIf"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],["echarts","",1,"ion-margin-top",3,"options"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l.TgZ(3,"ion-button",1),l.NdJ("click",function(){return e.modalController.dismiss()}),l._UZ(4,"ion-icon",2),l.qZA(),l.qZA(),l.TgZ(5,"ion-title"),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.TgZ(8,"ion-buttons",3),l.TgZ(9,"ion-button",1),l.NdJ("click",function(){return e.presentSearch()}),l._UZ(10,"ion-icon",4),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"ion-content"),l.YNc(12,g,2,0,"div",5),l.YNc(13,b,3,2,"div",6),l.qZA()),2&t&&(l.xp6(6),l.Oqu(l.lcZ(7,3,"LAB_MOD.ANALYZE")),l.xp6(6),l.Q6J("ngIf",e.loadingFlag.pending),l.xp6(1),l.Q6J("ngIf",!e.loadingFlag.pending))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,p.O5,c.PQ,p.sg,h._w],pipes:[d.X$],styles:[""]}),t})()},90559:function(t,e,n){n.d(e,{O:function(){return h}});var i=n(64762),o=n(90665),a=n(16738),s=n(40044),r=n(37716),l=n(47063),c=n(81780),d=n(84465),u=n(38583);function p(t,e){if(1&t&&(r.TgZ(0,"ion-select-option",11),r._uU(1),r.qZA()),2&t){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.Oqu(t.name)}}let h=(()=>{class t{constructor(t,e,n,i){this.modalController=t,this.labService=e,this.translate=n,this.toastService=i,this.form=new o.cw({species_id:new o.NI(""),startDate:new o.NI(""),endDate:new o.NI("")}),this.listSpecies=[],this.maxDate=a(),this.minDate=a().subtract(180,"days")}ngOnInit(){return(0,i.mG)(this,void 0,void 0,function*(){console.log(this.data),yield this.loadSpecies(),this.form.setValue(this.data)})}loadSpecies(){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.labService.loadSpecies().toPromise().catch(()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))});1==+t.status?this.listSpecies=t.data:this.toastService.warning(t.message)})}save(){this.modalController.dismiss(this.form.value)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(l.IN),r.Y36(s.y),r.Y36(c.sK),r.Y36(d.k))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-lab-filter"]],inputs:{data:"data"},decls:36,vars:30,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"formGroup"],["lines","inset"],["formControlName","species_id","interface","action-sheet"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","startDate",3,"displayFormat","min","max"],["formControlName","endDate",3,"displayFormat","min","max"],[3,"value"]],template:function(t,e){1&t&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r.TgZ(2,"ion-buttons",0),r.TgZ(3,"ion-button",1),r.NdJ("click",function(){return e.modalController.dismiss()}),r._UZ(4,"ion-icon",2),r.qZA(),r.qZA(),r.TgZ(5,"ion-title"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.TgZ(8,"ion-buttons",3),r.TgZ(9,"ion-button",1),r.NdJ("click",function(){return e.save()}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"ion-content"),r.TgZ(13,"form",4),r.TgZ(14,"ion-list"),r.TgZ(15,"ion-item",5),r.TgZ(16,"ion-label"),r._uU(17),r.ALo(18,"translate"),r.qZA(),r.TgZ(19,"ion-select",6),r.TgZ(20,"ion-select-option",7),r._uU(21),r.ALo(22,"translate"),r.qZA(),r.YNc(23,p,2,2,"ion-select-option",8),r.qZA(),r.qZA(),r.TgZ(24,"ion-item",5),r.TgZ(25,"ion-label"),r._uU(26),r.ALo(27,"translate"),r.qZA(),r._UZ(28,"ion-datetime",9),r.ALo(29,"translate"),r.qZA(),r.TgZ(30,"ion-item",5),r.TgZ(31,"ion-label"),r._uU(32),r.ALo(33,"translate"),r.qZA(),r._UZ(34,"ion-datetime",10),r.ALo(35,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.xp6(6),r.Oqu(r.lcZ(7,14,"SHOP.FILTER.TITLE")),r.xp6(4),r.Oqu(r.lcZ(11,16,"FARM_MOD.SAVE")),r.xp6(3),r.Q6J("formGroup",e.form),r.xp6(4),r.Oqu(r.lcZ(18,18,"SPECIES")),r.xp6(4),r.Oqu(r.lcZ(22,20,"FARM_MOD.ALL")),r.xp6(2),r.Q6J("ngForOf",e.listSpecies),r.xp6(3),r.Oqu(r.lcZ(27,22,"FARM_MOD.FROM")),r.xp6(2),r.Q6J("displayFormat",r.lcZ(29,24,"FORMAT_DATE_MOMENT"))("min",e.minDate.format("YYYY-MM-DD"))("max",e.maxDate.format("YYYY-MM-DD")),r.xp6(4),r.Oqu(r.lcZ(33,26,"FARM_MOD.TO")),r.xp6(2),r.Q6J("displayFormat",r.lcZ(35,28,"FORMAT_DATE_MOMENT"))("min",e.form.value.startDate)("max",e.maxDate.format("YYYY-MM-DD")))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o._Y,o.JL,o.sg,l.q_,l.Ie,l.Q$,l.t9,l.QI,o.JJ,o.u,l.n0,u.sg,l.x4],pipes:[c.X$],styles:[""]}),t})()},44577:function(t,e,n){n.d(e,{b:function(){return b}});var i=n(64762),o=n(16738),a=n(27887),s=n(90559),r=n(40044),l=n(37716),c=n(47063),d=n(81780),u=n(84465),p=n(38583),h=n(56209);function g(t,e){1&t&&(l.TgZ(0,"div",7),l._UZ(1,"ion-spinner",8),l.qZA())}function f(t,e){if(1&t&&(l.TgZ(0,"ion-item"),l.TgZ(1,"ion-label"),l.TgZ(2,"p"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"ion-text"),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.qZA(),l.TgZ(8,"ion-text",12),l._uU(9),l.ALo(10,"translate"),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(3),l.AsE("",l.lcZ(4,6,"FARM")," ",t.name,""),l.xp6(3),l.AsE(" ",t.pond," ",l.lcZ(7,8,"POND")," "),l.xp6(3),l.AsE(" ",l.lcZ(10,10,"LAB_MOD.VACCINATED")," ",t.total," ")}}function m(t,e){if(1&t&&(l.TgZ(0,"ion-item"),l.TgZ(1,"ion-label"),l.TgZ(2,"p"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"ion-text"),l._uU(6),l.qZA(),l.qZA(),l.TgZ(7,"ion-text",12),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(3),l.lnq("",t.farm_name," | ",l.lcZ(4,6,"POND")," ",t.name,""),l.xp6(3),l.hij(" ",t.seed," "),l.xp6(2),l.AsE(" ",l.lcZ(9,8,"POND_MOD.LOSS")," ",t.loss," ")}}function Z(t,e){if(1&t&&(l.TgZ(0,"div"),l.TgZ(1,"p",9),l._uU(2),l.ALo(3,"translate"),l.qZA(),l._UZ(4,"div",10),l.TgZ(5,"ion-list"),l.YNc(6,f,11,12,"ion-item",11),l.qZA(),l.TgZ(7,"p",9),l._uU(8),l.ALo(9,"translate"),l.qZA(),l._UZ(10,"div",10),l.TgZ(11,"ion-list"),l.TgZ(12,"ion-list-header"),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.YNc(15,m,10,10,"ion-item",11),l.qZA(),l.qZA()),2&t){const t=l.oxw();l.xp6(2),l.Oqu(l.lcZ(3,7,"LAB_MOD.TIME_OLD")),l.xp6(2),l.Q6J("options",t.optionSeedOld),l.xp6(2),l.Q6J("ngForOf",t.result.pondVaccinated),l.xp6(2),l.Oqu(l.lcZ(9,9,"LAB_MOD.LOSS_RANGE")),l.xp6(2),l.Q6J("options",t.optionLoss),l.xp6(3),l.hij(" ",l.lcZ(14,11,"LAB_MOD.ACTUAL_LOSS")," "),l.xp6(2),l.Q6J("ngForOf",t.result.pondVaccinatedInLab)}}let b=(()=>{class t{constructor(t,e,n,i){this.modalController=t,this.translate=e,this.toastService=n,this.labService=i,this.dataFilter={species_id:"",startDate:o().subtract(180,"days"),endDate:o()},this.loadingFlag=new a.E}ngOnInit(){this.loadData()}loadData(){const t={species_id:this.dataFilter.species_id,startDate:this.dataFilter.startDate.valueOf()/1e3,endDate:this.dataFilter.endDate.valueOf()/1e3};this.loadingFlag.setPending(!0),this.labService.loadReport(t).subscribe(t=>{1==+t.status?(this.result=t.data,this.dataFilter.startDate=o(t.data.rangeTime.start),this.dataFilter.endDate=o(t.data.rangeTime.end),this.processData(t.data)):this.toastService.warning(t.message),this.loadingFlag.setResult(!0)},()=>{this.loadingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentSearch(){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:s.O,componentProps:{data:{species_id:this.dataFilter.species_id,startDate:this.dataFilter.startDate.format("YYYY-MM-DD"),endDate:this.dataFilter.endDate.format("YYYY-MM-DD")}}});return t.onDidDismiss().then(t=>{t.data&&(this.dataFilter={species_id:t.data.species_id,startDate:o(t.data.startDate),endDate:o(t.data.endDate)},this.loadData())}),yield t.present()})}processData(t){let e=[],n=[{name:"< 30 "+this.translate.instant("FARM_MOD.OLD_DAY"),type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:[]},{name:"30-60 "+this.translate.instant("FARM_MOD.OLD_DAY"),type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:[]},{name:">60 "+this.translate.instant("FARM_MOD.OLD_DAY"),type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:[]}];t.listSeedOldInFarm&&(t.listSeedOldInFarm.forEach(t=>{var i=["","",""];t.data.split(",").forEach(t=>{var e=t.split(":::"),n=+e[1]>60?2:this.float2int(+e[1]/30);i[n.toString()]=+i[n]+1}),n[0].data.push(i[0]),n[1].data.push(i[1]),n[2].data.push(i[2]),e.push(t.farm_name)}),console.log(n)),this.optionSeedOld={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value"},xAxis:{type:"category",data:e},series:n};let i=[],o=[{name:"< 30 "+this.translate.instant("FARM_MOD.OLD_DAY"),type:"bar",data:[]},{name:"30-60 "+this.translate.instant("FARM_MOD.OLD_DAY"),type:"bar",data:[]},{name:">60 "+this.translate.instant("FARM_MOD.OLD_DAY"),type:"bar",data:[]}];t.lossInFarm&&t.lossInFarm.forEach(t=>{var e=[0,0,0],n=[0,0,0];t.data.split(",").forEach(t=>{var i=t.split(":::"),o=+i[1]>60?2:this.float2int(+i[1]/30);e[o]+=+i[2],n[o]+=+i[3]}),[0,1,2].forEach(t=>{o[t].data.push(0==e[t]||0==n[t]?"":(100*e[t]/n[t]).toFixed(2))}),i.push(t.farm_name)}),this.optionLoss={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value",boundaryGap:[0,.01]},xAxis:{type:"category",data:i},series:o},console.log(o)}float2int(t){return 0|t}getListLoss(t){let e=[];t.split(",").forEach(t=>{e.push({})})}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(c.IN),l.Y36(d.sK),l.Y36(u.k),l.Y36(r.y))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-lab-report"]],decls:14,vars:5,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["slot","icon-only","name","search-outline"],["class","spiner-loading",4,"ngIf"],[4,"ngIf"],[1,"spiner-loading"],["name","dots"],[1,"ion-text-center"],["echarts","",1,"ion-margin-top",3,"options"],[4,"ngFor","ngForOf"],["color","danger","slot","end"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l.TgZ(3,"ion-button",1),l.NdJ("click",function(){return e.modalController.dismiss()}),l._UZ(4,"ion-icon",2),l.qZA(),l.qZA(),l.TgZ(5,"ion-title"),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.TgZ(8,"ion-buttons",3),l.TgZ(9,"ion-button",1),l.NdJ("click",function(){return e.presentSearch()}),l._UZ(10,"ion-icon",4),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"ion-content"),l.YNc(12,g,2,0,"div",5),l.YNc(13,Z,16,13,"div",6),l.qZA()),2&t&&(l.xp6(6),l.Oqu(l.lcZ(7,3,"LAB_MOD.REPORT")),l.xp6(6),l.Q6J("ngIf",e.loadingFlag.pending),l.xp6(1),l.Q6J("ngIf",!e.loadingFlag.pending))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,p.O5,c.PQ,h._w,c.q_,p.sg,c.yh,c.Ie,c.Q$,c.yW],pipes:[d.X$],styles:[""]}),t})()},64557:function(t,e,n){n.r(e),n.d(e,{LabPageModule:function(){return D}});var i=n(38583),o=n(90665),a=n(47063),s=n(13619),r=n(64762),l=n(27887),c=n(75446),d=n(29111),u=n(44577),p=n(1209),h=n(40044),g=n(37716),f=n(81780),m=n(84465);function Z(t,e){1&t&&g._UZ(0,"ion-progress-bar",14)}function b(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"ion-item",15),g.TgZ(2,"ion-label"),g.TgZ(3,"ion-text"),g.TgZ(4,"h3"),g._uU(5),g.qZA(),g.qZA(),g.TgZ(6,"p"),g._uU(7),g.qZA(),g.qZA(),g.qZA(),g.BQk()),2&t){const t=e.$implicit;g.xp6(1),g.MGl("routerLink","/farm/",null==t?null:t.code,""),g.xp6(4),g.Oqu(t.name),g.xp6(2),g.Oqu(t.address)}}function A(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"ion-card",16),g.TgZ(2,"ion-card-content",17),g.TgZ(3,"p",18),g._uU(4),g.ALo(5,"translate"),g.qZA(),g.TgZ(6,"ion-button",19),g.NdJ("click",function(){return g.CHM(t),g.oxw().presentAddFarm()}),g._uU(7),g.ALo(8,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}2&t&&(g.xp6(4),g.Oqu(g.lcZ(5,2,"LAB_MOD.LAB_EMPTY")),g.xp6(3),g.hij(" ",g.lcZ(8,4,"LAB_MOD.FARM_EMPTY")," "))}const _=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o){this.translate=t,this.toastService=e,this.labService=n,this.route=i,this.modalController=o,this.keyword="",this.farms=[],this.loadingFlag=new l.E}ngOnInit(){this.code=this.route.snapshot.paramMap.get("code"),this.labService.setCode(this.code),this.inputSearch()}inputSearch(){this.loadingFlag.setPending(!0),this.labService.loadFarm(this.keyword).subscribe(t=>{1==t.status?this.farms=t.data:this.toastService.warning(t.message),this.loadingFlag.setResult(!0)},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT")),this.loadingFlag.setResult(!1)})}presentAddFarm(){return(0,r.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:c.e});return t.onDidDismiss().then(t=>{this.keyword="",this.inputSearch()}),yield t.present()})}presentSetting(){return(0,r.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:p.V});return t.onDidDismiss().then(t=>{}),yield t.present()})}openReport(){return(0,r.mG)(this,void 0,void 0,function*(){return yield(yield this.modalController.create({component:u.b})).present()})}openAnalyze(){return(0,r.mG)(this,void 0,void 0,function*(){return yield(yield this.modalController.create({component:d.k})).present()})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(f.sK),g.Y36(m.k),g.Y36(h.y),g.Y36(s.gz),g.Y36(a.IN))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-lab"]],decls:34,vars:16,consts:[["slot","start"],["text","","defaultHref","tabs/subscription"],["slot","end"],[3,"click"],["name","add"],["slot","icon-only","name","cog-outline"],["mode","ios",1,"menu-icon-square",3,"click"],["color","primary","src","assets/img/chemical-report.svg",1,"icon-large"],["color","primary","src","assets/img/lab-analyze.svg",1,"icon-large"],["id","line"],["mode","ios","debounce","300",3,"placeholder","ngModel","ngModelChange","ionChange"],["type","indeterminate",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["type","indeterminate"],["detail","",3,"routerLink"],["mode","ios"],[1,"ion-text-center"],[1,"ion-padding"],["shape","round","color","primary",3,"click"]],template:function(t,e){1&t&&(g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar"),g.TgZ(2,"ion-buttons",0),g.TgZ(3,"ion-buttons",0),g._UZ(4,"ion-back-button",1),g.qZA(),g.qZA(),g.TgZ(5,"ion-title"),g._uU(6),g.ALo(7,"translate"),g.qZA(),g.TgZ(8,"ion-buttons",2),g.TgZ(9,"ion-button",3),g.NdJ("click",function(){return e.presentAddFarm()}),g._UZ(10,"ion-icon",4),g.qZA(),g.TgZ(11,"ion-button",3),g.NdJ("click",function(){return e.presentSetting()}),g._UZ(12,"ion-icon",5),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(13,"ion-content"),g.TgZ(14,"div"),g.TgZ(15,"ion-grid"),g.TgZ(16,"ion-row"),g.TgZ(17,"ion-col"),g.TgZ(18,"ion-card",6),g.NdJ("click",function(){return e.openReport()}),g._UZ(19,"ion-icon",7),g._uU(20),g.ALo(21,"translate"),g.qZA(),g.qZA(),g.TgZ(22,"ion-col"),g.TgZ(23,"ion-card",6),g.NdJ("click",function(){return e.openAnalyze()}),g._UZ(24,"ion-icon",8),g._uU(25),g.ALo(26,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g._UZ(27,"div",9),g.TgZ(28,"ion-searchbar",10),g.NdJ("ngModelChange",function(t){return e.keyword=t})("ionChange",function(){return e.inputSearch()}),g.ALo(29,"translate"),g.qZA(),g.YNc(30,Z,1,0,"ion-progress-bar",11),g.TgZ(31,"ion-list"),g.YNc(32,b,8,3,"ng-container",12),g.qZA(),g.YNc(33,A,9,6,"div",13),g.qZA()),2&t&&(g.xp6(6),g.Oqu(g.lcZ(7,8,"MANAGEMENT")),g.xp6(14),g.hij(" ",g.lcZ(21,10,"LAB_MOD.REPORT")," "),g.xp6(5),g.hij(" ",g.lcZ(26,12,"LAB_MOD.ANALYZE")," "),g.xp6(3),g.s9C("placeholder",g.lcZ(29,14,"LAB_MOD.SEARCH_FARM")),g.Q6J("ngModel",e.keyword),g.xp6(2),g.Q6J("ngIf",e.loadingFlag.pending),g.xp6(2),g.Q6J("ngForOf",e.farms),g.xp6(1),g.Q6J("ngIf",0===e.farms.length&&""===e.keyword&&!e.loadingFlag.pending))},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.YG,a.gu,a.W2,a.jY,a.Nd,a.wI,a.PM,a.VI,a.j9,o.JJ,o.On,i.O5,a.q_,i.sg,a.X7,a.Ie,a.YI,s.rH,a.Q$,a.yW,a.FN],pipes:[f.X$],styles:["#line[_ngcontent-%COMP%]{border:.7px solid #f5f6f9}"]}),t})()},{path:"add-farm",loadChildren:()=>n.e(1178).then(n.bind(n,81178)).then(t=>t.AddFarmPageModule)},{path:"lab-setting",loadChildren:()=>n.e(5028).then(n.bind(n,75028)).then(t=>t.LabSettingPageModule)},{path:"lab-manager",loadChildren:()=>n.e(2857).then(n.bind(n,92857)).then(t=>t.LabManagerPageModule)},{path:"lab-edit",loadChildren:()=>n.e(5649).then(n.bind(n,75649)).then(t=>t.LabEditPageModule)},{path:"lab-create",loadChildren:()=>n.e(5524).then(n.bind(n,15524)).then(t=>t.LabCreatePageModule)},{path:"lab-map",loadChildren:()=>Promise.all([n.e(5869),n.e(8418)]).then(n.bind(n,58418)).then(t=>t.LabMapPageModule)},{path:"lab-report",loadChildren:()=>n.e(4480).then(n.bind(n,94480)).then(t=>t.LabReportPageModule)},{path:"lab-analyze",loadChildren:()=>n.e(2121).then(n.bind(n,32121)).then(t=>t.LabAnalyzePageModule)},{path:"lab-filter",loadChildren:()=>n.e(3464).then(n.bind(n,3464)).then(t=>t.LabFilterPageModule)}];let y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[s.Bz.forChild(_)],s.Bz]}),t})();var v=n(87498),O=n(66341),T=n(56209);let D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({providers:[h.y,v.R,O.n],imports:[[i.ez,o.u5,o.UX,a.Pc,y,f.aw.forChild(),T.Ns]]}),t})()}}]);