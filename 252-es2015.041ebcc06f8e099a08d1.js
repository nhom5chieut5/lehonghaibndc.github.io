"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[252],{54395:function(t,e,i){i.d(e,{b:function(){return a}});var s=i(77393),n=i(33637);function a(t,e=n.P){return i=>i.lift(new o(t,e))}class o{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new l(t,this.dueTime,this.scheduler))}}class l extends s.L{constructor(t,e,i){super(t),this.dueTime=e,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(r,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function r(t){t.debouncedNext()}},23453:function(t,e,i){i.d(e,{U:function(){return w}});var s=i(27887),n=i(69814),a=i(79765),o=i(25917),l=i(54395),r=i(87519),c=i(43190),h=i(37716),u=i(47063),g=i(84465),p=i(81780),d=i(71239),Z=i(38583);function f(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"h3"),h._uU(3),h.qZA(),h.qZA(),h.TgZ(4,"ion-button",10),h.NdJ("click",function(){const e=h.CHM(t).index;return h.oxw(2).removeSpecies(e)}),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit;h.xp6(3),h.Oqu(t),h.xp6(2),h.hij(" ",h.lcZ(6,2,"POND_MOD.DELETE")," ")}}function m(t,e){if(1&t&&(h.TgZ(0,"ion-list"),h.YNc(1,f,7,4,"ion-item",7),h.qZA()),2&t){const t=h.oxw();h.xp6(1),h.Q6J("ngForOf",t.speciesFollowing)}}function A(t,e){1&t&&(h.TgZ(0,"ion-list-header"),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.qZA()),2&t&&(h.xp6(2),h.Oqu(h.lcZ(3,1,"POND_MOD.RESULT")))}function b(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label"),h.TgZ(2,"h3"),h._uU(3),h.qZA(),h.qZA(),h.TgZ(4,"ion-button",11),h.NdJ("click",function(){const e=h.CHM(t).$implicit;return h.oxw().addSpecies(e.title)}),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit;h.xp6(3),h.Oqu(t.title),h.xp6(2),h.hij(" ",h.lcZ(6,2,"POND_MOD.SELECT")," ")}}function T(t,e){if(1&t&&(h.TgZ(0,"ion-item",12),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.message)}}function q(t,e){1&t&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",13),h.qZA())}let w=(()=>{class t{constructor(t,e,i,n,o){this.modalController=t,this.service=e,this.toastService=i,this.translate=n,this.localDb=o,this.speciesFollowing=[],this.savingFlag=new s.E,this.loadingFlag=new s.E,this.searchTerms=new a.xQ,this.keyword=""}ngOnInit(){this.localDb.speciesFollowing.forEach(t=>{this.speciesFollowing.push(t)});let t=this.searchTerms.pipe((0,l.b)(300),(0,r.x)(),(0,c.w)(t=>this.getSpeciesByTerm(t)));this.species$=t,this.species$.subscribe(t=>{t?(this.loadingFlag.setResult(!0),this.message=""):(this.loadingFlag.setResult(!1),this.message=this.translate.instant("POND_MOD.NOT_FOUND"))})}getSpeciesByTerm(t){return this.loadingFlag.setPending(!0),t.trim()?this.service.searchSpecies(t).pipe():(this.loadingFlag.setResult(!0),(0,o.of)([]))}search(t){this.searchTerms.next(t.detail.value),this.keyword=t.detail.value}addSpecies(t){this.speciesFollowing.find(e=>e==t)?this.toastService.success(this.translate.instant("WALL.MANAGE_SPECIES.FOLLOWED")):this.speciesFollowing.push(t)}removeSpecies(t){this.speciesFollowing.splice(t,1)}onSave(){this.savingFlag.setPending(!0),this.localDb.speciesFollowing=this.speciesFollowing,this.localDb.setLocalData("speciesFollowing",this.speciesFollowing),this.savingFlag.setResult(!1),this.modalController.dismiss({res:"success"})}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(u.IN),h.Y36(n.F),h.Y36(g.k),h.Y36(p.sK),h.Y36(d.T))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-manage-species"]],decls:23,vars:18,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[3,"value","placeholder","ionChange"],[4,"ngIf"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],["fill","outline","slot","end","color","danger",3,"click"],["fill","outline","slot","end",3,"click"],["lines","none"],["name","dots"]],template:function(t,e){1&t&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return e.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return e.onSave()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"ion-searchbar",5),h.NdJ("ionChange",function(t){return e.search(t)}),h.ALo(14,"translate"),h.qZA(),h.YNc(15,m,2,1,"ion-list",6),h.TgZ(16,"ion-list"),h.YNc(17,A,4,3,"ion-list-header",6),h.YNc(18,b,7,4,"ion-item",7),h.ALo(19,"async"),h.YNc(20,T,4,1,"ion-item",8),h.qZA(),h.TgZ(21,"div",9),h.YNc(22,q,2,0,"div",6),h.qZA(),h.qZA()),2&t&&(h.xp6(6),h.Oqu(h.lcZ(7,10,"WALL.MANAGE_SPECIES.TITLE")),h.xp6(3),h.Q6J("disabled",e.savingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(11,12,"POND_MOD.SAVE")),h.xp6(3),h.Q6J("value",e.keyword)("placeholder",h.lcZ(14,14,"WALL.MANAGE_SPECIES.SEARCH_SPECIES")),h.xp6(2),h.Q6J("ngIf",(null==e.speciesFollowing?null:e.speciesFollowing.length)>0),h.xp6(2),h.Q6J("ngIf",""!=e.keyword),h.xp6(1),h.Q6J("ngForOf",h.lcZ(19,16,e.species$)),h.xp6(2),h.Q6J("ngIf",e.message),h.xp6(2),h.Q6J("ngIf",e.loadingFlag.pending))},directives:[u.Gu,u.sr,u.Sm,u.YG,u.gu,u.wd,u.W2,u.VI,u.j9,Z.O5,u.q_,Z.sg,u.Ie,u.Q$,u.yh,u.PQ],pipes:[p.X$,Z.Ov],styles:[""]}),t})()},58149:function(t,e,i){i.d(e,{A:function(){return Z}});var s=i(27887),n=i(69814),a=i(37716),o=i(84465),l=i(47063),r=i(81780),c=i(38583),h=i(56209);function u(t,e){1&t&&(a.TgZ(0,"div",4),a._UZ(1,"ion-spinner",8),a.qZA())}function g(t,e){if(1&t&&a._UZ(0,"div",9),2&t){const t=a.oxw();a.Q6J("options",t.optionLine)}}function p(t,e){if(1&t&&(a.TgZ(0,"ion-item"),a.TgZ(1,"ion-text",0),a.TgZ(2,"small"),a.TgZ(3,"b"),a._uU(4),a.qZA(),a._uU(5),a.qZA(),a.qZA(),a.TgZ(6,"ion-text",12),a._uU(7),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(4),a.Oqu(t.user_name),a.xp6(1),a.hij(" | ",t.time,""),a.xp6(2),a.hij("",t.price,"\u0111")}}function d(t,e){if(1&t&&(a.TgZ(0,"ion-list",10),a.YNc(1,p,8,3,"ion-item",11),a.qZA()),2&t){const t=a.oxw();a.xp6(1),a.Q6J("ngForOf",null==t.rawData?null:t.rawData.logs)}}let Z=(()=>{class t{constructor(t,e,i,n){this.service=t,this.toastService=e,this.modalController=i,this.translate=n,this.rawData=[],this.processedData=[],this.chartData=[],this.loadingFlag=new s.E,this.show=!1,this.optionLine={title:{},tooltip:{trigger:"axis",position:["30%","60%"],formatter:function(t){let e="L\xfac "+t[0].name+"<br>";return e+="T\u1eeb t\xe9p b\u1ea1c: "+(0==t[0].value?"Ch\u01b0a c\u1eadp nh\u1eadt":t[0].value+" \u0111\u1ed3ng ")+"<br>",e+="T\u1eeb th\xe0nh vi\xean : "+(0==t[1].value?"Ch\u01b0a c\u1eadp nh\u1eadt":t[1].value+" \u0111\u1ed3ng"),e},textStyle:{fontFamily:"-apple-system,BlinkMacSystemFont,Roboto,Arial,sans-serif"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value",show:!0}],series:[{name:"\u0110\xe3 Duy\u1ec7t",type:"line",stack:"vertical",smooth:!0,areaStyle:{color:"rgb(96, 165, 250, 0.5)"},lineStyle:{color:"rgb(29, 78, 216)"},itemStyle:{color:"rgb(29, 78, 216)"},emphasis:{focus:"series"},data:[]},{name:"Th\xe0nh Vi\xean",type:"line",stack:"user",smooth:!0,areaStyle:{color:"rgb(252, 211, 77, 0.1)"},lineStyle:{color:"rgb(245, 158, 11)"},itemStyle:{color:"rgb(245, 158, 11)"},emphasis:{focus:"series"},data:[]}]}}ngOnInit(){this.getData()}getData(){this.loadingFlag.setPending(!0),this.service.getPriceHistory(this.data).pipe().subscribe(t=>{0==t.status?(this.toastService.warning(t.error),this.loadingFlag.setResult(!1)):(this.rawData=t.data,this.prepareData(this.rawData),this.loadingFlag.setResult(!0))},t=>{this.loadingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}prepareData(t){this.optionLine.xAxis[0].data=this.rawData.labels,this.optionLine.series[0].data=this.rawData.history,this.optionLine.series[1].data=this.rawData.history_user}dismiss(){this.modalController.dismiss()}ionViewDidEnter(){this.show=!0}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(n.F),a.Y36(o.k),a.Y36(l.IN),a.Y36(r.sK))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-price-history"]],inputs:{data:"data"},decls:17,vars:7,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"],[1,"ion-padding"],["echarts","","class","demo-chart",3,"options",4,"ngIf"],["lines","none",4,"ngIf"],["name","dots"],["echarts","",1,"demo-chart",3,"options"],["lines","none"],[4,"ngFor","ngForOf"],["slot","end","color","success"]],template:function(t,e){1&t&&(a.TgZ(0,"ion-header"),a.TgZ(1,"ion-toolbar"),a.TgZ(2,"ion-buttons",0),a.TgZ(3,"ion-button",1),a.NdJ("click",function(){return e.dismiss()}),a._UZ(4,"ion-icon",2),a.qZA(),a.qZA(),a.TgZ(5,"ion-title"),a._uU(6),a.ALo(7,"translate"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(8,"ion-content"),a.YNc(9,u,2,0,"div",3),a.TgZ(10,"div",4),a.TgZ(11,"div",5),a.TgZ(12,"h2"),a._uU(13),a.qZA(),a.qZA(),a.qZA(),a.TgZ(14,"div"),a.YNc(15,g,1,1,"div",6),a.qZA(),a.YNc(16,d,2,1,"ion-list",7),a.qZA()),2&t&&(a.xp6(6),a.Oqu(a.lcZ(7,5,"WALL.PRICE_HISTORY.TITLE")),a.xp6(3),a.Q6J("ngIf",e.loadingFlag.pending),a.xp6(4),a.Oqu(null==e.rawData.species?null:e.rawData.species.title),a.xp6(2),a.Q6J("ngIf",e.show),a.xp6(1),a.Q6J("ngIf",e.rawData))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,c.O5,l.PQ,h._w,l.q_,c.sg,l.Ie,l.yW],pipes:[r.X$],styles:[""]}),t})()},69814:function(t,e,i){i.d(e,{F:function(){return r}});var s=i(15189),n=i(92340),a=i(88002),o=i(37716),l=i(81780);let r=(()=>{class t{constructor(t,e){this.reqAPIService=t,this.translate=e,this.farmextApi="/manager/disease-neighboor-api",this.farmextWall="/manager/wall-api",this.tepbacApi="/farmext/update-api",this.weatherPath="http://api.openweathermap.org/data/2.5/onecall"}listDisease(){return this.reqAPIService.get(this.farmextApi)}listUpdate(t,e){return this.reqAPIService.postOutSiteNoneToken(n.h_.SITE_PATH+this.tepbacApi+"&action=list&page="+t,e)}getPriceHistory(t){return this.reqAPIService.getOutSite(n.h_.SITE_PATH+this.tepbacApi+"&action=get-price&sid="+t)}searchSpecies(t){return this.reqAPIService.getOutSite(n.h_.SITE_PATH+this.tepbacApi+"&action=search-species&keyword="+t).pipe((0,a.U)(t=>t.data))}loadAnalyze(t){return this.reqAPIService.post(this.farmextWall+"?action=analyze",t)}loadReport(t){return this.reqAPIService.post(this.farmextWall+"?action=report",t)}getWeatherToday(t,e){return this.reqAPIService.getOutSiteNoneToken(this.weatherPath+"?lat="+t+"&lon="+e+"&appid=9d7acdb5a0b7977b5dbd5dddf54c1fb4&lang="+this.translate.currentLang)}getWeather(t,e){return this.reqAPIService.getOutSiteNoneToken(this.weatherPath+"?lat="+t+"&lon="+e+"&appid=9d7acdb5a0b7977b5dbd5dddf54c1fb4&lang="+this.translate.currentLang).toPromise()}getWeatherYesterday(t,e,i){return this.reqAPIService.getOutSiteNoneToken(this.weatherPath+"?/timemachine?dt="+t+"&lat="+e+"&lon="+i+"&appid=9d7acdb5a0b7977b5dbd5dddf54c1fb4&lang="+this.translate.currentLang).toPromise()}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(s.$),o.LFG(l.sK))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);