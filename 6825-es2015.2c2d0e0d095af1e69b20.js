"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[6825],{54395:function(e,t,s){s.d(t,{b:function(){return r}});var i=s(77393),n=s(33637);function r(e,t=n.P){return s=>s.lift(new o(e,t))}class o{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new a(e,this.dueTime,this.scheduler))}}class a extends i.L{constructor(e,t,s){super(e),this.dueTime=t,this.scheduler=s,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(c,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function c(e){e.debouncedNext()}},27887:function(e,t,s){s.d(t,{E:function(){return i}});class i{constructor(){this.start=null,this.end=null,this.pending=null,this.result=null,this.count=0}setStart(e){this.start=e,!0===e&&(this.pending=!0,this.end=!1),this.result=null,this.count++}setPending(e){this.pending=e,!1===e?this.start=!1:this.end=!0}setResult(e){this.result=e,this.pending=!1,this.start=!1,this.end=!0}}},66341:function(e,t,s){s.d(t,{n:function(){return o}});var i=s(88002),n=s(15189),r=s(37716);let o=(()=>{class e{constructor(e){this.reqAPIService=e,this.urlApi="/manager/farm-api"}searchMember(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-user&key="+e).pipe((0,i.U)(e=>e.data))}searchExpert(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-expert&key="+e).pipe((0,i.U)(e=>e.data))}getSitePath(){return this.reqAPIService.FILE_PATH}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(n.$))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})()},26825:function(e,t,s){s.r(t),s.d(t,{StoreManagerPageModule:function(){return h}});var i=s(38583),n=s(90665),r=s(47063),o=s(13619),a=s(12039),c=s(37716);const l=[{path:"",component:a.N}];let u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[o.Bz.forChild(l)],o.Bz]}),e})(),h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[i.ez,n.u5,r.Pc,u]]}),e})()},12039:function(e,t,s){s.d(t,{N:function(){return _}});var i=s(64762),n=s(79765),r=s(25917),o=s(54395),a=s(87519),c=s(43190),l=s(27887),u=s(66341),h=s(22923),d=s(37716),g=s(47063),m=s(84465),p=s(81780),f=s(38583);function A(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-avatar",0),d._UZ(2,"img",8),d.qZA(),d.TgZ(3,"ion-label"),d.TgZ(4,"h3"),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"ion-button",9),d.NdJ("click",function(){const t=d.CHM(e).index;return d.oxw().presentRemoveUser(t)}),d._uU(7),d.ALo(8,"translate"),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(5),d.Oqu(e.user_name),d.xp6(2),d.hij(" ",d.lcZ(8,2,"POND_MOD.DELETE")," ")}}function Z(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-avatar",0),d._UZ(2,"img",10),d.qZA(),d.TgZ(3,"ion-label"),d.TgZ(4,"h3"),d._uU(5),d.qZA(),d.TgZ(6,"p"),d._uU(7),d.qZA(),d.qZA(),d.TgZ(8,"ion-button",11),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().addPermission(t)}),d._uU(9),d.ALo(10,"translate"),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,s=d.oxw();d.xp6(2),d.Q6J("src",s.memberService.getSitePath()+"/upload/users/avatars/medium/"+e.photo,d.LSH),d.xp6(3),d.Oqu(e.username),d.xp6(2),d.Oqu(e.email),d.xp6(1),d.Q6J("disabled",s.checkExistUser(e)),d.xp6(1),d.hij(" ",d.lcZ(10,5,"POND_MOD.SELECT")," ")}}function b(e,t){if(1&e&&(d.TgZ(0,"ion-item",12),d.TgZ(1,"ion-label"),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(3),d.Oqu(e.message)}}function v(e,t){1&e&&(d.TgZ(0,"div"),d._UZ(1,"ion-spinner",13),d.qZA())}let _=(()=>{class e{constructor(e,t,s,i,r,o){this.modalController=e,this.storeService=t,this.memberService=s,this.toastService=i,this.translate=r,this.alertController=o,this.savingFlag=new l.E,this.loadingFlag=new l.E,this.searchTerms=new n.xQ}ngOnInit(){let e=this.searchTerms.pipe((0,o.b)(300),(0,a.x)(),(0,c.w)(e=>this.getListMember(e)));this.members$=e,this.members$.subscribe(e=>{e?(this.loadingFlag.setResult(!0),this.message=""):(this.loadingFlag.setResult(!1),this.message=this.translate.instant("POND_MOD.NOT_FOUND"))})}search(e){this.searchTerms.next(e.detail.value)}getListMember(e){return this.loadingFlag.setPending(!0),e.trim()?this.memberService.searchMember(e).pipe():(this.loadingFlag.setResult(!0),(0,r.of)([]))}onSelect(e){this.memberSelected=e}addPermission(e){this.storeService.sendPost("addMember",{user_manager:e.user_id}).pipe().subscribe(t=>{0==t.status?this.toastService.warning(t.error):(this.manager.push({user_name:e.username,user_id:e.user_id}),this.toastService.success(this.translate.instant("FARM_MOD.ADDED_STAFF"))),this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}removePermission(e){this.storeService.getApiStore("removeMember","&user_id="+this.manager[e].user_id).pipe().subscribe(t=>{0==t.status?this.toastService.warning(t.error):(this.manager.splice(e,1),this.toastService.success(this.translate.instant("FARM_MOD.REMOVED_STAFF"))),this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentRemoveUser(e){return(0,i.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_REMOVE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{this.removePermission(e)}}]})).present()})}close(){this.modalController.dismiss(this.manager)}checkExistUser(e){for(let t=0;t<this.manager.length;t++)if(this.manager[t].user_name==e.username)return!0;return!1}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(g.IN),d.Y36(h.d),d.Y36(u.n),d.Y36(m.k),d.Y36(p.sK),d.Y36(g.Br))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-store-manager"]],inputs:{manager:"manager"},decls:23,vars:15,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"placeholder","ionChange"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],[4,"ngIf"],["src","assets/img/default-profile.jpg"],["slot","end","color","danger",3,"click"],["onError","this.src='assets/img/default-profile.jpg'",3,"src"],["slot","end",3,"disabled","click"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-buttons",0),d.TgZ(3,"ion-button",1),d.NdJ("click",function(){return t.close()}),d._UZ(4,"ion-icon",2),d.qZA(),d.qZA(),d.TgZ(5,"ion-title"),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"ion-content"),d.TgZ(9,"ion-searchbar",3),d.NdJ("ionChange",function(e){return t.search(e)}),d.ALo(10,"translate"),d.qZA(),d.TgZ(11,"ion-list"),d.YNc(12,A,9,4,"ion-item",4),d.qZA(),d.TgZ(13,"ion-list"),d.TgZ(14,"ion-list-header"),d.TgZ(15,"ion-label"),d._uU(16),d.ALo(17,"translate"),d.qZA(),d.qZA(),d.YNc(18,Z,11,7,"ion-item",4),d.ALo(19,"async"),d.YNc(20,b,4,1,"ion-item",5),d.qZA(),d.TgZ(21,"div",6),d.YNc(22,v,2,0,"div",7),d.qZA(),d.qZA()),2&e&&(d.xp6(6),d.Oqu(d.lcZ(7,7,"FARM_MOD.MEMBER")),d.xp6(3),d.Q6J("placeholder",d.lcZ(10,9,"FARM_MOD.MANAGER_EMAIL")),d.xp6(3),d.Q6J("ngForOf",t.manager),d.xp6(4),d.Oqu(d.lcZ(17,11,"POND_MOD.RESULT")),d.xp6(2),d.Q6J("ngForOf",d.lcZ(19,13,t.members$)),d.xp6(2),d.Q6J("ngIf",t.message),d.xp6(2),d.Q6J("ngIf",t.loadingFlag.pending))},directives:[g.Gu,g.sr,g.Sm,g.YG,g.gu,g.wd,g.W2,g.VI,g.j9,g.q_,f.sg,g.yh,g.Q$,f.O5,g.Ie,g.BJ,g.PQ],pipes:[p.X$,f.Ov],styles:[""]}),e})()},22923:function(e,t,s){s.d(t,{d:function(){return a}});var i=s(88002),n=s(26215),r=s(15189),o=s(37716);let a=(()=>{class e{constructor(e){this.reqAPIService=e,this.urlApi="/manager/store-api-mobie",this.NEW_URL_API="/manager/warehouse-api",this.changeDataStore=!1,this.onLoaded$=new n.X(0)}destroy(){this.fcode=null,this.store=null}setFarmCode(e){this.fcode=e}getFarmCode(){return this.fcode}setStoreCode(e){this.wcode=e}getStoreCode(){return this.wcode}setStore(e){this.store=e}getStore(){return this.store}itemChanged(e,t){void 0!==this.store[e]&&Object.assign(this.store[e],t)}getApiStore(e="",t="",s=""){let n;return n=""===s?this.NEW_URL_API+"?action="+e+"&wcode="+this.wcode+t:`/${s}?action=`+e+t,this.reqAPIService.get(n).pipe((0,i.U)(e=>e))}sendPost(e="",t={},s="",n=""){let r;return r=""===n?this.NEW_URL_API+"?action="+e+"&wcode="+this.wcode+s:`/${n}?action=`+e+s,this.reqAPIService.post(r,t).pipe((0,i.U)(e=>e))}sendPostWithFile(e="",t={},s="",i=""){return this.reqAPIService.postApiWithFile(e,t,"&wcode="+this.wcode+s,this.NEW_URL_API)}postEdit(e,t){return this.reqAPIService.post(this.urlApi+"?action=edit-product-private&fcode="+this.fcode+"&id="+e,t)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(r.$))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);