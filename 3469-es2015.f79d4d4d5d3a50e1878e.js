"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[3469],{73469:function(n,t,e){e.r(t),e.d(t,{ShopFlashsalesPageModule:function(){return J}});var i=e(38583),o=e(90665),s=e(47063),r=e(13619),a=e(16738),l=e(27887),g=e(15085),c=e(37716),d=e(84465),m=e(81780),h=e(71239),p=e(4015);function u(n,t){if(1&n){const n=c.EpF();c.TgZ(0,"ion-slide",17),c.NdJ("click",function(){const t=c.CHM(n).$implicit;return c.oxw().loadProduct(t.url)}),c.TgZ(1,"div"),c._UZ(2,"img",18),c.qZA(),c.qZA()}if(2&n){const n=t.$implicit,e=c.oxw();c.xp6(2),c.Q6J("src",e.shopService.SITE_PATH+"/upload/advertiment/ge_image/"+n.image,c.LSH)}}function f(n,t){1&n&&(c.TgZ(0,"span"),c._uU(1,"0"),c.qZA())}function x(n,t){1&n&&(c.TgZ(0,"span"),c._uU(1,"0"),c.qZA())}function _(n,t){1&n&&(c.TgZ(0,"span"),c._uU(1,"0"),c.qZA())}function P(n,t){if(1&n&&(c.TgZ(0,"ion-list-header",19),c.TgZ(1,"ion-label",20),c._uU(2,"Flash"),c._UZ(3,"ion-icon",21),c._uU(4,"sale"),c.qZA(),c.TgZ(5,"div",22),c.TgZ(6,"div",23),c.YNc(7,f,2,0,"span",13),c._uU(8),c.qZA(),c.TgZ(9,"div",23),c.YNc(10,x,2,0,"span",13),c._uU(11),c.qZA(),c.TgZ(12,"div",23),c.YNc(13,_,2,0,"span",13),c._uU(14),c.qZA(),c.qZA(),c.qZA()),2&n){const n=c.oxw();c.xp6(7),c.Q6J("ngIf",n.remainingTime.hour<10),c.xp6(1),c.Oqu(n.remainingTime.hour),c.xp6(2),c.Q6J("ngIf",n.remainingTime.min<10),c.xp6(1),c.Oqu(n.remainingTime.min),c.xp6(2),c.Q6J("ngIf",n.remainingTime.seconds<10),c.xp6(1),c.Oqu(n.remainingTime.seconds)}}function O(n,t){if(1&n){const n=c.EpF();c.TgZ(0,"ion-segment-button",24),c.NdJ("click",function(){const t=c.CHM(n).index;return c.oxw().segmentFrameChanged(t)}),c._uU(1),c.qZA()}if(2&n){const n=t.$implicit;c.Q6J("value",t.index),c.xp6(1),c.hij(" ",n[0],"H ")}}function C(n,t){if(1&n){const n=c.EpF();c.TgZ(0,"ion-segment-button",24),c.NdJ("click",function(){const t=c.CHM(n).$implicit;return c.oxw().segmentTermChanged(t.id)}),c._uU(1),c.qZA()}if(2&n){const n=t.$implicit;c.Q6J("value",n.id),c.xp6(1),c.hij(" ",n.name," ")}}function b(n,t){1&n&&(c.TgZ(0,"div"),c.TgZ(1,"p",25),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()),2&n&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"SHOP.HOME.NO_PRODUCTS")))}function M(n,t){1&n&&c._UZ(0,"ion-progress-bar",26)}function T(n,t){if(1&n&&(c.TgZ(0,"div",38),c.TgZ(1,"span"),c._uU(2),c.ALo(3,"number"),c.qZA(),c.qZA()),2&n){const n=c.oxw().$implicit;c.xp6(2),c.hij("-",c.xi3(3,1,100*n.ratio,"0.0-0"),"%")}}function Z(n,t){if(1&n&&c._UZ(0,"img",39),2&n){const n=c.oxw().$implicit,t=c.oxw(2);c.Q6J("src",t.shopService.SITE_PATH+"/upload/eventeshop/"+n.banner,c.LSH)}}function w(n,t){if(1&n&&(c.TgZ(0,"div",40),c._uU(1),c.ALo(2,"number"),c.qZA()),2&n){const n=c.oxw().$implicit;c.xp6(1),c.hij(" ",c.xi3(2,1,n.maxPrice,"1.0-0"),"\u20ab ")}}function A(n,t){if(1&n&&(c.TgZ(0,"div",40),c._uU(1),c.ALo(2,"number"),c.ALo(3,"number"),c.qZA()),2&n){const n=c.oxw().$implicit;c.xp6(1),c.AsE(" ",c.xi3(2,2,n.minPrice,"1.0-0")," ~ ",c.xi3(3,5,n.maxPrice,"1.0-0"),"\u20ab ")}}function v(n,t){if(1&n&&(c.TgZ(0,"ion-col",29),c.YNc(1,T,4,4,"div",30),c.TgZ(2,"div",31),c._UZ(3,"img",32),c.YNc(4,Z,1,1,"img",33),c.qZA(),c.TgZ(5,"div",34),c._uU(6),c.qZA(),c.TgZ(7,"div",35),c.TgZ(8,"small",36),c._uU(9),c.ALo(10,"number"),c.qZA(),c.qZA(),c.YNc(11,w,3,4,"div",37),c.YNc(12,A,4,8,"div",37),c.qZA()),2&n){const n=t.$implicit,e=c.oxw(2);c.MGl("routerLink","../product/",n.id,""),c.xp6(1),c.Q6J("ngIf",0!=n.ratio),c.xp6(2),c.Q6J("src",e.shopService.SITE_PATH+n.img_default,c.LSH),c.xp6(1),c.Q6J("ngIf",n.banner),c.xp6(2),c.Oqu(n.alias),c.xp6(3),c.hij("",c.xi3(10,8,n.maxFullPrice,"0.0-0"),"\u20ab"),c.xp6(2),c.Q6J("ngIf",n.minPrice==n.maxPrice),c.xp6(1),c.Q6J("ngIf",n.minPrice!=n.maxPrice)}}function F(n,t){if(1&n&&(c.TgZ(0,"ion-grid",27),c.TgZ(1,"ion-row"),c.YNc(2,v,13,11,"ion-col",28),c.qZA(),c.qZA()),2&n){const n=c.oxw();c.xp6(2),c.Q6J("ngForOf",n.flashSales.list)}}const S=[{path:"",component:(()=>{class n{constructor(n,t,e,i,o,s){this.modalController=n,this.shopService=t,this.toastService=e,this.translate=i,this.localDb=o,this.route=s,this.loadingFlag=new l.E,this.listADS=[],this.flashSales={list:[],numRows:0},this.page=0,this.remainingTime={hour:0,min:0,seconds:0},this.bannerOpts={speed:400,pagination:{el:".swiper-pagination",dynamicBullets:!0}}}ngOnInit(){this.loadFlashsale(),this.loadAds()}loadFlashsale(){this.loadingFlag.setPending(!0),this.shopService.loadFlashsaleFull(this.page,this.currentTerm,this.currentIndex).pipe().subscribe(n=>{"error"==n.status?(console.log(n.error.message),this.loadingFlag.setResult(!1)):(this.flashSales.numRows=n.data.numRows,this.flashSales.list=this.flashSales.list.concat(this.prepareProductPrice(n.data.list)),this.listTerms=n.data.listTerms,this.timeFrame=n.data.timeFrame,void 0===this.currentIndex&&(this.currentIndex=n.data.currentFrameIndex,this.prepareFlashsale()),this.currentTerm||(this.currentTerm=n.data.currentTerm),this.loadingFlag.setResult(!0))},n=>{console.log(this.translate.instant("ERROR_CONNECT")),this.loadingFlag.setResult(!1)})}prepareProductPrice(n){let t=[];return n.forEach(n=>{let e=n.label_price.split("~");n.minPrice=e[0],n.maxPrice=e[1],n.maxFullPrice=n.maxPrice/(1-n.ratio),t.push(n)}),t}loadAds(){this.shopService.getAds().subscribe(n=>{"success"==n.status?(this.listADS="EFW"in n.data?n.data.EFW:[],console.log(this.listADS)):this.toastService.danger(this.translate.instant("ERROR_CONNECT"))},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}loadProduct(n){let t=n.trim().split("//"),e=t[t.length-1].split("/");console.log(e);let i={company:"shop/companys/company/",detail:"shop/product/",shop:"shop/store/",term:"shop/products/"};if(4==e.length){let n=e[3].split("-");this.route.navigateByUrl(i[e[2]]+parseInt(n[n.length-1]))}}prepareFlashsale(){let n=this.timeFrame[this.currentIndex],t=new Date,e=(new Date(t.getFullYear(),t.getMonth()+1,t.getDate(),n[0],0,0,0),new Date(t.getFullYear(),t.getMonth(),t.getDate(),n[1],0,0,0)),i=a.utc(a(e.getTime()).diff(t.getTime())).format("HH:mm:ss").split(":");this.remainingTime.hour=parseInt(i[0]),this.remainingTime.min=parseInt(i[1]),this.remainingTime.seconds=parseInt(i[2]);let o=this;this.timeCountDown=setInterval(()=>{o.remainingTime.seconds=0==o.remainingTime.seconds?0:o.remainingTime.seconds-=1,0==o.remainingTime.seconds&&(o.remainingTime.min>0&&(o.remainingTime.seconds=59),o.remainingTime.min=0==o.remainingTime.min?0:o.remainingTime.min-=1),0==o.remainingTime.min&&(o.remainingTime.hour>0?(o.remainingTime.hour=o.remainingTime.hour>0?o.remainingTime.hour-=1:0,o.remainingTime.min=59,o.remainingTime.seconds=59):o.remainingTime.hour=0),0==o.remainingTime.hour&&0==o.remainingTime.min&&0==o.remainingTime.seconds&&(this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,clearInterval(this.timeCountDown))},1e3)}doRefresh(n){this.timeCountDown&&clearInterval(this.timeCountDown),this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,this.loadFlashsale(),n.target.complete()}loadMoreProducts(n){this.page+=1,this.loadFlashsale(),setTimeout(()=>{n.target.complete()},500)}segmentTermChanged(n){this.currentTerm=n,this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,this.loadFlashsale()}segmentFrameChanged(n){this.currentIndex=n,this.page=0,this.flashSales.list=[],this.flashSales.numRows=0,this.loadFlashsale()}}return n.\u0275fac=function(t){return new(t||n)(c.Y36(s.IN),c.Y36(g.d),c.Y36(d.k),c.Y36(m.sK),c.Y36(h.T),c.Y36(r.F0))},n.\u0275cmp=c.Xpm({type:n,selectors:[["app-shop-flashsales"]],decls:27,vars:11,consts:[["slot","start"],["text","","defaultHref","tabs/shop"],["slot","end"],["slot","fixed",3,"ionRefresh"],["mode","ios"],[1,"banner"],[3,"options"],[3,"click",4,"ngFor","ngForOf"],[1,"swiper-pagination"],["mode","ios","routerLink","product-flashsale",4,"ngIf"],["scrollable","","mode","ios",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],["scrollable","true","mode","ios",3,"ngModel","ngModelChange"],[4,"ngIf"],["type","indeterminate",4,"ngIf"],["class","grid-product",4,"ngIf"],["threshold","100px",3,"disabled","ionInfinite"],[3,"click"],[3,"src"],["mode","ios","routerLink","product-flashsale"],["color","danger"],["name","flash-outline"],[1,"boxTimeFlashsale"],[1,"boxTime"],[3,"value","click"],[1,"ion-text-center"],["type","indeterminate"],[1,"grid-product"],["size","6","size-sm","3",3,"routerLink",4,"ngFor","ngForOf"],["size","6","size-sm","3",3,"routerLink"],["class","discount-label",4,"ngIf"],[1,"img-box"],["onError","this.src='assets/img/1235.jpg'",1,"m-auto",3,"src"],["class","bannerProduct",3,"src",4,"ngIf"],[1,"product-alias"],[1,"promotion-box"],[1,"strike","ion-align-self-center"],["class","price-box",4,"ngIf"],[1,"discount-label"],[1,"bannerProduct",3,"src"],[1,"price-box"]],template:function(n,t){1&n&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5,"Flashsale"),c.qZA(),c.TgZ(6,"ion-buttons",2),c._UZ(7,"app-shop-toolbar"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"ion-content"),c.TgZ(9,"ion-refresher",3),c.NdJ("ionRefresh",function(n){return t.doRefresh(n)}),c._UZ(10,"ion-refresher-content",4),c.qZA(),c.TgZ(11,"div",5),c.TgZ(12,"ion-slides",6),c.YNc(13,u,3,1,"ion-slide",7),c.qZA(),c._UZ(14,"div",8),c.qZA(),c.YNc(15,P,15,6,"ion-list-header",9),c.TgZ(16,"ion-toolbar"),c.TgZ(17,"ion-segment",10),c.NdJ("ngModelChange",function(n){return t.currentIndex=n}),c.YNc(18,O,2,2,"ion-segment-button",11),c.qZA(),c.qZA(),c.TgZ(19,"ion-toolbar"),c.TgZ(20,"ion-segment",12),c.NdJ("ngModelChange",function(n){return t.currentTerm=n}),c.YNc(21,C,2,2,"ion-segment-button",11),c.qZA(),c.qZA(),c.YNc(22,b,4,3,"div",13),c.YNc(23,M,1,0,"ion-progress-bar",14),c.YNc(24,F,3,1,"ion-grid",15),c.TgZ(25,"ion-infinite-scroll",16),c.NdJ("ionInfinite",function(n){return t.loadMoreProducts(n)}),c._UZ(26,"ion-infinite-scroll-content"),c.qZA(),c.qZA()),2&n&&(c.xp6(12),c.Q6J("options",t.bannerOpts),c.xp6(1),c.Q6J("ngForOf",t.listADS),c.xp6(2),c.Q6J("ngIf",t.flashSales),c.xp6(2),c.Q6J("ngModel",t.currentIndex),c.xp6(1),c.Q6J("ngForOf",t.timeFrame),c.xp6(2),c.Q6J("ngModel",t.currentTerm),c.xp6(1),c.Q6J("ngForOf",t.listTerms),c.xp6(1),c.Q6J("ngIf",!t.flashSales),c.xp6(1),c.Q6J("ngIf",t.loadingFlag.pending),c.xp6(1),c.Q6J("ngIf",t.flashSales),c.xp6(1),c.Q6J("disabled",(null==t.flashSales?null:t.flashSales.numRows)==(null==t.flashSales?null:t.flashSales.list.length)))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,p.g,s.W2,s.nJ,s.Wo,s.Hr,i.sg,i.O5,s.cJ,s.QI,o.JJ,o.On,s.ju,s.MB,s.A$,s.yh,s.YI,r.rH,s.Q$,s.gu,s.GO,s.X7,s.jY,s.Nd,s.wI],pipes:[m.X$,i.JJ],styles:["[_nghost-%COMP%]{--bullet-background-active: var(--ion-color-light);--bullet-background: var(--ion-color-dark)}[_nghost-%COMP%]   .banner[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .banner[_ngcontent-%COMP%]   .swiper-pagination[_ngcontent-%COMP%]{z-index:1000;position:absolute;bottom:10px;left:5px}[_nghost-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{min-width:auto!important}",'[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--padding-bottom: 3em}[_nghost-%COMP%]   ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:"Averta";font-size:.8em}[_nghost-%COMP%]   .boxTimeFlashsale[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px;margin-top:29px;margin-bottom:6px;font-family:"Averta";font-size:.8em;display:flex;margin-right:16px}[_nghost-%COMP%]   .boxTimeFlashsale[_ngcontent-%COMP%]   .boxTime[_ngcontent-%COMP%]{color:#fff;background-color:#000;padding-left:2px;padding-right:2px;margin-right:2px;margin-left:2px;border-radius:2px;max-width:27px;width:27px;text-align:center}[_nghost-%COMP%]   .boxSpecial[_ngcontent-%COMP%]{min-height:150px}[_nghost-%COMP%]   .boxSpecial[_ngcontent-%COMP%]   .bannerSpecial[_ngcontent-%COMP%]{max-height:50px}[_nghost-%COMP%]   .boxSpecial[_ngcontent-%COMP%]   .imgProductSpecial[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .arrowButton[_ngcontent-%COMP%]{vertical-align:middle;margin-right:16px}[_nghost-%COMP%]   .bag-cart[_ngcontent-%COMP%]{color:#de2525;font-weight:bold;position:absolute;top:1em;font-size:.8em}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:240px;width:100%}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{border-top:1px solid rgba(192,192,192,.2);border-left:1px solid rgba(192,192,192,.2)}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{border-right:1px solid rgba(192,192,192,.2);border-bottom:1px solid rgba(192,192,192,.2)}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]{flex:auto;text-align:center;margin:0 auto;overflow:hidden;position:relative}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:80x!important;margin-bottom:5px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   .bannerProduct[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;max-height:60px;max-width:80%;width:auto}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .product-alias[_ngcontent-%COMP%]{line-height:1.2em;font-size:.9em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;height:2.4em;-webkit-box-orient:vertical}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .promotion-box[_ngcontent-%COMP%]{margin:3px 0}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .promotion-box[_ngcontent-%COMP%]   .mr[_ngcontent-%COMP%]{margin-left:3px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .promotion-box[_ngcontent-%COMP%]   .strike[_ngcontent-%COMP%]{text-decoration:line-through}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]{margin:3px 0;font-size:.9em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;height:1.3em;-webkit-box-orient:vertical;color:var(--ion-color-danger)}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]{padding:5px;position:absolute;right:5px;top:10px;float:left;width:43px;background-color:#de2525;z-index:9999;transform:rotate(20deg);border-radius:4px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]:after{right:42px;border:solid transparent;content:" ";height:0;width:0;position:absolute;border-color:#88b7d500;border-right-color:#de2525;border-width:13.5px;top:50%;margin-top:-13.6px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]:before{content:"";z-index:2;position:absolute;top:44%;right:100%;width:5px;height:5px;opacity:.95;background:#fff;border-radius:5px}[_nghost-%COMP%]   .grid-product[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .discount-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:12px;text-align:center;font-family:"Averta"}']}),n})()}];let q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({imports:[[r.Bz.forChild(S)],r.Bz]}),n})();var I=e(26177);let J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({imports:[[i.ez,o.u5,s.Pc,q,m.aw.forChild(),I.t]]}),n})()}}]);