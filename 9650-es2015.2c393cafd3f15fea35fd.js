"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[9650],{27887:function(e,t,i){i.d(t,{E:function(){return s}});class s{constructor(){this.start=null,this.end=null,this.pending=null,this.result=null,this.count=0}setStart(e){this.start=e,!0===e&&(this.pending=!0,this.end=!1),this.result=null,this.count++}setPending(e){this.pending=e,!1===e?this.start=!1:this.end=!0}setResult(e){this.result=e,this.pending=!1,this.start=!1,this.end=!0}}},39650:function(e,t,i){i.r(t),i.d(t,{AddDevicePageModule:function(){return F}});var s=i(38583),n=i(90665),r=i(13619),o=i(47063),c=i(64762),a=i(82629),p=i(27887),d=i(37716),h=i(84465),u=i(38605),v=i(81780);function l(e,t){1&e&&d._UZ(0,"ion-progress-bar",14)}function T(e,t){1&e&&d._UZ(0,"img",15)}function g(e,t){1&e&&d._UZ(0,"img",16)}function A(e,t){1&e&&d._UZ(0,"img",17)}function m(e,t){1&e&&(d.TgZ(0,"span",18),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"DEVICE_MOD.CABINET")))}function _(e,t){1&e&&(d.TgZ(0,"span",18),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"DEVICE_MOD.ENVISOR")))}function f(e,t){1&e&&(d.TgZ(0,"span",18),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"DEVICE_MOD.FEEDINGS")))}function q(e,t){if(1&e&&(d.TgZ(0,"ion-select-option",19),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e.infor.code),d.xp6(1),d.Oqu(e.infor.name)}}const P=[{path:"",component:(()=>{class e{constructor(e,t,i,s,r,o){this.toastService=e,this.route=t,this.router=i,this.storage=s,this.iotService=r,this.translate=o,this.ponds=[],this.loading=new p.E,this.form=new n.cw({name:new n.NI("",n.kI.required),pcode:new n.NI("",n.kI.required)})}ngOnInit(){this.listPond(),this.route.queryParams.subscribe(e=>{e&&e.device_id&&e.code&&e.type?(this.device_id=e.device_id,this.code=e.code,this.type=e.type):(this.router.navigateByUrl("home"),this.toastService.warning(this.translate.instant("DEVICE_MOD.DATA_NULL")))})}listPond(){this.storage.get("ponds").then(e=>{this.ponds=e}).catch(()=>{this.toastService.warning(this.translate.instant("DEVICE_MOD.EMPTY_POND"))})}save(){return(0,c.mG)(this,void 0,void 0,function*(){this.loading.setPending(!0);const e=yield this.iotService.active(this.code).catch(()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))});console.log(e);const t={device_id_fb:this.device_id,name:this.form.value.name,type:this.type,pond_code:this.form.value.pcode},i=yield this.iotService.add(t).catch(()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT")),this.loading.setResult(!1)});i&&1==i.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.ADDED_DEVICE")),this.router.navigateByUrl("pond/"+this.form.value.pcode)):this.toastService.warning(i.error),this.loading.setResult(!0)})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.k),d.Y36(r.gz),d.Y36(r.F0),d.Y36(u.Ke),d.Y36(a.d),d.Y36(v.sK))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-add-device"]],inputs:{pondsOb:"pondsOb"},decls:36,vars:25,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["type","indeterminate",4,"ngIf"],[3,"formGroup"],["src","../../../assets/img/cabinext.png",4,"ngIf"],["src","../../../assets/img/envisor.png",4,"ngIf"],["src","../../../assets/img/feeding.png",4,"ngIf"],["lines","inset",2,"text-align","center"],["slot","end",4,"ngIf"],["slot","end","formControlName","name"],["slot","end","formControlName","pcode","placeholder","Ch\u1ecdn ao"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-text-center"],["shape","round",3,"disabled","click"],["type","indeterminate"],["src","../../../assets/img/cabinext.png"],["src","../../../assets/img/envisor.png"],["src","../../../assets/img/feeding.png"],["slot","end"],[3,"value"]],template:function(e,t){1&e&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-buttons",0),d._UZ(3,"ion-back-button",1),d.qZA(),d.TgZ(4,"ion-title"),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"ion-content"),d.YNc(8,l,1,0,"ion-progress-bar",2),d.TgZ(9,"ion-card",3),d.YNc(10,T,1,0,"img",4),d.YNc(11,g,1,0,"img",5),d.YNc(12,A,1,0,"img",6),d.TgZ(13,"ion-card-content"),d.TgZ(14,"ion-list",7),d.TgZ(15,"ion-item"),d._uU(16),d.ALo(17,"translate"),d.YNc(18,m,3,3,"span",8),d.YNc(19,_,3,3,"span",8),d.YNc(20,f,3,3,"span",8),d.qZA(),d.TgZ(21,"ion-item"),d.TgZ(22,"ion-label"),d._uU(23),d.ALo(24,"translate"),d.qZA(),d._UZ(25,"ion-input",9),d.qZA(),d.TgZ(26,"ion-item"),d.TgZ(27,"ion-label"),d._uU(28),d.ALo(29,"translate"),d.qZA(),d.TgZ(30,"ion-select",10),d.YNc(31,q,2,2,"ion-select-option",11),d.qZA(),d.qZA(),d.qZA(),d.TgZ(32,"div",12),d.TgZ(33,"ion-button",13),d.NdJ("click",function(){return t.save()}),d._uU(34),d.ALo(35,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(5),d.Oqu(d.lcZ(6,15,"DEVICE_MOD.ADD_DEVICE")),d.xp6(3),d.Q6J("ngIf",t.loading.pending),d.xp6(1),d.Q6J("formGroup",t.form),d.xp6(1),d.Q6J("ngIf","cabinet"==t.type),d.xp6(1),d.Q6J("ngIf","envisor"==t.type),d.xp6(1),d.Q6J("ngIf","feeding"==t.type),d.xp6(4),d.hij(" ",d.lcZ(17,17,"DEVICE_MOD.TYPE"),""),d.xp6(2),d.Q6J("ngIf","cabinet"==t.type),d.xp6(1),d.Q6J("ngIf","envisor"==t.type),d.xp6(1),d.Q6J("ngIf","feeding"==t.type),d.xp6(3),d.Oqu(d.lcZ(24,19,"DEVICE_MOD.NAME")),d.xp6(5),d.Oqu(d.lcZ(29,21,"DEVICE_MOD.POND")),d.xp6(3),d.Q6J("ngForOf",t.ponds),d.xp6(2),d.Q6J("disabled",t.form.invalid),d.xp6(1),d.Oqu(d.lcZ(35,23,"DEVICE_MOD.ADD")))},directives:[o.Gu,o.sr,o.Sm,o.oU,o.cs,o.wd,o.W2,s.O5,o.PM,n.JL,n.sg,o.FN,o.q_,o.Ie,o.Q$,o.pK,o.j9,n.JJ,n.u,o.t9,o.QI,s.sg,o.YG,o.X7,o.n0],pipes:[v.X$],styles:[""]}),e})()}];let F=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.ez,n.u5,o.Pc,v.aw.forChild(),n.UX,r.Bz.forChild(P)]]}),e})()},82629:function(e,t,i){i.d(t,{d:function(){return r}});var s=i(15189),n=i(37716);let r=(()=>{class e{constructor(e){this.reqApiService=e,this.PATH_FT="http://35.240.204.122:8882/farmext",this.PATH_DEVICE="/manager/device-api",this.PATH_ADD_DEVICE="/manager/add-device-api",this.SITE_PATH_API="http://35.240.204.122:8882/api",this.listPermision=["company_manager","farm_manager","pond_manager"]}checkPermission(e){return!!this.listPermision.includes(e)}setPondCode(e){this.pcode=e}list(){return this.reqApiService.get(this.PATH_DEVICE+"?action=list&pcode="+this.pcode).toPromise()}get(e){return this.reqApiService.get(this.PATH_DEVICE+"?action=get&device_id_fb="+e+"&pcode="+this.pcode).toPromise()}update(e,t){return this.reqApiService.post(this.PATH_DEVICE+"?action=update&id="+t+"&pcode="+this.pcode,{name:e,pond_code:this.pcode}).toPromise()}add(e){return this.reqApiService.post(this.PATH_ADD_DEVICE,e).toPromise()}move(e,t,i){return this.reqApiService.post(this.PATH_DEVICE+"?action=update&id="+i+"&pcode="+this.pcode,{name:e,pond_code:t}).toPromise()}remove(e){return this.reqApiService.get(this.PATH_DEVICE+"?action=remove&id="+e+"&pcode="+this.pcode).toPromise()}check(e){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/qr/"+e).toPromise()}active(e){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/qr/"+e,{}).toPromise()}changeStatusContactor(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+i+"/peripherals/"+t+"/control",e)}getInforDevice(e){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+e).toPromise()}getListCondition(e,t){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/subscribes")}removeCondition(e,t,i){return this.reqApiService.deleteTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/subscribes/"+i)}addCondition(e,t,i){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/subscribes",i)}updateNameContactor(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e,i)}updateTimer(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/timer",i)}updateSetting(e,t){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e+"/setting",t).toPromise()}addConditonPub(e,t,i){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+e+"/peripherals/"+t+"/conditions",i)}updateConditonPub(e,t,i,s){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e+"/peripherals/"+t+"/conditions/"+i,s)}removeConditionPub(e,t,i){return this.reqApiService.deleteTokenFt(this.PATH_FT+"/v2/devices/"+e+"/peripherals/"+t+"/conditions/"+i)}saveAutoRecord(e,t){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e+"/third-setting",t)}commandFeeding(e,t){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+e+"/command",t)}removeTimer(e,t,i){return this.reqApiService.deleteTokenFt(this.PATH_FT+"/v2/devices/"+i+"/peripherals/"+t+"/timer/"+e)}addTimer(e,t,i){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/timer",i)}updateTimerFeed(e,t,i,s){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+i+"/peripherals/"+t+"/timer/"+e,s)}plus_analyze(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/plus_analyze",i)}abstract_analyze(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/abstract_analyze",i)}asyncData(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/sync",i)}removeDataFeed(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/clear",i)}updateCommonSetting(e,t){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e,t)}getListRepast(e,t){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/data")}getSuggestCalib(e,t,i,s){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+s+"/get-suggest-calib?feed="+i+"&start="+e+"&end="+t)}quickAddRepast(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/timer/feed",i)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(s.$))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);