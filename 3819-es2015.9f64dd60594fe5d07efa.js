"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[3819],{79941:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i(93576);e.EMPTY=new n.Observable(function(t){return t.complete()}),e.empty=function(t){return t?function(t){return new n.Observable(function(e){return t.schedule(function(){return e.complete()})})}(t):e.EMPTY}},20500:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=i(67241);e.defaultIfEmpty=function(t){return void 0===t&&(t=null),function(e){return e.lift(new s(t))}};var s=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.defaultValue))},t}(),a=function(t){function e(e,i){var n=t.call(this,e)||this;return n.defaultValue=i,n.isEmpty=!0,n}return o(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(r.Subscriber)},26179:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=i(67241);e.filter=function(t,e){return function(i){return i.lift(new s(t,e))}};var s=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.thisArg))},t}(),a=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.predicate=i,o.thisArg=n,o.count=0,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}e&&this.destination.next(t)},e}(r.Subscriber)},13169:function(t,e,i){var n=i(88465),o=i(26179),r=i(71056),s=i(20500),a=i(20474),u=i(72516);e.P=function(t,e){var i=arguments.length>=2;return function(c){return c.pipe(t?o.filter(function(e,i){return t(e,i,c)}):u.identity,r.take(1),i?s.defaultIfEmpty(e):a.throwIfEmpty(function(){return new n.EmptyError}))}}},71056:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=i(67241),s=i(72974),a=i(79941);e.take=function(t){return function(e){return 0===t?a.empty():e.lift(new u(t))}};var u=function(){function t(t){if(this.total=t,this.total<0)throw new s.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.total))},t}(),c=function(t){function e(e,i){var n=t.call(this,e)||this;return n.total=i,n.count=0,n}return o(e,t),e.prototype._next=function(t){var e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))},e}(r.Subscriber)},20474:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=i(88465),s=i(67241);e.throwIfEmpty=function(t){return void 0===t&&(t=c),function(e){return e.lift(new a(t))}};var a=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.errorFactory))},t}(),u=function(t){function e(e,i){var n=t.call(this,e)||this;return n.errorFactory=i,n.hasValue=!1,n}return o(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(s.Subscriber);function c(){return new r.EmptyError}},72974:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}();e.ArgumentOutOfRangeError=i},88465:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}();e.EmptyError=i},62014:function(t,e,i){i.d(e,{y:function(){return n}});class n{constructor(t,e="currency"){this.setType(e),this.setInput(t),this.processConvert()}setInput(t){"string"!=typeof t&&(t=String(t)),this.input=t}setValue(t){"string"!=typeof t&&(t=String(t)),this.input=t,this.processConvert()}setType(t){this.type=t}processConvert(){let t,e,i=this.input.split(",").join("");if(i.indexOf(".")!=i.lastIndexOf(".")&&(i=i.slice(0,i.lastIndexOf("."))),-1!=i.indexOf(".")){e=i.indexOf(".");let n=i.split(".");i=n[0],"float"===this.type&&(t=n[1].substring(0,2))}else e=i.length;let n=new Array,o=1;for(var r=-3;Math.abs(r)<e;r-=3)n.push(i.slice(r,e+r+3)),o++;let s=i.slice(0,e-3*(o-1));s.length>0&&n.push(s),n.reverse();let a=i.replace(/,/gi,""),u="";this.fakeView=n.join(),"float"===this.type&&null!=t&&(this.fakeView=this.fakeView+"."+t,u=t),this.realValue=parseFloat(a+"."+u)}}},13819:function(t,e,i){i.d(e,{m:function(){return C}});var n=i(64762),o=i(90665),r=i(27887),s=i(22923),a=i(28049),u=i(26164),c=i(37716),l=i(47063),p=i(84465),m=i(81780),h=i(38583);function d(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",23),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.value),c.xp6(1),c.Oqu(t.label)}}function f(t,e){1&t&&(c.TgZ(0,"ion-item",5),c.TgZ(1,"ion-label",6),c._uU(2),c.ALo(3,"translate"),c.qZA(),c._UZ(4,"ion-input",24),c.qZA()),2&t&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"WAREHOUSE_MOD.CONVERT_KG")))}function g(t,e){1&t&&(c.TgZ(0,"div"),c._UZ(1,"ion-spinner",25),c.qZA())}let Z=(()=>{class t{constructor(t,e,i,n,o,s,a){this.modalController=t,this.formBulder=e,this.toastService=i,this.storeService=n,this.translate=o,this.companyService=s,this.alertController=a,this.savingFlag=new r.E,this.units=[{value:"kg",label:"Kg"},{value:"lit",label:this.translate.instant("WAREHOUSE_MOD.LITER")}]}ngOnInit(){"kg"!=this.item.unit&&"lit"!=this.item.unit&&this.units.push({value:this.item.unit,label:this.item.unit}),this.createForm()}createForm(){this.form=this.formBulder.group({name:[this.item.name,[o.kI.required]],group_id:[this.item.group_id,[o.kI.required]],unit:[this.item.unit,[o.kI.required]],manufacturer_name:[this.item.manufacturer_name,[o.kI.required]],uses:[this.item.uses,[o.kI.required]],dosage:[this.item.dosage],packing:[this.item.packing,[o.kI.required,o.kI.min(1)]]})}onSubmit(){this.savingFlag.setPending(!0),this.companyService.sendPost("edit-product-private",this.form.value,"&ccode="+this.companyService.ccode+"&id="+this.item.id,"manager/company-category-api").pipe((0,a.P)()).subscribe(t=>{1===t.status?(this.toastService.success(t.message),this.item.name=this.form.value.name,this.item.group_id=this.form.value.group_id,this.item.manufacturer_name=this.form.value.manufacturer_name,this.item.uses=this.form.value.uses,this.item.unit=this.form.value.unit,this.item.dosage=this.form.value.dosage,this.modalController.dismiss(this.item)):this.toastService.warning(t.error),this.savingFlag.setResult(!0)},t=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentAddUnit(){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("ADD")+" "+this.translate.instant("MONEY_MOD.GROUP"),inputs:[{name:"unit",type:"text",placeholder:this.translate.instant("UNIT")}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:t=>{this.units.push({value:t.unit,label:t.unit}),this.form.patchValue({unit:t.unit})}}]})).present()})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(l.IN),c.Y36(o.qu),c.Y36(p.k),c.Y36(s.d),c.Y36(m.sK),c.Y36(u.J),c.Y36(l.Br))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-store-product-edit"]],inputs:{item:"item"},decls:68,vars:49,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding","ion-text-center"],[3,"formGroup","ngSubmit"],["lines","inset"],["position","floating"],["type","text","formControlName","name","inputmode","text"],["formControlName","group_id",3,"placeholder"],["value","1"],["value","2"],["value","3"],["formControlName","unit",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["slot","end"],["slot","icon-only","name","add-circle"],["lines","inset",4,"ngIf"],["type","text","formControlName","manufacturer_name","inputmode","text"],["type","text","formControlName","uses"],["type","text","formControlName","dosage"],[1,"ion-text-center","ion-padding"],[4,"ngIf"],["type","submit","color","primary","shape","round",3,"disabled"],[3,"value"],["formControlName","packing","type","tel","inputmode","decimal"],["name","dots"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.modalController.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"ion-content"),c.TgZ(9,"div",3),c.TgZ(10,"h1"),c._uU(11),c.qZA(),c.TgZ(12,"p"),c._uU(13),c.ALo(14,"translate"),c.qZA(),c.qZA(),c.TgZ(15,"form",4),c.NdJ("ngSubmit",function(){return e.onSubmit()}),c.TgZ(16,"ion-list"),c.TgZ(17,"ion-item",5),c.TgZ(18,"ion-label",6),c._uU(19),c.ALo(20,"translate"),c.qZA(),c._UZ(21,"ion-input",7),c.qZA(),c.TgZ(22,"ion-item",5),c.TgZ(23,"ion-label"),c._uU(24),c.ALo(25,"translate"),c.qZA(),c.TgZ(26,"ion-select",8),c.ALo(27,"translate"),c.TgZ(28,"ion-select-option",9),c._uU(29),c.ALo(30,"translate"),c.qZA(),c.TgZ(31,"ion-select-option",10),c._uU(32),c.ALo(33,"translate"),c.qZA(),c.TgZ(34,"ion-select-option",11),c._uU(35),c.ALo(36,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(37,"ion-item",5),c.TgZ(38,"ion-label"),c._uU(39),c.ALo(40,"translate"),c.qZA(),c.TgZ(41,"ion-select",12),c.ALo(42,"translate"),c.YNc(43,d,2,2,"ion-select-option",13),c.qZA(),c.TgZ(44,"ion-buttons",14),c.TgZ(45,"ion-button",1),c.NdJ("click",function(){return e.presentAddUnit()}),c._UZ(46,"ion-icon",15),c.qZA(),c.qZA(),c.qZA(),c.YNc(47,f,5,3,"ion-item",16),c.TgZ(48,"ion-item",5),c.TgZ(49,"ion-label",6),c._uU(50),c.ALo(51,"translate"),c.qZA(),c._UZ(52,"ion-input",17),c.qZA(),c.TgZ(53,"ion-item",5),c.TgZ(54,"ion-label",6),c._uU(55),c.ALo(56,"translate"),c.qZA(),c._UZ(57,"ion-textarea",18),c.qZA(),c.TgZ(58,"ion-item",5),c.TgZ(59,"ion-label",6),c._uU(60),c.ALo(61,"translate"),c.qZA(),c._UZ(62,"ion-textarea",19),c.qZA(),c.qZA(),c.TgZ(63,"div",20),c.YNc(64,g,2,0,"div",21),c.TgZ(65,"ion-button",22),c._uU(66),c.ALo(67,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(6),c.Oqu(c.lcZ(7,21,"WAREHOUSE_MOD.EDIT_PRODUCT")),c.xp6(5),c.Oqu(e.item.name),c.xp6(2),c.AsE("",c.lcZ(14,23,"WAREHOUSE_MOD.PRODUCER"),": ",e.item.manufacturer_name,""),c.xp6(2),c.Q6J("formGroup",e.form),c.xp6(4),c.Oqu(c.lcZ(20,25,"WAREHOUSE_MOD.PRODUCT")),c.xp6(5),c.Oqu(c.lcZ(25,27,"WAREHOUSE_MOD.GROUP_USED")),c.xp6(2),c.Q6J("placeholder",c.lcZ(27,29,"WAREHOUSE_MOD.SELECT")),c.xp6(3),c.Oqu(c.lcZ(30,31,"WAREHOUSE_MOD.FEED")),c.xp6(3),c.Oqu(c.lcZ(33,33,"WAREHOUSE_MOD.FEED_SUPPLEMENT")),c.xp6(3),c.Oqu(c.lcZ(36,35,"WAREHOUSE_MOD.TREATMENT")),c.xp6(4),c.Oqu(c.lcZ(40,37,"WAREHOUSE_MOD.UNIT")),c.xp6(2),c.Q6J("placeholder",c.lcZ(42,39,"WAREHOUSE_MOD.SELECT")),c.xp6(2),c.Q6J("ngForOf",e.units),c.xp6(4),c.Q6J("ngIf","kg"!=e.form.value.unit&&"lit"!=e.form.value.unit),c.xp6(3),c.Oqu(c.lcZ(51,41,"WAREHOUSE_MOD.PRODUCER")),c.xp6(5),c.Oqu(c.lcZ(56,43,"WAREHOUSE_MOD.USAGE")),c.xp6(5),c.Oqu(c.lcZ(61,45,"WAREHOUSE_MOD.DOSAGE")),c.xp6(4),c.Q6J("ngIf",e.savingFlag.pending),c.xp6(1),c.Q6J("disabled",e.form.invalid||e.savingFlag.pending),c.xp6(1),c.hij("",c.lcZ(67,47,"WAREHOUSE_MOD.SAVE")," "))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,o._Y,o.JL,o.sg,l.q_,l.Ie,l.Q$,l.pK,l.j9,o.JJ,o.u,l.t9,l.QI,l.n0,h.sg,h.O5,l.g2,l.PQ],pipes:[m.X$],styles:[""]}),t})();var _=i(62014),O=i(13169),A=i(71239);function E(t,e){if(1&t&&(c.TgZ(0,"div",14),c.TgZ(1,"h1"),c._uU(2),c.qZA(),c.TgZ(3,"p"),c._uU(4),c.ALo(5,"translate"),c.ALo(6,"number"),c.qZA(),c.TgZ(7,"p"),c._uU(8),c.ALo(9,"translate"),c.TgZ(10,"span"),c._uU(11),c.ALo(12,"number"),c.qZA(),c._uU(13),c.ALo(14,"translate"),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Oqu(t.infor.name),c.xp6(2),c.lnq("",c.lcZ(5,8,"WAREHOUSE_MOD.INVENTORY"),": ",c.xi3(6,10,t.infor.quantity_current,"1.0-1")," ",t.infor.unit,""),c.xp6(4),c.hij("",c.lcZ(9,13,"WAREHOUSE_MOD.PRICE"),": "),c.xp6(3),c.Oqu(c.xi3(12,15,t.infor.price,"1.0-1")),c.xp6(2),c.AsE(" ",c.lcZ(14,18,"CURRENCY_S"),"/",t.infor.unit,"")}}function v(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",17),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t.code),c.xp6(1),c.Oqu(t.name)}}function q(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",6),c.TgZ(1,"ion-label",7),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-select",15),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw().setInforProduct(e)}),c.YNc(5,v,2,2,"ion-select-option",16),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(2),c.Oqu(c.lcZ(3,2,"FARM_MOD.WAREHOUSE")),c.xp6(3),c.Q6J("ngForOf",t.listStore)}}function y(t,e){1&t&&(c.TgZ(0,"div"),c._UZ(1,"ion-spinner",18),c.qZA())}let T=(()=>{class t{constructor(t,e,i,n,o,s){this.modalController=t,this._formBuilder=e,this.toastService=i,this.storeService=n,this.translate=o,this.dbLocalService=s,this.formatQuantity=new _.y(""),this.formatPrice=new _.y(""),this.savingFlag=new r.E,this.listStore=[]}ngOnInit(){this.dbLocalService.farms.findIndex(t=>t.infor.code===this.storeService.getFarmCode())>=0&&(this.listStore=this.dbLocalService.stores),"store"==this.from&&(this.infor=this.item),this.form=this._formBuilder.group({quantity_current:["",[o.kI.required,o.kI.min(0)]],price:["",[o.kI.required,o.kI.min(0)]],note:["",[o.kI.maxLength(100)]],wcode:["farm"==this.from?"":this.storeService.getStoreCode(),[o.kI.required]]})}onSubmit(){const t=`&id=${this.item.id}`;this.savingFlag.setPending(!0);let e={quantity_current:this.form.value.quantity_current.replace(",","."),price:this.formatPrice.realValue,note:this.form.value.note,sid:this.infor.id_store};this.storeService.setStoreCode(this.form.value.wcode),this.storeService.sendPost("correctProduct",e,t).pipe((0,O.P)()).subscribe(t=>{1===t.status?(this.toastService.success(t.message),this.item.quantity_current=e.quantity_current,this.item.price=e.price,this.item.note=e.note,this.modalController.dismiss(this.item)):this.toastService.warning(t.error),this.savingFlag.setResult(!0)},t=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT")),this.savingFlag.setResult(!1)})}setInforProduct(t){this.storeService.setStoreCode(t.detail.value),this.storeService.getApiStore("getAProduct","&id="+this.item.id).subscribe(t=>{1==t.status?this.infor=t.data:this.toastService.warning(t.error)},()=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(l.IN),c.Y36(o.qu),c.Y36(p.k),c.Y36(s.d),c.Y36(m.sK),c.Y36(A.T))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-store-inventory-edit"]],inputs:{item:"item",from:"from",infor:"infor"},decls:33,vars:21,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["class","ion-padding ion-text-center",4,"ngIf"],[3,"formGroup","ngSubmit"],["lines","inset",4,"ngIf"],["lines","inset"],["position","floating"],["type","tel","formControlName","quantity_current","autofocus","","inputmode","decimal"],["type","tel","formControlName","price","inputmode","decimal",3,"value","ionChange"],["formControlName","note"],[1,"ion-text-center","ion-padding"],[4,"ngIf"],["type","submit","color","primary","shape","round",3,"disabled"],[1,"ion-padding","ion-text-center"],["formControlName","wcode","okText","Okay","cancelText","Dismiss",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","dots"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.modalController.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"ion-content"),c.YNc(9,E,15,20,"div",3),c.TgZ(10,"form",4),c.NdJ("ngSubmit",function(){return e.onSubmit()}),c.TgZ(11,"ion-list"),c.YNc(12,q,6,4,"ion-item",5),c.TgZ(13,"ion-item",6),c.TgZ(14,"ion-label",7),c._uU(15),c.ALo(16,"translate"),c.qZA(),c._UZ(17,"ion-input",8),c.qZA(),c.TgZ(18,"ion-item",6),c.TgZ(19,"ion-label",7),c._uU(20),c.ALo(21,"translate"),c.qZA(),c.TgZ(22,"ion-input",9),c.NdJ("ionChange",function(t){return e.formatPrice.setValue(t.target.value)}),c.qZA(),c.qZA(),c.TgZ(23,"ion-item",6),c.TgZ(24,"ion-label",7),c._uU(25),c.ALo(26,"translate"),c.qZA(),c._UZ(27,"ion-textarea",10),c.qZA(),c.qZA(),c.TgZ(28,"div",11),c.YNc(29,y,2,0,"div",12),c.TgZ(30,"ion-button",13),c._uU(31),c.ALo(32,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(6),c.Oqu(c.lcZ(7,11,"WAREHOUSE_MOD.EDIT_INVENTORY")),c.xp6(3),c.Q6J("ngIf",e.infor),c.xp6(1),c.Q6J("formGroup",e.form),c.xp6(2),c.Q6J("ngIf","farm"==e.from),c.xp6(3),c.Oqu(c.lcZ(16,13,"WAREHOUSE_MOD.NEW_INVENTORY")),c.xp6(5),c.Oqu(c.lcZ(21,15,"WAREHOUSE_MOD.NEW_PRICE")),c.xp6(2),c.Q6J("value",e.formatPrice.fakeView),c.xp6(3),c.Oqu(c.lcZ(26,17,"WAREHOUSE_MOD.CHANGE_NOTE")),c.xp6(4),c.Q6J("ngIf",e.savingFlag.pending),c.xp6(1),c.Q6J("disabled",e.form.invalid||e.savingFlag.pending),c.xp6(1),c.hij("",c.lcZ(32,19,"WAREHOUSE_MOD.SAVE")," "))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,h.O5,o._Y,o.JL,o.sg,l.q_,l.Ie,l.Q$,l.pK,l.j9,o.JJ,o.u,l.g2,l.t9,l.QI,h.sg,l.n0,l.PQ],pipes:[m.X$,h.JJ],styles:[""]}),t})();function b(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item"),c.TgZ(1,"ion-label"),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"span",9),c._uU(5),c.qZA(),c.TgZ(6,"ion-button",10),c.NdJ("click",function(){return c.CHM(t),c.oxw().presentEditStore()}),c._uU(7),c.ALo(8,"translate"),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(2),c.AsE("",c.lcZ(3,4,"WAREHOUSE_MOD.INVENTORY")," (",t.item.unit,")"),c.xp6(3),c.Oqu(t.item.quantity_current),c.xp6(2),c.hij(" ",c.lcZ(8,6,"WAREHOUSE_MOD.CORRECTION")," ")}}function x(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",11),c.NdJ("click",function(){return c.CHM(t),c.oxw().presentEditProduct()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}2&t&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"WAREHOUSE_MOD.EDIT_INFOR")," "))}function S(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",12),c.NdJ("click",function(){return c.CHM(t),c.oxw().presentLock()}),c._UZ(1,"ion-icon",13),c._uU(2),c.ALo(3,"translate"),c.qZA()}2&t&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"WAREHOUSE_MOD.LOCK")," "))}function U(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",12),c.NdJ("click",function(){return c.CHM(t),c.oxw().presentLock()}),c._UZ(1,"ion-icon",14),c._uU(2),c.ALo(3,"translate"),c.qZA()}2&t&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"WAREHOUSE_MOD.UNLOCK")," "))}function R(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",15),c.NdJ("click",function(){return c.CHM(t),c.oxw().presentRemove()}),c._UZ(1,"ion-icon",16),c._uU(2),c.ALo(3,"translate"),c.qZA()}2&t&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"WAREHOUSE_MOD.DELETE")," "))}let C=(()=>{class t{constructor(t,e,i,n,o){this.modalController=t,this.actionSheetController=e,this.toastService=i,this.storeService=n,this.translate=o,this.itemChanged=!1}ngOnInit(){console.log(this.from),console.log(this.item)}dismiss(){this.itemChanged?this.modalController.dismiss(this.item):this.modalController.dismiss()}presentRemove(){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.actionSheetController.create({header:this.translate.instant("WAREHOUSE_MOD.CONFIRM"),buttons:[{text:this.translate.instant("WAREHOUSE_MOD.DELETE"),role:"destructive",icon:"trash-outline",handler:()=>{"company"!=this.from&&this.delete(this.item)}},{text:this.translate.instant("WAREHOUSE_MOD.NO"),icon:"close",role:"cancel"}]})).present()})}presentLock(){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.actionSheetController.create({header:this.translate.instant("WAREHOUSE_MOD.CONFIRM"),buttons:[{text:this.translate.instant(1==this.item.status?"WAREHOUSE_MOD.LOCK":"WAREHOUSE_MOD.UNLOCK"),role:"destructive",icon:1==this.item.status?"lock-closed-outline":"ock-open-outline",handler:()=>{this.onLock()}},{text:this.translate.instant("WAREHOUSE_MOD.NO"),icon:"close",role:"cancel"}]})).present()})}presentEditProduct(){return(0,n.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:Z,componentProps:{item:this.item}});return t.onDidDismiss().then(t=>{t.data&&(this.item=t.data,this.itemChanged=!0)}),yield t.present()})}presentEditStore(){return(0,n.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:T,componentProps:{item:this.item,from:this.from}});return t.onDidDismiss().then(t=>{t.data&&(this.item=t.data,this.itemChanged=!0)}),yield t.present()})}onLock(){const t=0==this.item.status?1:0;this.storeService.getApiStore("spause",`&id=${this.item.id_store}&val=${t}`).pipe((0,a.P)()).subscribe(e=>{1===e.status?(this.item.status=t,this.itemChanged=!0,this.toastService.success(e.message)):this.toastService.warning(e.error)},t=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}deleteAll(t){const e=`&fcode=${this.storeService.getFarmCode()}&id=${t.id}`;this.storeService.getApiStore("removeProduct",e,"manager/store-api-mobie").pipe((0,a.P)()).subscribe(t=>{1===t.status?(this.toastService.success(t.message),this.modalController.dismiss({delete:!0})):this.toastService.warning(t.error)},t=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}delete(t){this.storeService.getApiStore("removeProduct",`&id=${t.id_store}`).pipe((0,a.P)()).subscribe(t=>{1===t.status?(this.toastService.success(t.message),this.modalController.dismiss({delete:!0})):this.toastService.warning(t.error)},t=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(l.IN),c.Y36(l.BX),c.Y36(p.k),c.Y36(s.d),c.Y36(m.sK))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-store-product-detail"]],inputs:{item:"item",from:"from"},decls:38,vars:21,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-text-center"],[4,"ngIf"],[1,"ion-padding"],["size","large","color","primary","expand","block","shape","round","fill","outline",3,"click",4,"ngIf"],["size","large","color","medium","expand","block","shape","round","fill","outline",3,"click",4,"ngIf"],["size","large","color","danger","expand","block","shape","round","fill","outline",3,"click",4,"ngIf"],["slot","end"],["shape","round","fill","outline","slot","end",3,"click"],["size","large","color","primary","expand","block","shape","round","fill","outline",3,"click"],["size","large","color","medium","expand","block","shape","round","fill","outline",3,"click"],["name","lock-closed-outline","slot","start"],["name","lock-open-outline","slot","start"],["size","large","color","danger","expand","block","shape","round","fill","outline",3,"click"],["name","remove-circle-outline","slot","start"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c.TgZ(3,"ion-button",1),c.NdJ("click",function(){return e.dismiss()}),c._UZ(4,"ion-icon",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"ion-content"),c.TgZ(9,"h1",3),c._uU(10),c.qZA(),c.TgZ(11,"ion-item"),c.TgZ(12,"ion-label"),c.TgZ(13,"h3"),c._uU(14),c.ALo(15,"translate"),c.qZA(),c.TgZ(16,"p"),c._uU(17),c.qZA(),c.qZA(),c.qZA(),c.TgZ(18,"ion-item"),c.TgZ(19,"ion-label"),c.TgZ(20,"h3"),c._uU(21),c.ALo(22,"translate"),c.qZA(),c.TgZ(23,"p"),c._uU(24),c.qZA(),c.qZA(),c.qZA(),c.TgZ(25,"ion-item"),c.TgZ(26,"ion-label"),c.TgZ(27,"h3"),c._uU(28),c.ALo(29,"translate"),c.qZA(),c.TgZ(30,"p"),c._uU(31),c.qZA(),c.qZA(),c.qZA(),c.YNc(32,b,9,8,"ion-item",4),c.TgZ(33,"div",5),c.YNc(34,x,3,3,"ion-button",6),c.YNc(35,S,4,3,"ion-button",7),c.YNc(36,U,4,3,"ion-button",7),c.YNc(37,R,4,3,"ion-button",8),c.qZA(),c.qZA()),2&t&&(c.xp6(6),c.Oqu(c.lcZ(7,13,"WAREHOUSE_MOD.PRODUCT")),c.xp6(4),c.Oqu(e.item.name),c.xp6(4),c.Oqu(c.lcZ(15,15,"WAREHOUSE_MOD.PRODUCER")),c.xp6(3),c.Oqu(e.item.manufacturer_name),c.xp6(4),c.Oqu(c.lcZ(22,17,"WAREHOUSE_MOD.USAGE")),c.xp6(3),c.Oqu(e.item.uses),c.xp6(4),c.Oqu(c.lcZ(29,19,"WAREHOUSE_MOD.DOSAGE")),c.xp6(3),c.Oqu(e.item.dosage),c.xp6(1),c.Q6J("ngIf","store"==e.from),c.xp6(2),c.Q6J("ngIf",1==e.item.extend&&"company"==e.from),c.xp6(1),c.Q6J("ngIf",1==e.item.status&&"store"==e.from),c.xp6(1),c.Q6J("ngIf",0==e.item.status&&"store"==e.from),c.xp6(1),c.Q6J("ngIf","store"==e.from))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,l.Ie,l.Q$,h.O5],pipes:[m.X$],styles:[""]}),t})()}}]);