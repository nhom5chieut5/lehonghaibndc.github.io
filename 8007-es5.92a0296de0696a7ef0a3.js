!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[8007],{8007:function(t,n,o){o.r(n),o.d(n,{MineralPageModule:function(){return Q}});var a,s=o(38583),l=o(90665),r=o(13619),c=o(47063),u=o(64762),m=o(27887),h=o(15189),g=o(92340),Z=o(37716),A=o(38605),p=((a=function(){function t(i,n){e(this,t),this.storage=i,this.RequestApiService=n,this.PATH=g.h_.SITE_PATH}return i(t,[{key:"setMineralData",value:function(e){this.storage.set("mineral",e)}},{key:"getMineralData",value:function(){return this.storage.get("mineral")}},{key:"reqCalculate",value:function(e){return this.RequestApiService.postOutSiteNoneToken(this.PATH+"/chemical/chemical-api?a=multisearch",e)}},{key:"getSearchMolecule",value:function(e){return this.RequestApiService.getOutSite(this.PATH+"/chemical/chemical-api?a=searchMolecule&keyword="+e)}},{key:"getMolecule",value:function(e,t){return this.RequestApiService.getOutSite(this.PATH+"/chemical/chemical-api?a=getMolecule&id="+e+"&species_id="+t)}}]),t}()).\u0275fac=function(e){return new(e||a)(Z.LFG(A.Ke),Z.LFG(h.$))},a.\u0275prov=Z.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a),f=o(84465),d=o(81780);function T(e,t){1&e&&(Z.TgZ(0,"ion-grid",6),Z.TgZ(1,"ion-row",7),Z._UZ(2,"ion-spinner",8),Z.qZA(),Z.qZA())}function q(e,t){if(1&e&&(Z.TgZ(0,"ion-item",10),Z.TgZ(1,"ion-label"),Z.TgZ(2,"ion-text",11),Z.TgZ(3,"h3"),Z._uU(4),Z.qZA(),Z.qZA(),Z.TgZ(5,"p"),Z._uU(6),Z.ALo(7,"translate"),Z.ALo(8,"number"),Z.TgZ(9,"small"),Z._uU(10,"\u0111/kg"),Z.qZA(),Z._uU(11),Z.ALo(12,"number"),Z.qZA(),Z.TgZ(13,"p"),Z._uU(14),Z.ALo(15,"translate"),Z.TgZ(16,"ion-text",12),Z._uU(17),Z.ALo(18,"number"),Z.qZA(),Z.TgZ(19,"small"),Z._uU(20," kg/1000m"),Z.TgZ(21,"sup"),Z._uU(22,"3"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(23,"p"),Z._uU(24),Z.ALo(25,"translate"),Z.TgZ(26,"ion-text",13),Z._uU(27),Z.ALo(28,"number"),Z.qZA(),Z.TgZ(29,"small"),Z._uU(30," \u0111/1000m"),Z.TgZ(31,"sup"),Z._uU(32,"3"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA()),2&e){var i=t.$implicit,n=Z.oxw(2);Z.xp6(4),Z.Oqu(i.name),Z.xp6(2),Z.AsE("",Z.lcZ(7,8,"MINERAL.MINERAL_RES.PRICE")," ",Z.lcZ(8,10,i.cost)," "),Z.xp6(5),Z.hij(" (",Z.lcZ(12,12,i.purity),"%)"),Z.xp6(3),Z.hij("",Z.lcZ(15,14,"MINERAL.MINERAL_RES.TREATMENT_AMOUNT"),": "),Z.xp6(3),Z.hij(" ",Z.xi3(18,16,100*n.atomSelect[n.atomFocusKey].miss/(i.ratio*i.purity),"0.0-0"),""),Z.xp6(7),Z.hij("",Z.lcZ(25,19,"MINERAL.MINERAL_RES.TREATMENT_COST"),": "),Z.xp6(3),Z.hij(" ",Z.xi3(28,21,n.atomSelect[n.atomFocusKey].miss*i.cost/(i.ratio*i.purity*10),"0.0-0"),",000 ")}}function M(e,t){if(1&e&&(Z.TgZ(0,"ion-list"),Z.TgZ(1,"ion-list-header"),Z.TgZ(2,"ion-label"),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.qZA(),Z.YNc(5,q,33,24,"ion-item",9),Z.qZA()),2&e){var i=Z.oxw();Z.xp6(3),Z.Oqu(Z.lcZ(4,2,"MINERAL.MINERAL_RES.SINGLE_TREAT")),Z.xp6(2),Z.Q6J("ngForOf",i.chemicalResMix)}}function E(e,t){1&e&&(Z.TgZ(0,"ion-list-header"),Z.TgZ(1,"ion-label"),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z.qZA()),2&e&&(Z.xp6(2),Z.Oqu(Z.lcZ(3,1,"MINERAL.MINERAL_RES.COMBINED_TREAT")))}function R(e,t){if(1&e&&(Z.TgZ(0,"ion-item",10),Z.TgZ(1,"ion-label"),Z.TgZ(2,"ion-text",11),Z.TgZ(3,"h3"),Z._uU(4),Z.qZA(),Z.qZA(),Z.TgZ(5,"p"),Z._uU(6),Z.ALo(7,"translate"),Z.ALo(8,"number"),Z.TgZ(9,"small"),Z._uU(10,"\u0111/kg"),Z.qZA(),Z._uU(11),Z.ALo(12,"number"),Z.qZA(),Z.TgZ(13,"p"),Z._uU(14),Z.ALo(15,"translate"),Z.TgZ(16,"ion-text",12),Z._uU(17),Z.ALo(18,"number"),Z.qZA(),Z.TgZ(19,"small"),Z._uU(20," kg/1000m"),Z.TgZ(21,"sup"),Z._uU(22,"3"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(23,"p"),Z._uU(24),Z.ALo(25,"translate"),Z.TgZ(26,"ion-text",13),Z._uU(27),Z.ALo(28,"number"),Z.qZA(),Z.TgZ(29,"small"),Z._uU(30," \u0111/1000m"),Z.TgZ(31,"sup"),Z._uU(32,"3"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA()),2&e){var i=t.$implicit,n=Z.oxw(2);Z.xp6(4),Z.Oqu(i.name),Z.xp6(2),Z.AsE("",Z.lcZ(7,8,"MINERAL.MINERAL_RES.PRICE")," ",Z.lcZ(8,10,i.cost)," "),Z.xp6(5),Z.hij(" (",Z.lcZ(12,12,i.purity),"%)"),Z.xp6(3),Z.hij("",Z.lcZ(15,14,"MINERAL.MINERAL_RES.TREATMENT_AMOUNT"),": "),Z.xp6(3),Z.hij(" ",Z.xi3(18,16,100*n.atomSelect[n.atomFocusKey].miss/(i.ratio*i.purity),"0.0-0"),""),Z.xp6(7),Z.hij("",Z.lcZ(25,19,"MINERAL.MINERAL_RES.TREATMENT_COST"),": "),Z.xp6(3),Z.hij(" ",Z.xi3(28,21,n.atomSelect[n.atomFocusKey].miss*i.cost/(i.ratio*i.purity*10),"0.0-0"),",000 ")}}function x(e,t){if(1&e&&(Z.TgZ(0,"ion-list"),Z.YNc(1,E,4,3,"ion-list-header",5),Z.YNc(2,R,33,24,"ion-item",9),Z.qZA()),2&e){var i=Z.oxw();Z.xp6(1),Z.Q6J("ngIf",i.chemicalResMix.length>0),Z.xp6(1),Z.Q6J("ngForOf",i.chemicalRes)}}var v=function(){var t=function(){function t(i,n,o,a,s){e(this,t),this.modalCtrl=i,this.navParams=n,this.mineralService=o,this.toastService=a,this.translate=s,this.chemicalRes=[],this.chemicalResMix=[],this.atomOfDemand=[],this.atomFocusKey=0,this.calculatingFlag=new m.E}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.info=this.navParams.data.info,this.mineral=this.navParams.data.mineral,this.atomSelect=this.navParams.data.mineralSelect,this.atomSelect.forEach(function(t,i){e.atomSelect[i].value=e.mineral[t.name]}),this.calculate()}},{key:"close",value:function(){this.modalCtrl.dismiss()}},{key:"calculate",value:function(){var e=this,t="";this.navParams.data.mineralSelect.forEach(function(i){t+='{"id":'+i.id+', "mass": '+e.navParams.data.mineral[i.name]+"},"}),this.calculatingFlag.setPending(!0);var i={id_species:this.info.species,salinity:this.info.salinity,atom:"["+t.slice(0,-1)+"]"};this.mineralService.reqCalculate(i).subscribe(function(t){"success"==t.status?(e.chemicalRes=t.data.chemical_single,e.chemicalResMix=t.data.chemical_mix,e.atomOfDemand=t.data.demand,e.processAtomMiss()):e.message=t.error.message[0],e.calculatingFlag.setResult(!0)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT")),e.calculatingFlag.setResult(!1)})}},{key:"processAtomMiss",value:function(){var e=this,t=[];this.atomSelect.map(function(i){var n=e.atomOfDemand.find(function(e){return e.atom_id==i.id});void 0===n?(i.miss=0,i.ratioMiss=0,i.demand=0,t.push(0)):(i.miss=n.ingredient*e.info.salinity-i.value,i.ratioMiss=i.miss/n.ingredient,i.demand=n.ingredient,t.push(i.ratioMiss))});var i=Math.max.apply(Math,t);this.atomFocusKey=t.indexOf(i)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(Z.Y36(c.IN),Z.Y36(c.X1),Z.Y36(p),Z.Y36(f.k),Z.Y36(d.sK))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-mineral-result"]],decls:12,vars:6,consts:[["mode","ios"],["slot","primary"],[3,"click"],["name","close-outline"],["padding","",4,"ngIf"],[4,"ngIf"],["padding",""],[1,"ion-align-items-center","ion-justify-content-center"],["name","crescent"],["detail","true","text-wrap","",4,"ngFor","ngForOf"],["detail","true","text-wrap",""],["color","primary"],["color","secondary"],["color","danger"]],template:function(e,t){1&e&&(Z.TgZ(0,"ion-header",0),Z.TgZ(1,"ion-toolbar"),Z.TgZ(2,"ion-title"),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.TgZ(5,"ion-buttons",1),Z.TgZ(6,"ion-button",2),Z.NdJ("click",function(){return t.close()}),Z._UZ(7,"ion-icon",3),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(8,"ion-content"),Z.YNc(9,T,3,0,"ion-grid",4),Z.YNc(10,M,6,4,"ion-list",5),Z.YNc(11,x,3,2,"ion-list",5),Z.qZA()),2&e&&(Z.xp6(3),Z.Oqu(Z.lcZ(4,4,"MINERAL.MINERAL_RES.TITLE")),Z.xp6(6),Z.Q6J("ngIf",t.calculatingFlag.pending),Z.xp6(1),Z.Q6J("ngIf",t.chemicalResMix.length>0),Z.xp6(1),Z.Q6J("ngIf",t.chemicalRes.length>0))},directives:[c.Gu,c.sr,c.wd,c.Sm,c.YG,c.gu,c.W2,s.O5,c.jY,c.Nd,c.PQ,c.q_,c.yh,c.Q$,s.sg,c.Ie,c.yW],pipes:[d.X$,s.JJ],styles:[""]}),t}();function _(e,t){1&e&&(Z.TgZ(0,"ion-grid",14),Z.TgZ(1,"ion-row",15),Z._UZ(2,"ion-spinner",16),Z.qZA(),Z.qZA())}function L(e,t){if(1&e&&(Z.TgZ(0,"ion-row"),Z.TgZ(1,"ion-col",18),Z._uU(2),Z.qZA(),Z.TgZ(3,"ion-col",23),Z._uU(4),Z.ALo(5,"number"),Z.qZA(),Z.TgZ(6,"ion-col",21),Z._uU(7),Z.ALo(8,"number"),Z.qZA(),Z.TgZ(9,"ion-col",21),Z.TgZ(10,"ion-text"),Z._uU(11),Z.ALo(12,"number"),Z.qZA(),Z.qZA(),Z.qZA()),2&e){var i=t.$implicit,n=Z.oxw(2);Z.xp6(2),Z.AsE("",i.name," (",i.label,")"),Z.xp6(2),Z.Oqu(Z.xi3(5,5,i.value,"0.0-0")),Z.xp6(3),Z.Oqu(Z.xi3(8,8,i.demand*n.info.salinity,"0.0-0")),Z.xp6(4),Z.hij(" ",Z.xi3(12,11,i.ratio*n.chemicalGram+i.value,"0.0-0")," ")}}function I(e,t){if(1&e&&(Z.TgZ(0,"ion-grid",17),Z.TgZ(1,"ion-row"),Z.TgZ(2,"ion-col",18),Z.TgZ(3,"ion-text",19),Z._uU(4),Z.ALo(5,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(6,"ion-col",20),Z.TgZ(7,"ion-text",19),Z._uU(8),Z.ALo(9,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(10,"ion-col",21),Z.TgZ(11,"ion-text",19),Z._uU(12),Z.ALo(13,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(14,"ion-col",21),Z.TgZ(15,"ion-text",19),Z._uU(16),Z.ALo(17,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(18,L,13,14,"ion-row",22),Z.qZA()),2&e){var i=Z.oxw();Z.xp6(4),Z.Oqu(Z.lcZ(5,5,"MINERAL.MINERAL_RES_CHOICE.MINERAL")),Z.xp6(4),Z.Oqu(Z.lcZ(9,7,"MINERAL.MINERAL_RES_CHOICE.CURRENT")),Z.xp6(4),Z.Oqu(Z.lcZ(13,9,"MINERAL.MINERAL_RES_CHOICE.SUGGESTED")),Z.xp6(4),Z.Oqu(Z.lcZ(17,11,"MINERAL.MINERAL_RES_CHOICE.PREDICTED")),Z.xp6(2),Z.Q6J("ngForOf",i.atomResult)}}function N(e,t){1&e&&(Z.TgZ(0,"div",11),Z.TgZ(1,"ion-text",24),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z.qZA()),2&e&&(Z.xp6(2),Z.Oqu(Z.lcZ(3,1,"MINERAL.MINERAL_RES_CHOICE.CHEM_WARN")))}var C=function(){var t=function(){function t(i,n,o,a,s){e(this,t),this.modalCtrl=i,this.navParams=n,this.mineralService=o,this.toastService=a,this.translate=s,this.chemicalGram=0,this.chemicalGramReal=0,this.atomOfMol=[],this.atomResult=[],this.atomFocusKey=0,this.calculatingFlag=new m.E}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.info=this.navParams.data.info,this.moleculeChoice=this.navParams.data.info.chemicalChoice,this.mineral=this.navParams.data.mineral,this.atomSelect=this.navParams.data.mineralSelect,this.atomSelect.forEach(function(t,i){e.atomSelect[i].value=e.mineral[t.name]}),this.getMolecule(this.moleculeChoice.name.id)}},{key:"close",value:function(){this.modalCtrl.dismiss()}},{key:"calculate",value:function(){console.log(this.atomResult[this.atomFocusKey]),this.atomResult[this.atomFocusKey].miss<0||0==this.atomResult[this.atomFocusKey].ratio||(this.chemicalGram=this.atomResult[this.atomFocusKey].miss/this.atomResult[this.atomFocusKey].ratio,this.chemicalGramReal=this.chemicalGram*(100/this.moleculeChoice.ratio))}},{key:"getMolecule",value:function(e){var t=this;this.calculatingFlag.setPending(!0),this.mineralService.getMolecule(e,this.info.species).subscribe(function(e){if("success"==e.status){t.atomOfMol=e.data.atoms,t.atomOfDemand=e.data.demand,console.log(t.atomOfDemand);var i=[];t.atomSelect.forEach(function(e){console.log(e);var n=t.atomOfDemand.find(function(t){return t.atom_id==e.id});void 0===n?(e.miss=0,e.ratioMiss=0,e.demand=0):(e.miss=n.ingredient*t.info.salinity-e.value,e.ratioMiss=e.miss/n.ingredient,e.demand=n.ingredient);var o=t.atomOfMol.find(function(t){return t.id==e.id});void 0===o?(e.ratio=0,i.push(0)):(e.ratio=o.ratio,i.push(e.ratioMiss)),t.atomResult.push(e)});var n=Math.max.apply(Math,i);console.log(n),t.atomFocusKey=i.indexOf(n),console.log(t.atomFocusKey),t.calculate()}else t.toastService.warning(e.error.message[0]);t.calculatingFlag.setResult(!0)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT")),t.calculatingFlag.setResult(!1)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(Z.Y36(c.IN),Z.Y36(c.X1),Z.Y36(p),Z.Y36(f.k),Z.Y36(d.sK))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-mineral-result-choice"]],decls:69,vars:39,consts:[["mode","ios"],["slot","primary"],[3,"click"],["name","close-outline"],["padding","",4,"ngIf"],["color","tertiary"],["slot","end"],["lines","inset"],["type","number","placeholder","m3",2,"text-align","end",3,"ngModel","ngModelChange"],["class","ion-padding-horizontal",4,"ngIf"],["class","ion-padding",4,"ngIf"],[1,"ion-padding"],[1,"suggest"],["color","dark"],["padding",""],[1,"ion-align-items-center","ion-justify-content-center"],["name","crescent"],[1,"ion-padding-horizontal"],["size","4"],["color","medium tb-title"],["size","2","text-right",""],["size","3","text-right",""],[4,"ngFor","ngForOf"],["size","2","text-right","",1,"weightAll"],["color","danger"]],template:function(e,t){1&e&&(Z.TgZ(0,"ion-header",0),Z.TgZ(1,"ion-toolbar"),Z.TgZ(2,"ion-title"),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.TgZ(5,"ion-buttons",1),Z.TgZ(6,"ion-button",2),Z.NdJ("click",function(){return t.close()}),Z._UZ(7,"ion-icon",3),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(8,"ion-content"),Z.YNc(9,_,3,0,"ion-grid",4),Z.TgZ(10,"ion-list"),Z.TgZ(11,"ion-list-header"),Z.TgZ(12,"ion-label"),Z._uU(13),Z.ALo(14,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(15,"ion-item"),Z.TgZ(16,"ion-label",5),Z._uU(17),Z.qZA(),Z.TgZ(18,"span",6),Z._uU(19),Z.TgZ(20,"small"),Z._uU(21,"%"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(22,"ion-item"),Z.TgZ(23,"ion-label"),Z._uU(24),Z.ALo(25,"translate"),Z.qZA(),Z.TgZ(26,"span",6),Z._uU(27),Z.TgZ(28,"small"),Z._uU(29,"\u2030"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(30,"ion-item"),Z.TgZ(31,"ion-label"),Z._uU(32),Z.ALo(33,"translate"),Z.qZA(),Z.TgZ(34,"span",6),Z._uU(35),Z.ALo(36,"number"),Z.TgZ(37,"small"),Z._uU(38,"kg/1.000m"),Z.TgZ(39,"sup"),Z._uU(40,"3"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(41,"ion-item",7),Z.TgZ(42,"ion-label"),Z._uU(43),Z.ALo(44,"translate"),Z.qZA(),Z.TgZ(45,"ion-input",8),Z.NdJ("ngModelChange",function(e){return t.volume=e}),Z.qZA(),Z.qZA(),Z.TgZ(46,"ion-item"),Z.TgZ(47,"ion-label"),Z._uU(48),Z.ALo(49,"translate"),Z.qZA(),Z.TgZ(50,"span",6),Z._uU(51),Z.ALo(52,"number"),Z.TgZ(53,"small"),Z._uU(54,"kg"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(55,"ion-list"),Z.TgZ(56,"ion-list-header"),Z.TgZ(57,"ion-label"),Z._uU(58),Z.ALo(59,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(60,I,19,13,"ion-grid",9),Z.YNc(61,N,4,3,"div",10),Z.TgZ(62,"div",11),Z.TgZ(63,"div",12),Z.TgZ(64,"p"),Z._uU(65,"L\u01b0u \xfd: "),Z.TgZ(66,"ion-text",13),Z._uU(67),Z.ALo(68,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA()),2&e&&(Z.xp6(3),Z.Oqu(Z.lcZ(4,17,"MINERAL.MINERAL_RES_CHOICE.TITLE")),Z.xp6(6),Z.Q6J("ngIf",t.calculatingFlag.pending),Z.xp6(4),Z.Oqu(Z.lcZ(14,19,"MINERAL.MINERAL_RES_CHOICE.TREATMENT")),Z.xp6(4),Z.Oqu(t.moleculeChoice.name.formula),Z.xp6(2),Z.hij("",t.moleculeChoice.ratio," "),Z.xp6(5),Z.Oqu(Z.lcZ(25,21,"MINERAL.MINERAL_RES_CHOICE.SALINITY")),Z.xp6(3),Z.hij("",t.info.salinity," "),Z.xp6(5),Z.Oqu(Z.lcZ(33,23,"MINERAL.MINERAL_RES_CHOICE.TREATMENT_DOSAGE")),Z.xp6(3),Z.hij("",Z.xi3(36,25,t.chemicalGramReal,"0.0-0")," "),Z.xp6(8),Z.Oqu(Z.lcZ(44,28,"MINERAL.MINERAL_RES_CHOICE.POND_WATER")),Z.xp6(2),Z.Q6J("ngModel",t.volume),Z.xp6(3),Z.Oqu(Z.lcZ(49,30,"MINERAL.MINERAL_RES_CHOICE.TREATMENT_AMOUNT")),Z.xp6(3),Z.hij("",Z.xi3(52,32,t.chemicalGramReal*t.volume/1e3,"0.0-0")," "),Z.xp6(7),Z.hij("",Z.lcZ(59,35,"MINERAL.MINERAL_RES_CHOICE.AFTER")," (mg/l)"),Z.xp6(2),Z.Q6J("ngIf",t.atomResult.length>0),Z.xp6(1),Z.Q6J("ngIf",0==t.chemicalGram),Z.xp6(6),Z.Oqu(Z.lcZ(68,37,"MINERAL.MINERAL_RES_CHOICE.NOTE")))},directives:[c.Gu,c.sr,c.wd,c.Sm,c.YG,c.gu,c.W2,s.O5,c.q_,c.yh,c.Q$,c.Ie,c.pK,c.as,l.JJ,l.On,c.yW,c.jY,c.Nd,c.PQ,c.wI,s.sg],pipes:[d.X$,s.JJ],styles:["[_nghost-%COMP%]   .tb-title[_ngcontent-%COMP%]{font-size:.8em}"]}),t}(),S=o(51739),O=o(86804);function b(e,t){if(1&e&&(Z.TgZ(0,"div",23),Z._uU(1),Z.qZA()),2&e){var i=Z.oxw(3);Z.xp6(1),Z.hij(" ",i.chemicalSearchMes," ")}}function y(e,t){if(1&e){var i=Z.EpF();Z.TgZ(0,"ion-item"),Z.TgZ(1,"ion-label",11),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z.TgZ(4,"ionic-selectable",21),Z.NdJ("onSearch",function(e){return Z.CHM(i),Z.oxw(2).searchMolecule(e)})("onChange",function(e){return Z.CHM(i),Z.oxw(2).moleculeChange(e)}),Z.YNc(5,b,2,1,"ng-template",22),Z.qZA(),Z.qZA()}if(2&e){var n=Z.oxw(2);Z.xp6(2),Z.Oqu(Z.lcZ(3,4,"MINERAL.CHOOSE_CHEM")),Z.xp6(2),Z.Q6J("shouldFocusSearchbar",!0)("items",n.molecules)("canSearch",!0)}}function U(e,t){1&e&&(Z.TgZ(0,"ion-item"),Z.TgZ(1,"ion-label",11),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z._UZ(4,"ion-input",24),Z.qZA()),2&e&&(Z.xp6(2),Z.hij("",Z.lcZ(3,1,"MINERAL.COMPOSITION")," %"))}function k(e,t){if(1&e){var i=Z.EpF();Z.TgZ(0,"ion-item"),Z.TgZ(1,"ion-icon",25),Z.NdJ("click",function(){var e=Z.CHM(i),t=e.index,n=e.$implicit;return Z.oxw(2).removeParameter(t,n)}),Z.qZA(),Z.TgZ(2,"ion-label",26),Z._uU(3),Z.qZA(),Z._UZ(4,"ion-input",27),Z.qZA()}if(2&e){var n=t.$implicit;Z.xp6(3),Z.Oqu(n.name),Z.xp6(1),Z.Q6J("formControlName",n.name)}}function F(e,t){1&e&&(Z.TgZ(0,"span"),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e&&(Z.xp6(1),Z.Oqu(Z.lcZ(2,1,"MINERAL.CALC")))}function w(e,t){1&e&&(Z.TgZ(0,"span"),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e&&(Z.xp6(1),Z.Oqu(Z.lcZ(2,1,"MINERAL.GET_CHEM")))}var P=function(){return{standalone:!0}};function Y(e,t){if(1&e){var i=Z.EpF();Z.TgZ(0,"ion-content",3),Z.TgZ(1,"ion-list"),Z.TgZ(2,"ion-item"),Z.TgZ(3,"ion-label",4),Z._uU(4),Z.ALo(5,"translate"),Z.qZA(),Z.TgZ(6,"ion-select",5),Z.TgZ(7,"ion-select-option",6),Z._uU(8,"Th\u1ebb ch\xe2n tr\u1eafng"),Z.qZA(),Z.TgZ(9,"ion-select-option",7),Z._uU(10,"T\xf4m s\xfa"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(11,"ion-item"),Z.TgZ(12,"ion-label",4),Z._uU(13),Z.ALo(14,"translate"),Z.qZA(),Z._UZ(15,"ion-input",8),Z.qZA(),Z.qZA(),Z.TgZ(16,"ion-list",9),Z.TgZ(17,"ion-item",10),Z.TgZ(18,"ion-label",11),Z._uU(19),Z.ALo(20,"translate"),Z.qZA(),Z.TgZ(21,"ion-toggle",12),Z.NdJ("ngModelChange",function(e){return Z.CHM(i),Z.oxw().isChoise=e}),Z.qZA(),Z.qZA(),Z.YNc(22,y,6,6,"ion-item",13),Z.YNc(23,U,5,3,"ion-item",13),Z.qZA(),Z.TgZ(24,"ion-list"),Z.TgZ(25,"ion-list-header",14),Z.TgZ(26,"ion-label"),Z._uU(27),Z.ALo(28,"translate"),Z.qZA(),Z.TgZ(29,"ion-button",15),Z.NdJ("click",function(){return Z.CHM(i),Z.oxw().presentAlertParameter()}),Z._uU(30),Z.ALo(31,"translate"),Z._UZ(32,"ion-icon",16),Z.qZA(),Z.qZA(),Z.TgZ(33,"ion-item-group",17),Z.YNc(34,k,5,2,"ion-item",18),Z.qZA(),Z.qZA(),Z.TgZ(35,"div",19),Z.TgZ(36,"ion-button",20),Z.NdJ("click",function(){return Z.CHM(i),Z.oxw().calculate()}),Z.YNc(37,F,3,3,"span",13),Z.YNc(38,w,3,3,"span",13),Z.qZA(),Z.qZA(),Z.qZA()}if(2&e){var n=Z.oxw();Z.Q6J("formGroup",n.infoForm),Z.xp6(4),Z.Oqu(Z.lcZ(5,15,"MINERAL.SPECIES")),Z.xp6(9),Z.hij("",Z.lcZ(14,17,"MINERAL.SALINITY")," (\u2030)"),Z.xp6(6),Z.Oqu(Z.lcZ(20,19,"MINERAL.CHEMICAL")),Z.xp6(2),Z.Q6J("ngModel",n.isChoise)("ngModelOptions",Z.DdM(25,P)),Z.xp6(1),Z.Q6J("ngIf",n.isChoise),Z.xp6(1),Z.Q6J("ngIf",n.isChoise),Z.xp6(4),Z.Oqu(Z.lcZ(28,21,"MINERAL.POND_STATUS")),Z.xp6(3),Z.hij(" ",Z.lcZ(31,23,"MINERAL.ADD")," "),Z.xp6(4),Z.Q6J("ngForOf",n.listMineralSelected),Z.xp6(2),Z.Q6J("color",n.isChoise?"tertiary":"success")("disabled",!n.infoForm.controls.mineralList.valid||0==n.listMineralSelected.length),Z.xp6(1),Z.Q6J("ngIf",n.isChoise),Z.xp6(1),Z.Q6J("ngIf",!n.isChoise)}}var J=function(){var t=function(){function t(i,n,o,a,s,l){e(this,t),this.fb=i,this.modalCtrl=n,this.alertCtrl=o,this.NavControllor=a,this.mineralService=s,this.translate=l,this.isChoise=!1,this.listMineral=[{name:"Ca",id:1,label:this.translate.instant("MINERAL.Ca")},{name:"Mg",id:2,label:this.translate.instant("MINERAL.Mg")},{name:"K",id:3,label:this.translate.instant("MINERAL.K")},{name:"Na",id:4,label:this.translate.instant("MINERAL.Na")},{name:"P",id:5,label:this.translate.instant("MINERAL.P")}],this.listMineralSelected=[],this.formGroupMineral={}}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.mineralService.getMineralData().then(function(t){e.formSaved=t||{species:"1",salinity:15},e.buildForms()},function(t){return console.error(e.translate.instant("MINERAL.GET_ERROR"),t)})}},{key:"buildForms",value:function(){this.infoForm=this.fb.group({species:[this.formSaved.species,[l.kI.required]],salinity:[this.formSaved.salinity,[l.kI.required,l.kI.min(0)]],mineralList:l.cw,chemicalChoice:this.fb.group({name:[""],ratio:["",[l.kI.min(0),l.kI.max(100)]]})})}},{key:"presentAlertParameter",value:function(){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.listMineral.forEach(function(e){t.push({name:e.name,label:e.name,type:"radio",value:e.id})}),e.next=4,this.alertCtrl.create({header:this.translate.instant("MINERAL.PARAM"),inputs:t,buttons:[{text:this.translate.instant("MINERAL.CANCEL"),role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:this.translate.instant("MINERAL.CONFIRM"),handler:function(e){if(!e)return!1;var t=i.listMineral.findIndex(function(t){return t.id===e});i.formGroupMineral[i.listMineral[t].name]=new l.NI("",l.kI.required),i.infoForm.controls.mineralList=new l.cw(i.formGroupMineral),i.listMineralSelected.push(i.listMineral[t]),i.listMineral.splice(t,1)}}]});case 4:return e.next=6,e.sent.present();case 6:case"end":return e.stop()}},e,this)}))}},{key:"removeParameter",value:function(e,t){delete this.formGroupMineral[t.name],this.infoForm.controls.mineralList=new l.cw(this.formGroupMineral),this.listMineralSelected.splice(e,1),this.listMineral.push(t)}},{key:"calculate",value:function(){this.mineralService.setMineralData({species:this.infoForm.value.species,salinity:this.infoForm.value.salinity}),this.presentModalResult()}},{key:"presentModalResult",value:function(){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isChoise){e.next=8;break}return e.next=3,this.modalCtrl.create({component:C,componentProps:{info:this.infoForm.value,mineral:this.infoForm.controls.mineralList.value,mineralSelect:this.listMineralSelected}});case 3:return e.next=5,e.sent.present();case 5:e.t0=e.sent,e.next=13;break;case 8:return e.next=10,this.modalCtrl.create({component:v,componentProps:{info:this.infoForm.value,mineral:this.infoForm.controls.mineralList.value,mineralSelect:this.listMineralSelected}});case 10:return e.next=12,e.sent.present();case 12:e.t0=e.sent;case 13:return e.abrupt("return",e.t0);case 14:case"end":return e.stop()}},e,this)}))}},{key:"onChoice",value:function(){this.isChoise=!this.isChoise,this.infoForm.controls.isChoise.setValue(this.isChoise)}},{key:"moleculeChange",value:function(e){console.log("port:",e.value)}},{key:"filterMolecules",value:function(e,t){if(e)return e.filter(function(e){return-1!==e.name.toLowerCase().indexOf(t)||-1!==e.id.toString().toLowerCase().indexOf(t)||-1!==e.formula.toString().toLowerCase().indexOf(t)})}},{key:"searchMolecule",value:function(e){var t=this;console.log(e.text),this.chemicalSearchMes=this.translate.instant("MINERAL.SEARCH_MES");var i=e.text.trim().toLowerCase();if(e.component.startSearch(),this.moleculesSubscription&&this.moleculesSubscription.unsubscribe(),!i)return this.moleculesSubscription&&this.moleculesSubscription.unsubscribe(),e.component.items=[],void e.component.endSearch();this.moleculesSubscription=this.mineralService.getSearchMolecule(i).subscribe(function(n){t.moleculesSubscription.closed||(e.component.items=t.filterMolecules(n.data,i),void 0===e.component.items&&(t.chemicalSearchMes=t.translate.instant("MINERAL.SEARCH_NULL")),e.component.endSearch())})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(Z.Y36(l.qu),Z.Y36(c.IN),Z.Y36(c.Br),Z.Y36(c.SH),Z.Y36(p),Z.Y36(d.sK))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-mineral"]],decls:8,vars:4,consts:[["slot","start"],["text","","defaultHref","tabs/more"],["padding","",3,"formGroup",4,"ngIf"],["padding","",3,"formGroup"],["color","medium","position","fixed"],["formControlName","species","slot","end"],["value","1","selected",""],["value","2"],["type","number","formControlName","salinity",2,"text-align","end"],["formGroupName","chemicalChoice"],["lines","none"],["color","medium"],["slot","end",3,"ngModel","ngModelOptions","ngModelChange"],[4,"ngIf"],[1,"ion-align-items-center","ion-justify-content-between"],["color","primary","size","small","fill","clear",3,"click"],["slot","end","name","add-circle-outline"],["formGroupName","mineralList"],[4,"ngFor","ngForOf"],["margin-top","",1,"ion-text-center"],["shape","round",3,"color","disabled","click"],["formControlName","name","itemValueField","id","itemTextField","formula",3,"shouldFocusSearchbar","items","canSearch","onSearch","onChange"],["ionicSelectableSearchFailTemplate",""],[1,"ion-padding"],["type","number","formControlName","ratio",2,"text-align","end"],["name","remove-circle","slot","start","color","danger",3,"click"],["position","fixed"],["type","number","placeholder","mg/l",3,"formControlName"]],template:function(e,t){1&e&&(Z.TgZ(0,"ion-header"),Z.TgZ(1,"ion-toolbar"),Z.TgZ(2,"ion-buttons",0),Z._UZ(3,"ion-back-button",1),Z.qZA(),Z.TgZ(4,"ion-title"),Z._uU(5),Z.ALo(6,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(7,Y,39,26,"ion-content",2)),2&e&&(Z.xp6(5),Z.Oqu(Z.lcZ(6,2,"MINERAL.TITLE")),Z.xp6(2),Z.Q6J("ngIf",t.infoForm))},directives:[c.Gu,c.sr,c.Sm,c.oU,c.cs,c.wd,s.O5,c.W2,l.JL,l.sg,c.q_,c.Ie,c.Q$,c.t9,c.QI,l.JJ,l.u,c.n0,c.pK,c.as,l.x0,c.ho,c.w,l.On,c.yh,c.YG,c.gu,c.Ub,s.sg,S.R,O.i],pipes:[d.X$],styles:[""]}),t}(),G=o(93319),H=[{path:"",component:J}],Q=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Z.oAB({type:t}),t.\u0275inj=Z.cJS({imports:[[s.ez,l.u5,l.UX,c.Pc,G.UV,r.Bz.forChild(H),d.aw.forChild()]]}),t}()},27887:function(t,n,o){o.d(n,{E:function(){return a}});var a=function(){function t(){e(this,t),this.start=null,this.end=null,this.pending=null,this.result=null,this.count=0}return i(t,[{key:"setStart",value:function(e){this.start=e,!0===e&&(this.pending=!0,this.end=!1),this.result=null,this.count++}},{key:"setPending",value:function(e){this.pending=e,!1===e?this.start=!1:this.end=!0}},{key:"setResult",value:function(e){this.result=e,this.pending=!1,this.start=!1,this.end=!0}}]),t}()}}])}();