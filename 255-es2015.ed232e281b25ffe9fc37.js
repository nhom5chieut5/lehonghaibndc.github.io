"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[255],{27887:function(e,t,n){n.d(t,{E:function(){return i}});class i{constructor(){this.start=null,this.end=null,this.pending=null,this.result=null,this.count=0}setStart(e){this.start=e,!0===e&&(this.pending=!0,this.end=!1),this.result=null,this.count++}setPending(e){this.pending=e,!1===e?this.start=!1:this.end=!0}setResult(e){this.result=e,this.pending=!1,this.start=!1,this.end=!0}}},255:function(e,t,n){n.r(t),n.d(t,{WallPageModule:function(){return k}});var i=n(38583),o=n(90665),s=n(13619),a=n(47063),r=n(64762),c=n(53760),l=n(69814),u=n(27887),d=n(92340),g=n(23453),h=n(58149),p=n(87152),Z=n(66542),f=n(20714),m=n(99045),A=n(37716),x=n(81780),b=n(82196),T=n(71239),_=n(84465),w=n(79503);function q(e,t){1&e&&(A.TgZ(0,"div",19),A._UZ(1,"ion-spinner",20),A.qZA())}function L(e,t){if(1&e&&(A.TgZ(0,"ion-row",21),A.TgZ(1,"ion-col",22),A.TgZ(2,"div"),A._uU(3),A.ALo(4,"translate"),A.TgZ(5,"span",23),A._uU(6),A.TgZ(7,"sup"),A.TgZ(8,"small"),A._uU(9,"o"),A.qZA(),A.qZA(),A._uU(10,"C"),A.qZA(),A._uU(11),A.ALo(12,"translate"),A.ALo(13,"translate"),A.qZA(),A.qZA(),A.TgZ(14,"ion-col",24),A.TgZ(15,"ion-thumbnail",25),A._UZ(16,"img",26),A.qZA(),A.qZA(),A.qZA()),2&e){const e=A.oxw();A.xp6(3),A.hij("",A.lcZ(4,6,"WALL.WEATHER_TODAY")," "),A.xp6(3),A.Oqu(e.weatherData.temp),A.xp6(5),A.lnq(", ",A.lcZ(12,8,"WALL.FORECAST_MES")," ",e.weatherData.weather,"",A.lcZ(13,10,"WALL.FORECAST_MES_END")," "),A.xp6(5),A.Q6J("src",e.weatherData.icon,A.LSH)}}function C(e,t){1&e&&(A.TgZ(0,"div",19),A._UZ(1,"ion-spinner",20),A.qZA())}function v(e,t){if(1&e&&(A.TgZ(0,"ion-item",29),A.TgZ(1,"ion-label"),A._uU(2),A.qZA(),A.TgZ(3,"ion-note",30),A._uU(4),A.ALo(5,"translate"),A.qZA(),A.qZA()),2&e){const e=t.$implicit;A.xp6(2),A.Oqu(e.name),A.xp6(2),A.AsE("",e.count," ",A.lcZ(5,3,"POND"),"")}}function O(e,t){if(1&e&&(A.TgZ(0,"ion-card",5),A.TgZ(1,"ion-card-header"),A.TgZ(2,"ion-card-subtitle"),A._UZ(3,"ion-icon",27),A._uU(4),A.ALo(5,"translate"),A.qZA(),A.qZA(),A.YNc(6,C,2,0,"div",8),A.YNc(7,v,6,5,"ion-item",28),A.qZA()),2&e){const e=A.oxw();A.xp6(4),A.hij(" ",A.lcZ(5,3,"WALL.DISEASES")," "),A.xp6(2),A.Q6J("ngIf",e.loadingDiseaseFlag.pending),A.xp6(1),A.Q6J("ngForOf",e.diseaseList)}}function U(e,t){1&e&&(A.TgZ(0,"div",19),A._UZ(1,"ion-spinner",20),A.qZA())}function N(e,t){if(1&e){const e=A.EpF();A.TgZ(0,"ion-card",5),A.TgZ(1,"ion-card-header"),A.TgZ(2,"ion-card-subtitle"),A._UZ(3,"ion-icon",31),A._uU(4),A.ALo(5,"translate"),A.qZA(),A.qZA(),A.YNc(6,U,2,0,"div",8),A.TgZ(7,"ion-item",29),A.TgZ(8,"ion-label"),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.TgZ(11,"ion-note",32),A._uU(12),A.qZA(),A.qZA(),A.TgZ(13,"ion-item"),A.TgZ(14,"ion-button",33),A.NdJ("click",function(){return A.CHM(e),A.oxw().openReport()}),A._uU(15,"B\xe1o c\xe1o"),A.qZA(),A.TgZ(16,"ion-button",33),A.NdJ("click",function(){return A.CHM(e),A.oxw().openAnalyst()}),A._uU(17,"Ph\xe2n t\xedch"),A.qZA(),A.qZA(),A.qZA()}if(2&e){const e=A.oxw();A.xp6(4),A.hij(" ",A.lcZ(5,4,"WALL.FARM_ANALYST")," "),A.xp6(2),A.Q6J("ngIf",e.loadingDiseaseFlag.pending),A.xp6(3),A.Oqu(A.lcZ(10,6,"WALL.TOTAL_FARM")),A.xp6(3),A.hij(" ",e.labAnalyst.farms.length," ")}}function F(e,t){1&e&&(A.TgZ(0,"div",19),A._UZ(1,"ion-spinner",20),A.qZA())}function S(e,t){if(1&e){const e=A.EpF();A.TgZ(0,"ion-item",34),A.NdJ("click",function(){const t=A.CHM(e).$implicit;return A.oxw().presentPriceHistory(t.sid)}),A.TgZ(1,"ion-label"),A.TgZ(2,"span",35),A._uU(3),A.qZA(),A.qZA(),A.TgZ(4,"ion-note",36),A._uU(5),A.ALo(6,"number"),A.TgZ(7,"sup"),A._uU(8,"\u20ab"),A.qZA(),A.qZA(),A.qZA()}if(2&e){const e=t.$implicit;A.xp6(3),A.Oqu(e.sname),A.xp6(2),A.Oqu(A.Dn7(6,2,e.price,"1.0","en-US"))}}function P(e,t){if(1&e){const e=A.EpF();A.TgZ(0,"ion-col",37),A.TgZ(1,"ion-card",38),A.NdJ("click",function(){const t=A.CHM(e).$implicit;return A.oxw().openNews(t.title,t.news_id)}),A._UZ(2,"img",39),A.TgZ(3,"ion-card-content"),A._UZ(4,"div",40),A.qZA(),A.qZA(),A.qZA()}if(2&e){const e=t.$implicit;A.xp6(2),A.Q6J("src","http://tepbac.com/upload/news/ge_image/"+e.home_img_file,A.LSH),A.xp6(2),A.Q6J("innerHTML",e.title,A.oJD)}}function M(e,t){1&e&&(A.TgZ(0,"ion-card"),A.TgZ(1,"ion-card-content"),A.TgZ(2,"div",19),A._UZ(3,"ion-spinner",20),A.qZA(),A.qZA(),A.qZA())}function D(e,t){if(1&e){const e=A.EpF();A.TgZ(0,"div",45),A.TgZ(1,"ion-buttons",46),A.NdJ("click",function(){return A.CHM(e),A.oxw(2).showBoxChat=!1}),A.TgZ(2,"ion-button",47),A._UZ(3,"ion-icon",48),A.qZA(),A.qZA(),A._uU(4),A.ALo(5,"translate"),A.qZA()}2&e&&(A.xp6(4),A.hij(" ",A.lcZ(5,1,"ASSISTANT.SAY_HI")," "))}function y(e,t){if(1&e&&(A.TgZ(0,"div",41),A.YNc(1,D,6,3,"div",42),A.TgZ(2,"div",43),A._UZ(3,"img",44),A.qZA(),A.qZA()),2&e){const e=A.oxw();A.xp6(1),A.Q6J("ngIf",e.showBoxChat)}}let E=(()=>{class e{constructor(e,t,n,i,o,s,a,r){this.translate=e,this.settingSerivce=t,this.service=n,this.localDb=i,this.iab=o,this.modalCtrl=s,this.toastService=a,this.geoLocation=r,this.loadingFlag=new u.E,this.loadingDiseaseFlag=new u.E,this.loadingWeatherFlag=new u.E,this.page=0,this.showBoxChat=!0,this.labAnalyst={farms:[],data:null}}ngOnInit(){this.getWeather(),this.getUpdates(),this.getLocalDisease()}getWeather(){this.geoLocation.getCurrentPosition().then(e=>{this.lon=e.coords.longitude,this.lat=e.coords.latitude,this.updateWeather()}).catch(e=>{this.toastService.warning(this.translate.instant("ASSISTANT.NEED_PER_LOCALTION"))})}updateWeather(){this.loadingWeatherFlag.setPending(!0),this.service.getWeatherToday(this.lat,this.lon).pipe().subscribe(e=>{this.processWeatherData(e),this.loadingWeatherFlag.setResult(!0)},e=>{this.loadingWeatherFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}getUpdates(){this.loadingFlag.setPending(!0),this.service.listUpdate(this.page,{names:this.localDb.speciesFollowing}).pipe().subscribe(e=>{0==e.status?this.toastService.warning(e.error):0==this.page?(this.priceList=e.data.species,0==this.localDb.speciesFollowing.length&&this.priceList.forEach(e=>{this.localDb.addItem("speciesFollowing",e.sname)}),this.newsList=e.data.news):this.newsList=this.newsList.concat(e.data.news),this.loadingFlag.setResult(!0)},e=>{this.loadingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}getLocalDisease(){this.loadingDiseaseFlag.setPending(!0),this.service.listDisease().pipe().subscribe(e=>{0==e.status?this.toastService.warning(e.error):(this.diseaseList=e.data,this.labAnalyst.farms=e.farms),this.loadingDiseaseFlag.setResult(!0)},e=>{this.loadingDiseaseFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}openNews(e,t){let n=d.h_.SITE_PATH+"/tin-tuc/full/"+this.convertSlug(e)+"-"+t+".html";this.iab.create(n,"_blank")}loadMoreNews(e){this.page+=1,this.getUpdates(),setTimeout(()=>{e.target.complete()},500)}reload(){this.page=0,this.newsList=[],this.getUpdates(),this.getLocalDisease(),this.updateWeather()}processWeatherData(e){this.weatherWeekData=e.daily;let t=e.daily[0];this.weatherData={temp:(t.temp.day-273.15).toFixed(2),temp_max:(t.temp.max-273.15).toFixed(2),weather:t.weather[0].description,icon:`http://openweathermap.org/img/w/${t.weather[0].icon}.png`}}convertSlug(e){return(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\xe0|\xe1|\u1ea1|\u1ea3|\xe3|\xe2|\u1ea7|\u1ea5|\u1ead|\u1ea9|\u1eab|\u0103|\u1eb1|\u1eaf|\u1eb7|\u1eb3|\u1eb5/g,"a")).replace(/\xe8|\xe9|\u1eb9|\u1ebb|\u1ebd|\xea|\u1ec1|\u1ebf|\u1ec7|\u1ec3|\u1ec5/g,"e")).replace(/\xec|\xed|\u1ecb|\u1ec9|\u0129/g,"i")).replace(/\xf2|\xf3|\u1ecd|\u1ecf|\xf5|\xf4|\u1ed3|\u1ed1|\u1ed9|\u1ed5|\u1ed7|\u01a1|\u1edd|\u1edb|\u1ee3|\u1edf|\u1ee1/g,"o")).replace(/\xf9|\xfa|\u1ee5|\u1ee7|\u0169|\u01b0|\u1eeb|\u1ee9|\u1ef1|\u1eed|\u1eef/g,"u")).replace(/\u1ef3|\xfd|\u1ef5|\u1ef7|\u1ef9/g,"y")).replace(/\u0111/g,"d")).replace(/\xc0|\xc1|\u1ea0|\u1ea2|\xc3|\xc2|\u1ea6|\u1ea4|\u1eac|\u1ea8|\u1eaa|\u0102|\u1eb0|\u1eae|\u1eb6|\u1eb2|\u1eb4/g,"A")).replace(/\xc8|\xc9|\u1eb8|\u1eba|\u1ebc|\xca|\u1ec0|\u1ebe|\u1ec6|\u1ec2|\u1ec4/g,"E")).replace(/\xcc|\xcd|\u1eca|\u1ec8|\u0128/g,"I")).replace(/\xd2|\xd3|\u1ecc|\u1ece|\xd5|\xd4|\u1ed2|\u1ed0|\u1ed8|\u1ed4|\u1ed6|\u01a0|\u1edc|\u1eda|\u1ee2|\u1ede|\u1ee0/g,"O")).replace(/\xd9|\xda|\u1ee4|\u1ee6|\u0168|\u01af|\u1eea|\u1ee8|\u1ef0|\u1eec|\u1eee/g,"U")).replace(/\u1ef2|\xdd|\u1ef4|\u1ef6|\u1ef8/g,"Y")).replace(/\u0110/g,"D")).replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g,"")).replace(/\u02C6|\u0306|\u031B/g,"")).replace(/ + /g," ")).replace(/&quot;|!|@|%|\^|\*|\(|\)|\+|\=|\<|\>|\?|\/|,|\.|\:|\;|\'|\"|\&|\#|\[|\]|~|\$|_|`|-|{|}|\||\\|/g,"")).replace(/ /g,"-")).toLowerCase()}presentManageSpecies(){return(0,r.mG)(this,void 0,void 0,function*(){const e=yield this.modalCtrl.create({component:g.U});return e.onDidDismiss().then(e=>{var t;"success"==(null===(t=e.data)||void 0===t?void 0:t.res)&&(this.toastService.success(this.translate.instant("WALL.UPDATE_SUCCESS")),this.getUpdates())}),yield e.present()})}presentPriceHistory(e){return(0,r.mG)(this,void 0,void 0,function*(){return yield(yield this.modalCtrl.create({component:h.A,componentProps:{data:e}})).present()})}presentWeatherForecast(){return(0,r.mG)(this,void 0,void 0,function*(){return yield(yield this.modalCtrl.create({component:Z.J,componentProps:{data:this.weatherWeekData}})).present()})}openAnalyst(){return(0,r.mG)(this,void 0,void 0,function*(){if(0!=this.labAnalyst.farms.length)return yield(yield this.modalCtrl.create({component:f.h,componentProps:{farms:this.labAnalyst.farms}})).present();this.toastService.warning(this.translate.instant("DEVICE_MOD.DATA_NULL"))})}openReport(){return(0,r.mG)(this,void 0,void 0,function*(){if(0!=this.labAnalyst.farms.length)return yield(yield this.modalCtrl.create({component:m.C,componentProps:{farms:this.labAnalyst.farms}})).present();this.toastService.warning(this.translate.instant("DEVICE_MOD.DATA_NULL"))})}}return e.\u0275fac=function(t){return new(t||e)(A.Y36(x.sK),A.Y36(b.R),A.Y36(l.F),A.Y36(T.T),A.Y36(c.i),A.Y36(a.IN),A.Y36(_.k),A.Y36(p.b))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-wall"]],decls:41,vars:18,consts:[["slot","start"],["slot","end"],[3,"click"],["slot","icon-only","name","filter-circle-outline"],["slot","icon-only","name","refresh-circle-outline"],["mode","ios",1,"card-header-icon"],["name","accessibility-outline",1,"icon-f"],["name","chevron-forward-outline",1,"icon-detail"],["class","ion-text-center",4,"ngIf"],[2,"padding-top","0"],["class","ion-align-items-start",4,"ngIf"],["mode","ios","class","card-header-icon",4,"ngIf"],["name","pricetag-outline",1,"icon-f"],["lines","none","detail","true",3,"click",4,"ngFor","ngForOf"],[1,"ion-no-padding"],["size","12","size-sm","6","class","ion-no-padding",4,"ngFor","ngForOf"],[4,"ngIf"],["threshold","100px",3,"ionInfinite"],["class","box-assistant",4,"ngIf"],[1,"ion-text-center"],["name","dots"],[1,"ion-align-items-start"],["size","10"],[2,"color","red"],["size","2"],[2,"width","48px","height","48px"],[1,"float-right",3,"src"],["name","bug-outline",1,"icon-f"],["lines","none",4,"ngFor","ngForOf"],["lines","none"],["color","danger","slot","end"],["name","pie-chart-outline",1,"icon-f"],["slot","end","color","tertiary"],["mode","ios","size","small","fill","outline","slot","end",3,"click"],["lines","none","detail","true",3,"click"],[1,"price-species"],["color","success","slot","end"],["size","12","size-sm","6",1,"ion-no-padding"],["mode","ios",3,"click"],[3,"src"],[1,"news-title",3,"innerHTML"],[1,"box-assistant"],["class","box-message arrow-bottom",4,"ngIf"],["routerLink","/assistant/",1,"box-avatar"],["src","../../assets/img/octopus.svg","width","45px"],[1,"box-message","arrow-bottom"],[1,"btn-assistant",3,"click"],["color","medium"],["name","close-outline"]],template:function(e,t){1&e&&(A.TgZ(0,"ion-header"),A.TgZ(1,"ion-toolbar"),A.TgZ(2,"ion-buttons",0),A._UZ(3,"app-avatar"),A.qZA(),A.TgZ(4,"ion-title"),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"ion-buttons",1),A.TgZ(8,"ion-button",2),A.NdJ("click",function(){return t.presentManageSpecies()}),A._UZ(9,"ion-icon",3),A.qZA(),A.TgZ(10,"ion-button",2),A.NdJ("click",function(){return t.reload()}),A._UZ(11,"ion-icon",4),A.qZA(),A.qZA(),A.qZA(),A.qZA(),A.TgZ(12,"ion-content"),A.TgZ(13,"ion-card",5),A.TgZ(14,"ion-card-header",2),A.NdJ("click",function(){return t.presentWeatherForecast()}),A.TgZ(15,"ion-card-subtitle"),A._UZ(16,"ion-icon",6),A._uU(17),A.ALo(18,"translate"),A._UZ(19,"ion-icon",7),A.qZA(),A.qZA(),A.YNc(20,q,2,0,"div",8),A.TgZ(21,"ion-card-content",9),A.TgZ(22,"ion-grid"),A.YNc(23,L,17,12,"ion-row",10),A.qZA(),A.qZA(),A.qZA(),A.YNc(24,O,8,5,"ion-card",11),A.YNc(25,N,18,8,"ion-card",11),A.TgZ(26,"ion-card",5),A.TgZ(27,"ion-card-header"),A.TgZ(28,"ion-card-subtitle"),A._UZ(29,"ion-icon",12),A._uU(30),A.ALo(31,"translate"),A.qZA(),A.qZA(),A.YNc(32,F,2,0,"div",8),A.YNc(33,S,9,6,"ion-item",13),A.qZA(),A.TgZ(34,"ion-grid",14),A.TgZ(35,"ion-row"),A.YNc(36,P,5,2,"ion-col",15),A.qZA(),A.qZA(),A.YNc(37,M,4,0,"ion-card",16),A.TgZ(38,"ion-infinite-scroll",17),A.NdJ("ionInfinite",function(e){return t.loadMoreNews(e)}),A._UZ(39,"ion-infinite-scroll-content"),A.qZA(),A.YNc(40,y,4,1,"div",18),A.qZA()),2&e&&(A.xp6(5),A.Oqu(A.lcZ(6,12,"WALL.UPDATING")),A.xp6(12),A.hij(" ",A.lcZ(18,14,"WALL.ASSIST")," "),A.xp6(3),A.Q6J("ngIf",t.loadingWeatherFlag.pending),A.xp6(3),A.Q6J("ngIf",t.weatherData),A.xp6(1),A.Q6J("ngIf",(null==t.diseaseList?null:t.diseaseList.length)>0),A.xp6(1),A.Q6J("ngIf",t.labAnalyst),A.xp6(5),A.hij(" ",A.lcZ(31,16,"WALL.PRICES")," "),A.xp6(2),A.Q6J("ngIf",t.loadingFlag.pending),A.xp6(1),A.Q6J("ngForOf",t.priceList),A.xp6(3),A.Q6J("ngForOf",t.newsList),A.xp6(1),A.Q6J("ngIf",t.loadingFlag.pending&&0==t.page),A.xp6(3),A.Q6J("ngIf",t.settingSerivce.showAssistant&&"vi"==t.translate.currentLang))},directives:[a.Gu,a.sr,a.Sm,w.A,a.wd,a.YG,a.gu,a.W2,a.PM,a.Zi,a.tO,i.O5,a.FN,a.jY,i.sg,a.Nd,a.ju,a.MB,a.PQ,a.wI,a.Bs,a.Ie,a.Q$,a.uN,a.YI,s.rH],pipes:[x.X$,i.JJ],styles:['[_nghost-%COMP%]   .box-assistant[_ngcontent-%COMP%]{background-color:transparent;position:fixed;bottom:3.7em;right:.5em;width:100%}[_nghost-%COMP%]   .box-avatar[_ngcontent-%COMP%]{border-style:solid;border-color:#fff;border-radius:50%;float:right;padding:3px 5px;background-color:#fff;box-shadow:0 0 .5em .1em #d3d2d2}[_nghost-%COMP%]   .box-message[_ngcontent-%COMP%]{background-color:#82cee0;border-radius:5px;color:#174caa;padding:15px;position:absolute;margin-bottom:12px;-webkit-animation-name:myAni;animation-name:myAni;-webkit-animation-duration:.5s;animation-duration:.5s;bottom:0;right:5em}[_nghost-%COMP%]   .box-message.arrow-bottom[_ngcontent-%COMP%]:after{content:" ";position:absolute;right:-10px;bottom:0;border-top:15px solid #82cee0;border-right:15px solid transparent;border-left:0 solid transparent;border-bottom:none}[_nghost-%COMP%]   .btn-assistant[_ngcontent-%COMP%]{position:absolute;top:-30px;right:-15px}[_nghost-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{--border-radius: 8px;--size: 100%}[_nghost-%COMP%]   .card-header-icon[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{padding-left:3em}[_nghost-%COMP%]   .card-header-icon[_ngcontent-%COMP%]   ion-icon.icon-f[_ngcontent-%COMP%]{font-size:2em;position:absolute;left:0;top:-.2em}[_nghost-%COMP%]   .news-title[_ngcontent-%COMP%]{line-height:1.5em;font-size:1.1em;font-family:Averta;color:#333;font-weight:bold}[_nghost-%COMP%]   .price-species[_ngcontent-%COMP%]{font-size:.9em}']}),e})();var I=n(76361),J=n(56209);const W=[{path:"",component:E}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=A.oAB({type:e}),e.\u0275inj=A.cJS({imports:[[i.ez,o.u5,a.Pc,s.Bz.forChild(W),I.F,x.aw.forChild(),J.Ns]]}),e})()}}]);