!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[9650],{27887:function(t,n,r){r.d(n,{E:function(){return s}});var s=function(){function t(){e(this,t),this.start=null,this.end=null,this.pending=null,this.result=null,this.count=0}return i(t,[{key:"setStart",value:function(e){this.start=e,!0===e&&(this.pending=!0,this.end=!1),this.result=null,this.count++}},{key:"setPending",value:function(e){this.pending=e,!1===e?this.start=!1:this.end=!0}},{key:"setResult",value:function(e){this.result=e,this.pending=!1,this.start=!1,this.end=!0}}]),t}()},39650:function(t,n,r){r.r(n),r.d(n,{AddDevicePageModule:function(){return E}});var s=r(38583),o=r(90665),a=r(13619),c=r(47063),u=r(64762),p=r(82629),d=r(27887),v=r(37716),l=r(84465),h=r(38605),f=r(81780);function g(e,t){1&e&&v._UZ(0,"ion-progress-bar",14)}function T(e,t){1&e&&v._UZ(0,"img",15)}function A(e,t){1&e&&v._UZ(0,"img",16)}function m(e,t){1&e&&v._UZ(0,"img",17)}function _(e,t){1&e&&(v.TgZ(0,"span",18),v._uU(1),v.ALo(2,"translate"),v.qZA()),2&e&&(v.xp6(1),v.Oqu(v.lcZ(2,1,"DEVICE_MOD.CABINET")))}function k(e,t){1&e&&(v.TgZ(0,"span",18),v._uU(1),v.ALo(2,"translate"),v.qZA()),2&e&&(v.xp6(1),v.Oqu(v.lcZ(2,1,"DEVICE_MOD.ENVISOR")))}function y(e,t){1&e&&(v.TgZ(0,"span",18),v._uU(1),v.ALo(2,"translate"),v.qZA()),2&e&&(v.xp6(1),v.Oqu(v.lcZ(2,1,"DEVICE_MOD.FEEDINGS")))}function q(e,t){if(1&e&&(v.TgZ(0,"ion-select-option",19),v._uU(1),v.qZA()),2&e){var i=t.$implicit;v.Q6J("value",i.infor.code),v.xp6(1),v.Oqu(i.infor.name)}}var P,F=[{path:"",component:(P=function(){function t(i,n,r,s,a,c){e(this,t),this.toastService=i,this.route=n,this.router=r,this.storage=s,this.iotService=a,this.translate=c,this.ponds=[],this.loading=new d.E,this.form=new o.cw({name:new o.NI("",o.kI.required),pcode:new o.NI("",o.kI.required)})}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.listPond(),this.route.queryParams.subscribe(function(t){t&&t.device_id&&t.code&&t.type?(e.device_id=t.device_id,e.code=t.code,e.type=t.type):(e.router.navigateByUrl("home"),e.toastService.warning(e.translate.instant("DEVICE_MOD.DATA_NULL")))})}},{key:"listPond",value:function(){var e=this;this.storage.get("ponds").then(function(t){e.ponds=t}).catch(function(){e.toastService.warning(e.translate.instant("DEVICE_MOD.EMPTY_POND"))})}},{key:"save",value:function(){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,i,n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.setPending(!0),e.next=3,this.iotService.active(this.code).catch(function(){r.toastService.danger(r.translate.instant("ERROR_CONNECT"))});case 3:return t=e.sent,console.log(t),i={device_id_fb:this.device_id,name:this.form.value.name,type:this.type,pond_code:this.form.value.pcode},e.next=8,this.iotService.add(i).catch(function(){r.toastService.danger(r.translate.instant("ERROR_CONNECT")),r.loading.setResult(!1)});case 8:(n=e.sent)&&1==n.status?(this.toastService.success(this.translate.instant("DEVICE_MOD.ADDED_DEVICE")),this.router.navigateByUrl("pond/"+this.form.value.pcode)):this.toastService.warning(n.error),this.loading.setResult(!0);case 10:case"end":return e.stop()}},e,this)}))}}]),t}(),P.\u0275fac=function(e){return new(e||P)(v.Y36(l.k),v.Y36(a.gz),v.Y36(a.F0),v.Y36(h.Ke),v.Y36(p.d),v.Y36(f.sK))},P.\u0275cmp=v.Xpm({type:P,selectors:[["app-add-device"]],inputs:{pondsOb:"pondsOb"},decls:36,vars:25,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["type","indeterminate",4,"ngIf"],[3,"formGroup"],["src","../../../assets/img/cabinext.png",4,"ngIf"],["src","../../../assets/img/envisor.png",4,"ngIf"],["src","../../../assets/img/feeding.png",4,"ngIf"],["lines","inset",2,"text-align","center"],["slot","end",4,"ngIf"],["slot","end","formControlName","name"],["slot","end","formControlName","pcode","placeholder","Ch\u1ecdn ao"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-text-center"],["shape","round",3,"disabled","click"],["type","indeterminate"],["src","../../../assets/img/cabinext.png"],["src","../../../assets/img/envisor.png"],["src","../../../assets/img/feeding.png"],["slot","end"],[3,"value"]],template:function(e,t){1&e&&(v.TgZ(0,"ion-header"),v.TgZ(1,"ion-toolbar"),v.TgZ(2,"ion-buttons",0),v._UZ(3,"ion-back-button",1),v.qZA(),v.TgZ(4,"ion-title"),v._uU(5),v.ALo(6,"translate"),v.qZA(),v.qZA(),v.qZA(),v.TgZ(7,"ion-content"),v.YNc(8,g,1,0,"ion-progress-bar",2),v.TgZ(9,"ion-card",3),v.YNc(10,T,1,0,"img",4),v.YNc(11,A,1,0,"img",5),v.YNc(12,m,1,0,"img",6),v.TgZ(13,"ion-card-content"),v.TgZ(14,"ion-list",7),v.TgZ(15,"ion-item"),v._uU(16),v.ALo(17,"translate"),v.YNc(18,_,3,3,"span",8),v.YNc(19,k,3,3,"span",8),v.YNc(20,y,3,3,"span",8),v.qZA(),v.TgZ(21,"ion-item"),v.TgZ(22,"ion-label"),v._uU(23),v.ALo(24,"translate"),v.qZA(),v._UZ(25,"ion-input",9),v.qZA(),v.TgZ(26,"ion-item"),v.TgZ(27,"ion-label"),v._uU(28),v.ALo(29,"translate"),v.qZA(),v.TgZ(30,"ion-select",10),v.YNc(31,q,2,2,"ion-select-option",11),v.qZA(),v.qZA(),v.qZA(),v.TgZ(32,"div",12),v.TgZ(33,"ion-button",13),v.NdJ("click",function(){return t.save()}),v._uU(34),v.ALo(35,"translate"),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA()),2&e&&(v.xp6(5),v.Oqu(v.lcZ(6,15,"DEVICE_MOD.ADD_DEVICE")),v.xp6(3),v.Q6J("ngIf",t.loading.pending),v.xp6(1),v.Q6J("formGroup",t.form),v.xp6(1),v.Q6J("ngIf","cabinet"==t.type),v.xp6(1),v.Q6J("ngIf","envisor"==t.type),v.xp6(1),v.Q6J("ngIf","feeding"==t.type),v.xp6(4),v.hij(" ",v.lcZ(17,17,"DEVICE_MOD.TYPE"),""),v.xp6(2),v.Q6J("ngIf","cabinet"==t.type),v.xp6(1),v.Q6J("ngIf","envisor"==t.type),v.xp6(1),v.Q6J("ngIf","feeding"==t.type),v.xp6(3),v.Oqu(v.lcZ(24,19,"DEVICE_MOD.NAME")),v.xp6(5),v.Oqu(v.lcZ(29,21,"DEVICE_MOD.POND")),v.xp6(3),v.Q6J("ngForOf",t.ponds),v.xp6(2),v.Q6J("disabled",t.form.invalid),v.xp6(1),v.Oqu(v.lcZ(35,23,"DEVICE_MOD.ADD")))},directives:[c.Gu,c.sr,c.Sm,c.oU,c.cs,c.wd,c.W2,s.O5,c.PM,o.JL,o.sg,c.FN,c.q_,c.Ie,c.Q$,c.pK,c.j9,o.JJ,o.u,c.t9,c.QI,s.sg,c.YG,c.X7,c.n0],pipes:[f.X$],styles:[""]}),P)}],E=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=v.oAB({type:t}),t.\u0275inj=v.cJS({imports:[[s.ez,o.u5,c.Pc,f.aw.forChild(),o.UX,a.Bz.forChild(F)]]}),t}()},82629:function(t,n,r){r.d(n,{d:function(){return c}});var s,o=r(15189),a=r(37716),c=((s=function(){function t(i){e(this,t),this.reqApiService=i,this.PATH_FT="http://35.240.204.122:8882/farmext",this.PATH_DEVICE="/manager/device-api",this.PATH_ADD_DEVICE="/manager/add-device-api",this.SITE_PATH_API="http://35.240.204.122:8882/api",this.listPermision=["company_manager","farm_manager","pond_manager"]}return i(t,[{key:"checkPermission",value:function(e){return!!this.listPermision.includes(e)}},{key:"setPondCode",value:function(e){this.pcode=e}},{key:"list",value:function(){return this.reqApiService.get(this.PATH_DEVICE+"?action=list&pcode="+this.pcode).toPromise()}},{key:"get",value:function(e){return this.reqApiService.get(this.PATH_DEVICE+"?action=get&device_id_fb="+e+"&pcode="+this.pcode).toPromise()}},{key:"update",value:function(e,t){return this.reqApiService.post(this.PATH_DEVICE+"?action=update&id="+t+"&pcode="+this.pcode,{name:e,pond_code:this.pcode}).toPromise()}},{key:"add",value:function(e){return this.reqApiService.post(this.PATH_ADD_DEVICE,e).toPromise()}},{key:"move",value:function(e,t,i){return this.reqApiService.post(this.PATH_DEVICE+"?action=update&id="+i+"&pcode="+this.pcode,{name:e,pond_code:t}).toPromise()}},{key:"remove",value:function(e){return this.reqApiService.get(this.PATH_DEVICE+"?action=remove&id="+e+"&pcode="+this.pcode).toPromise()}},{key:"check",value:function(e){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/qr/"+e).toPromise()}},{key:"active",value:function(e){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/qr/"+e,{}).toPromise()}},{key:"changeStatusContactor",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+i+"/peripherals/"+t+"/control",e)}},{key:"getInforDevice",value:function(e){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+e).toPromise()}},{key:"getListCondition",value:function(e,t){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/subscribes")}},{key:"removeCondition",value:function(e,t,i){return this.reqApiService.deleteTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/subscribes/"+i)}},{key:"addCondition",value:function(e,t,i){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/subscribes",i)}},{key:"updateNameContactor",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e,i)}},{key:"updateTimer",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/timer",i)}},{key:"updateSetting",value:function(e,t){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e+"/setting",t).toPromise()}},{key:"addConditonPub",value:function(e,t,i){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+e+"/peripherals/"+t+"/conditions",i)}},{key:"updateConditonPub",value:function(e,t,i,n){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e+"/peripherals/"+t+"/conditions/"+i,n)}},{key:"removeConditionPub",value:function(e,t,i){return this.reqApiService.deleteTokenFt(this.PATH_FT+"/v2/devices/"+e+"/peripherals/"+t+"/conditions/"+i)}},{key:"saveAutoRecord",value:function(e,t){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e+"/third-setting",t)}},{key:"commandFeeding",value:function(e,t){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+e+"/command",t)}},{key:"removeTimer",value:function(e,t,i){return this.reqApiService.deleteTokenFt(this.PATH_FT+"/v2/devices/"+i+"/peripherals/"+t+"/timer/"+e)}},{key:"addTimer",value:function(e,t,i){return this.reqApiService.postTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/timer",i)}},{key:"updateTimerFeed",value:function(e,t,i,n){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+i+"/peripherals/"+t+"/timer/"+e,n)}},{key:"plus_analyze",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/plus_analyze",i)}},{key:"abstract_analyze",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/abstract_analyze",i)}},{key:"asyncData",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/sync",i)}},{key:"removeDataFeed",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/clear",i)}},{key:"updateCommonSetting",value:function(e,t){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+e,t)}},{key:"getListRepast",value:function(e,t){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/data")}},{key:"getSuggestCalib",value:function(e,t,i,n){return this.reqApiService.getTokenFt(this.PATH_FT+"/v2/devices/"+n+"/get-suggest-calib?feed="+i+"&start="+e+"&end="+t)}},{key:"quickAddRepast",value:function(e,t,i){return this.reqApiService.putTokenFt(this.PATH_FT+"/v2/devices/"+t+"/peripherals/"+e+"/timer/feed",i)}}]),t}()).\u0275fac=function(e){return new(e||s)(a.LFG(o.$))},s.\u0275prov=a.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s)}}])}();