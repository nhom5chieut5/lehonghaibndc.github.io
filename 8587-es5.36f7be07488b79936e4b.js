!function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[8587],{98587:function(e,n,i){i.d(n,{s:function(){return v}});var a=i(16738),o=i(27887),s=i(80272),l=i(37716),c=i(47063),g=i(81780),r=i(84465),u=i(38583),d=i(90665);function p(t,e){1&t&&(l.TgZ(0,"div",6),l._UZ(1,"ion-spinner",16),l.qZA())}function h(t,e){if(1&t&&(l.TgZ(0,"ion-segment-button",17),l.TgZ(1,"ion-label"),l._uU(2),l.qZA(),l.qZA()),2&t){var n=e.$implicit;l.Q6J("value",n.key),l.xp6(2),l.Oqu(n.value.label)}}function Z(t,e){if(1&t&&(l.TgZ(0,"ion-select-option",17),l._uU(1),l.qZA()),2&t){var n=e.$implicit;l.Q6J("value",n.disease_id),l.xp6(1),l.Oqu(n.name)}}function m(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"ion-col",28),l.TgZ(1,"ion-item"),l.TgZ(2,"ion-label",25),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"ion-input",29),l.NdJ("ngModelChange",function(t){return l.CHM(n),l.oxw().$implicit.value=t})("ionChange",function(){return l.CHM(n),l.oxw(3).checkEmpty()}),l.qZA(),l.qZA(),l.qZA()}if(2&t){var i=l.oxw().$implicit;l.xp6(3),l.Oqu(l.lcZ(4,2,"VALUE")),l.xp6(2),l.Q6J("ngModel",i.value)}}function f(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"ion-row",21),l.TgZ(1,"ion-col",7),l.TgZ(2,"ion-button",22),l.NdJ("click",function(){var t=l.CHM(n).index;return l.oxw(2).removeRow(t)}),l._UZ(3,"ion-icon",23),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",24),l.TgZ(5,"ion-item"),l.TgZ(6,"ion-label",25),l._uU(7),l.qZA(),l.TgZ(8,"ion-select",26),l.NdJ("ngModelChange",function(t){return e.$implicit.key=t})("ionChange",function(){return l.CHM(n),l.oxw(2).checkEmpty()}),l.YNc(9,Z,2,2,"ion-select-option",14),l.qZA(),l.qZA(),l.qZA(),l.YNc(10,m,6,4,"ion-col",27),l.qZA()}if(2&t){var i=e.$implicit,a=l.oxw(2);l.xp6(7),l.Oqu(a.segmentType[a.typeInputing].label),l.xp6(1),l.Q6J("ngModel",i.key),l.xp6(1),l.Q6J("ngForOf",a.segmentType[a.typeInputing].options),l.xp6(1),l.Q6J("ngIf","antibiotic"==a.typeInputing||"bacteria"==a.typeInputing)}}function y(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"div"),l.YNc(1,f,11,4,"ion-row",18),l.TgZ(2,"ion-row"),l.TgZ(3,"ion-col",6),l.TgZ(4,"ion-button",19),l.NdJ("click",function(){return l.CHM(n),l.oxw().addRow()}),l._UZ(5,"ion-icon",20),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&t){var i=l.oxw();l.xp6(1),l.Q6J("ngForOf",i.segmentType[i.typeInputing].data),l.xp6(5),l.hij(" ",l.lcZ(7,2,"ADD")," ")}}function T(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"div"),l.TgZ(1,"ion-grid"),l.TgZ(2,"ion-row"),l.TgZ(3,"ion-col",30),l.TgZ(4,"ion-item"),l.TgZ(5,"ion-label",25),l._uU(6),l.ALo(7,"translate"),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"ion-input",31),l.NdJ("ngModelChange",function(t){l.CHM(n);var e=l.oxw();return e.segmentType[e.typeInputing].data.weight=t}),l.qZA(),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",30),l.TgZ(11,"ion-item"),l.TgZ(12,"ion-label",25),l._uU(13),l.ALo(14,"translate"),l.ALo(15,"translate"),l.qZA(),l.TgZ(16,"ion-input",31),l.NdJ("ngModelChange",function(t){l.CHM(n);var e=l.oxw();return e.segmentType[e.typeInputing].data.loss=t}),l.qZA(),l.qZA(),l.qZA(),l.TgZ(17,"ion-col",30),l.TgZ(18,"ion-item"),l.TgZ(19,"ion-label",25),l._uU(20),l.ALo(21,"translate"),l.ALo(22,"translate"),l.qZA(),l.TgZ(23,"ion-input",31),l.NdJ("ngModelChange",function(t){l.CHM(n);var e=l.oxw();return e.segmentType[e.typeInputing].data.vaccinated=t}),l.qZA(),l.qZA(),l.qZA(),l.TgZ(24,"ion-col",30),l.TgZ(25,"ion-item"),l.TgZ(26,"ion-label",25),l._uU(27),l.ALo(28,"translate"),l.qZA(),l.TgZ(29,"ion-textarea",32),l.NdJ("ngModelChange",function(t){l.CHM(n);var e=l.oxw();return e.segmentType[e.typeInputing].data.note=t}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&t){var i=l.oxw();l.xp6(6),l.AsE(" ",l.lcZ(7,11,"WEIGHT")," (g/",l.lcZ(8,13,"POND_MOD.ANIMAL"),")"),l.xp6(3),l.Q6J("ngModel",i.segmentType[i.typeInputing].data.weight),l.xp6(4),l.AsE("",l.lcZ(14,15,"POND_MOD.LOSS")," (",l.lcZ(15,17,"POND_MOD.ANIMAL"),")"),l.xp6(3),l.Q6J("ngModel",i.segmentType[i.typeInputing].data.loss),l.xp6(4),l.AsE(" ",l.lcZ(21,19,"LAB_MOD.VACCINATED")," (",l.lcZ(22,21,"POND_MOD.ANIMAL"),")"),l.xp6(3),l.Q6J("ngModel",i.segmentType[i.typeInputing].data.vaccinated),l.xp6(4),l.Oqu(l.lcZ(28,23,"POND_MOD.HEALTH_STATUS")),l.xp6(2),l.Q6J("ngModel",i.segmentType[i.typeInputing].data.note)}}var A,v=((A=function(){function e(t,n,i,s,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.modalCtrl=t,this.translate=n,this.toastService=i,this.pondService=s,this.cd=l,this.segmentType={antibiotic:{label:this.translate.instant("LAB_MOD.ANTIBIOTIC"),data:[],options:[]},bacteria:{label:this.translate.instant("LAB_MOD.BACTERIA"),data:[],options:[]},parasites:{label:this.translate.instant("LAB_MOD.PARASITES"),data:[],options:[]},disease:{label:this.translate.instant("LAB_MOD.DISEASE"),data:[],options:[]},health:{label:this.translate.instant("POND_MOD.HEALTH"),data:{loss:"",weight:"",note:""},options:[]}},this.loadingFlag=new o.E,this.savingFlag=new o.E,this.dateRangeSelected=a().format("YYYY-MM-DD"),this.maxDate=a(),this.minDate=a().subtract(180,"days"),this.isEmpty=!0}var n,i,s;return n=e,(i=[{key:"ngOnInit",value:function(){this.dateRangeSelected=this.time.format("YYYY-MM-DD"),this.typeInputing=this.tab,this.getListOptions(),this.getData()}},{key:"save",value:function(){var t=this,e={date:this.dateRangeSelected,antibiotic:this.segmentType.antibiotic.data,bacteria:this.segmentType.bacteria.data,parasites:this.segmentType.parasites.data,disease:this.segmentType.disease.data,health:this.segmentType.health.data};this.savingFlag.setPending(!0),this.pondService.addDailyLab(e).subscribe(function(n){t.savingFlag.setResult(!0),1==+n.status?(t.processOption(n.data),t.toastService.success(t.translate.instant("WALL.UPDATE_SUCCESS")),t.modalCtrl.dismiss(e)):t.toastService.warning(n.warning)},function(){t.savingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"getListOptions",value:function(){var t=this;this.pondService.loadLabOptions().subscribe(function(e){1==+e.status?t.processOption(e.data):t.toastService.warning(e.warning)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"processOption",value:function(t){for(var e in t)this.segmentType[e]&&(this.segmentType[e].options=t[e])}},{key:"changeDate",value:function(t){var e=a(this.dateRangeSelected).add(t,"days");this.dateRangeSelected=e.format("YYYY-MM-DD")}},{key:"onChangeDate",value:function(t){this.dateRangeSelected=t.detail.value,console.log(this.dateRangeSelected),this.getData()}},{key:"closeModal",value:function(){this.modalCtrl.dismiss()}},{key:"getData",value:function(){var t=this;this.loadingFlag.setPending(!0),this.pondService.loadDailyLab(this.dateRangeSelected).subscribe(function(e){1==+e.status?(t.processData(e.data.record),t.cd.detectChanges()):t.toastService.warning(e.warning),t.loadingFlag.setResult(!0)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT")),t.loadingFlag.setResult(!1)})}},{key:"processData",value:function(t){for(var e in this.resetData(),t)"health"!=e&&this.segmentType[e]?this.segmentType[e].data=t[e]:"health"==e&&(this.segmentType[e].data={loss:t[e]?this.filterHealth(t[e],"loss"):"",weight:t[e]?this.filterHealth(t[e],"weight"):"",note:t[e]?this.filterHealth(t[e],"note"):"",vaccinated:t[e]?this.filterHealth(t[e],"vaccinated"):""});this.checkEmpty()}},{key:"resetData",value:function(){var t=this;["antibiotic","bacteria","parasites","disease"].forEach(function(e){t.segmentType[e].data=[]}),this.segmentType.health.data={loss:"",weight:"",note:"",vaccinated:""}}},{key:"removeRow",value:function(t){this.segmentType[this.typeInputing].data.splice(t,1),this.checkEmpty()}},{key:"addRow",value:function(){this.segmentType[this.typeInputing].data.push({key:"",value:"antibiotic"==this.typeInputing?"":1}),this.checkEmpty()}},{key:"filterHealth",value:function(t,e){var n=t.find(function(t){return t.key==e});return n?n.value:""}},{key:"checkEmpty",value:function(){var t=this;this.isEmpty=!1;var e=function(e){"health"!=e&&t.segmentType[e].data.forEach(function(n){if(t.segmentType[e].data.filter(function(t){return t.key==n.key}).length>1)return console.log(n),void(t.isEmpty=!0);n.value&&n.key||(t.isEmpty=!0)})};for(var n in this.segmentType)e(n);console.log(this.isEmpty)}}])&&t(n.prototype,i),s&&t(n,s),e}()).\u0275fac=function(t){return new(t||A)(l.Y36(c.IN),l.Y36(g.sK),l.Y36(r.k),l.Y36(s.p),l.Y36(l.sBO))},A.\u0275cmp=l.Xpm({type:A,selectors:[["app-daily-lab-update"]],inputs:{tab:"tab",time:"time",data:"data"},decls:32,vars:22,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"],["size","2"],["fill","clear",3,"disabled","click"],["slot","icon-only","name","arrow-back"],["size","8"],[1,"ion-text-center","w-100",3,"displayFormat","min","max","value","ionChange"],["slot","icon-only","name","arrow-forward"],["mode","ios",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["name","dots"],[3,"value"],["class","align-items-center ion-justify-content-center",4,"ngFor","ngForOf"],["shape","round","fill","outline","size","small","color","primary",3,"click"],["name","add","slot","start"],[1,"align-items-center","ion-justify-content-center"],["fill","clear","color","medium",3,"click"],["name","remove-circle-outline","slot","icon-only"],["size","6"],["position","floating"],["okText","Okay","cancelText","Dismiss",3,"ngModel","ngModelChange","ionChange"],["size","4",4,"ngIf"],["size","4"],["type","tel","inputmode","decimal",3,"ngModel","ngModelChange","ionChange"],["size","12"],["type","tel","inputmode","decimal",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l.TgZ(3,"ion-button",1),l.NdJ("click",function(){return e.closeModal()}),l._UZ(4,"ion-icon",2),l.qZA(),l.qZA(),l.TgZ(5,"ion-title"),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.TgZ(8,"ion-buttons",3),l.TgZ(9,"ion-button",4),l.NdJ("click",function(){return e.save()}),l._uU(10),l.ALo(11,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(12,"ion-content"),l.YNc(13,p,2,0,"div",5),l.TgZ(14,"div",6),l.TgZ(15,"ion-grid"),l.TgZ(16,"ion-row"),l.TgZ(17,"ion-col",7),l.TgZ(18,"ion-button",8),l.NdJ("click",function(){return e.changeDate(-1)}),l._UZ(19,"ion-icon",9),l.qZA(),l.qZA(),l.TgZ(20,"ion-col",10),l.TgZ(21,"ion-item",6),l.TgZ(22,"ion-datetime",11),l.NdJ("ionChange",function(t){return e.onChangeDate(t)}),l.ALo(23,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(24,"ion-col",7),l.TgZ(25,"ion-button",8),l.NdJ("click",function(){return e.changeDate(1)}),l._UZ(26,"ion-icon",12),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(27,"ion-segment",13),l.NdJ("ngModelChange",function(t){return e.typeInputing=t}),l.YNc(28,h,3,2,"ion-segment-button",14),l.ALo(29,"keyvalue"),l.qZA(),l.YNc(30,y,8,4,"div",15),l.YNc(31,T,30,25,"div",15),l.qZA()),2&t&&(l.xp6(6),l.hij(" ",l.lcZ(7,14,"POND_MOD.LAB_DAILY_RECORD"),""),l.xp6(3),l.Q6J("disabled",e.savingFlag.pending||e.isEmpty),l.xp6(1),l.hij(" ",l.lcZ(11,16,"SAVE")," "),l.xp6(3),l.Q6J("ngIf",e.loadingFlag.pending),l.xp6(5),l.Q6J("disabled",e.dateRangeSelected<=e.minDate.format("YYYY-MM-DD")),l.xp6(4),l.Q6J("displayFormat",l.lcZ(23,18,"FORMAT_DATE_MOMENT"))("min",e.minDate.format("YYYY-MM-DD"))("max",e.maxDate.format("YYYY-MM-DD"))("value",e.dateRangeSelected),l.xp6(3),l.Q6J("disabled",e.dateRangeSelected>=e.maxDate.format("YYYY-MM-DD")),l.xp6(2),l.Q6J("ngModel",e.typeInputing),l.xp6(1),l.Q6J("ngForOf",l.lcZ(29,20,e.segmentType)),l.xp6(2),l.Q6J("ngIf","health"!=e.typeInputing),l.xp6(1),l.Q6J("ngIf","health"==e.typeInputing))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,u.O5,c.jY,c.Nd,c.wI,c.Ie,c.x4,c.QI,c.cJ,d.JJ,d.On,u.sg,c.PQ,c.GO,c.Q$,c.t9,c.n0,c.pK,c.j9,c.g2],pipes:[g.X$,u.Nd],styles:[""]}),A)}}])}();