!function(){"use strict";function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,o=i(e);if(t){var a=i(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return n(this,r)}}function n(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[7096],{54395:function(n,i,o){o.d(i,{b:function(){return l}});var s=o(77393),c=o(33637);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.P;return function(n){return n.lift(new u(e,t))}}var u=function(){function e(t,n){r(this,e),this.dueTime=t,this.scheduler=n}return a(e,[{key:"call",value:function(e,t){return t.subscribe(new d(e,this.dueTime,this.scheduler))}}]),e}(),d=function(n){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(o,n);var i=t(o);function o(e,t,n){var a;return r(this,o),(a=i.call(this,e)).dueTime=t,a.scheduler=n,a.debouncedSubscription=null,a.lastValue=null,a.hasValue=!1,a}return a(o,[{key:"_next",value:function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(f,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}},{key:"clearDebounce",value:function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}]),o}(s.L);function f(e){e.debouncedNext()}},73473:function(e,t,n){n.d(t,{l:function(){return s}});var i,o=n(37716),s=((i=function(){function e(t){r(this,e),this.el=t,this.permissionsCanShow=[],this.el.nativeElement.style.visibility="hidden",this.el.nativeElement.style.display="none"}return a(e,[{key:"PermissionsShow",set:function(e){this.permissionsCanShow=e}},{key:"CurrentPermisson",set:function(e){this.currentPermission=e,this.setShow()}},{key:"PermissionAction",set:function(e){this.currentPermission=e,this.setPointEvents()}},{key:"ngOnInit",value:function(){}},{key:"setShow",value:function(){this.permissionsCanShow.includes(this.currentPermission)?(this.el.nativeElement.style.visibility="visible",this.el.nativeElement.style.display="block"):(this.el.nativeElement.style.visibility="hidden",this.el.nativeElement.style.display="none")}},{key:"setPointEvents",value:function(){this.el.nativeElement.style.visibility="visible",this.el.nativeElement.style.display="block",this.el.nativeElement.style["pointer-events"]=this.permissionsCanShow.includes(this.currentPermission)?"visible":"none"}}]),e}()).\u0275fac=function(e){return new(e||i)(o.Y36(o.SBq))},i.\u0275dir=o.lG2({type:i,selectors:[["","appPermission",""]],inputs:{PermissionsShow:["appPermission","PermissionsShow"],CurrentPermisson:["currentPermission","CurrentPermisson"],PermissionAction:["permissionAction","PermissionAction"]}}),i)},7096:function(e,t,n){n.r(t),n.d(t,{FarmPageModule:function(){return Fe}});var i=n(38583),o=n(90665),s=n(13619),c=n(47063),l=n(64762),u=n(27887),d=n(51937),f=n(79765),m=n(25917),p=n(54395),g=n(87519),v=n(43190),Z=n(66341),h=n(37716),A=n(84465),_=n(81780);function T(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",8),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h3"),h._uU(5),h.TgZ(6,"span",9),h._uU(7),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-button",10),h.NdJ("click",function(){var e=h.CHM(n).index;return h.oxw().presentRemoveUser(e)}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,r=h.oxw();h.xp6(5),h.hij("",i.user_name," - "),h.xp6(2),h.Oqu(r.permissions[i.key]),h.xp6(2),h.hij(" ",h.lcZ(10,3,"FARM_MOD.DELETE")," ")}}function q(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",11),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h3"),h._uU(5),h.qZA(),h.TgZ(6,"p"),h._uU(7),h.qZA(),h.qZA(),h.TgZ(8,"ion-button",12),h.NdJ("click",function(){var e=h.CHM(n).$implicit;return h.oxw().presentAddUser(e)}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA()}if(2&e){var i=t.$implicit,r=h.oxw();h.xp6(2),h.Q6J("src",r.memberService.getSitePath()+"/upload/users/avatars/medium/"+i.photo,h.LSH),h.xp6(3),h.Oqu(i.username),h.xp6(2),h.Oqu(i.email),h.xp6(1),h.Q6J("disabled",r.checkExistUser(i)),h.xp6(1),h.hij(" ",h.lcZ(10,5,"FARM_MOD.SELECT")," ")}}function x(e,t){if(1&e&&(h.TgZ(0,"ion-item",13),h.TgZ(1,"ion-label"),h.TgZ(2,"p"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(3),h.Oqu(n.message)}}function O(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",14),h.qZA())}var b,M=((b=function(){function e(t,n,i,o,a,s){r(this,e),this.modalController=t,this.farmService=n,this.memberService=i,this.toastService=o,this.translate=a,this.alertController=s,this.savingFlag=new u.E,this.loadingFlag=new u.E,this.searchTerms=new f.xQ}return a(e,[{key:"ngOnInit",value:function(){var e=this,t=this.searchTerms.pipe((0,p.b)(300),(0,g.x)(),(0,v.w)(function(t){return e.getListMember(t)}));this.members$=t,this.members$.subscribe(function(t){t?(e.loadingFlag.setResult(!0),e.message=""):(e.loadingFlag.setResult(!1),e.message=e.translate.instant("FARM_MOD.NOT_FOUND"))}),this.permissions={farm_manager:this.translate.instant("FARM_MOD.FARM_MANAGER"),farm_operation:this.translate.instant("FARM_MOD.FARM_OPERATION"),store_manager:this.translate.instant("FARM_MOD.STORE_MANAGER"),keeper_manager:this.translate.instant("FARM_MOD.KEEPER_MANAGER")}}},{key:"search",value:function(e){this.searchTerms.next(e.detail.value)}},{key:"getListMember",value:function(e){return this.loadingFlag.setPending(!0),e.trim()?this.memberService.searchMember(e).pipe():(this.loadingFlag.setResult(!0),(0,m.of)([]))}},{key:"onSelect",value:function(e){this.memberSelected=e}},{key:"addPermission",value:function(e,t){var n=this;this.farmService.updatePrivate({user_manager:e.user_id,fid:this.farmService.farm.id,position:t}).pipe().subscribe(function(i){0==i.status?n.toastService.warning(i.error):(n.manager.push({user_name:e.username,user_id:e.user_id,key:t}),n.toastService.success(n.translate.instant("FARM_MOD.ADDED_STAFF"))),n.savingFlag.setResult(!0)},function(e){n.savingFlag.setResult(!1),n.toastService.danger(n.translate.instant("ERROR_CONNECT"))})}},{key:"removePermission",value:function(e){var t=this;this.farmService.removePermission(this.manager[e].user_id,this.manager[e].key).pipe().subscribe(function(n){0==n.status?t.toastService.warning(n.error):(t.manager.splice(e,1),t.toastService.success(t.translate.instant("FARM_MOD.REMOVED_STAFF"))),t.savingFlag.setResult(!0)},function(e){t.savingFlag.setResult(!1),t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"presentRemoveUser",value:function(e){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_REMOVE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){n.removePermission(e)}}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}},{key:"presentAddUser",value:function(e){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i in n=[],this.permissions)n.push({name:this.permissions[i],type:"radio",value:i,label:this.permissions[i],checked:!1});return n[0].checked=!0,t.next=5,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_ADD"),inputs:n,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(t){r.addPermission(e,t)}}]});case 5:return t.next=7,t.sent.present();case 7:case"end":return t.stop()}},t,this)}))}},{key:"close",value:function(){this.modalController.dismiss(this.manager)}},{key:"checkExistUser",value:function(e){for(var t=0;t<this.manager.length;t++)if(this.manager[t].user_name==e.username)return!0;return!1}}]),e}()).\u0275fac=function(e){return new(e||b)(h.Y36(c.IN),h.Y36(d.D),h.Y36(Z.n),h.Y36(A.k),h.Y36(_.sK),h.Y36(c.Br))},b.\u0275cmp=h.Xpm({type:b,selectors:[["app-farm-select-manager"]],inputs:{manager:"manager"},decls:22,vars:13,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"placeholder","ionChange"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],[4,"ngIf"],["src","assets/img/default-profile.jpg"],[2,"color","red"],["slot","end","color","danger",3,"click"],["onError","this.src='assets/img/default-profile.jpg'",3,"src"],["slot","end",3,"disabled","click"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.close()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"ion-searchbar",3),h.NdJ("ionChange",function(e){return t.search(e)}),h.qZA(),h.TgZ(10,"ion-list"),h.YNc(11,T,11,5,"ion-item",4),h.qZA(),h.TgZ(12,"ion-list"),h.TgZ(13,"ion-list-header"),h.TgZ(14,"ion-label"),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.qZA(),h.YNc(17,q,11,7,"ion-item",4),h.ALo(18,"async"),h.YNc(19,x,4,1,"ion-item",5),h.qZA(),h.TgZ(20,"div",6),h.YNc(21,O,2,0,"div",7),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,7,"FARM_MOD.MANAGER")),h.xp6(3),h.Q6J("placeholder",t.translate.instant("FARM_MOD.MANAGER_EMAIL")),h.xp6(2),h.Q6J("ngForOf",t.manager),h.xp6(4),h.Oqu(h.lcZ(16,9,"FARM_MOD.RESULT")),h.xp6(2),h.Q6J("ngForOf",h.lcZ(18,11,t.members$)),h.xp6(2),h.Q6J("ngIf",t.message),h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,c.VI,c.j9,c.q_,i.sg,c.yh,c.Q$,i.O5,c.Ie,c.BJ,c.PQ],pipes:[_.X$,i.Ov],styles:[""]}),b),S=n(71239);function R(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",11),h.qZA())}var y=function(){var e=function(){function e(t,n,i,o,a){r(this,e),this.modalController=t,this.farmService=n,this.toastService=i,this.translate=o,this.dblocalService=a,this.savingFlag=new u.E,this.viewModeCode=0}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.indexFarm=this.dblocalService.farms.findIndex(function(t){return t.infor.code===e.farmService.fcode})}},{key:"selected",value:function(e){this.viewModeCode=e.detail.value}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0),this.farmService.updatePrivate({public:this.viewModeCode,fid:this.farmService.farm.id}).pipe().subscribe(function(t){0==t.status?e.toastService.warning(t.error):(e.farmService.farm.public=e.viewModeCode,e.dblocalService.farms[e.indexFarm].infor.public=e.viewModeCode,e.dblocalService.setLocalData("farms",e.dblocalService.farms),e.toastService.success(t.message)),e.savingFlag.setResult(!0),e.modalController.dismiss()},function(t){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(c.IN),h.Y36(d.D),h.Y36(A.k),h.Y36(_.sK),h.Y36(S.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-farm-view-mode"]],decls:50,vars:31,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[1,"ion-padding","ion-text-center"],[4,"ngIf"],[3,"value","ionChange"],["slot","start","value","3"],["slot","start","value","2"],["slot","start","value","1"],["name","dots"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content"),h.TgZ(13,"div",5),h.TgZ(14,"h1"),h._uU(15),h.qZA(),h.YNc(16,R,2,0,"div",6),h.qZA(),h.TgZ(17,"ion-list"),h.TgZ(18,"ion-radio-group",7),h.NdJ("ionChange",function(e){return t.selected(e)}),h.TgZ(19,"ion-list-header"),h.TgZ(20,"ion-label"),h._uU(21),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.TgZ(23,"ion-item"),h.TgZ(24,"ion-label"),h.TgZ(25,"h3"),h._uU(26),h.ALo(27,"translate"),h.qZA(),h.TgZ(28,"p"),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.qZA(),h._UZ(31,"ion-radio",8),h.qZA(),h.TgZ(32,"ion-item"),h.TgZ(33,"ion-label"),h.TgZ(34,"h3"),h._uU(35),h.ALo(36,"translate"),h.qZA(),h.TgZ(37,"p"),h._uU(38),h.ALo(39,"translate"),h.qZA(),h.qZA(),h._UZ(40,"ion-radio",9),h.qZA(),h.TgZ(41,"ion-item"),h.TgZ(42,"ion-label"),h.TgZ(43,"h3"),h._uU(44),h.ALo(45,"translate"),h.qZA(),h.TgZ(46,"p"),h._uU(47),h.ALo(48,"translate"),h.qZA(),h.qZA(),h._UZ(49,"ion-radio",10),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,13,"FARM_MOD.PRIVATE")),h.xp6(3),h.Q6J("disabled",t.savingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(11,15,"FARM_MOD.SAVE")),h.xp6(5),h.Oqu(t.farmService.farm.name),h.xp6(1),h.Q6J("ngIf",t.savingFlag.pending),h.xp6(2),h.Q6J("value",t.farmService.farm.public),h.xp6(3),h.Oqu(h.lcZ(22,17,"FARM_MOD.WHO_SEE")),h.xp6(5),h.Oqu(h.lcZ(27,19,"FARM_MOD.PUPLIC")),h.xp6(3),h.Oqu(h.lcZ(30,21,"FARM_MOD.ANYONE")),h.xp6(6),h.Oqu(h.lcZ(36,23,"FARM_MOD.FOLLOW")),h.xp6(3),h.Oqu(h.lcZ(39,25,"FARM_MOD.RULE_FOLLOW")),h.xp6(6),h.Oqu(h.lcZ(45,27,"FARM_MOD.PRIVATE")),h.xp6(3),h.Oqu(h.lcZ(48,29,"FARM_MOD.RULE_PRIVATE")))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,i.O5,c.q_,c.se,c.QI,c.yh,c.Q$,c.Ie,c.B7,c.U5,c.PQ],pipes:[_.X$],styles:[""]}),e}(),k=n(87152);function C(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",18),h.qZA())}function E(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",21),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.id),h.xp6(1),h.Oqu(n.name)}}function N(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",8),h.TgZ(1,"ion-label",9),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-select",19),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().changeProvince(e)}),h.YNc(5,E,2,2,"ion-select-option",20),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"PROVINCE")),h.xp6(3),h.Q6J("ngForOf",i.listProvince)}}function F(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",21),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.id),h.xp6(1),h.Oqu(n.name)}}function w(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-item",8),h.TgZ(1,"ion-label",9),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-select",22),h.NdJ("ionChange",function(e){return h.CHM(n),h.oxw().changeDistrict(e)}),h.YNc(5,F,2,2,"ion-select-option",20),h.qZA(),h.qZA()}if(2&e){var i=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"DISTRICT")),h.xp6(3),h.Q6J("ngForOf",i.listDistrict)}}function L(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",21),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.id),h.xp6(1),h.Oqu(n.name)}}function U(e,t){if(1&e&&(h.TgZ(0,"ion-item",8),h.TgZ(1,"ion-label",9),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-select",23),h.YNc(5,L,2,2,"ion-select-option",20),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"WARDS")),h.xp6(3),h.Q6J("ngForOf",n.listWards)}}function P(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",21),h._uU(1),h.qZA()),2&e){var n=t.$implicit;h.Q6J("value",n.species_id),h.xp6(1),h.Oqu(n.name)}}function D(e,t){if(1&e&&(h.TgZ(0,"ion-item",8),h.TgZ(1,"ion-label",24),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-select",25),h.YNc(5,P,2,2,"ion-select-option",20),h.qZA(),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,2,"FARM_MOD.SPECIES")),h.xp6(3),h.Q6J("ngForOf",n.species)}}var I=function(){var e=function(){function e(t,n,i,a,s,c,l){r(this,e),this._formBuilder=t,this.farmService=n,this.modalController=i,this.toastService=a,this.translate=s,this.geolocation=c,this.dbLocalService=l,this.savingFlag=new u.E,this.form=new o.cw({name:new o.NI(["",o.kI.required]),address:new o.NI(["",[o.kI.required,o.kI.minLength(5)]]),area:new o.NI(["",o.kI.required]),species_id:new o.NI(["",o.kI.required]),longitude:new o.NI([""]),latitude:new o.NI([""]),province:new o.NI([""]),district:new o.NI([""]),wards:new o.NI([""])}),this.species=[]}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.data=this.farmService.farm,this.indexFarm=this.dbLocalService.farms.findIndex(function(t){return t.infor.code===e.farmService.fcode}),this.getSpecies(),this.createForm(),this.getListProvince(0),this.getListDistrict(this.data.province_id),this.getListWards(this.data.district_id)}},{key:"createForm",value:function(){this.form.setValue({name:this.data.name,address:this.data.address,area:this.data.area,species_id:this.data.species_id,longitude:this.data.longitude,latitude:this.data.latitude,province:this.data.province_id,district:this.data.district_id,wards:this.data.wards_id})}},{key:"getSpecies",value:function(){var e=this;this.farmService.getSpecies().subscribe(function(t){t.error||1!=t.status?e.toastService.warning(t.error):(e.species=t.data,e.form.patchValue({species_id:e.data.species_id}))},function(t){e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"getListProvince",value:function(e){var t=this;this.farmService.listAddress(e).subscribe(function(e){1==e.status?t.listProvince=e.data:t.toastService.warning(e.error)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"getListDistrict",value:function(e){var t=this;this.farmService.listAddress(e).subscribe(function(e){1==e.status?t.listDistrict=e.data:t.toastService.warning(e.error)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"getListWards",value:function(e){var t=this;this.farmService.listAddress(e).subscribe(function(e){1==e.status?t.listWards=e.data:t.toastService.warning(e.error)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}},{key:"changeProvince",value:function(e){var t=e.detail.value;this.listDistrict=[],this.form.value.district_id=0,this.getListDistrict(t)}},{key:"changeDistrict",value:function(e){var t=e.detail.value;this.listWards=[],this.form.value.wards_id=0,this.getListWards(t)}},{key:"save",value:function(){var e=this;this.savingFlag.setPending(!0),this.farmService.updateFarm(this.form.value).subscribe(function(t){t.error||1!=t.status?e.toastService.warning(t.error):(e.toastService.success(t.message),e.farmService.farm.name=e.form.value.name,e.farmService.farm.address=e.form.value.address,e.farmService.farm.area=e.form.value.area,e.farmService.farm.species_id=e.form.value.species_id,e.farmService.farm.longitude=e.form.value.longitude,e.farmService.farm.latitude=e.form.value.latitude,e.farmService.farm.provice_id=e.form.value.province,e.farmService.farm.district_id=e.form.value.district,e.farmService.farm.wards_id=e.form.value.wards,-1!=e.indexFarm&&(e.dbLocalService.farms[e.indexFarm].infor=e.farmService.farm,e.dbLocalService.setLocalData("farms",e.dbLocalService.farms)),e.modalController.dismiss()),e.savingFlag.setResult(!0)},function(t){e.toastService.warning(e.translate.instant("FARM_MOD.ERROR_SAVE")),e.savingFlag.setResult(!1)})}},{key:"getLocation",value:function(){var e=this;this.geolocation.getCurrentPosition().then(function(t){console.log(t),t.coords.latitude&&t.coords.longitude&&(e.form.controls.latitude.setValue(t.coords.latitude),e.form.controls.longitude.setValue(t.coords.longitude))}).catch(function(){e.toastService.danger(e.translate.instant("COMPANY_MOD.ERROR_LOCATE"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(o.qu),h.Y36(d.D),h.Y36(c.IN),h.Y36(A.k),h.Y36(_.sK),h.Y36(k.b),h.Y36(S.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-farm-edit"]],decls:51,vars:32,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],[3,"disabled","click"],[3,"formGroup"],[1,"ion-padding","ion-text-center"],[4,"ngIf"],["lines","inset"],["position","floating"],["formControlName","name"],["formControlName","address","type","text","inputmode","text"],["lines","inset",4,"ngIf"],["formControlName","area","type","tel","inputmode","decimal"],["formControlName","longitude","type","tel","inputmode","decimal"],["formControlName","latitude","type","tel","inputmode","decimal"],["lines","none"],["slot","end","fill","outline",3,"click"],["name","dots"],["formControlName","province",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","district",3,"ionChange"],["formControlName","wards"],["position","stacked"],["formControlName","species_id"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.save()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content",5),h.TgZ(13,"div",6),h.TgZ(14,"h1"),h._uU(15),h.qZA(),h.YNc(16,C,2,0,"div",7),h.qZA(),h.TgZ(17,"ion-list"),h.TgZ(18,"ion-item",8),h.TgZ(19,"ion-label",9),h._uU(20),h.ALo(21,"translate"),h.qZA(),h._UZ(22,"ion-input",10),h.qZA(),h.TgZ(23,"ion-item",8),h.TgZ(24,"ion-label",9),h._uU(25),h.ALo(26,"translate"),h.qZA(),h._UZ(27,"ion-input",11),h.qZA(),h.YNc(28,N,6,4,"ion-item",12),h.YNc(29,w,6,4,"ion-item",12),h.YNc(30,U,6,4,"ion-item",12),h.TgZ(31,"ion-item",8),h.TgZ(32,"ion-label",9),h._uU(33),h.ALo(34,"translate"),h.qZA(),h._UZ(35,"ion-input",13),h.qZA(),h.YNc(36,D,6,4,"ion-item",12),h.TgZ(37,"ion-item",8),h.TgZ(38,"ion-label",9),h._uU(39),h.ALo(40,"translate"),h.qZA(),h._UZ(41,"ion-input",14),h.qZA(),h.TgZ(42,"ion-item",8),h.TgZ(43,"ion-label",9),h._uU(44),h.ALo(45,"translate"),h.qZA(),h._UZ(46,"ion-input",15),h.qZA(),h.TgZ(47,"ion-item",16),h.TgZ(48,"ion-button",17),h.NdJ("click",function(){return t.getLocation()}),h._uU(49),h.ALo(50,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,16,"FARM_MOD.EDIT")),h.xp6(3),h.Q6J("disabled",t.form.invalid||t.savingFlag.pending),h.xp6(1),h.Oqu(h.lcZ(11,18,"FARM_MOD.SAVE")),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(3),h.Oqu(t.data.name),h.xp6(1),h.Q6J("ngIf",t.savingFlag.pending),h.xp6(4),h.Oqu(h.lcZ(21,20,"FARM_MOD.NAME_FARM")),h.xp6(5),h.Oqu(h.lcZ(26,22,"FARM_MOD.ADDRESS")),h.xp6(3),h.Q6J("ngIf",t.listProvince),h.xp6(1),h.Q6J("ngIf",t.listDistrict),h.xp6(1),h.Q6J("ngIf",t.listWards),h.xp6(3),h.hij("",h.lcZ(34,24,"AREA")," (ha)"),h.xp6(3),h.Q6J("ngIf",t.species.length>0),h.xp6(3),h.Oqu(h.lcZ(40,26,"FARM_MOD.LONG")),h.xp6(5),h.Oqu(h.lcZ(45,28,"FARM_MOD.LAT")),h.xp6(5),h.Oqu(h.lcZ(50,30,"COMPANY_MOD.CURRENT_LOCATE")))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,o.JL,o.sg,i.O5,c.q_,c.Ie,c.Q$,c.pK,c.j9,o.JJ,o.u,c.PQ,c.t9,c.QI,i.sg,c.n0],pipes:[_.X$],styles:[""]}),e}(),Y=n(62014),J=n(16738);function Q(e,t){1&e&&(h.TgZ(0,"div"),h._UZ(1,"ion-spinner",20),h.qZA())}function G(e,t){if(1&e&&(h.TgZ(0,"ion-item",9),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"ion-datetime",21),h.ALo(5,"translate"),h.ALo(6,"translate"),h.qZA()),2&e){var n=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,5,"POND_MOD.SEASON_CREATE_DATE")),h.xp6(2),h.Q6J("displayFormat",h.lcZ(5,7,"FORMAT_DATE_MOMENT"))("placeholder",h.lcZ(6,9,"SELECT_DATE"))("min",n.minDate.format("YYYY-MM-DD"))("max",n.maxDate.format("YYYY-MM-DD"))}}var V=function(){var e=function(){function e(t,n,i,o,a,s){r(this,e),this.modalController=t,this._formBuilder=n,this.farmService=i,this.toastService=o,this.translate=a,this.dbLocalService=s,this.savingFlag=new u.E,this.numberFormatCost=new Y.y(""),this.maxDate=J(),this.minDate=J().subtract(180,"days")}return a(e,[{key:"ngOnInit",value:function(){this.createForm()}},{key:"createForm",value:function(){this.form=this._formBuilder.group({name:["",[o.kI.required,o.kI.maxLength(20)]],area:["",[o.kI.required,o.kI.max(5e4),o.kI.min(0)]],deep:["",[o.kI.required,o.kI.min(0),o.kI.max(10)]],cost:[""],expire:[""],type:["pond",[o.kI.required]],time_start:[J().format("YYYY-MM-DD")]})}},{key:"createPond",value:function(){var e=this;this.form.patchValue({cost:this.numberFormatCost.realValue});var t={fid:this.farmService.farm.id,name:this.form.value.name,area:this.form.value.area,deep:this.form.value.deep,cost:this.form.value.cost,expire:this.form.value.expire,type:this.form.value.type,time_start:J(this.form.value.time_start).valueOf()/1e3};this.savingFlag.setPending(!0),this.farmService.insertOnePond(t).subscribe(function(n){if(n.error)e.toastService.warning(n.error);else{e.toastService.success(e.translate.instant("FARM_MOD.NOTI_CREATE"));var i={infor:{id:0,code:n.data.code,name:t.name,public:1,area:t.area,create_cost:t.cost,deep:t.deep,expire_date:t.expire,add_time:(new Date).getTime(),warning:0,current_season:"",farm_id:e.farmService.farm.id,permission:"farm_manager"},devices:[]};e.dbLocalService.ponds.push(i),e.dbLocalService.setLocalData("ponds",e.dbLocalService.ponds),e.modalController.dismiss(i)}e.savingFlag.setResult(!0)},function(t){e.savingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(c.IN),h.Y36(o.qu),h.Y36(d.D),h.Y36(A.k),h.Y36(_.sK),h.Y36(S.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-create"]],decls:73,vars:54,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["slot","end"],["color","primary",3,"disabled","click"],[3,"formGroup"],[1,"ion-padding","ion-text-center"],[4,"ngIf"],["lines","lines"],["lines","inset"],["position","floating"],["formControlName","name"],["slot","end","formControlName","type","okText","Ok","cancelText","Dismiss",3,"placeholder"],["value","pond"],["value","handle"],["lines","inset",4,"ngIf"],["formControlName","area","type","tel","inputmode","decimal"],["formControlName","deep","type","tel","inputmode","decimal"],["formControlName","cost","type","tel","inputmode","numeric",3,"value","ionChange"],["type","number","inputmode","numeric","formControlName","expire"],["name","dots"],["formControlName","time_start",3,"displayFormat","placeholder","min","max"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",3),h.TgZ(9,"ion-button",4),h.NdJ("click",function(){return t.createPond()}),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content",5),h.TgZ(13,"div",6),h.TgZ(14,"h1"),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.YNc(17,Q,2,0,"div",7),h.qZA(),h.TgZ(18,"ion-list",8),h.TgZ(19,"ion-item",9),h.TgZ(20,"ion-label",10),h._uU(21),h.ALo(22,"translate"),h.TgZ(23,"ion-text"),h.TgZ(24,"small"),h._uU(25,"(T\u1eeb 1 \u0111\u1ebfn 7 k\xfd t\u1ef1)"),h.qZA(),h.qZA(),h.qZA(),h._UZ(26,"ion-input",11),h.qZA(),h.TgZ(27,"ion-item",9),h.TgZ(28,"ion-label"),h._uU(29),h.ALo(30,"translate"),h.qZA(),h.TgZ(31,"ion-select",12),h.ALo(32,"translate"),h.TgZ(33,"ion-select-option",13),h._uU(34),h.ALo(35,"translate"),h.qZA(),h.TgZ(36,"ion-select-option",14),h._uU(37),h.ALo(38,"translate"),h.qZA(),h.qZA(),h.qZA(),h.YNc(39,G,7,11,"ion-item",15),h.TgZ(40,"ion-item",9),h.TgZ(41,"ion-label",10),h._uU(42),h.ALo(43,"translate"),h.TgZ(44,"sup"),h._uU(45,"2"),h.qZA(),h._uU(46,")"),h.qZA(),h._UZ(47,"ion-input",16),h.qZA(),h.TgZ(48,"ion-item",9),h.TgZ(49,"ion-label",10),h._uU(50),h.ALo(51,"translate"),h.qZA(),h._UZ(52,"ion-input",17),h.qZA(),h.TgZ(53,"ion-item",9),h.TgZ(54,"ion-label",10),h._uU(55),h.ALo(56,"translate"),h.ALo(57,"translate"),h.qZA(),h.TgZ(58,"ion-input",18),h.NdJ("ionChange",function(e){return t.numberFormatCost.setValue(e.detail.value)}),h.qZA(),h.qZA(),h.TgZ(59,"ion-item",9),h.TgZ(60,"ion-label",10),h._uU(61),h.ALo(62,"translate"),h.qZA(),h._UZ(63,"ion-input",19),h.qZA(),h.TgZ(64,"ion-item",9),h.TgZ(65,"ion-label"),h.TgZ(66,"p"),h._uU(67),h.ALo(68,"translate"),h.ALo(69,"translate"),h.qZA(),h.TgZ(70,"span"),h._uU(71),h.ALo(72,"number"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,21,"FARM_MOD.CREATE")),h.xp6(3),h.Q6J("disabled",t.form.invalid||t.savingFlag.pending),h.xp6(1),h.hij(" ",h.lcZ(11,23,"FARM_MOD.SAVE"),""),h.xp6(2),h.Q6J("formGroup",t.form),h.xp6(3),h.Oqu(h.lcZ(16,25,"FARM_MOD.NEW_POND")),h.xp6(2),h.Q6J("ngIf",t.savingFlag.pending),h.xp6(4),h.hij("",h.lcZ(22,27,"FARM_MOD.NAME_POND")," "),h.xp6(8),h.Oqu(h.lcZ(30,29,"MONEY_MOD.CATEGORY")),h.xp6(2),h.Q6J("placeholder",h.lcZ(32,31,"MONEY_MOD.CATEGORY")),h.xp6(3),h.Oqu(h.lcZ(35,33,"POND_MOD.FARMING")),h.xp6(3),h.Oqu(h.lcZ(38,35,"POND_MOD.WATER_TREAMENT")),h.xp6(2),h.Q6J("ngIf","handle"==t.form.value.type),h.xp6(3),h.hij("",h.lcZ(43,37,"AREA")," (m"),h.xp6(8),h.hij("",h.lcZ(51,39,"FARM_MOD.DEPTH")," (m)"),h.xp6(5),h.AsE("",h.lcZ(56,41,"FARM_MOD.COST")," (",h.lcZ(57,43,"CURRENCY_S"),")"),h.xp6(3),h.Q6J("value",t.numberFormatCost.fakeView),h.xp6(3),h.Oqu(h.lcZ(62,45,"FARM_MOD.NUM_SEASON")),h.xp6(6),h.AsE("",h.lcZ(68,47,"FARM_MOD.NUM_CROP")," (",h.lcZ(69,49,"CURRENCY_S"),")"),h.xp6(4),h.Oqu(h.xi3(72,51,t.numberFormatCost.realValue/t.form.value.expire,"1.0-0")))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,o.JL,o.sg,i.O5,c.q_,c.Ie,c.Q$,c.yW,c.pK,c.j9,o.JJ,o.u,c.t9,c.QI,c.n0,c.as,c.PQ,c.x4],pipes:[_.X$,i.JJ],styles:[""]}),e}();function j(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"FARM_MOD.PEOPLE_CAN_SEE")))}function H(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"FARM_MOD.ONLY_FOLLOWER")))}function $(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"FARM_MOD.ONLY_MANAGERS")))}var W=function(){var e=function(){function e(t,n){r(this,e),this.modalController=t,this.farmService=n,this.manager=[]}return a(e,[{key:"ngOnInit",value:function(){this.loadSetting()}},{key:"loadSetting",value:function(){var e=this;this.farmService.getSeting().pipe().subscribe(function(t){1==t.status&&("farm_manager"in t.data.manager&&t.data.manager.farm_manager.forEach(function(t){t.key="farm_manager",e.manager.push(t)}),"farm_operation"in t.data.manager&&t.data.manager.farm_operation.forEach(function(t){t.key="farm_operation",e.manager.push(t)}),"store_manager"in t.data.manager&&t.data.manager.store_manager.forEach(function(t){t.key="store_manager",e.manager.push(t)}),"keeper_manager"in t.data.manager&&t.data.manager.keeper_manager.forEach(function(t){t.key="keeper_manager",e.manager.push(t)}))})}},{key:"presentManager",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:M,componentProps:{manager:this.manager}});case 2:return(t=e.sent).onDidDismiss().then(function(e){e.data&&(n.manager=e.data)}),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))}},{key:"presentEdit",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:I});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentViewMode",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:y});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentPondCreate",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.modalController.dismiss(),e.next=3,this.modalController.create({component:V});case 3:return e.next=5,e.sent.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(c.IN),h.Y36(d.D))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-farm-info"]],decls:75,vars:43,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding","ion-text-center"],[1,""],["src","assets/icon/adress.svg","slot","start"],["src","assets/icon/select.svg","slot","start"],["src","assets/icon/location_on-24px.svg","slot","start"],["detail","",3,"click"],["src","assets/icon/remove_red_eye-24px.svg","slot","start"],[4,"ngIf"],["src","assets/icon/supervised_user_circle-24px.svg","slot","start"],["mode","ios"],["name","options"],["size","large","expand","block","shape","round","fill","outline",3,"click"],["name","create-outline","slot","start"],["name","add-circle-outline","slot","start"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.modalController.dismiss()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title"),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(8,"ion-content"),h.TgZ(9,"div",3),h.TgZ(10,"h1",4),h._uU(11),h.qZA(),h.TgZ(12,"span"),h._uU(13),h.qZA(),h.qZA(),h.TgZ(14,"ion-list"),h.TgZ(15,"ion-item"),h._UZ(16,"ion-icon",5),h.TgZ(17,"ion-label"),h.TgZ(18,"h3"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.TgZ(21,"p"),h._uU(22),h.qZA(),h.qZA(),h.qZA(),h.TgZ(23,"ion-item"),h._UZ(24,"ion-icon",6),h.TgZ(25,"ion-label"),h.TgZ(26,"h3"),h._uU(27),h.ALo(28,"translate"),h.qZA(),h.TgZ(29,"p"),h._uU(30),h.ALo(31,"number"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(32,"ion-item"),h._UZ(33,"ion-icon",7),h.TgZ(34,"ion-label"),h.TgZ(35,"h3"),h._uU(36),h.ALo(37,"translate"),h.qZA(),h.TgZ(38,"p"),h._uU(39),h.qZA(),h.qZA(),h.qZA(),h.TgZ(40,"ion-item",8),h.NdJ("click",function(){return t.presentViewMode()}),h._UZ(41,"ion-icon",9),h.TgZ(42,"ion-label"),h.TgZ(43,"h3"),h._uU(44),h.ALo(45,"translate"),h.qZA(),h.TgZ(46,"p"),h.YNc(47,j,3,3,"span",10),h.YNc(48,H,3,3,"span",10),h.YNc(49,$,3,3,"span",10),h.qZA(),h.qZA(),h.qZA(),h.TgZ(50,"ion-item",8),h.NdJ("click",function(){return t.presentManager()}),h._UZ(51,"ion-icon",11),h.TgZ(52,"ion-label"),h.TgZ(53,"h3"),h._uU(54),h.ALo(55,"translate"),h.qZA(),h.TgZ(56,"p"),h._uU(57),h.ALo(58,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(59,"div"),h.TgZ(60,"ion-card",12),h.TgZ(61,"ion-card-header"),h.TgZ(62,"ion-card-subtitle"),h._UZ(63,"ion-icon",13),h._uU(64),h.ALo(65,"translate"),h.qZA(),h.qZA(),h.TgZ(66,"ion-card-content"),h.TgZ(67,"ion-button",14),h.NdJ("click",function(){return t.presentEdit()}),h._UZ(68,"ion-icon",15),h._uU(69),h.ALo(70,"translate"),h.qZA(),h.TgZ(71,"ion-button",14),h.NdJ("click",function(){return t.presentPondCreate()}),h._UZ(72,"ion-icon",16),h._uU(73),h.ALo(74,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Oqu(h.lcZ(7,20,"FARM_MOD.FARM_INFO")),h.xp6(5),h.Oqu(t.farmService.farm.name),h.xp6(2),h.hij("#",t.farmService.farm.code,""),h.xp6(6),h.Oqu(h.lcZ(20,22,"FARM_MOD.ADDRESS")),h.xp6(3),h.Oqu(t.farmService.farm.address),h.xp6(5),h.Oqu(h.lcZ(28,24,"AREA")),h.xp6(3),h.hij("",h.xi3(31,26,t.farmService.farm.area,"1.0-0")," ha"),h.xp6(6),h.Oqu(h.lcZ(37,29,"FARM_MOD.LOCATE")),h.xp6(3),h.AsE("",t.farmService.farm.longitude," : ",t.farmService.farm.latitude,""),h.xp6(5),h.Oqu(h.lcZ(45,31,"FARM_MOD.DISPLAY")),h.xp6(3),h.Q6J("ngIf",3==t.farmService.farm.public),h.xp6(1),h.Q6J("ngIf",2==t.farmService.farm.public),h.xp6(1),h.Q6J("ngIf",1==t.farmService.farm.public),h.xp6(5),h.Oqu(h.lcZ(55,33,"FARM_MOD.MANAGER")),h.xp6(3),h.AsE("",null==t.manager?null:t.manager.length," ",h.lcZ(58,35,"FARM_MOD.MEMBER"),""),h.xp6(7),h.hij(" ",h.lcZ(65,37,"FARM_MOD.CONFIG")," "),h.xp6(5),h.hij(" ",h.lcZ(70,39,"FARM_MOD.EDIT")," "),h.xp6(4),h.hij(" ",h.lcZ(74,41,"FARM_MOD.CREATE_POND")," "))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,c.q_,c.Ie,c.Q$,i.O5,c.PM,c.Zi,c.tO,c.FN],pipes:[_.X$,i.JJ],styles:[""]}),e}(),B=n(2426),X=n(40044),z=n(23211),K=n(73473),ee=n(75853),te=n(82196);function ne(e,t){1&e&&(h.TgZ(0,"div",8),h._UZ(1,"ion-spinner",9),h.qZA())}function ie(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",10),h.NdJ("click",function(){return h.CHM(n),h.oxw().changeModeView("list")}),h._UZ(1,"ion-icon",11),h.qZA()}}function re(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"ion-button",10),h.NdJ("click",function(){return h.CHM(n),h.oxw().changeModeView("grid")}),h._UZ(1,"ion-icon",12),h.qZA()}}function oe(e,t){if(1&e&&(h.TgZ(0,"div"),h._uU(1),h.ALo(2,"number"),h.TgZ(3,"small"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(3).$implicit,i=h.oxw(3);h.xp6(1),h.hij("",h.xi3(2,2,(i.now-n.infor.start_time)/86400+1,"0.0-0")," "),h.xp6(3),h.Oqu(h.lcZ(5,5,"FARM_MOD.DAY"))}}function ae(e,t){if(1&e&&(h.TgZ(0,"div"),h._uU(1),h.ALo(2,"number"),h.TgZ(3,"small"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(3).$implicit,i=h.oxw(3);h.xp6(1),h.hij("",h.xi3(2,2,(i.now-n.infor.seed_date)/86400+1,"0.0-0")," "),h.xp6(3),h.Oqu(h.lcZ(5,5,"FARM_MOD.OLD_DAY"))}}function se(e,t){if(1&e&&(h.TgZ(0,"ion-card-content"),h.TgZ(1,"div",23),h._uU(2),h.qZA(),h.YNc(3,oe,6,7,"div",7),h.YNc(4,ae,6,7,"div",7),h.qZA()),2&e){var n=h.oxw(2).$implicit;h.xp6(2),h.hij(" ",n.infor.species," "),h.xp6(1),h.Q6J("ngIf",0==n.infor.seed_date),h.xp6(1),h.Q6J("ngIf",n.infor.seed_date>0)}}function ce(e,t){1&e&&(h.TgZ(0,"ion-card-content"),h.TgZ(1,"div",23),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"div"),h._uU(5,"--"),h.qZA(),h.qZA()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"FARM_MOD.EMPTY")," "))}function le(e,t){if(1&e&&(h.TgZ(0,"ion-col",16),h.TgZ(1,"ion-card",20),h.TgZ(2,"ion-card-header",21),h.TgZ(3,"ion-card-title",22),h._uU(4),h.qZA(),h.qZA(),h.YNc(5,se,5,3,"ion-card-content",7),h.YNc(6,ce,6,3,"ion-card-content",7),h.qZA(),h.qZA()),2&e){var n=h.oxw().$implicit;h.xp6(1),h.MGl("routerLink","/pond/",n.infor.code,""),h.xp6(2),h.Q6J("color",0!=n.infor.current_season&&0==n.infor.warning?"primary":0!=n.infor.current_season&&1==n.infor.warning?"danger":"medium"),h.xp6(1),h.hij(" ",n.infor.name,""),h.xp6(1),h.Q6J("ngIf",0!=n.infor.current_season),h.xp6(1),h.Q6J("ngIf",0==n.infor.current_season)}}function ue(e,t){if(1&e&&(h.ynx(0),h.YNc(1,le,7,5,"ion-col",19),h.BQk()),2&e){var n=t.$implicit,i=h.oxw(3);h.xp6(1),h.Q6J("ngIf",!i.isActive||1==i.isActive&&0!=(null==n?null:n.infor.current_season))}}function de(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",14),h.TgZ(1,"ion-grid"),h.TgZ(2,"ion-row"),h.YNc(3,ue,2,1,"ng-container",15),h.TgZ(4,"ion-col",16),h.TgZ(5,"ion-card",17),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).presentPondCreate()}),h.TgZ(6,"ion-card-content"),h._UZ(7,"ion-icon",18),h.TgZ(8,"p"),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var i=h.oxw(2);h.xp6(3),h.Q6J("ngForOf",i.pondListFilter),h.xp6(6),h.Oqu(h.lcZ(10,2,"FARM_MOD.POND_CREATE"))}}function fe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div"),h.TgZ(1,"ion-card",24),h.TgZ(2,"ion-card-content",25),h.TgZ(3,"p",26),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.TgZ(6,"ion-button",27),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).presentPondCreate()}),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()}2&e&&(h.xp6(4),h.Oqu(h.lcZ(5,2,"FARM_MOD.THIS_FARM_HAVE_NOT_POND")),h.xp6(3),h.hij(" ",h.lcZ(8,4,"FARM_MOD.POND_CREATE")," "))}function me(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,de,11,4,"div",13),h.YNc(2,fe,9,6,"div",7),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.farmService.numberOfPonds>0),h.xp6(1),h.Q6J("ngIf",0===n.farmService.numberOfPonds)}}function pe(e,t){if(1&e&&(h.TgZ(0,"ion-text",33),h._uU(1),h.ALo(2,"number"),h.TgZ(3,"small"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2).$implicit,i=h.oxw(3);h.xp6(1),h.hij("",h.xi3(2,2,(i.now-n.infor.start_time)/86400,"0.0-0")," "),h.xp6(3),h.Oqu(h.lcZ(5,5,"FARM_MOD.DAY"))}}function ge(e,t){if(1&e&&(h.TgZ(0,"ion-text",34),h._uU(1),h.ALo(2,"number"),h.TgZ(3,"small"),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA()),2&e){var n=h.oxw(2).$implicit,i=h.oxw(3);h.xp6(1),h.hij("",h.xi3(2,2,(i.now-n.infor.seed_date)/86400,"0.0-0")," "),h.xp6(3),h.Oqu(h.lcZ(5,5,"FARM_MOD.OLD_DAY"))}}function ve(e,t){if(1&e&&(h.TgZ(0,"ion-item",29),h.TgZ(1,"ion-label"),h.TgZ(2,"ion-text",30),h.TgZ(3,"h3"),h._uU(4),h.qZA(),h.qZA(),h.TgZ(5,"p"),h._uU(6),h.qZA(),h.qZA(),h.YNc(7,pe,6,7,"ion-text",31),h.YNc(8,ge,6,7,"ion-text",32),h.qZA()),2&e){var n=h.oxw().$implicit;h.MGl("routerLink","/pond/",n.infor.code,""),h.xp6(2),h.Q6J("color",0!=n.infor.current_season&&0==n.infor.warning?"primary":0!=n.infor.current_season&&1==n.infor.warning?"danger":"medium"),h.xp6(2),h.Oqu(n.infor.name),h.xp6(2),h.Oqu(n.infor.species),h.xp6(1),h.Q6J("ngIf",0==n.infor.seed_date),h.xp6(1),h.Q6J("ngIf",n.infor.seed_date>0)}}function Ze(e,t){if(1&e&&(h.ynx(0),h.YNc(1,ve,9,6,"ion-item",28),h.BQk()),2&e){var n=t.$implicit,i=h.oxw(3);h.xp6(1),h.Q6J("ngIf",!i.isActive||1==i.isActive&&0!=(null==n?null:n.infor.current_season))}}function he(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-list"),h.YNc(2,Ze,2,1,"ng-container",15),h.qZA(),h.qZA()),2&e){var n=h.oxw(2);h.xp6(2),h.Q6J("ngForOf",n.pondListFilter)}}function Ae(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,he,3,1,"div",7),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.farmService.numberOfPonds>0)}}var _e=function(){var e=function(){function e(t,n,i,o,a,s,c,l){r(this,e),this.farmService=t,this.toastService=n,this.modalController=i,this.translate=o,this.alertController=a,this.packageService=s,this.dbLocalService=c,this.settingService=l,this.reloadEvent=new h.vpe,this.loadingFlag=new u.E,this.now=(new Date).valueOf()/1e3,this.pondListFilter=[],this.isActive=!1}return a(e,[{key:"ngOnInit",value:function(){this.getPonds(),this.packageService.check(this.farmService.fcode,"farm")}},{key:"doRefresh",value:function(e){this.getPonds(),e.target.complete()}},{key:"changeModeView",value:function(e){this.settingService.farmModeView=e,this.settingService.settingChange("farmModeView",e)}},{key:"getPonds",value:function(){var e=this;this.loadingFlag.setPending(!0),this.farmService.loadPonds().pipe().subscribe(function(t){if(0==t.status)e.toastService.warning(t.error);else{e.farmService.numberOfPonds=t.data.length,t.data.reverse();var n="";void 0!==t.permission?n=t.permission:(n=e.farmService.permission,console.log(n)),t.data.forEach(function(t){t.permission=n;var i=e.dbLocalService.ponds.findIndex(function(e){return e.infor.code==t.code});i<0?e.dbLocalService.ponds.push({infor:t,devices:[]}):e.dbLocalService.ponds[i]={infor:t,devices:[]}}),e.pondListFilter=e.dbLocalService.filterPond("farm_id",e.farmService.farm.id),e.pondListFilter.sort(function(e,t){return e.infor.name.localeCompare(t.infor.name)}),e.dbLocalService.setLocalData("ponds",e.dbLocalService.ponds)}e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"presentPondCreate",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.packageService.localCheck(this.farmService.fcode,"pond_quantity")){e.next=2;break}return e.abrupt("return",void this.presentAlertPackage());case 2:return e.next=4,this.modalController.create({component:V});case 4:return(t=e.sent).onDidDismiss().then(function(e){e.data&&(n.farmService.numberOfPonds+=1,n.pondListFilter=n.dbLocalService.filterPond("farm_id",n.farmService.farm.id),n.pondListFilter.sort(function(e,t){return e.infor.name.localeCompare(t.infor.name)}))}),e.next=8,t.present();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}))}},{key:"presentAlertPackage",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.packageService.checkIsOwner()){e.next=6;break}return e.next=3,this.alertController.create({header:this.translate.instant("COMPANY_MOD.UPGRADE"),message:this.translate.instant("COMPANY_MOD.YOU_NEED_UPGRADE_TO CREATE"),buttons:[{text:this.translate.instant("CANCEL"),role:"cancel",cssClass:"secondary"},{text:this.translate.instant("OKAY"),handler:function(){n.packageService.goToUpgrade()}}]});case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,this.alertController.create({header:this.translate.instant("COMPANY_MOD.UPGRADE"),message:this.translate.instant("COMPANY_MOD.YOU_NEED_UPGRADE_TO CREATE"),buttons:[{text:this.translate.instant("CANCEL"),role:"cancel",cssClass:"secondary"}]});case 8:e.t0=e.sent;case 9:return t=e.t0,e.next=12,t.present();case 12:case"end":return e.stop()}},e,this)}))}},{key:"filter",value:function(e){var t=e.target.value;this.pondListFilter=this.dbLocalService.filterPond("farm_id",this.farmService.farm.id).filter(function(e){return e.infor.name.toLowerCase().indexOf(t.toLowerCase())>-1}),this.pondListFilter.sort(function(e,t){return e.infor.name.localeCompare(t.infor.name)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(d.D),h.Y36(A.k),h.Y36(c.IN),h.Y36(_.sK),h.Y36(c.Br),h.Y36(ee.M),h.Y36(S.T),h.Y36(te.R))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-pond-list"]],outputs:{reloadEvent:"reloadEvent"},decls:14,vars:12,consts:[["slot","fixed",3,"ionRefresh"],["class","spiner-loading",4,"ngIf"],["lines","none"],["slot","start",3,"ngModel","ngModelChange"],["slot","start"],["slot","end","mode","ios",1,"ion-no-margin",3,"placeholder","ionInput"],["class","ion-no-margin","slot","end","fill","clear","size","small","color","primary",3,"click",4,"ngIf"],[4,"ngIf"],[1,"spiner-loading"],["name","dots"],["slot","end","fill","clear","size","small","color","primary",1,"ion-no-margin",3,"click"],["slot","icon-only","name","list-outline"],["slot","icon-only","name","grid-outline"],["class","list-pond",4,"ngIf"],[1,"list-pond"],[4,"ngFor","ngForOf"],["size","6"],["mode","ios",1,"ion-text-center","ion-text-nowrap","add-pond",3,"click"],["name","add-outline","color","primary"],["size","6",4,"ngIf"],["mode","ios",1,"ion-text-center","ion-text-nowrap",3,"routerLink"],[1,"ion-text-nowrap"],[1,"pond-name",3,"color"],[1,"sm-text"],["mode","ios"],[1,"ion-text-center"],[1,"ion-padding"],["shape","round","color","primary",3,"click"],["detail","",3,"routerLink",4,"ngIf"],["detail","",3,"routerLink"],[3,"color"],["slot","end",4,"ngIf"],["color","primary","slot","end",4,"ngIf"],["slot","end"],["color","primary","slot","end"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-refresher",0),h.NdJ("ionRefresh",function(e){return t.doRefresh(e)}),h._UZ(1,"ion-refresher-content"),h.qZA(),h.YNc(2,ne,2,0,"div",1),h.TgZ(3,"ion-item",2),h.TgZ(4,"ion-toggle",3),h.NdJ("ngModelChange",function(e){return t.isActive=e}),h.qZA(),h.TgZ(5,"span",4),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-searchbar",5),h.NdJ("ionInput",function(e){return t.filter(e)}),h.ALo(9,"translate"),h.qZA(),h.YNc(10,ie,2,0,"ion-button",6),h.YNc(11,re,2,0,"ion-button",6),h.qZA(),h.YNc(12,me,3,2,"div",7),h.YNc(13,Ae,2,1,"div",7)),2&e&&(h.xp6(2),h.Q6J("ngIf",t.loadingFlag.pending),h.xp6(2),h.Q6J("ngModel",t.isActive),h.xp6(2),h.Oqu(h.lcZ(7,8,"POND_MOD.IS_ACTIVE")),h.xp6(2),h.Q6J("placeholder",h.lcZ(9,10,"FARM_MOD.SEARCH")),h.xp6(2),h.Q6J("ngIf","grid"===t.settingService.farmModeView),h.xp6(1),h.Q6J("ngIf","list"===t.settingService.farmModeView),h.xp6(1),h.Q6J("ngIf","grid"==t.settingService.farmModeView),h.xp6(1),h.Q6J("ngIf","list"==t.settingService.farmModeView))},directives:[c.nJ,c.Wo,i.O5,c.Ie,c.ho,c.w,o.JJ,o.On,c.VI,c.j9,c.PQ,c.YG,c.gu,c.jY,c.Nd,i.sg,c.wI,c.PM,c.FN,c.YI,s.rH,c.Zi,c.gZ,c.q_,c.Q$,c.yW],pipes:[_.X$,i.JJ],styles:["[_nghost-%COMP%]   .list-pond[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .list-pond[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{display:flex;justify-content:center;--ion-grid-column-padding-xs: { padding: 1px; } }[_nghost-%COMP%]   .list-pond[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .list-pond[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   .add-pond[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3em}[_nghost-%COMP%]   ion-card-title.pond-name[_ngcontent-%COMP%]{font-size:1.5em;overflow:hidden}"]}),e}();function Te(e,t){1&e&&(h.TgZ(0,"div",24),h._UZ(1,"ion-spinner",25),h.qZA())}function qe(e,t){if(1&e&&(h.TgZ(0,"div"),h.YNc(1,Te,2,0,"div",23),h.qZA()),2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.loadingFlag.pending)}}function xe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"app-pond-list",26),h.NdJ("reloadEvent",function(){return h.CHM(n),h.oxw().getFarm()}),h.qZA()}}function Oe(e,t){if(1&e){var n=h.EpF();h.TgZ(0,"div",27),h.TgZ(1,"ion-button",20),h.NdJ("click",function(){return h.CHM(n),h.oxw().presentConfirmRemoveLab()}),h._UZ(2,"ion-icon",28),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.qZA()}2&e&&(h.xp6(3),h.hij(" ",h.lcZ(4,1,"LAB_MOD.REMOVE_FARM")," "))}var be=function(){return["company_manager","farm_manager"]},Me=function(){return["company_manager","farm_manager","keeper_manager"]},Se=function(){return["company_manager","farm_manager","farm_operation"]},Re=function(){return["company_manager","farm_manager","farm_operation","keeper_manager","store_manager"]},ye=function(){var e=function(){function e(t,n,i,o,a,s,c,l,d,f,m){r(this,e),this.farmService=t,this.toastService=n,this.route=i,this.modalController=o,this.translate=a,this.tour=s,this.menu=c,this.dblocalService=l,this.alertController=d,this.labService=f,this.router=m,this.loadingFlag=new u.E,this.view=!1}return a(e,[{key:"ngOnInit",value:function(){console.log("inite farm"),this.fcode=this.route.snapshot.paramMap.get("id"),this.farmService.setCode(this.fcode),console.log(this.fcode),this.getFarm()}},{key:"ngOnDestroy",value:function(){console.log("destroy farm"),this.farmService.destroyValue()}},{key:"ionViewDidEnter",value:function(){this.view=!0,this.tour.show("farm")}},{key:"findFarm",value:function(){var e=this;return this.dblocalService.farms.find(function(t){return t.infor.code===e.fcode})}},{key:"getFarm",value:function(){var e=this;console.log("vao day"),this.loadingFlag.setPending(!0),this.farmService.loadFarm().pipe().subscribe(function(t){if(0==t.status)e.toastService.warning(t.error);else{var n=t.data;n.permission=t.permission,e.farmService.setFarm(n),e.farmLab=t.farm_lab,console.log(e.farmLab),!e.findFarm()&&!e.farmLab&&e.dblocalService.addItem("farms",{infor:n,store:[]}),e.farmService.permission=t.permission,e.permission=t.permission,e.estimate=t.estimate,e.store=t.store,e.farmService.storeCommon=t.store,t.lab&&(e.labService.setCode(t.lab.lcode),e.lab=t.lab)}e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"presentInfomation",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:W});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentEstimate",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:B.O});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"openList",value:function(){this.menu.enable(!0,"list"),this.menu.close("userMenu"),this.menu.open("list")}},{key:"reLoadFarm",value:function(e){console.log("chay")}},{key:"presentConfirmRemoveLab",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.labService.code),e.next=3,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM"),message:this.translate.instant("LAB_MOD.REMOVE_FARM"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){t.labService.removeFarm(t.fcode).subscribe(function(e){1==e.status?(t.toastService.success(t.translate.instant("LAB_MOD.REMOVE_FARM_SUCCESS")),t.router.navigateByUrl("/tabs/subscription")):t.toastService.warning(e.message)},function(){t.toastService.danger(t.translate.instant("ERROR_CONNECT"))})}}]});case 3:return e.next=5,e.sent.present();case 5:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(d.D),h.Y36(A.k),h.Y36(s.gz),h.Y36(c.IN),h.Y36(_.sK),h.Y36(z.M),h.Y36(c._q),h.Y36(S.T),h.Y36(c.Br),h.Y36(X.y),h.Y36(s.F0))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-farm"]],decls:49,vars:38,consts:[["slot","start"],["text","","defaultHref","tabs/management"],[3,"click"],["slot","end","name","chevron-forward-circle-outline"],["slot","end",3,"appPermission","currentPermission"],["name","stats-chart-outline"],["slot","icon-only","name","cog-outline"],[3,"appPermission","currentPermission"],["mode","ios",1,"menu-icon-square",3,"routerLink"],["color","primary","src","assets/icon/003-accounting.svg",1,"icon-large"],["color","primary","src","assets/icon/004-todolist.svg",1,"icon-large"],["id","line","lines","none",1,"ion-margin"],[1,"ion-margin-end"],["name","home-outline"],["color","primary"],["size","small","color","danger","fill","outline",3,"routerLink"],["color","primary","slot","end"],[4,"ngIf"],[3,"reloadEvent",4,"ngIf"],[1,"ion-padding",3,"appPermission","currentPermission"],["color","medium","expand","block","shape","round","fill","clear",3,"click"],["name","cog-outline","slot","start"],["class","ion-padding",4,"ngIf"],["class","spiner-loading",4,"ngIf"],[1,"spiner-loading"],["name","dots"],[3,"reloadEvent"],[1,"ion-padding"],["name","trash-bin-outline"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-buttons",0),h._UZ(4,"ion-back-button",1),h.qZA(),h.TgZ(5,"ion-button",2),h.NdJ("click",function(){return t.openList()}),h._uU(6),h._UZ(7,"ion-icon",3),h.qZA(),h.qZA(),h.TgZ(8,"ion-buttons",4),h.TgZ(9,"ion-button",2),h.NdJ("click",function(){return t.presentEstimate()}),h._UZ(10,"ion-icon",5),h.qZA(),h.TgZ(11,"ion-button",2),h.NdJ("click",function(){return t.presentInfomation()}),h._UZ(12,"ion-icon",6),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(13,"ion-content"),h.TgZ(14,"div"),h.TgZ(15,"ion-grid"),h.TgZ(16,"ion-row"),h.TgZ(17,"ion-col",7),h.TgZ(18,"ion-card",8),h._UZ(19,"ion-icon",9),h._uU(20),h.ALo(21,"translate"),h.qZA(),h.qZA(),h.TgZ(22,"ion-col",7),h.TgZ(23,"ion-card",8),h._UZ(24,"ion-icon",10),h._uU(25),h.ALo(26,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(27,"div",7),h.TgZ(28,"ion-item",11),h.TgZ(29,"h1",12),h._UZ(30,"ion-icon",13),h.qZA(),h.TgZ(31,"ion-label"),h.TgZ(32,"p"),h._uU(33),h.ALo(34,"translate"),h.qZA(),h.TgZ(35,"ion-text",14),h._uU(36),h.ALo(37,"number"),h.qZA(),h.qZA(),h.TgZ(38,"ion-button",15),h._uU(39,"Xem"),h.qZA(),h._UZ(40,"ion-text",16),h.qZA(),h.qZA(),h.qZA(),h.YNc(41,qe,2,1,"div",17),h.YNc(42,xe,1,0,"app-pond-list",18),h.TgZ(43,"div",19),h.TgZ(44,"ion-button",20),h.NdJ("click",function(){return t.presentInfomation()}),h._UZ(45,"ion-icon",21),h._uU(46),h.ALo(47,"translate"),h.qZA(),h.qZA(),h.YNc(48,Oe,5,3,"div",22),h.qZA()),2&e&&(h.xp6(6),h.hij(" ",null==t.farmService.farm?null:t.farmService.farm.name," "),h.xp6(2),h.Q6J("appPermission",h.DdM(33,be))("currentPermission",t.farmService.permission),h.xp6(9),h.Q6J("appPermission",h.DdM(34,Me))("currentPermission",t.farmService.permission),h.xp6(1),h.MGl("routerLink","/money/",t.farmService.fcode,""),h.xp6(2),h.hij(" ",h.lcZ(21,23,"FARM_MOD.BUDGET")," "),h.xp6(2),h.Q6J("appPermission",h.DdM(35,Se))("currentPermission",t.farmService.permission),h.xp6(1),h.MGl("routerLink","/calendar/",t.farmService.fcode,""),h.xp6(2),h.hij(" ",h.lcZ(26,25,"FARM_MOD.CALENDAR")," "),h.xp6(2),h.Q6J("appPermission",h.DdM(36,Re))("currentPermission",t.farmService.permission),h.xp6(6),h.AsE("",null==t.store?null:t.store.totalStore," ",h.lcZ(34,27,"FARM_MOD.WAREHOUSE"),""),h.xp6(3),h.hij(" ",h.lcZ(37,29,null==t.store?null:t.store.totalCost),"\u0111 "),h.xp6(2),h.MGl("routerLink","/store/",t.farmService.fcode,"/list"),h.xp6(3),h.Q6J("ngIf",t.view),h.xp6(1),h.Q6J("ngIf",!t.loadingFlag.pending),h.xp6(1),h.Q6J("appPermission",h.DdM(37,be))("currentPermission",t.farmService.permission),h.xp6(3),h.hij(" ",h.lcZ(47,31,"FARM_MOD.SETTING")," "),h.xp6(2),h.Q6J("ngIf",t.farmLab))},directives:[c.Gu,c.sr,c.Sm,c.oU,c.cs,c.YG,c.gu,K.l,c.W2,c.jY,c.Nd,c.wI,c.PM,c.YI,s.rH,c.Ie,c.Q$,c.yW,i.O5,c.PQ,_e],pipes:[_.X$,i.JJ],styles:["#line[_ngcontent-%COMP%]{border:.7px solid #f5f6f9}ion-card[_ngcontent-%COMP%]{margin-inline:5px}"]}),e}(),ke=n(54373),Ce=n(56209),Ee=n(24023),Ne=[{path:"",component:ye,children:[{path:"",children:[{path:"",redirectTo:"pond",pathMatch:"full"},{path:"pond",component:_e}]}]}],Fe=function(){var e=function e(){r(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({providers:[Z.n,X.y,k.b],imports:[[i.ez,o.u5,c.Pc,o.UX,Ce.Ns,_.aw.forChild(),s.Bz.forChild(Ne),ke.i,Ee.E]]}),e}()},40044:function(e,t,n){n.d(t,{y:function(){return c}});var i=n(88002),o=n(15189),s=n(37716),c=function(){var e=function(){function e(t){r(this,e),this.reqAPIService=t,this.PATH={MEMBER:"/manager/lab-member-api",MANAGER:"/manager/lab-manager-api",ROOT:"/user/user-lab-api"}}return a(e,[{key:"setCode",value:function(e){this.code=e,console.log("set lab code")}},{key:"getApiStore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this.reqAPIService.get(n+="?action="+e+"&lcode="+this.code+t).pipe((0,i.U)(function(e){return e}))}},{key:"postApiStore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this.reqAPIService.post(r+="?action="+e+"&lcode="+this.code+n,t).pipe((0,i.U)(function(e){return e}))}},{key:"loadLab",value:function(){return this.getApiStore("home","",this.PATH.MEMBER)}},{key:"loadLabRoot",value:function(){return this.getApiStore("get","",this.PATH.ROOT)}},{key:"loadFarm",value:function(e){return this.getApiStore("searchFarm","&keyword="+e,this.PATH.MANAGER)}},{key:"addFarm",value:function(e){return this.getApiStore("addFarm","&fcode="+e,this.PATH.MANAGER)}},{key:"removeFarm",value:function(e){return this.getApiStore("removeFarm","&fcode="+e,this.PATH.MANAGER)}},{key:"getLab",value:function(){return this.getApiStore("getLab","",this.PATH.MANAGER)}},{key:"addLab",value:function(e){return this.postApiStore("addLab",e,"",this.PATH.ROOT)}},{key:"register",value:function(e){return this.postApiStore("register",e,"",this.PATH.ROOT)}},{key:"updateLabOwner",value:function(e){return this.postApiStore("updateInfor",e,"",this.PATH.ROOT)}},{key:"updateLab",value:function(e){return this.postApiStore("updateLab",e,"",this.PATH.MANAGER)}},{key:"addMember",value:function(e){return this.getApiStore("addManager","&user_id="+e,this.PATH.ROOT)}},{key:"removeMember",value:function(e){return this.getApiStore("removeManager","&user_id="+e,this.PATH.ROOT)}},{key:"removeLab",value:function(e){return this.getApiStore("removeLab","&id="+e,this.PATH.ROOT)}},{key:"loadSpecies",value:function(){return this.getApiStore("listSpecies","",this.PATH.MANAGER)}},{key:"loadReport",value:function(e){return this.postApiStore("reportLab",e,"",this.PATH.MANAGER)}},{key:"loadAnalyze",value:function(e){return this.postApiStore("analyzeLab",e,"",this.PATH.MANAGER)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.$))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac}),e}()},62014:function(e,t,n){n.d(t,{y:function(){return i}});var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currency";r(this,e),this.setType(n),this.setInput(t),this.processConvert()}return a(e,[{key:"setInput",value:function(e){"string"!=typeof e&&(e=String(e)),this.input=e}},{key:"setValue",value:function(e){"string"!=typeof e&&(e=String(e)),this.input=e,this.processConvert()}},{key:"setType",value:function(e){this.type=e}},{key:"processConvert",value:function(){var e,t,n=this.input.split(",").join("");if(n.indexOf(".")!=n.lastIndexOf(".")&&(n=n.slice(0,n.lastIndexOf("."))),-1!=n.indexOf(".")){t=n.indexOf(".");var i=n.split(".");n=i[0],"float"===this.type&&(e=i[1].substring(0,2))}else t=n.length;for(var r=new Array,o=1,a=-3;Math.abs(a)<t;a-=3)r.push(n.slice(a,t+a+3)),o++;var s=n.slice(0,t-3*(o-1));s.length>0&&r.push(s),r.reverse();var c=n.replace(/,/gi,""),l="";this.fakeView=r.join(),"float"===this.type&&null!=e&&(this.fakeView=this.fakeView+"."+e,l=e),this.realValue=parseFloat(c+"."+l)}}]),e}()},66341:function(e,t,n){n.d(t,{n:function(){return c}});var i=n(88002),o=n(15189),s=n(37716),c=function(){var e=function(){function e(t){r(this,e),this.reqAPIService=t,this.urlApi="/manager/farm-api"}return a(e,[{key:"searchMember",value:function(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-user&key="+e).pipe((0,i.U)(function(e){return e.data}))}},{key:"searchExpert",value:function(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-expert&key="+e).pipe((0,i.U)(function(e){return e.data}))}},{key:"getSitePath",value:function(){return this.reqAPIService.FILE_PATH}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.$))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac}),e}()}}])}();