!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[8097],{18097:function(t,i,o){o.r(i),o.d(i,{AuthPageModule:function(){return Te}});var r,s=o(38583),a=o(90665),u=o(13619),l=o(47063),c=o(37716),g=((r=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(e){return new(e||r)},r.\u0275cmp=c.Xpm({type:r,selectors:[["app-auth"]],decls:5,vars:0,template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3,"auth"),c.qZA(),c.qZA(),c.qZA(),c._UZ(4,"ion-content"))},directives:[l.Gu,l.sr,l.wd,l.W2],styles:[""]}),r),d=o(64762),m=o(50384),p=o(27887),h=o(42377),f=o(21224),Z=o(38739),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,d.ZT)(t,e),Object.defineProperty(t.prototype,"cordova",{get:function(){return(0,Z.J2)(this,"cordova")},set:function(e){(0,Z.Iq)(this,"cordova",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return(0,Z.J2)(this,"model")},set:function(e){(0,Z.Iq)(this,"model",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"platform",{get:function(){return(0,Z.J2)(this,"platform")},set:function(e){(0,Z.Iq)(this,"platform",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uuid",{get:function(){return(0,Z.J2)(this,"uuid")},set:function(e){(0,Z.Iq)(this,"uuid",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return(0,Z.J2)(this,"version")},set:function(e){(0,Z.Iq)(this,"version",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"manufacturer",{get:function(){return(0,Z.J2)(this,"manufacturer")},set:function(e){(0,Z.Iq)(this,"manufacturer",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVirtual",{get:function(){return(0,Z.J2)(this,"isVirtual")},set:function(e){(0,Z.Iq)(this,"isVirtual",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serial",{get:function(){return(0,Z.J2)(this,"serial")},set:function(e){(0,Z.Iq)(this,"serial",e)},enumerable:!1,configurable:!0}),t.pluginName="Device",t.plugin="cordova-plugin-device",t.pluginRef="device",t.repo="https://github.com/apache/cordova-plugin-device",t.platforms=["Android","Browser","iOS","macOS","Windows"],t.\u0275fac=function(e){return(n||(n=c.n5z(t)))(e||t)},t.\u0275prov=c.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),t;var n}(Z.KY),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,d.ZT)(t,e),t.prototype.login=function(e){return(0,Z.DM)(this,"login",{successIndex:1,errorIndex:2},arguments)},t.prototype.trySilentLogin=function(e){return(0,Z.DM)(this,"trySilentLogin",{},arguments)},t.prototype.logout=function(){return(0,Z.DM)(this,"logout",{},arguments)},t.prototype.disconnect=function(){return(0,Z.DM)(this,"disconnect",{},arguments)},t.prototype.getSigningCertificateFingerprint=function(){return(0,Z.DM)(this,"getSigningCertificateFingerprint",{},arguments)},t.pluginName="GooglePlus",t.plugin="cordova-plugin-googleplus",t.pluginRef="window.plugins.googleplus",t.repo="https://github.com/EddyVerbruggen/cordova-plugin-googleplus",t.install="ionic cordova plugin add cordova-plugin-googleplus --variable REVERSED_CLIENT_ID=myreversedclientid",t.installVariables=["REVERSED_CLIENT_ID"],t.platforms=["Android","iOS"],t.\u0275fac=function(e){return(n||(n=c.n5z(t)))(e||t)},t.\u0275prov=c.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),t;var n}(Z.KY),T=o(84465),_=o(81780),q=o(38605);function b(e,t){1&e&&c._UZ(0,"ion-spinner",22)}function x(e,t){1&e&&(c.TgZ(0,"span"),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"AUTH.LOGIN")))}function w(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-bottom-drawer",23),c.NdJ("stateChange",function(e){return c.CHM(n),c.oxw().drawerOtps.drawerState=e}),c.TgZ(1,"div",24),c.TgZ(2,"ion-button",25),c.NdJ("click",function(){return c.CHM(n),c.oxw().showDrawer()}),c._UZ(3,"ion-icon",26),c._uU(4," kh\xe1c "),c.qZA(),c.qZA(),c.TgZ(5,"div",27),c.TgZ(6,"div",28),c.TgZ(7,"ion-item",29),c.TgZ(8,"ion-label",30),c.TgZ(9,"h4"),c._uU(10,"Farmext xin ch\xe0o!"),c.qZA(),c.TgZ(11,"small"),c._uU(12," Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 \u0111\u0103ng nh\u1eadp ho\u1eb7c t\u1ea1o t\xe0i kho\u1ea3n "),c.qZA(),c.qZA(),c.qZA(),c.TgZ(13,"ion-item"),c._UZ(14,"ion-input",31),c.qZA(),c.TgZ(15,"div",32),c.TgZ(16,"ion-button",33),c.NdJ("click",function(){return c.CHM(n),c.oxw().phoneLogin()}),c._uU(17,"Ti\u1ebfp theo"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&e){var i=c.oxw();c.Q6J("minimumHeight",i.drawerOtps.minimumHeight)("disableDrag",i.drawerOtps.disableDrag)("state",i.drawerOtps.drawerState)("distanceTop",i.drawerOtps.distanceTop),c.xp6(3),c.Q6J("name",2==i.drawerOtps.drawerState?"chevron-down-outline":"chevron-up-outline"),c.xp6(11),c.Q6J("formControl",i.formPhone),c.xp6(2),c.Q6J("disabled",i.formPhone.invalid)}}var O=function(){var t=function(){function t(n,i,o,r,s,u,l,c,g,d){e(this,t),this.device=n,this.formBuilder=i,this.authService=o,this.router=r,this.toastService=s,this.alertController=u,this.translate=l,this.googlePlus=c,this.setTranslate=g,this.storage=d,this.requestFlag=new p.E,this.phoneAuthRequestFlag=new p.E,this.reqGoogleFlag=new p.E,this.devPhoto="",this.formPhone=new a.NI("",[a.kI.required,a.kI.minLength(9),a.kI.maxLength(12)]),this.drawerOtps={minimumHeight:40,disableDrag:!0,drawerState:f.Wk.Top,distanceTop:190}}return n(t,[{key:"ngOnInit",value:function(){this.formLogin=this.formBuilder.group({username:["",a.kI.compose([a.kI.required])],password:["",a.kI.required]})}},{key:"ionViewDidEnter",value:function(){this.authService.checkIsLoggedIn&&this.router.navigate(["tabs/management"])}},{key:"onSubmit",value:function(){var e=this;this.requestFlag.setPending(!0),this.message=null,this.authService.reqLogin({username:this.formLogin.value.username,password:this.formLogin.value.password,token_device:this.authService.tokenDevice}).subscribe(function(t){if(t.error)e.message=t.message,e.toastService.warning(e.message);else{e.authService.setUser({id:t.data.user.user_id,username:t.data.user.user_name,first_name:t.data.user.first_name,last_name:t.data.user.last_name,email:t.data.user.user_email,photo:t.data.user.user_photo,permission:t.data.user.permission,token:t.data.token,token_fb:""});var n=e.authService.redirectUrl?e.router.parseUrl(e.authService.redirectUrl):"/tabs/wall";e.router.navigateByUrl(n)}e.requestFlag.setResult(!0)},function(){e.requestFlag.setResult(!1),e.message="Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i"})}},{key:"presentLanguage",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"Language",inputs:[{name:"vi",type:"radio",label:"Ti\u1ebfng Vi\u1ec7t",value:"vi",checked:"vi"==this.translate.currentLang},{name:"en",type:"radio",label:"English",value:"en",checked:"en"==this.translate.currentLang}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(e){t.setTranslate.setLang(e)}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"loginByGoogle",value:function(){var e=this;this.reqGoogleFlag.setStart(!0),this.googlePlus.login({webClientId:"760955382669-jalcfc5qklp9qd7t6k995nrbsvqp6r8h.apps.googleusercontent.com",offline:!0}).then(function(t){t.idToken?(alert(t.idToken),e.authService.reqLoginByGoogle({idToken:t.idToken,email:t.email,userId:t.userId,lastName:t.givenName,firstName:t.familyName,token_device:e.authService.tokenDevice}).subscribe(function(t){!t.error&&t.data.token?(e.authService.setUser({id:t.data.user.user_id,username:t.data.user.user_name,first_name:t.data.user.first_name,last_name:t.data.user.last_name,email:t.data.user.user_email,photo:t.data.user.user_photo,permission:t.data.user.permission,token:t.data.token,token_fb:""}),e.router.navigateByUrl(t.data.user.new_member?"/account":"/tabs/wall")):(e.reqGoogleFlag.setResult(!0),e.toastService.success(t.error?t.message:""))},function(t){e.reqGoogleFlag.setResult(!1),e.toastService.warning(e.translate.instant("ERROR_CONNECTION"))})):(e.reqGoogleFlag.setResult(!1),e.toastService.danger(e.translate.instant("AUTH.CAN_NOT_AUTH_BY_GOOGLE")))}).catch(function(t){e.reqGoogleFlag.setResult(!1),console.log(t),e.toastService.warning(e.translate.instant("AUTH.PLATFORM_NOT_SUPPORT"))})}},{key:"downloadImge",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://farmext.com/favicon.png",{mode:"no-cors"});case 2:return t=e.sent,console.log(t),e.next=6,t.blob();case 6:return n=e.sent,e.next=9,i=n,new Promise(function(e,t){var n=new FileReader;console.log(n),n.onerror=t,n.onload=function(){e(n.result)},n.onloadend=function(){console.log(n.result)},n.readAsDataURL(i)});case 9:this.devPhoto=e.sent;case 10:case"end":return e.stop()}},e,this)}))}},{key:"showDrawer",value:function(){this.drawerOtps.drawerState=2==this.drawerOtps.drawerState?f.Wk.Bottom:f.Wk.Top}},{key:"phoneLogin",value:function(){var e=this;console.log(this.formPhone.value),this.phoneAuthRequestFlag.setPending(!0),this.authService.reqAuthPhone({phone:this.formPhone.value,uuid:this.device.uuid}).subscribe(function(t){console.log(t),1==t.status?(e.storage.set("phoneOTP",e.formPhone.value),e.router.navigate(["auth/phone-confirm"])):(e.storage.set("phoneOTP",e.formPhone.value),e.toastService.warning(e.translate.instant(t.message)),e.drawerOtps.drawerState=f.Wk.Bottom)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(v),c.Y36(a.qu),c.Y36(m.e),c.Y36(u.F0),c.Y36(T.k),c.Y36(l.Br),c.Y36(_.sK),c.Y36(A),c.Y36(h.$),c.Y36(q.Ke))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-login"]],decls:41,vars:24,consts:[["slot","end"],["size","small",3,"click"],["name","globe","slot","start"],["no-bounce","",1,"ion-padding"],[1,"ion-padding","ion-text-center"],["src","assets/icon/farmext-circle.svg","alt","Farmext logo",1,"logo"],[3,"formGroup","ngSubmit"],["size","10","offset","1","size-sm","6","offset-sm","3"],["lines","none"],["type","email","formControlName","username","name","username","inputmode","email",3,"placeholder"],["type","Password","formControlName","password","name","password","inputmode","text",3,"placeholder"],["type","submit","expand","block","shape","round",3,"disabled"],["slot","start","name","dots",4,"ngIf"],[4,"ngIf"],[1,"other"],["expand","block","shape","round","fill","outline",3,"click"],["expand","block","shape","round","fill","clear","routerLink","/auth/signup"],["slot","end","name","arrow-forward-outline"],[1,"ion-text-center"],["size","small","fill","clear","routerLink","/auth/forgot",1,"text-s"],["color","primary"],[3,"minimumHeight","disableDrag","state","distanceTop","stateChange",4,"ngIf"],["slot","start","name","dots"],[3,"minimumHeight","disableDrag","state","distanceTop","stateChange"],[1,"ion-text-end"],["color","primary","size","small","fill","clear","shape","round",3,"click"],["slot","start",3,"name"],[1,"drawer-content"],[1,"content-wraper","ion-padding"],["lines","none",1,"bg-none"],["color","light"],["placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i","autocomplete","tel","inputmode","tel","type","tel",3,"formControl"],[1,"box-btn-next"],["color","primary","shape","round","expand","block","mode","ios",3,"disabled","click"]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.TgZ(5,"ion-buttons",0),c.TgZ(6,"ion-button",1),c.NdJ("click",function(){return t.presentLanguage()}),c._UZ(7,"ion-icon",2),c._uU(8),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"ion-content",3),c.TgZ(10,"div",4),c._UZ(11,"img",5),c.qZA(),c.TgZ(12,"form",6),c.NdJ("ngSubmit",function(){return t.onSubmit()}),c.TgZ(13,"ion-grid"),c.TgZ(14,"ion-row"),c.TgZ(15,"ion-col",7),c.TgZ(16,"ion-item",8),c._UZ(17,"ion-input",9),c.ALo(18,"translate"),c.qZA(),c.TgZ(19,"ion-item",8),c._UZ(20,"ion-input",10),c.ALo(21,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(22,"ion-row"),c.TgZ(23,"ion-col",7),c.TgZ(24,"ion-button",11),c.YNc(25,b,1,0,"ion-spinner",12),c.YNc(26,x,3,3,"span",13),c.qZA(),c.TgZ(27,"div",14),c.TgZ(28,"ion-button",15),c.NdJ("click",function(){return t.loginByGoogle()}),c._uU(29),c.ALo(30,"translate"),c.qZA(),c.TgZ(31,"ion-button",16),c._uU(32),c.ALo(33,"translate"),c._UZ(34,"ion-icon",17),c.qZA(),c.qZA(),c.TgZ(35,"div",18),c.TgZ(36,"span",19),c.TgZ(37,"ion-text",20),c._uU(38),c.ALo(39,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(40,w,18,7,"ion-bottom-drawer",21)),2&e&&(c.xp6(3),c.Oqu(c.lcZ(4,12,"AUTH.LOGIN")),c.xp6(5),c.hij(" ",t.translate.currentLang," "),c.xp6(4),c.Q6J("formGroup",t.formLogin),c.xp6(5),c.Q6J("placeholder",c.lcZ(18,14,"AUTH.EMAIL_OR_USERNAME")),c.xp6(3),c.Q6J("placeholder",c.lcZ(21,16,"AUTH.PASSWORD")),c.xp6(4),c.Q6J("disabled",t.formLogin.invalid||t.requestFlag.pending),c.xp6(1),c.Q6J("ngIf",t.requestFlag.pending),c.xp6(1),c.Q6J("ngIf",!t.requestFlag.pending),c.xp6(3),c.hij(" ",c.lcZ(30,18,"AUTH.LOGIN_BY_GOOGLE")," "),c.xp6(3),c.hij(" ",c.lcZ(33,20,"AUTH.NOT_HAVE_ACCOUNT")," "),c.xp6(6),c.hij(" ",c.lcZ(39,22,"AUTH.FORGOT_PASSWORD")," "),c.xp6(2),c.Q6J("ngIf","vi"==t.translate.currentLang))},directives:[l.Gu,l.sr,l.wd,l.Sm,l.YG,l.gu,l.W2,a._Y,a.JL,a.sg,l.jY,l.Nd,l.wI,l.Ie,l.pK,l.j9,a.JJ,a.u,s.O5,l.YI,u.rH,l.yW,l.PQ,f.w5,l.Q$,a.oH],pipes:[_.X$],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #e3f4fd url(/assets/img/background.svg) bottom center no-repeat !important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-radius: 50px;margin:5px}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-end: 5px;--padding-start: 5px}[_nghost-%COMP%]   .logo[_ngcontent-%COMP%]{max-width:120px;margin:0 auto}[_nghost-%COMP%]   .other[_ngcontent-%COMP%]{margin-top:2em}[_nghost-%COMP%]   .text-s[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]{background-color:transparent}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .drawer-content[_ngcontent-%COMP%]{height:100%;border-radius:30px!important;background-color:#14499e;box-shadow:#b8b8b866 0 -5px 20px -5px}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .drawer-content[_ngcontent-%COMP%]   .content-wraper[_ngcontent-%COMP%]{max-width:360px;margin:0 auto}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .drawer-content[_ngcontent-%COMP%]   ion-item.bg-none[_ngcontent-%COMP%]{--background: transparent !important}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .drawer-content[_ngcontent-%COMP%]   .box-btn-next[_ngcontent-%COMP%]{margin-top:1.5em}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .item-highlight[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .item-inner-highlight[_ngcontent-%COMP%]{background-color:transparent!important;border-radius:50px!important}[_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .item-has-focus[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-bottom-drawer[_ngcontent-%COMP%]   .item-interactive[_ngcontent-%COMP%]{background-color:transparent!important;border-radius:50px!important}"]}),t}(),U=o(15189),C=function(){var t=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-term"]],decls:5,vars:0,template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3,"term"),c.qZA(),c.qZA(),c.qZA(),c._UZ(4,"ion-content"))},directives:[l.Gu,l.sr,l.wd,l.W2],styles:[""]}),t}(),k=["slides"];function N(e,t){1&e&&(c.TgZ(0,"ion-item",29),c.TgZ(1,"ion-label"),c.TgZ(2,"p"),c.TgZ(3,"ion-text",30),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,1,"AUTH.EMAIL_EXIST")))}function E(e,t){1&e&&(c.TgZ(0,"ion-item",29),c.TgZ(1,"ion-label"),c.TgZ(2,"p"),c.TgZ(3,"ion-text",30),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,1,"AUTH.PHONENUMBER_EXIST")))}function I(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-item",6),c.TgZ(1,"ion-label",7),c._uU(2,"Email"),c.qZA(),c.TgZ(3,"ion-input",31),c.NdJ("ionChange",function(e){return c.CHM(n),c.oxw().validateEmailExistence(e)}),c.qZA(),c.qZA()}}function y(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-item",6),c.TgZ(1,"ion-label",7),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"ion-input",32),c.NdJ("ionChange",function(e){return c.CHM(n),c.oxw().validatePhoneExistence(e)}),c.qZA(),c.qZA()}2&e&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"AUTH.PHONE_NUMBER")))}function S(e,t){1&e&&(c.TgZ(0,"p",24),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"AUTH.NOTE_EMAIL_CONFIRM")," "))}function P(e,t){1&e&&(c.TgZ(0,"p",24),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"AUTH.NOTE_PHONE_CONFIRM")," "))}function L(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"p"),c.TgZ(1,"small",35),c.NdJ("click",function(){return c.CHM(n),c.oxw(2).changeContact("email")}),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()}2&e&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"AUTH.BY_EMAIL")))}function R(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"p"),c.TgZ(1,"small",35),c.NdJ("click",function(){return c.CHM(n),c.oxw(2).changeContact("phone")}),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()}2&e&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"AUTH.BY_PHONE")))}function M(e,t){if(1&e&&(c.TgZ(0,"div",33),c.YNc(1,L,4,3,"p",34),c.YNc(2,R,4,3,"p",34),c.qZA()),2&e){var n=c.oxw();c.xp6(1),c.Q6J("ngIf","phone"==n.activeBy),c.xp6(1),c.Q6J("ngIf","email"==n.activeBy)}}function J(e,t){1&e&&(c.TgZ(0,"ion-item",29),c.TgZ(1,"ion-label"),c.TgZ(2,"p"),c.TgZ(3,"ion-text",30),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,1,"AUTH.USER_NAME_EXIST")))}function H(e,t){1&e&&(c.TgZ(0,"ion-item",29),c.TgZ(1,"ion-label",36),c.TgZ(2,"p"),c.TgZ(3,"ion-text",30),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,1,"AUTH.USER_NAME_INVALID")))}function F(e,t){1&e&&(c.TgZ(0,"ion-item",29),c.TgZ(1,"ion-label"),c.TgZ(2,"p"),c.TgZ(3,"ion-text",30),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,1,"AUTH.PASSWORD_IS_WEAK")))}function Y(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-chip",37),c.NdJ("click",function(){var e=c.CHM(n).$implicit;return c.oxw().selectUsername(e)}),c.TgZ(1,"ion-label"),c._uU(2),c.qZA(),c.qZA()}if(2&e){var i=t.$implicit;c.xp6(2),c.Oqu(i)}}function Q(e,t){1&e&&c._UZ(0,"ion-spinner",38)}var B=function(){var t=function(){function t(n,i,o,r,s,a,u,l,c,g,d){e(this,t),this._formBuilder=n,this.reqAPIService=i,this.modalController=o,this.router=r,this.navController=s,this.device=a,this.authService=u,this.toastService=l,this.translate=c,this.alertController=g,this.storage=d,this.loadingFlag=new p.E,this.activeBy="phone",this.showPassword=!0,this.passwordToggleIcon="eye-off-outline",this.form1Valid=!1,this.recomnetUsernames=[],this.recomnetUsernamesFilter=[]}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.storage.get("registering").then(function(t){t&&(e.navController.setDirection("back"),e.router.navigateByUrl("auth/email-confirm"))}),this.form=this._formBuilder.group({form0:this._formBuilder.group({firstname:["",[a.kI.required]],lastname:["",[a.kI.required]]}),form1:this._formBuilder.group({email:[""],phonenumber:[""]}),form2:this._formBuilder.group({username:["",[a.kI.required,a.kI.minLength(5),a.kI.pattern("^[a-z0-9._-]{5,20}$")]],password:["",[a.kI.required,a.kI.minLength(6)]]})}),this.form.get("form1").valueChanges.subscribe(function(){e.form1Valid=e.form.get("form1").valid}),this.changeContact("vi"==this.translate.currentLang?"phone":"email")}},{key:"ionViewDidEnter",value:function(){this.slides.lockSwipes(!0)}},{key:"register",value:function(){var e=this,t={firstname:this.form.value.form0.firstname,lastname:this.form.value.form0.lastname,username:this.form.value.form2.username,email:this.form.value.form1.email,phonenumber:this.form.value.form1.phonenumber,password:this.form.value.form2.password,obj:"register",notMobile:!0,uuid:this.device.uuid,activeBy:this.activeBy};this.loadingFlag.setPending(!0),this.authService.register(t).subscribe(function(n){n.error?e.toastService.warning(n.message):(e.authService.setUserNotVerify({username:t.username,email:t.email}),e.toastService.warning(n.message),e.storage.set("registering",t),e.navController.setDirection("back"),e.router.navigateByUrl("auth/email-confirm")),e.loadingFlag.setResult(!0)},function(t){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"validateUsernameExistence",value:function(e){var t=this;console.log(e),this.form.get("form2.username").valid&&this.reqAPIService.postNoneToken("/user/register-api",{data:e.target.value,obj:"u"}).subscribe(function(e){e.error?t.form.get("form2.username").setErrors({existence:!0}):t.form.get("form2.username").setErrors(null),t.form.get("form2").updateValueAndValidity()},function(e){console.log(e)})}},{key:"validateEmailExistence",value:function(e){var t=this;this.form.get("form1.email").valid&&this.reqAPIService.postNoneToken("/user/register-api",{data:e.target.value,obj:"e"}).subscribe(function(e){e.error?(console.log("E-mail"),t.form.get("form1.email").setErrors({existence:!0})):t.form.get("form1.email").setErrors(null),t.form.get("form1").updateValueAndValidity()},function(e){console.log(e)})}},{key:"validatePhoneExistence",value:function(e){var t=this;this.form.get("form1.phonenumber").valid&&this.reqAPIService.postNoneToken("/user/register-api",{data:e.target.value,obj:"p"}).subscribe(function(e){e.error?(console.log("Phonenumber"),t.form.get("form1.phonenumber").setErrors({existence:!0})):t.form.get("form1.phonenumber").setErrors(null),t.form.get("form1").updateValueAndValidity()},function(e){console.log(e)})}},{key:"validatePassword",value:function(){this.form.get("form2.password").valid&&(this.form.get("form2.password"),this.form.get("form2.password").setErrors(null),this.form.get("form1").updateValueAndValidity())}},{key:"changeContact",value:function(e){this.activeBy=e,this.form.get("form1").reset(),"email"===this.activeBy?(this.form.get("form1.email").setValidators([a.kI.required,a.kI.email]),this.form.get("form1.phonenumber").clearValidators(),this.form.get("form1.phonenumber").updateValueAndValidity()):(this.form.get("form1.phonenumber").setValidators([a.kI.required,a.kI.minLength(8),a.kI.maxLength(15),a.kI.pattern("^([+][1-9][0-9]*(([0-9]*)|-[0-9]*-))?[0]?[1-9][0-9- ]*$")]),this.form.get("form1.email").clearValidators(),this.form.get("form1.email").updateValueAndValidity()),this.form1Valid=!1}},{key:"togglePassword",value:function(){this.showPassword?(this.passwordToggleIcon="eye-outline",this.showPassword=!1):(this.passwordToggleIcon="eye-off-outline",this.showPassword=!0)}},{key:"retypeUsername",value:function(){this.form.get("form2.username").reset()}},{key:"presentTerm",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:C});case 2:return e.next=4,e.sent.present();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentAlert",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"phone"===this.activeBy?(t=this.form.value.form1.phonenumber,n=this.translate.instant("AUTH.CONFIRM_PHONE_RECEIVED_CODE")):(t=this.form.value.form1.email,n=this.translate.instant("AUTH.CONFIRM_EMAIL_RECEIVED_CODE")),e.next=3,this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("AUTH.NOTE"),subHeader:t,message:n,buttons:[{text:this.translate.instant("CANCEL"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(){i.slides.lockSwipes(!1),i.slides.slideNext()}}]});case 3:return e.next=5,e.sent.present();case 5:case"end":return e.stop()}},e,this)}))}},{key:"endView",value:function(){var e=this.autoCreatUserName();this.checkAutoName(e)}},{key:"slideNext",value:function(){this.slides.lockSwipes(!1),this.slides.slideNext()}},{key:"enterSlide",value:function(){var e=this;this.slides.isEnd().then(function(t){1!=t&&e.slides.lockSwipes(!0)})}},{key:"autoCreatUserName",value:function(){var e=[];if(e.push(this.removeAccents(this.form.value.form0.firstname)+this.removeAccents(this.form.value.form0.lastname)),e.push(this.removeAccents(this.form.value.form0.firstname)+"."+this.removeAccents(this.form.value.form0.lastname)),e.push(this.removeAccents(this.form.value.form0.lastname)+"."+this.removeAccents(this.form.value.form0.firstname)),console.log(this.form.value.form1.phonenumber),null!=this.form.value.form1.phonenumber&&""!=this.form.value.form1.phonenumber){var t=this.form.value.form1.phonenumber.replace(/\s/g,"").slice(-3);e.push(this.removeAccents(this.form.value.form0.firstname)+this.removeAccents(this.form.value.form0.lastname)+"."+t)}var n=Math.floor(900*Math.random()+100);return e.push(this.removeAccents(this.form.value.form0.firstname)+this.removeAccents(this.form.value.form0.lastname)+"."+n),e}},{key:"removeAccents",value:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\u0111/g,"d").replace(/\u0110/g,"D").replace(/\s/g,"").toLowerCase()}},{key:"checkAutoName",value:function(e){var t=this;this.reqAPIService.postNoneToken("/user/register-api",{data:e,obj:"ul"}).subscribe(function(e){if(e.error)return!1;e.data&&(t.recomnetUsernames=e.data,t.form.get("form2.username").setValue(e.data[0]),t.recomnetUsernamesFilter=t.recomnetUsernames.filter(function(t){return t!=e.data[0]}))})}},{key:"selectUsername",value:function(e){this.form.get("form2.username").setValue(e),this.recomnetUsernamesFilter=this.recomnetUsernames.filter(function(t){return t!=e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(a.qu),c.Y36(U.$),c.Y36(l.IN),c.Y36(u.F0),c.Y36(l.SH),c.Y36(v),c.Y36(m.e),c.Y36(T.k),c.Y36(_.sK),c.Y36(l.Br),c.Y36(q.Ke))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-signup"]],viewQuery:function(e,t){var n;(1&e&&c.Gf(k,7),2&e)&&(c.iGM(n=c.CRH())&&(t.slides=n.first))},decls:70,vars:48,consts:[["slot","start"],["text","","defaultHref","auth/login"],[3,"formGroup"],[3,"ionSlideReachEnd","ionSlideWillChange"],["slides",""],["formGroupName","form0",1,"w-100","ion-padding"],["lines","inset"],["position","floating"],["formControlName","firstname","type","text","inputmode","text"],["formControlName","lastname","type","text","inputmode","text"],["shape","round",1,"ion-margin",3,"disabled","click"],["slot","end","name","arrow-forward"],["formGroupName","form1",1,"w-100","ion-padding"],["lines","none",4,"ngIf"],["lines","inset",4,"ngIf"],["class","tip",4,"ngIf"],["shape","round",3,"disabled","click"],["class","float-change",4,"ngIf"],["formGroupName","form2",1,"w-100","ion-padding"],["color","primary",3,"click",4,"ngFor","ngForOf"],["formControlName","username","type","text","inputmode","text","debounce","300",1,"username",3,"ionChange"],["slot","end","name","backspace-outline",3,"click"],["formControlName","password","inputmode","password",3,"type","ionChange"],["slot","end",3,"name","click"],[1,"tip"],["name","dots",4,"ngIf"],[1,"ion-padding"],["shape","round","fill","clear",3,"click"],["slot","start","name","arrow-back"],["lines","none"],["color","danger"],["formControlName","email","type","email","inputmode","email","debounce","300",3,"ionChange"],["formControlName","phonenumber","type","tel","inputmode","tel","debounce","300",3,"ionChange"],[1,"float-change"],[4,"ngIf"],[3,"click"],[1,"ion-text-wrap"],["color","primary",3,"click"],["name","dots"]],template:function(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(7,"ion-content",2),c.TgZ(8,"ion-slides",3,4),c.NdJ("ionSlideReachEnd",function(){return t.endView()})("ionSlideWillChange",function(){return t.enterSlide()}),c.TgZ(10,"ion-slide"),c.TgZ(11,"div",5),c.TgZ(12,"ion-item",6),c.TgZ(13,"ion-label",7),c._uU(14),c.ALo(15,"translate"),c.qZA(),c._UZ(16,"ion-input",8),c.qZA(),c.TgZ(17,"ion-item",6),c.TgZ(18,"ion-label",7),c._uU(19),c.ALo(20,"translate"),c.qZA(),c._UZ(21,"ion-input",9),c.qZA(),c.TgZ(22,"ion-button",10),c.NdJ("click",function(){return t.slideNext()}),c._uU(23),c.ALo(24,"translate"),c._UZ(25,"ion-icon",11),c.qZA(),c.qZA(),c.qZA(),c.TgZ(26,"ion-slide"),c.TgZ(27,"div",12),c.YNc(28,N,6,3,"ion-item",13),c.YNc(29,E,6,3,"ion-item",13),c.YNc(30,I,4,0,"ion-item",14),c.YNc(31,y,5,3,"ion-item",14),c.YNc(32,S,3,3,"p",15),c.YNc(33,P,3,3,"p",15),c.TgZ(34,"ion-button",16),c.NdJ("click",function(){return t.presentAlert()}),c._uU(35),c.ALo(36,"translate"),c._UZ(37,"ion-icon",11),c.qZA(),c.qZA(),c.YNc(38,M,3,2,"div",17),c.qZA(),c.TgZ(39,"ion-slide"),c.TgZ(40,"div",18),c.YNc(41,J,6,3,"ion-item",13),c.YNc(42,H,6,3,"ion-item",13),c.YNc(43,F,6,3,"ion-item",13),c.TgZ(44,"div"),c.YNc(45,Y,3,1,"ion-chip",19),c.qZA(),c.TgZ(46,"ion-item",6),c.TgZ(47,"ion-label"),c._uU(48),c.ALo(49,"translate"),c.qZA(),c.TgZ(50,"ion-input",20),c.NdJ("ionChange",function(e){return t.validateUsernameExistence(e)}),c.qZA(),c.TgZ(51,"ion-icon",21),c.NdJ("click",function(){return t.retypeUsername()}),c.qZA(),c.qZA(),c.TgZ(52,"ion-item",6),c.TgZ(53,"ion-label"),c._uU(54),c.ALo(55,"translate"),c.qZA(),c.TgZ(56,"ion-input",22),c.NdJ("ionChange",function(){return t.validatePassword()}),c.qZA(),c.TgZ(57,"ion-icon",23),c.NdJ("click",function(){return t.togglePassword()}),c.qZA(),c.qZA(),c.TgZ(58,"p",24),c._uU(59),c.ALo(60,"translate"),c.qZA(),c.YNc(61,Q,1,0,"ion-spinner",25),c.TgZ(62,"div",26),c.TgZ(63,"ion-button",27),c.NdJ("click",function(){return c.CHM(n),c.MAs(9).slidePrev()}),c._UZ(64,"ion-icon",28),c._uU(65),c.ALo(66,"translate"),c.qZA(),c.TgZ(67,"ion-button",16),c.NdJ("click",function(){return t.register()}),c._uU(68),c.ALo(69,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}2&e&&(c.xp6(5),c.Oqu(c.lcZ(6,28,"AUTH.SIGNUP")),c.xp6(2),c.Q6J("formGroup",t.form),c.xp6(7),c.Oqu(c.lcZ(15,30,"AUTH.FIRSTNAME")),c.xp6(5),c.Oqu(c.lcZ(20,32,"AUTH.LASTNAME")),c.xp6(3),c.Q6J("disabled",t.form.controls.form0.invalid),c.xp6(1),c.hij(" ",c.lcZ(24,34,"NEXT")," "),c.xp6(5),c.Q6J("ngIf",t.form.get("form1.email").hasError("existence")),c.xp6(1),c.Q6J("ngIf",t.form.get("form1.phonenumber").hasError("existence")),c.xp6(1),c.Q6J("ngIf","email"==t.activeBy),c.xp6(1),c.Q6J("ngIf","phone"==t.activeBy),c.xp6(1),c.Q6J("ngIf","email"==t.activeBy),c.xp6(1),c.Q6J("ngIf","phone"==t.activeBy),c.xp6(1),c.Q6J("disabled",!t.form1Valid),c.xp6(1),c.hij(" ",c.lcZ(36,36,"NEXT")," "),c.xp6(3),c.Q6J("ngIf","vi"==t.translate.currentLang),c.xp6(3),c.Q6J("ngIf",t.form.get("form2.username").hasError("existence")),c.xp6(1),c.Q6J("ngIf",t.form.get("form2.username").hasError("pattern")),c.xp6(1),c.Q6J("ngIf",t.form.get("form2.password").hasError("weak")),c.xp6(2),c.Q6J("ngForOf",t.recomnetUsernamesFilter),c.xp6(3),c.hij("",c.lcZ(49,38,"AUTH.USER_NAME"),":"),c.xp6(6),c.hij("",c.lcZ(55,40,"AUTH.PASSWORD"),":"),c.xp6(2),c.Q6J("type",t.showPassword?"text":"password"),c.xp6(1),c.Q6J("name",t.passwordToggleIcon),c.xp6(2),c.hij(" ",c.lcZ(60,42,"AUTH.PASSWWORD_MUST_MORE_6_CHARACTERS")," "),c.xp6(2),c.Q6J("ngIf",t.loadingFlag.pending),c.xp6(4),c.hij(" ",c.lcZ(66,44,"BACK")," "),c.xp6(2),c.Q6J("disabled",t.form.invalid||t.loadingFlag.pending),c.xp6(1),c.hij(" ",c.lcZ(69,46,"CONFIRM")," "))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.W2,a.JL,a.sg,l.Hr,l.A$,a.x0,l.Ie,l.Q$,l.pK,l.j9,a.JJ,a.u,l.YG,l.gu,s.O5,s.sg,l.yW,l.hM,l.PQ],pipes:[_.X$],styles:["[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .w-100[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:.6em;font-style:italic;padding:10px}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .p-info[_ngcontent-%COMP%]{padding:5px 0}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-weight:bold}[_nghost-%COMP%]   ion-slides[_ngcontent-%COMP%]   .float-change[_ngcontent-%COMP%]{width:80%;position:absolute;bottom:0;text-align:center}"]}),t}();function D(e,t){if(1&e&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&e){var n=c.oxw();c.xp6(1),c.Oqu(null==n.user?null:n.user.lastname)}}function V(e,t){if(1&e&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&e){var n=c.oxw();c.xp6(1),c.Oqu(null==n.user?null:n.user.firstname)}}function j(e,t){if(1&e&&(c.TgZ(0,"p"),c._uU(1),c.ALo(2,"translate"),c.TgZ(3,"b"),c._uU(4),c.qZA(),c._uU(5),c.ALo(6,"translate"),c.qZA()),2&e){var n=c.oxw();c.xp6(1),c.hij("",c.lcZ(2,3,"AUTH.YOU_NEED_TO_CHECK_YOUR_EMAIL")," "),c.xp6(3),c.Oqu(null==n.user?null:n.user.email),c.xp6(1),c.hij(", ",c.lcZ(6,5,"AUTH.TO_GET_THE_VERIFICATION_CODE"),"")}}function G(e,t){if(1&e&&(c.TgZ(0,"p"),c._uU(1),c.ALo(2,"translate"),c.TgZ(3,"b"),c._uU(4),c.qZA(),c._uU(5),c.ALo(6,"translate"),c.qZA()),2&e){var n=c.oxw();c.xp6(1),c.hij("",c.lcZ(2,3,"AUTH.A_CODE_HAS_JUST_BEEN_SENT_TO")," "),c.xp6(3),c.Oqu(null==n.user?null:n.user.phonenumber),c.xp6(1),c.hij(" ",c.lcZ(6,5,"AUTH.ENTER_IT_HERE"),"")}}function W(e,t){1&e&&(c.TgZ(0,"div"),c._UZ(1,"ion-spinner",11),c.qZA())}function K(e,t){if(1&e&&(c.TgZ(0,"p"),c.TgZ(1,"ion-text",12),c._uU(2),c.qZA(),c.qZA()),2&e){var n=c.oxw();c.xp6(2),c.Oqu(n.message)}}function X(e,t){if(1&e&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&e){var n=c.oxw(2);c.xp6(1),c.hij("",n.timeLeft," \xa0")}}function z(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div",13),c.TgZ(1,"ion-button",14),c.NdJ("click",function(){return c.CHM(n),c.oxw().resendCode()}),c.YNc(2,X,2,1,"span",6),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.qZA()}if(2&e){var i=c.oxw();c.xp6(1),c.Q6J("disabled",i.timeLeft>0),c.xp6(1),c.Q6J("ngIf",i.timeLeft>0),c.xp6(1),c.Oqu(c.lcZ(4,3,"AUTH.REQUEST_RESEND_CODE"))}}var $=function(){var t=function(){function t(n,i,o,r,s,u){e(this,t),this._authService=n,this.toastService=i,this.router=o,this.navController=r,this.translate=s,this.storage=u,this.code=new a.NI("",[a.kI.required,a.kI.maxLength(4)]),this.loadingFlag=new p.E,this.timeLeft=30,this.requestResend=!1,this.requestFlag=new p.E}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.storage.get("registering").then(function(t){e.user=t})}},{key:"ionViewDidEnter",value:function(){var e=this;this.storage.get("registering").then(function(t){e.user=t}),this.startTimer()}},{key:"onSubmit",value:function(){var e=this;this.message=null;var t={code:this.code.value,email:this.user.email,phonenumber:this.user.phonenumber,activeBy:this.user.activeBy};this.loadingFlag.setPending(!0),this._authService.reqVerifyByCode(t).subscribe(function(t){1==t.status?(e.toastService.success(t.message),e.onLogin()):(e.message=t.message,e.toastService.warning(t.message)),e.loadingFlag.setResult(!0)},function(){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"startTimer",value:function(){var e=this;this.interval=setInterval(function(){e.timeLeft>0&&e.timeLeft--},1e3)}},{key:"resendCode",value:function(){var e=this;this._authService.requestResendOTP(this.user.phonenumber).subscribe(function(t){e.requestResend=!0,1==t.status?e.toastService.success("Farmext \u0111\xe3 g\u1eedi l\u1ea1i m\xe3 x\xe1c th\u1ef1c v\xe0o s\u1ed1 "+e.user.phonenumber):(e.message=t.message,e.toastService.warning(e.message))})}},{key:"onLogin",value:function(){var e=this;this.requestFlag.setPending(!0),this.message=null,this._authService.reqLogin({username:this.user.username,password:this.user.password}).subscribe(function(t){if(1==t.error)e.message=t.message,e.toastService.warning(e.message);else{e._authService.setUser({id:t.data.user.user_id,username:t.data.user.user_name,first_name:t.data.user.first_name,last_name:t.data.user.last_name,email:t.data.user.user_email,photo:t.data.user.user_photo,permission:t.data.user.permission,token:t.data.token}),e.storage.remove("registering");var n=e._authService.redirectUrl?e.router.parseUrl(e._authService.redirectUrl):"/home";e.router.navigateByUrl(n)}e.requestFlag.setResult(!0)},function(){e.requestFlag.setResult(!1),e.message=e.translate.instant("ERROR_CONNECT")})}},{key:"cancelActive",value:function(){this.storage.remove("registering"),this.toastService.warning(this.translate.instant("AUTH.CANCELED_ACTIVE")),this.router.navigateByUrl("/auth/login")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(m.e),c.Y36(T.k),c.Y36(u.F0),c.Y36(l.SH),c.Y36(_.sK),c.Y36(q.Ke))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-email-confirm"]],decls:30,vars:21,consts:[["slot","start"],["text","","defaultHref","auth/login"],["slot","end"],["color","danger",3,"click"],[1,"ion-text-center","ion-padding"],[1,"title","ion-padding"],[4,"ngIf"],["lines","none",1,"ion-text-center"],["required","",1,"l-r",3,"placeholder","formControl"],["shape","round",3,"disabled","click"],["class","ion-text-center bt",4,"ngIf"],["name","dots"],["color","danger"],[1,"ion-text-center","bt"],["shape","round","fill","clear","size","small",3,"disabled","click"]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"ion-buttons",2),c.TgZ(8,"ion-button",3),c.NdJ("click",function(){return t.cancelActive()}),c._uU(9),c.ALo(10,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(11,"ion-content"),c.TgZ(12,"div",4),c.TgZ(13,"h1",5),c.TgZ(14,"small"),c._uU(15,"Hi "),c.qZA(),c.YNc(16,D,2,1,"span",6),c.YNc(17,V,2,1,"span",6),c._uU(18,"! "),c.qZA(),c.YNc(19,j,7,7,"p",6),c.YNc(20,G,7,7,"p",6),c.TgZ(21,"ion-item",7),c._UZ(22,"ion-input",8),c.ALo(23,"translate"),c.qZA(),c.YNc(24,W,2,0,"div",6),c.YNc(25,K,3,1,"p",6),c.TgZ(26,"ion-button",9),c.NdJ("click",function(){return t.onSubmit()}),c._uU(27),c.ALo(28,"translate"),c.qZA(),c.qZA(),c.YNc(29,z,5,5,"div",10),c.qZA()),2&e&&(c.xp6(5),c.Oqu(c.lcZ(6,13,"AUTH.VERIFY")),c.xp6(4),c.Oqu(c.lcZ(10,15,"AUTH.CANCEL_ACTIVE")),c.xp6(7),c.Q6J("ngIf","vi"==t.translate.currentLang),c.xp6(1),c.Q6J("ngIf","en"==t.translate.currentLang),c.xp6(2),c.Q6J("ngIf","email"==(null==t.user?null:t.user.activeBy)),c.xp6(1),c.Q6J("ngIf","phone"==(null==t.user?null:t.user.activeBy)),c.xp6(2),c.Q6J("placeholder",c.lcZ(23,17,"AUTH.VERIFICATION_CODE"))("formControl",t.code),c.xp6(2),c.Q6J("ngIf",t.loadingFlag.pending),c.xp6(1),c.Q6J("ngIf",t.message),c.xp6(1),c.Q6J("disabled",t.code.invalid||t.loadingFlag.pending),c.xp6(1),c.hij("",c.lcZ(28,19,"CONFIRM")," "),c.xp6(2),c.Q6J("ngIf","phone"==(null==t.user?null:t.user.activeBy)&&0==t.requestResend))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.YG,l.W2,s.O5,l.Ie,l.pK,l.j9,a.Q7,a.JJ,a.oH,l.PQ,l.yW],pipes:[_.X$],styles:["[_nghost-%COMP%]   .bt[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}"]}),t}();function ee(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-button",6),c.NdJ("click",function(){return c.CHM(n),c.oxw().changeActive("phone")}),c._uU(1,"SMS"),c.qZA()}}function te(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"ion-button",6),c.NdJ("click",function(){return c.CHM(n),c.oxw().changeActive("email")}),c._uU(1,"Email"),c.qZA()}}function ne(e,t){1&e&&c._UZ(0,"ion-spinner",10)}function ie(e,t){if(1&e&&(c.TgZ(0,"div",7),c.TgZ(1,"p",11),c.TgZ(2,"ion-text",12),c._uU(3),c.qZA(),c.qZA(),c.qZA()),2&e){var n=c.oxw(2);c.xp6(3),c.Oqu(n.message)}}function oe(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-item"),c._UZ(2,"ion-input",13),c.qZA(),c.TgZ(3,"div",14),c.TgZ(4,"ion-button",15),c.NdJ("click",function(){return c.CHM(n),c.oxw(2).onSubmit()}),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&e){var i=c.oxw(2);c.xp6(2),c.Q6J("formControl",i.emailForm),c.xp6(2),c.Q6J("disabled",i.emailForm.invalid||i.reqLoading.pending),c.xp6(1),c.hij(" ",c.lcZ(6,3,"AUTH.SEND_CONFIRM_MAIL"),"")}}function re(e,t){if(1&e&&(c.TgZ(0,"div",7),c.TgZ(1,"h1"),c._UZ(2,"ion-icon",16),c.qZA(),c.TgZ(3,"i",11),c._uU(4),c.ALo(5,"translate"),c.qZA(),c._UZ(6,"br"),c.TgZ(7,"strong"),c._uU(8),c.qZA(),c.TgZ(9,"p"),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.qZA()),2&e){var n=c.oxw(2);c.xp6(4),c.Oqu(c.lcZ(5,3,"AUTH.PLEASE_CHECK_MAIL")),c.xp6(4),c.Oqu(n.emailForm.value),c.xp6(2),c.Oqu(c.lcZ(11,5,"AUTH.AND_RECEIVE_PASS"))}}function se(e,t){if(1&e&&(c.TgZ(0,"div"),c.TgZ(1,"div",7),c.TgZ(2,"h1"),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.TgZ(5,"p"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.YNc(8,ne,1,0,"ion-spinner",8),c.qZA(),c.YNc(9,ie,4,1,"div",9),c.YNc(10,oe,7,5,"div",5),c.YNc(11,re,12,7,"div",9),c.qZA()),2&e){var n=c.oxw();c.xp6(3),c.Oqu(c.lcZ(4,6,"AUTH.FORGOT_PASSWORD")),c.xp6(3),c.Oqu(c.lcZ(7,8,"AUTH.SYSTEM_SEND")),c.xp6(2),c.Q6J("ngIf",n.reqLoading.pending),c.xp6(1),c.Q6J("ngIf",n.message),c.xp6(1),c.Q6J("ngIf",!n.complete),c.xp6(1),c.Q6J("ngIf",n.complete)}}function ae(e,t){1&e&&c._UZ(0,"ion-spinner",10)}function ue(e,t){if(1&e&&(c.TgZ(0,"div",7),c.TgZ(1,"p",11),c.TgZ(2,"ion-text",12),c._uU(3),c.qZA(),c.qZA(),c.qZA()),2&e){var n=c.oxw(2);c.xp6(3),c.Oqu(n.message)}}function le(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-item"),c._UZ(2,"ion-input",17),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",14),c.TgZ(5,"ion-button",15),c.NdJ("click",function(){return c.CHM(n),c.oxw(2).onSubmitByPhone()}),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&e){var i=c.oxw(2);c.xp6(2),c.Q6J("formControl",i.telForm)("placeholder",c.lcZ(3,4,"AUTH.PHONE_NUMBER")),c.xp6(3),c.Q6J("disabled",i.telForm.invalid||i.reqLoading.pending),c.xp6(1),c.hij(" ",c.lcZ(7,6,"AUTH.SEND_CONFIRM_PHONE"),"")}}function ce(e,t){if(1&e&&(c.TgZ(0,"div"),c.TgZ(1,"div",7),c.TgZ(2,"h1"),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.TgZ(5,"p"),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.YNc(8,ae,1,0,"ion-spinner",8),c.qZA(),c.YNc(9,ue,4,1,"div",9),c.YNc(10,le,8,8,"div",5),c.qZA()),2&e){var n=c.oxw();c.xp6(3),c.Oqu(c.lcZ(4,5,"AUTH.FORGOT_PASSWORD")),c.xp6(3),c.Oqu(c.lcZ(7,7,"AUTH.SYSTEM_SEND_SMS")),c.xp6(2),c.Q6J("ngIf",n.reqLoading.pending),c.xp6(1),c.Q6J("ngIf",n.message),c.xp6(1),c.Q6J("ngIf",!n.complete)}}var ge=function(){var t=function(){function t(n,i,o,r){e(this,t),this.authenService=n,this.translate=i,this.router=o,this.navController=r,this.reqLoading=new p.E,this.message="",this.complete=!1,this.activeBy="email",this.emailForm=new a.NI("",[a.kI.required,a.kI.email]),this.telForm=new a.NI("",[a.kI.required,a.kI.minLength(8),a.kI.maxLength(15)])}return n(t,[{key:"ngOnInit",value:function(){}},{key:"onSubmit",value:function(){var e=this;this.reqLoading.setPending(!0),this.authenService.requestResetPasswordByEmail(this.emailForm.value).subscribe(function(t){1==t.status?(e.message=t.message,e.complete=!0):e.message=t.message,e.reqLoading.setResult(!0)},function(){e.message=e.translate.instant("ERROR_CONNECT"),e.reqLoading.setResult(!1)})}},{key:"onSubmitByPhone",value:function(){var e=this;this.reqLoading.setPending(!0),this.authenService.requestResetPasswordByPhone(this.telForm.value).subscribe(function(t){1==t.status?(e.message=t.message,e.complete=!0,e.authenService.userTemp=t.data,e.navController.setDirection("back"),e.router.navigateByUrl("auth/set-password")):e.message=t.message,e.reqLoading.setResult(!0)},function(){e.message=e.translate.instant("ERROR_CONNECT"),e.reqLoading.setResult(!1)})}},{key:"changeActive",value:function(e){this.activeBy=e}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(m.e),c.Y36(_.sK),c.Y36(u.F0),c.Y36(l.SH))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-forgot-password"]],decls:13,vars:7,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["slot","end"],[3,"click",4,"ngIf"],[1,"ion-padding"],[4,"ngIf"],[3,"click"],[1,"ion-text-center"],["slot","start","name","dots",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["slot","start","name","dots"],[1,"sm-text"],["color","danger"],["type","email","inputmode","email","placeholder","Email","autofocus","",3,"formControl"],[1,"ion-padding","ion-text-center"],["shape","round",3,"disabled","click"],["name","checkmark","color","success"],["type","tel","inputmode","tel","autofocus","",3,"formControl","placeholder"]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"ion-buttons",2),c.YNc(8,ee,2,0,"ion-button",3),c.YNc(9,te,2,0,"ion-button",3),c.qZA(),c.qZA(),c.qZA(),c.TgZ(10,"ion-content",4),c.YNc(11,se,12,10,"div",5),c.YNc(12,ce,11,9,"div",5),c.qZA()),2&e&&(c.xp6(5),c.Oqu(c.lcZ(6,5,"AUTH.CONFIRM")),c.xp6(3),c.Q6J("ngIf","email"==t.activeBy),c.xp6(1),c.Q6J("ngIf","phone"==t.activeBy),c.xp6(2),c.Q6J("ngIf","email"==t.activeBy),c.xp6(1),c.Q6J("ngIf","phone"==t.activeBy))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,s.O5,l.W2,l.YG,l.PQ,l.yW,l.Ie,l.pK,l.j9,a.JJ,a.oH,l.gu],pipes:[_.X$],styles:[""]}),t}(),de=["slides"];function me(e,t){1&e&&(c.TgZ(0,"ion-item",15),c.TgZ(1,"ion-label"),c.TgZ(2,"p"),c.TgZ(3,"ion-text",16),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,1,"AUTH.PASSWORD_IS_WEAK")))}var pe=function(){var t=function(){function t(n,i,o,r){e(this,t),this._authService=n,this.translate=i,this.toastService=o,this.router=r,this.code=new a.NI("",[a.kI.required,a.kI.minLength(4),a.kI.maxLength(4)]),this.password=new a.NI("",[a.kI.required,a.kI.minLength(6)]),this.showPassword=!0,this.passwordToggleIcon="eye-off-outline",this.reqLoading=new p.E,this.requestFlag=new p.E,this.message="",this.username=""}return n(t,[{key:"ngOnInit",value:function(){}},{key:"togglePassword",value:function(){this.showPassword?(this.passwordToggleIcon="eye-outline",this.showPassword=!1):(this.passwordToggleIcon="eye-off-outline",this.showPassword=!0)}},{key:"validateCode",value:function(){var e=this;void 0!==this._authService.userTemp?(this.username=this._authService.userTemp.username,this._authService.validateResetPasswordCode({username:this._authService.userTemp.username,code:this.code.value}).subscribe(function(t){1==t.status?e.slides.slideNext():e.toastService.warning(t.message)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT")),e.reqLoading.setResult(!1)})):this.toastService.warning(this.translate.instant("AUTH.UNDEFINED_USER"))}},{key:"setNewPassword",value:function(){var e=this;if(void 0!==this._authService.userTemp){var t={username:this._authService.userTemp.username,code:this.code.value,password:this.password.value};this._authService.resetPasswordCode(t).subscribe(function(n){1==n.status?(e.toastService.warning(n.message),e.onLogin(t.username,t.password)):e.toastService.warning(n.message)},function(){e.toastService.danger(e.translate.instant("ERROR_CONNECT")),e.reqLoading.setResult(!1)})}else this.toastService.warning(this.translate.instant("AUTH.UNDEFINED_USER"))}},{key:"onLogin",value:function(e,t){var n=this;this.requestFlag.setPending(!0),this.message=null,this._authService.reqLogin({username:e,password:t}).subscribe(function(e){if(1==e.error)n.message=e.message,n.toastService.warning(n.message);else{n._authService.setUser({id:e.data.user.user_id,username:e.data.user.user_name,first_name:e.data.user.first_name,last_name:e.data.user.last_name,email:e.data.user.user_email,photo:e.data.user.user_photo,permission:e.data.user.permission,token:e.data.token});var t=n._authService.redirectUrl?n.router.parseUrl(n._authService.redirectUrl):"/home";n.router.navigateByUrl(t)}n.requestFlag.setResult(!0)},function(){n.requestFlag.setResult(!1),n.message="Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i"})}},{key:"validatePassword",value:function(){if(this.password.valid){for(var e=this.password.value,t=[],n=!1,i=0;i<e.length;i++)1+parseInt(e.charAt(i))==e.charAt(i+1)?t.push(!0):t.push(!1);var o=0;t.forEach(function(e,t){e?++o>=5&&(n=!0):o=0}),e===this.username&&(n=!0),this.password.setErrors(n?{weak:!0}:null)}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(m.e),c.Y36(_.sK),c.Y36(T.k),c.Y36(u.F0))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-set-password"]],viewQuery:function(e,t){var n;(1&e&&c.Gf(de,7),2&e)&&(c.iGM(n=c.CRH())&&(t.slides=n.first))},decls:41,vars:29,consts:[["slot","start"],["text","","defaultHref","tabs/management"],["slides",""],[1,"w-100","ion-padding"],[1,"ion-text-center"],["lines","none",1,"ion-text-center"],["required","",1,"l-r",3,"placeholder","formControl"],["shape","round","maxlength","4","minlength","4","type","number","inputmode","numeric",1,"ion-margin",3,"disabled","click"],["slot","end","name","arrow-forward"],[1,"ion-text-center","ion-padding"],["lines","none",4,"ngIf"],["lines","inset"],["inputmode","password",3,"formControl","type","ionChange"],["slot","end",3,"name","click"],["shape","round",1,"ion-margin",3,"disabled","click"],["lines","none"],["color","danger"]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(7,"ion-content"),c.TgZ(8,"ion-slides",null,2),c.TgZ(10,"ion-slide"),c.TgZ(11,"div",3),c.TgZ(12,"div",4),c.TgZ(13,"p"),c._uU(14),c.ALo(15,"translate"),c.qZA(),c.qZA(),c.TgZ(16,"ion-item",5),c._UZ(17,"ion-input",6),c.ALo(18,"translate"),c.qZA(),c.TgZ(19,"ion-button",7),c.NdJ("click",function(){return t.validateCode()}),c._uU(20),c.ALo(21,"translate"),c._UZ(22,"ion-icon",8),c.qZA(),c.qZA(),c.qZA(),c.TgZ(23,"ion-slide"),c.TgZ(24,"div",3),c.TgZ(25,"div",9),c._uU(26),c.ALo(27,"translate"),c.TgZ(28,"b"),c._uU(29),c.qZA(),c._uU(30,"? "),c.qZA(),c.YNc(31,me,6,3,"ion-item",10),c.TgZ(32,"ion-item",11),c.TgZ(33,"ion-label"),c._uU(34),c.ALo(35,"translate"),c.qZA(),c.TgZ(36,"ion-input",12),c.NdJ("ionChange",function(){return t.validatePassword()}),c.qZA(),c.TgZ(37,"ion-icon",13),c.NdJ("click",function(){return t.togglePassword()}),c.qZA(),c.qZA(),c.TgZ(38,"ion-button",14),c.NdJ("click",function(){return t.setNewPassword()}),c._uU(39),c.ALo(40,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(5),c.Oqu(c.lcZ(6,15,"AUTH.CONFIRM")),c.xp6(9),c.Oqu(c.lcZ(15,17,"AUTH.CHECK YOUR_PHONE")),c.xp6(3),c.Q6J("placeholder",c.lcZ(18,19,"AUTH.VERIFICATION_CODE"))("formControl",t.code),c.xp6(2),c.Q6J("disabled",t.code.invalid),c.xp6(1),c.hij(" ",c.lcZ(21,21,"NEXT")," "),c.xp6(6),c.hij(" ",c.lcZ(27,23,"AUTH.ARE_YOU_SURE_SET_NEW_PW_FOR")," "),c.xp6(3),c.Oqu(t.username),c.xp6(2),c.Q6J("ngIf",t.password.hasError("weak")),c.xp6(3),c.hij("",c.lcZ(35,25,"AUTH.PASSWORD"),":"),c.xp6(2),c.Q6J("formControl",t.password)("type",t.showPassword?"text":"password"),c.xp6(1),c.Q6J("name",t.passwordToggleIcon),c.xp6(1),c.Q6J("disabled",t.password.invalid||t.requestFlag.pending),c.xp6(1),c.hij(" ",c.lcZ(40,27,"CONFIRM")," "))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.W2,l.Hr,l.A$,l.Ie,l.pK,l.j9,a.Q7,a.JJ,a.oH,l.YG,l.gu,s.O5,l.Q$,l.yW],pipes:[_.X$],styles:[""]}),t}();function he(e,t){1&e&&(c.TgZ(0,"div"),c._UZ(1,"ion-spinner",12),c.qZA())}function fe(e,t){if(1&e&&(c.TgZ(0,"p"),c.TgZ(1,"ion-text",13),c._uU(2),c.qZA(),c.qZA()),2&e){var n=c.oxw();c.xp6(2),c.Oqu(n.message)}}function Ze(e,t){if(1&e&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&e){var n=c.oxw(2);c.xp6(1),c.hij("",n.timeLeft," \xa0")}}function ve(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div",14),c.TgZ(1,"ion-button",15),c.NdJ("click",function(){return c.CHM(n),c.oxw().resendCode()}),c.YNc(2,Ze,2,1,"span",9),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.qZA()}if(2&e){var i=c.oxw();c.xp6(1),c.Q6J("disabled",i.timeLeft>0),c.xp6(1),c.Q6J("ngIf",i.timeLeft>0),c.xp6(1),c.Oqu(c.lcZ(4,3,"AUTH.REQUEST_RESEND_CODE"))}}var Ae=[{path:"",component:g},{path:"login",component:O},{path:"signup",component:B},{path:"forgot",component:ge},{path:"email-confirm",component:$},{path:"phone-confirm",component:function(){var t=function(){function t(n,i,o,r,s,u){var l=this;e(this,t),this._authService=n,this.toastService=i,this.router=o,this.navController=r,this.translate=s,this.storage=u,this.code=new a.NI("",[a.kI.required,a.kI.minLength(4),a.kI.maxLength(4),a.kI.pattern("^[0-9]{4}$")]),this.loadingFlag=new p.E,this.timeLeft=30,this.requestResend=!1,this.requestFlag=new p.E,this.code.valueChanges.subscribe(function(){console.log(l.code.valid),l.code.valid&&l.onSubmit()})}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.storage.get("phoneOTP").then(function(t){e.phone=t})}},{key:"ionViewDidEnter",value:function(){var e=this;this.storage.get("phoneOTP").then(function(t){e.phone=t}),this.startTimer()}},{key:"onSubmit",value:function(){var e=this;console.log("on submit"),this.message=null;var t={code:this.code.value,phone:this.phone};this.loadingFlag.setPending(!0),this._authService.reqAuthValidateOTPCode(t).subscribe(function(t){if(1==t.status)if(void 0!==t.data){e._authService.setUser({id:t.data.user.user_id,username:t.data.user.user_name,first_name:t.data.user.first_name,last_name:t.data.user.last_name,email:t.data.user.user_email,photo:t.data.user.user_photo,permission:t.data.user.permission,token:t.data.token}),e.storage.remove("phoneOTP");var n=e._authService.redirectUrl?e.router.parseUrl(e._authService.redirectUrl):"/tabs/management";e.router.navigateByUrl(n)}else e.toastService.warning(t.message);else e.message=t.message,e.toastService.warning(t.message);e.loadingFlag.setResult(!0),console.log(e.loadingFlag.pending)},function(){e.loadingFlag.setResult(!1),e.toastService.danger(e.translate.instant("ERROR_CONNECT"))})}},{key:"startTimer",value:function(){var e=this;this.interval=setInterval(function(){e.timeLeft>0&&e.timeLeft--},1e3)}},{key:"resendCode",value:function(){var e=this;this._authService.reqAuthResendOTPCode({phone:this.phone}).subscribe(function(t){e.requestResend=!0,1==t.status?e.toastService.success("Farmext \u0111\xe3 g\u1eedi l\u1ea1i m\xe3 OTP v\xe0o s\u1ed1 "+e.phone):(e.message=t.message,e.toastService.warning(e.message))})}},{key:"cancelActive",value:function(){this.storage.remove("registering"),this.toastService.warning(this.translate.instant("AUTH.CANCELED_ACTIVE")),this.router.navigateByUrl("/auth/login")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(m.e),c.Y36(T.k),c.Y36(u.F0),c.Y36(l.SH),c.Y36(_.sK),c.Y36(q.Ke))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-phone-confirm"]],decls:30,vars:21,consts:[["slot","start"],["text","","defaultHref","auth/login"],["slot","end"],["color","danger",3,"click"],[1,"ion-text-center","ion-padding"],[1,"title"],[1,"text-sm"],["lines","none",1,"ion-text-center"],["required","","inputmode","numeric","autocomplete","one-time-code","size","4",1,"l-r","input-code",3,"placeholder","formControl"],[4,"ngIf"],["shape","round",3,"disabled","click"],["class","ion-text-center bt",4,"ngIf"],["name","dots"],["color","danger"],[1,"ion-text-center","bt"],["shape","round","fill","clear","size","small",3,"disabled","click"]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"ion-buttons",2),c.TgZ(8,"ion-button",3),c.NdJ("click",function(){return t.cancelActive()}),c._uU(9),c.ALo(10,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(11,"ion-content"),c.TgZ(12,"div",4),c.TgZ(13,"h4",5),c.TgZ(14,"small"),c._uU(15,"Nh\u1eadp m\xe3 x\xe1c th\u1ef1c OTP"),c.qZA(),c.qZA(),c.TgZ(16,"p",6),c._uU(17),c.ALo(18,"translate"),c.TgZ(19,"b"),c._uU(20),c.qZA(),c.qZA(),c.TgZ(21,"ion-item",7),c._UZ(22,"ion-input",8),c.ALo(23,"translate"),c.qZA(),c.YNc(24,he,2,0,"div",9),c.YNc(25,fe,3,1,"p",9),c.TgZ(26,"ion-button",10),c.NdJ("click",function(){return t.onSubmit()}),c._uU(27),c.ALo(28,"translate"),c.qZA(),c.qZA(),c.YNc(29,ve,5,5,"div",11),c.qZA()),2&e&&(c.xp6(5),c.Oqu(c.lcZ(6,11,"AUTH.VERIFY")),c.xp6(4),c.Oqu(c.lcZ(10,13,"AUTH.CANCEL_ACTIVE")),c.xp6(8),c.hij("",c.lcZ(18,15,"AUTH.A_CODE_HAS_JUST_BEEN_SENT_TO")," "),c.xp6(3),c.Oqu(t.phone),c.xp6(2),c.Q6J("placeholder",c.lcZ(23,17,"AUTH.VERIFICATION_CODE"))("formControl",t.code),c.xp6(2),c.Q6J("ngIf",t.loadingFlag.pending),c.xp6(1),c.Q6J("ngIf",t.message),c.xp6(1),c.Q6J("disabled",t.code.invalid||t.loadingFlag.pending),c.xp6(1),c.hij("",c.lcZ(28,19,"CONFIRM")," "),c.xp6(2),c.Q6J("ngIf",0==t.requestResend))},directives:[l.Gu,l.sr,l.Sm,l.oU,l.cs,l.wd,l.YG,l.W2,l.Ie,l.pK,l.j9,a.Q7,a.JJ,a.oH,s.O5,l.PQ,l.yW],pipes:[_.X$],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #e3f4fd url(/assets/img/background.svg) bottom center no-repeat !important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent!important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--background: #fff;border-radius:10px}[_nghost-%COMP%]   .text-sm[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .bt[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}"]}),t}()},{path:"set-password",component:pe}],Te=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({providers:[v,A],imports:[[s.ez,a.u5,l.Pc,a.UX,f.Tn,u.Bz.forChild(Ae),_.aw.forChild()]]}),t}()},27887:function(t,i,o){o.d(i,{E:function(){return r}});var r=function(){function t(){e(this,t),this.start=null,this.end=null,this.pending=null,this.result=null,this.count=0}return n(t,[{key:"setStart",value:function(e){this.start=e,!0===e&&(this.pending=!0,this.end=!1),this.result=null,this.count++}},{key:"setPending",value:function(e){this.pending=e,!1===e?this.start=!1:this.end=!0}},{key:"setResult",value:function(e){this.result=e,this.pending=!1,this.start=!1,this.end=!0}}]),t}()}}])}();