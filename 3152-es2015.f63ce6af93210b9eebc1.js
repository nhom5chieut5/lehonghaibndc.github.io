"use strict";(self.webpackChunkFarmext2=self.webpackChunkFarmext2||[]).push([[3152],{66341:function(e,t,i){i.d(t,{n:function(){return o}});var s=i(88002),n=i(15189),r=i(37716);let o=(()=>{class e{constructor(e){this.reqAPIService=e,this.urlApi="/manager/farm-api"}searchMember(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-user&key="+e).pipe((0,s.U)(e=>e.data))}searchExpert(e){return this.reqAPIService.get("/user/list-api-mobie?action=get-expert&key="+e).pipe((0,s.U)(e=>e.data))}getSitePath(){return this.reqAPIService.FILE_PATH}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(n.$))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})()},54101:function(e,t,i){i.d(t,{C:function(){return Z}});var s=i(90665),n=i(28049),r=i(27887),o=i(22923),a=i(37716),l=i(47063),c=i(81780),u=i(84465),g=i(71239),d=i(38583);function m(e,t){if(1&e&&(a.TgZ(0,"div",13),a.TgZ(1,"ion-text",14),a.TgZ(2,"i"),a._uU(3),a.qZA(),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(3),a.Oqu(e.message)}}function h(e,t){1&e&&(a.TgZ(0,"div"),a._UZ(1,"ion-spinner",15),a.qZA())}let Z=(()=>{class e{constructor(e,t,i,n,o){this.modalController=e,this.translate=t,this.storeService=i,this.toastService=n,this.dbLocalService=o,this.form=new s.cw({name:new s.NI("",s.kI.required),area:new s.NI("",s.kI.required),description:new s.NI("")}),this.savingFlag=new r.E,this.manager=[]}ngOnInit(){this.form.setValue({name:this.data.name,area:this.data.area,description:this.data.description})}onSubmit(){this.savingFlag.setPending(!0),this.storeService.sendPost("edit",this.form.value).pipe((0,n.P)()).subscribe(e=>{if(1===e.status){this.modalController.dismiss(this.form.value);let e=this.dbLocalService.stores.findIndex(e=>e.infor.code===this.storeService.getStoreCode());e>=0&&(this.dbLocalService.stores[e].infor.name=this.form.value.name,this.dbLocalService.stores[e].infor.area=this.form.value.area,this.dbLocalService.stores[e].infor.description=this.form.value.description,this.dbLocalService.setLocalData("stores",this.dbLocalService.stores))}else this.message=e.error;this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.message=this.translate.instant("ERROR_CONNECT")})}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(l.IN),a.Y36(c.sK),a.Y36(o.d),a.Y36(u.k),a.Y36(g.T))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-store-edit"]],inputs:{data:"data"},decls:32,vars:19,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],["class","ion-padding ion-text-center",4,"ngIf"],[3,"formGroup","ngSubmit"],["lines","inset"],["position","floating"],["type","text","formControlName","name","inputmode","text"],["type","number","formControlName","area","inputmode","text"],["type","text","formControlName","description","inputmode","text"],[1,"ion-text-center","ion-padding"],[4,"ngIf"],["type","submit","color","primary","shape","round",3,"disabled"],[1,"ion-padding","ion-text-center"],["color","danger"],["name","dots"]],template:function(e,t){1&e&&(a.TgZ(0,"ion-header"),a.TgZ(1,"ion-toolbar"),a.TgZ(2,"ion-buttons",0),a.TgZ(3,"ion-button",1),a.NdJ("click",function(){return t.modalController.dismiss()}),a._UZ(4,"ion-icon",2),a.qZA(),a.qZA(),a.TgZ(5,"ion-title"),a._uU(6),a.ALo(7,"translate"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(8,"ion-content"),a.YNc(9,m,4,1,"div",3),a.TgZ(10,"form",4),a.NdJ("ngSubmit",function(){return t.onSubmit()}),a.TgZ(11,"ion-list"),a.TgZ(12,"ion-item",5),a.TgZ(13,"ion-label",6),a._uU(14),a.ALo(15,"translate"),a.qZA(),a._UZ(16,"ion-input",7),a.qZA(),a.TgZ(17,"ion-item",5),a.TgZ(18,"ion-label",6),a._uU(19),a.ALo(20,"translate"),a.qZA(),a._UZ(21,"ion-input",8),a.qZA(),a.TgZ(22,"ion-item",5),a.TgZ(23,"ion-label",6),a._uU(24),a.ALo(25,"translate"),a.qZA(),a._UZ(26,"ion-textarea",9),a.qZA(),a.qZA(),a.TgZ(27,"div",10),a.YNc(28,h,2,0,"div",11),a.TgZ(29,"ion-button",12),a._uU(30),a.ALo(31,"translate"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.xp6(6),a.Oqu(a.lcZ(7,9,"WAREHOUSE_MOD.UPDATE_INFOR")),a.xp6(3),a.Q6J("ngIf",t.message),a.xp6(1),a.Q6J("formGroup",t.form),a.xp6(4),a.Oqu(a.lcZ(15,11,"WAREHOUSE_MOD.NAME")),a.xp6(5),a.Oqu(a.lcZ(20,13,"AREA")),a.xp6(5),a.Oqu(a.lcZ(25,15,"PHOTO_MOD.DESCRIPTION")),a.xp6(4),a.Q6J("ngIf",t.savingFlag.pending),a.xp6(1),a.Q6J("disabled",t.form.invalid||t.savingFlag.pending),a.xp6(1),a.hij("",a.lcZ(31,17,"WAREHOUSE_MOD.SAVE")," "))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,d.O5,s._Y,s.JL,s.sg,l.q_,l.Ie,l.Q$,l.pK,l.j9,s.JJ,s.u,l.as,l.g2,l.yW,l.PQ],pipes:[c.X$],styles:[""]}),e})()},12039:function(e,t,i){i.d(t,{N:function(){return f}});var s=i(64762),n=i(79765),r=i(25917),o=i(54395),a=i(87519),l=i(43190),c=i(27887),u=i(66341),g=i(22923),d=i(37716),m=i(47063),h=i(84465),Z=i(81780),p=i(38583);function A(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-avatar",0),d._UZ(2,"img",8),d.qZA(),d.TgZ(3,"ion-label"),d.TgZ(4,"h3"),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"ion-button",9),d.NdJ("click",function(){const t=d.CHM(e).index;return d.oxw().presentRemoveUser(t)}),d._uU(7),d.ALo(8,"translate"),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(5),d.Oqu(e.user_name),d.xp6(2),d.hij(" ",d.lcZ(8,2,"POND_MOD.DELETE")," ")}}function T(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-avatar",0),d._UZ(2,"img",10),d.qZA(),d.TgZ(3,"ion-label"),d.TgZ(4,"h3"),d._uU(5),d.qZA(),d.TgZ(6,"p"),d._uU(7),d.qZA(),d.qZA(),d.TgZ(8,"ion-button",11),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().addPermission(t)}),d._uU(9),d.ALo(10,"translate"),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,i=d.oxw();d.xp6(2),d.Q6J("src",i.memberService.getSitePath()+"/upload/users/avatars/medium/"+e.photo,d.LSH),d.xp6(3),d.Oqu(e.username),d.xp6(2),d.Oqu(e.email),d.xp6(1),d.Q6J("disabled",i.checkExistUser(e)),d.xp6(1),d.hij(" ",d.lcZ(10,5,"POND_MOD.SELECT")," ")}}function v(e,t){if(1&e&&(d.TgZ(0,"ion-item",12),d.TgZ(1,"ion-label"),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(3),d.Oqu(e.message)}}function q(e,t){1&e&&(d.TgZ(0,"div"),d._UZ(1,"ion-spinner",13),d.qZA())}let f=(()=>{class e{constructor(e,t,i,s,r,o){this.modalController=e,this.storeService=t,this.memberService=i,this.toastService=s,this.translate=r,this.alertController=o,this.savingFlag=new c.E,this.loadingFlag=new c.E,this.searchTerms=new n.xQ}ngOnInit(){let e=this.searchTerms.pipe((0,o.b)(300),(0,a.x)(),(0,l.w)(e=>this.getListMember(e)));this.members$=e,this.members$.subscribe(e=>{e?(this.loadingFlag.setResult(!0),this.message=""):(this.loadingFlag.setResult(!1),this.message=this.translate.instant("POND_MOD.NOT_FOUND"))})}search(e){this.searchTerms.next(e.detail.value)}getListMember(e){return this.loadingFlag.setPending(!0),e.trim()?this.memberService.searchMember(e).pipe():(this.loadingFlag.setResult(!0),(0,r.of)([]))}onSelect(e){this.memberSelected=e}addPermission(e){this.storeService.sendPost("addMember",{user_manager:e.user_id}).pipe().subscribe(t=>{0==t.status?this.toastService.warning(t.error):(this.manager.push({user_name:e.username,user_id:e.user_id}),this.toastService.success(this.translate.instant("FARM_MOD.ADDED_STAFF"))),this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}removePermission(e){this.storeService.getApiStore("removeMember","&user_id="+this.manager[e].user_id).pipe().subscribe(t=>{0==t.status?this.toastService.warning(t.error):(this.manager.splice(e,1),this.toastService.success(this.translate.instant("FARM_MOD.REMOVED_STAFF"))),this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentRemoveUser(e){return(0,s.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:this.translate.instant("CONFIRM")+"!",message:this.translate.instant("FARM_MOD.CONFIRM_REMOVE"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{this.removePermission(e)}}]})).present()})}close(){this.modalController.dismiss(this.manager)}checkExistUser(e){for(let t=0;t<this.manager.length;t++)if(this.manager[t].user_name==e.username)return!0;return!1}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(m.IN),d.Y36(g.d),d.Y36(u.n),d.Y36(h.k),d.Y36(Z.sK),d.Y36(m.Br))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-store-manager"]],inputs:{manager:"manager"},decls:23,vars:15,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[3,"placeholder","ionChange"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"ion-text-center"],[4,"ngIf"],["src","assets/img/default-profile.jpg"],["slot","end","color","danger",3,"click"],["onError","this.src='assets/img/default-profile.jpg'",3,"src"],["slot","end",3,"disabled","click"],["lines","none"],["name","dots"]],template:function(e,t){1&e&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-buttons",0),d.TgZ(3,"ion-button",1),d.NdJ("click",function(){return t.close()}),d._UZ(4,"ion-icon",2),d.qZA(),d.qZA(),d.TgZ(5,"ion-title"),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"ion-content"),d.TgZ(9,"ion-searchbar",3),d.NdJ("ionChange",function(e){return t.search(e)}),d.ALo(10,"translate"),d.qZA(),d.TgZ(11,"ion-list"),d.YNc(12,A,9,4,"ion-item",4),d.qZA(),d.TgZ(13,"ion-list"),d.TgZ(14,"ion-list-header"),d.TgZ(15,"ion-label"),d._uU(16),d.ALo(17,"translate"),d.qZA(),d.qZA(),d.YNc(18,T,11,7,"ion-item",4),d.ALo(19,"async"),d.YNc(20,v,4,1,"ion-item",5),d.qZA(),d.TgZ(21,"div",6),d.YNc(22,q,2,0,"div",7),d.qZA(),d.qZA()),2&e&&(d.xp6(6),d.Oqu(d.lcZ(7,7,"FARM_MOD.MEMBER")),d.xp6(3),d.Q6J("placeholder",d.lcZ(10,9,"FARM_MOD.MANAGER_EMAIL")),d.xp6(3),d.Q6J("ngForOf",t.manager),d.xp6(4),d.Oqu(d.lcZ(17,11,"POND_MOD.RESULT")),d.xp6(2),d.Q6J("ngForOf",d.lcZ(19,13,t.members$)),d.xp6(2),d.Q6J("ngIf",t.message),d.xp6(2),d.Q6J("ngIf",t.loadingFlag.pending))},directives:[m.Gu,m.sr,m.Sm,m.YG,m.gu,m.wd,m.W2,m.VI,m.j9,m.q_,p.sg,m.yh,m.Q$,p.O5,m.Ie,m.BJ,m.PQ],pipes:[Z.X$,p.Ov],styles:[""]}),e})()},93152:function(e,t,i){i.d(t,{T:function(){return h}});var s=i(64762),n=i(27887),r=i(54101),o=i(12039),a=i(22923),l=i(37716),c=i(47063),u=i(81780),g=i(84465),d=i(71239),m=i(13619);let h=(()=>{class e{constructor(e,t,i,s,r,o,a){this.modalController=e,this.storeService=t,this.translate=i,this.toastService=s,this.alertController=r,this.dbLocalService=o,this.router=a,this.loading=new n.E,this.manager=[]}ngOnInit(){this.getSetting()}getSetting(){this.loading.setPending(!0),this.storeService.getApiStore("getSetting").subscribe(e=>{1===e.status?(this.store=e.data.infor,this.manager=e.data.managers):this.toastService.warning(e.error)},e=>{this.toastService.danger(this.translate.instant("ERROR_CONNECT"))})}presentManager(){return(0,s.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:o.N,componentProps:{manager:this.manager}});return e.onDidDismiss().then(e=>{e.data&&(this.manager=e.data)}),yield e.present()})}presentEdit(){return(0,s.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:r.C,componentProps:{data:this.store}});return e.onDidDismiss().then(e=>{e.data&&(this.store.name=e.data.name,this.store.area=e.data.area,this.store.description=e.data.description)}),yield e.present()})}presentDelete(){return(0,s.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:this.translate.instant("POND_MOD.CAREFUL"),message:this.translate.instant("POND_MOD.CONFIRM_DELETE")+" <strong>"+this.store.name+"</strong>?",inputs:[{name:"confirmInput",type:"text",placeholder:this.translate.instant("POND_MOD.ENTER")+' "OK"'}],buttons:[{text:this.translate.instant("NO"),role:"cancel",cssClass:"secondary"},{text:this.translate.instant("POND_MOD.DELETE"),cssClass:"secondary",handler:e=>{"OK"===e.confirmInput&&this.delete()}}]})).present()})}delete(){this.storeService.getApiStore("remove","&wcode="+this.store.code+"&fcode="+this.storeService.getFarmCode(),"manager/store-api-mobie").pipe().subscribe(e=>{if(1==e.status){let e=this.dbLocalService.stores.findIndex(e=>e.infor.code===this.store.code);this.dbLocalService.stores.splice(e,1),this.dbLocalService.setLocalData("stores",this.dbLocalService.stores),this.toastService.success(this.translate.instant("WAREHOUSE_MOD.DELETED")),this.modalController.dismiss(),this.router.navigateByUrl("store/"+this.storeService.getFarmCode()+"/list")}else this.toastService.warning(e.error)})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.IN),l.Y36(a.d),l.Y36(u.sK),l.Y36(g.k),l.Y36(c.Br),l.Y36(d.T),l.Y36(m.F0))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-store-setting"]],decls:56,vars:29,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding","ion-text-center"],[1,""],["name","cube-outline","slot","start"],["name","book-outline","slot","start"],["detail","",3,"click"],["src","assets/icon/supervised_user_circle-24px.svg","slot","start"],["mode","ios"],["name","options"],["size","large","expand","block","shape","round","fill","outline",3,"click"],["name","create-outline","slot","start"],["size","small","color","medium","expand","block","fill","clear",3,"click"],["name","remove-circle-outline","slot","start"]],template:function(e,t){1&e&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l.TgZ(3,"ion-button",1),l.NdJ("click",function(){return t.modalController.dismiss()}),l._UZ(4,"ion-icon",2),l.qZA(),l.qZA(),l.TgZ(5,"ion-title"),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"ion-content"),l.TgZ(9,"div",3),l.TgZ(10,"h1",4),l._uU(11),l.qZA(),l.TgZ(12,"span"),l._uU(13),l.qZA(),l.qZA(),l.TgZ(14,"ion-list"),l.TgZ(15,"ion-item"),l._UZ(16,"ion-icon",5),l.TgZ(17,"ion-label"),l.TgZ(18,"h3"),l._uU(19),l.ALo(20,"translate"),l.qZA(),l.TgZ(21,"p"),l._uU(22),l.qZA(),l.qZA(),l.qZA(),l.TgZ(23,"ion-item"),l._UZ(24,"ion-icon",6),l.TgZ(25,"ion-label"),l.TgZ(26,"h3"),l._uU(27),l.ALo(28,"translate"),l.qZA(),l.TgZ(29,"p"),l._uU(30),l.qZA(),l.qZA(),l.qZA(),l.TgZ(31,"ion-item",7),l.NdJ("click",function(){return t.presentManager()}),l._UZ(32,"ion-icon",8),l.TgZ(33,"ion-label"),l.TgZ(34,"h3"),l._uU(35),l.ALo(36,"translate"),l.qZA(),l.TgZ(37,"p"),l._uU(38),l.ALo(39,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(40,"div"),l.TgZ(41,"ion-card",9),l.TgZ(42,"ion-card-header"),l.TgZ(43,"ion-card-subtitle"),l._UZ(44,"ion-icon",10),l._uU(45),l.ALo(46,"translate"),l.qZA(),l.qZA(),l.TgZ(47,"ion-card-content"),l.TgZ(48,"ion-button",11),l.NdJ("click",function(){return t.presentEdit()}),l._UZ(49,"ion-icon",12),l._uU(50),l.ALo(51,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(52,"ion-button",13),l.NdJ("click",function(){return t.presentDelete()}),l._UZ(53,"ion-icon",14),l._uU(54),l.ALo(55,"translate"),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(6),l.Oqu(l.lcZ(7,13,"WAREHOUSE_MOD.SETTING")),l.xp6(5),l.Oqu(null==t.store?null:t.store.name),l.xp6(2),l.hij("#",null==t.store?null:t.store.code,""),l.xp6(6),l.Oqu(l.lcZ(20,15,"AREA")),l.xp6(3),l.hij("",null==t.store?null:t.store.area," m2"),l.xp6(5),l.Oqu(l.lcZ(28,17,"PHOTO_MOD.DESCRIPTION")),l.xp6(3),l.Oqu(null==t.store?null:t.store.description),l.xp6(5),l.Oqu(l.lcZ(36,19,"FARM_MOD.MANAGER")),l.xp6(3),l.AsE("",null==t.manager?null:t.manager.length," ",l.lcZ(39,21,"FARM_MOD.MEMBER"),""),l.xp6(7),l.hij(" ",l.lcZ(46,23,"WAREHOUSE_MOD.SETTING")," "),l.xp6(5),l.hij(" ",l.lcZ(51,25,"FARM_MOD.EDIT")," "),l.xp6(4),l.hij(" ",l.lcZ(55,27,"DEVICE_MOD.REMOVE")," "))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,c.q_,c.Ie,c.Q$,c.PM,c.Zi,c.tO,c.FN],pipes:[u.X$],styles:[""]}),e})()}}]);